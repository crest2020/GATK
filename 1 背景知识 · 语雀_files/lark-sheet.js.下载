var GC,Common={};!function e(t,n){"object"==typeof exports&&"object"==typeof module?(Common=module.exports=n(),window.GC=window.GC||{},window.GC.Spread=Common):"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.Spread=n():(Common=n(),t.GC=t.GC||{},t.GC.Spread=Common)}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";t.Common=n(1),t.Commands=n(13),t.Formatter=n(16),t.Sparklines=n(19),t.Slicers=n(21)}()},function(e,t,n){!function(){"use strict";var t,r,o=n(2);n(10),t=n(3),i(o,t),r=n(11),i(o,r),o._Types=n(4),o._ArrayHelper=n(9),o._DateTimeHelper=n(8),o._NumberHelper=n(5),o._RegexHelper=n(6),o._StringHelper=n(7),o.SR={},o.SR.en=n(12),e.exports=o;function i(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}}()},function(e,t,n){!function(){"use strict";var t={},r=n(3).CultureManager,o=function(e){return function(){var t,n=r.culture();return e&&n?(t=n.substr(0,2).toLowerCase(),e.hasOwnProperty(t)?e[t]:e.en):{}}};function i(e,t,n,r){var o,i,a,l,s;if(e&&0<=n&&n<t){for(o=[],a=n;a<t;a++)void 0!==e[a]&&o.push(a);for(i=o.length,a=0;a<i;a++)l=o[i-a-1],s=e[l],e[l]=null,e[Math.floor(l)+r]=s}}function a(e,t,n,r){var o,i,a,l,s,u;if(e&&0<=n&&n<t){for(o=[],a=n+r,l=n;l<t;l++)void 0!==e[l]&&(n<=l&&l<a?e[l]=null:l>=a&&o.push(l));for(i=o.length,l=0;l<i;l++)s=o[l],u=e[s],e[s]=null,e[Math.floor(s)-r]=u}}function l(e,t){return e.hasOwnProperty(t)}function s(e,t){return e instanceof t}t._addElements=i,t._deleteElements=a,t._getResource=o,t._hasOwnProperty=l,t._isInstanceOf=s,e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c=n(4),_=void 0,f=null,d=c._inherit,h=c._each,g=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"],p=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"],m=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],v=g.concat(p);h(g,function(e,t){h(p,function(e,n){e<p.length-4&&v.push(t+" "+n)})}),v=v.concat(m),h(m,function(e,t){h(p,function(e,n){e<p.length-4&&v.push(t+" "+n)})}),t=function(){function e(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"\xa4",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"\u2030",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM"},this.name=function(){return""},this.id=-1}e.prototype={constructor:e,_getDateTimePattern:function(){var e,t,n;return this._dateTimeFormatPattern||(e=this.DateTimeFormat,t=e.shortDatePattern.replace(/m/g,"M"),n=[t,t+" h:mm",t+" h:mm:ss",t+" h:mm:ss.0"],this._dateTimeFormatPattern=n.concat(v)),this._dateTimeFormatPattern},_getMonthIndex:function(e){var t=this;return t._upperMonths||(t._upperMonths=n(t.DateTimeFormat.monthNames),t._upperMonthsGenitive=n(t.DateTimeFormat.monthGenitiveNames)),r(e,t._upperMonths,t._upperMonthsGenitive)},_getAbbrMonthIndex:function(e){var t=this;return t._upperAbbrMonths||(t._upperAbbrMonths=n(t.DateTimeFormat.abbreviatedMonthNames),t._upperAbbrMonthsGenitive=n(t.DateTimeFormat.abbreviatedMonthGenitiveNames)),r(e,t._upperAbbrMonths,t._upperAbbrMonthsGenitive)},_getDayIndex:function(e){var r=this;return r._upperDays||(r._upperDays=n(r.DateTimeFormat.dayNames)),r._upperDays.indexOf(t(e))},_getAbbrDayIndex:function(e){var r=this;return r._upperAbbrDays||(r._upperAbbrDays=n(r.DateTimeFormat.abbreviatedDayNames)),r._upperAbbrDays.indexOf(t(e))}};function t(e){return e.split("\xa0").join(" ").toUpperCase()}function n(e){var n,r,o=[];for(n=0,r=e.length;n<r;n++)o[n]=t(e[n]);return o}function r(e,n,r){var o=t(e),i=n.indexOf(o);return-1===i&&(i=r.indexOf(o)),i}return e}(),r=function(){function e(){}return e._isValidEraDate=function(e){return e>=this._getEraMin()&&e<=this._getEraMax()},e._getEraDates=function(){var e,n,r=t.eras;if(r!==_){for(e=[],n=0;n<r.length;n++)e[n]=new Date(r[n].startDate.replace(/-/g,"/"));return e}return this._EraDates},e._getEraPropByFormat=function(e){var n,r,o,i,a,l=this;switch(e){case"g":n="symbol",r=l._symbols;break;case"gg":n="abbreviation",r=l._abbreviations;break;case"ggg":n="name",r=l._names;break;default:return[]}if(o=t.eras,i=[],o!==_){for(a=0;a<o.length;a++)i[a]=o[a][n];return i}return r},e._getEraMax=function(){var e,n=t.eras;return n!==_&&n.length>0?(e=new Date(n[n.length-1].startDate.replace(/-/g,"/")),e.setFullYear(e.getFullYear()+99),e):this._EraMax},e._getEraMin=function(){var e=t.eras;return e!==_&&e.length>0?new Date(e[0].startDate.replace(/-/g,"/")):this._EraMin},e._getEraCount=function(){var e=t.eras;return e!==_?e.length:this._EraCount},e._getEraYears=function(){var e,n,r,o,i=t.eras;if(i!==_){for(e=[],n=1;n<i.length;n++)r=new Date(i[n-1].startDate.replace(/-/g,"/")),o=new Date(i[n].startDate.replace(/-/g,"/")),e[n-1]=o.getFullYear()-r.getFullYear()+1;return e[n-1]=99,e}return this._EraYears},e._getEraDate=function(e){var t,n,r,o={};if(o._era=-1,o._eraYear=-1,t=this,!t._isValidEraDate(e))return o;for(n=0;n<t._getEraCount();n++)if(r=n+1!==t._getEraCount()?t._getEraDates()[n+1]:t._addMilliseconds(t._getEraMax(),1),e<r){o._era=n,o._eraYear=e.getFullYear()-t._getEraDates()[n].getFullYear()+1;break}return o},e._addMilliseconds=function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds());return n.setMilliseconds(n.getMilliseconds()+t),new Date(n.valueOf())},e._getYearFromEra=function(t,n){return e._getEraDates()[t].getFullYear()+n-1},e._parseEraPart=function(t,n){var r,o;for(n=n.toUpperCase(),r=e._getEraPropByFormat(t),o=0;o<r.length;o++)if(r[o]===n)return o;return-1},e._formatEraPart=function(t,n){var r,o,i,a=e,l=a._getEraDate(n),s=l._era;if(s>=0&&(r=a._getEraPropByFormat(t),r.length>0))return r[s];if((o=l._eraYear)>=0){if(i=""+o,"ee"===t)return 1===i.length&&(i="0"+i),i;if("e"===t)return i}return""},e._EraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],e._EraCount=4,e._EraYears=[45,15,64,99],e._EraMax=new Date(2087,11,31,23,59,59),e._EraMin=new Date(1868,8,8),e._shortcuts=["1,m","2,t","3,s","4,h"],e._EraIndices=[0,1,2,3,0,1,2,3],e._names=["\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210"],e._symbols=["M","T","S","H"],e._abbreviations=["\u660e","\u5927","\u662d","\u5e73"],e._EraYearMax=99,e}(),o=function(e){d(t,e);function t(){e.apply(this,arguments),C.call(this,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),C.call(this,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!1]),this.name=function(){return"en-US"},this.id=1033}return t}(t),i=function(e){d(t,e);function t(){var t,n,o;e.apply(this,arguments),t={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u3007","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\u62fe","\u5104","\u9621","\u767e","\u62fe","\u842c","\u9621","\u767e","\u62fe",""],numbers:["\u3007","\u58f1","\u5f10","\u53c2","\u56db","\u4f0d","\u516d","\u4e03","\u516b","\u4e5d"]},3:{letters:f,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},C.call(this,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[0,1,"\xa5",!1,"NaN (\u975e\u6570\u5024)","-\u221e",1,1,"+\u221e",t]),n=["1","2","3","4","5","6","7","8","9","10","11","12",""],o=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],C.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern"],[["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],n,n,"\u5348\u524d",!1,["\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"],"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",o,o,"\u897f\u66a6 (\u65e5\u672c\u8a9e)","\u5348\u5f8c","yyyy/MM/dd",["\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"],"H:mm","yyyy'\u5e74'M'\u6708'"]),this.DateTimeFormat.eras=r,this.name=function(){return"ja-JP"},this.id=1041}return t}(t),a=function(e){d(t,e);function t(){var t,n,r;e.apply(this,arguments),t={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u4ebf","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\u25cb","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u4edf","\u4f70","\u62fe","\u4ebf","\u4edf","\u4f70","\u62fe","\u4e07","\u4edf","\u4f70","\u62fe",""],numbers:["\u96f6","\u58f9","\u8d30","\u53c1","\u8086","\u4f0d","\u9646","\u67d2","\u634c","\u7396"]},3:{letters:f,numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},C.call(this,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber"],[2,"\xa5",!1,"\u975e\u6570\u5b57","\u8d1f\u65e0\u7a77\u5927",1,1,"\u6b63\u65e0\u7a77\u5927",t]),n=["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708",""],r=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708",""],C.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern"],[["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],n,n,"\u4e0a\u5348",!1,["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],1,"yyyy'\u5e74'M'\u6708'd'\u65e5' H:mm:ss","yyyy'\u5e74'M'\u6708'd'\u65e5'","H:mm:ss","M'\u6708'd'\u65e5'",r,r,"\u516c\u5386","\u4e0b\u5348","yyyy/M/d",["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"],"H:mm","yyyy'\u5e74'M'\u6708'"]),this.name=function(){return"zh-cn"},this.id=2052}return t}(t),l=function(e){d(t,e);function t(){var t,n,r;e.apply(this,arguments),t={1:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\uf9d1","\u4e03","\u516b","\u4e5d"]},2:{letters:["\u5146","\u9621","\u767e","\uf973","\u5104","\u9621","\u767e","\uf973","\u842c","\u9621","\u767e","\uf973",""],numbers:["\uf9b2","\u58f9","\u8cb3","\uf96b","\u56db","\u4f0d","\uf9d1","\u4e03","\u516b","\u4e5d"]},3:{letters:["\u5146","\u5343","\u767e","\u5341","\u5104","\u5343","\u767e","\u5341","\u4e07","\u5343","\u767e","\u5341",""],numbers:["\uff10","\uff11","\uff12","\uff13","\uff14","\uff15","\uff16","\uff17","\uff18","\uff19"]}},C.call(this,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber"],[0,1,"\u20a9",!1,t]),n=["1","2","3","4","5","6","7","8","9","10","11","12",""],r=["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4",""],C.call(this,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern"],[["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],n,n,"\uc624\uc804",!1,["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],1,"yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd h:mm:ss","yyyy'\ub144' M'\uc6d4' d'\uc77c' dddd","h:mm:ss","M'\uc6d4' d'\uc77c'",r,r,"\uc11c\uae30","\uc624\ud6c4","yyyy-MM-dd",["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],"tt h:mm","yyyy'\ub144' M'\uc6d4'"]),this.name=function(){return"ko-kr"},this.id=1042}return t}(t),s={invariant:new t,"en-us":new o,"ja-jp":new i,"zh-cn":new a,"ko-kr":new l};function C(e,t,n){var r,o,i,a=this;for(o=0,i=t.length;o<i;o++)r=t[o],a[e][r]=n[o]}u=function(){if("object"==typeof e.instance)return e.instance;function e(){var o="en-us";this.culture=function(e){if(0===arguments.length)return o;e&&o!==e&&(o=e.toLowerCase(),r(o))},this.addCultureInfo=function(e,t){var r,o=t.NumberFormat.numberDecimalSeparator,i=t.NumberFormat.arrayListSeparator,a=t.NumberFormat.arrayGroupSeparator;if(o===t.NumberFormat.listSeparator||a===i)throw r=n(2),r._getResource(r.SR)().Exp_Separator;s[e.toLowerCase()]=t},this.getCultureInfo=function(e){var t,n,r,i;if(0===arguments.length)return s[o];t="string"==typeof e,e=t?e.toLowerCase():e,n=s,r=f;for(i in n)if(i===e||n[i].id!==_&&n[i].id===e){r=n[i];break}return r},this._getCultureInfo=function(e){var n=this.getCultureInfo(e);return n||(n=s[o])||(n=new t),n},e.instance=this}function r(e){var t;"function"!=typeof CustomEvent?(t=document.createEvent("CustomEvent"),t.initCustomEvent("cultureChanged",!1,!1,void 0)):t=new CustomEvent("cultureChanged",{}),t.cultureInfo=e,document.dispatchEvent(t)}return e}(),e.exports={CultureInfo:t,CultureManager:new u}}()},function(e,t,n){!function(){"use strict";var t={};t._each=function(e,n){var r,o,i,a;if(t._isArraylike(e))for(o=0,i=e.length;o<i&&!1!==(r=n.call(e[o],o,e[o]));o++);else for(a in e)if(e.hasOwnProperty(a)&&!1===(r=n.call(e[a],a,e[a])))break;return e},t._isEmptyObject=function(e){return!e||"object"==typeof e&&0===Object.keys(e).length},t._isFunction=function(e){return"function"===t._getType(e)},t._isArray=function(e){return Array.isArray?Array.isArray(e):"array"===t._getType(e)},t._isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},t._getType=function(e){var n,r,o,i,a,l;if(null===e)return"null";if(!(n=t._class2type))for(n=t._class2type={},r=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],o=0,i=r.length;o<i;o++)n["[object "+r[o]+"]"]=r[o].toLowerCase();return a=n.toString,l=typeof e,"object"===l||"function"===l?n[a.call(e)]||"object":l},t._inArray=function(e,n,r){var o,i;if(n){if(i=[].indexOf)return i.call(n,e,r);for(o=n.length,t._isNullOrUndefined(r)&&(r=0),r=r<0?Math.max(0,o+r):r;r<o;r++)if(r in n&&n[r]===e)return r}return-1},t._merge=function(e,t){var n=t.length,r=e.length,o=0;if("number"==typeof n)for(;o<n;o++)e[r++]=t[o];else for(;void 0!==t[o];)e[r++]=t[o++];return e.length=r,e},t._map=function(e,n,r){var o,i,a=0,l=e.length,s=t._isArraylike(e),u=[];if(s)for(;a<l;a++)null!==(o=n(e[a],a,r))&&(u[u.length]=o);else for(a in e)e.hasOwnProperty(a)&&null!==(o=n(e[a],a,r))&&(u[u.length]=o);return i=[].concat,i.apply([],u)},t._extend=function(){var e,n,r,o,i,a,l,s,u,c,_,f=[];for(e=0;e<arguments.length;e++)f[e]=arguments[e];for(s=arguments[0]||{},u=1,c=arguments.length,_=!1,"boolean"==typeof s&&(_=s,s=arguments[1]||{},u=2),"object"==typeof s||t._isFunction(s)||(s={}),c===u&&(s=this,--u);u<c;u++)if(a=arguments[u],!t._isNullOrUndefined(a))for(i in a)n=s[i],o=a[i],s!==o&&(r=t._isArray(o),_&&o&&(t._isPlainObject(o)||r)?(l=r?n&&t._isArray(n)?n:[]:n&&t._isPlainObject(n)?n:{},s[i]=t._extend(_,l,o)):void 0!==o&&(s[i]=o));return s},t._inherit=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r},t._isWindow=function(e){return null!==e&&e===e.window},t._isPlainObject=function(e){var n,r;if(!e||"object"!==t._getType(e)||e.nodeType||t._isWindow(e))return!1;n={}.hasOwnProperty;try{if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}for(r in e);return void 0===r||n.call(e,r)},t._isArraylike=function(e){if(t._isNullOrUndefined(e))return!1;var n=e.length,r=t._getType(e);return!t._isWindow(e)&&(!(1!==e.nodeType||!n)||("array"===r||"function"!==r&&(0===n||"number"==typeof n&&n>0&&n-1 in e)))},t._makeArray=function(e,n){var r=n||[];return null!==e&&(t._isArraylike(Object(e))?t._merge(r,"string"==typeof e?[e]:e):[].push.call(r,e)),r},t._isType=function(e,n){return t._isNullOrUndefined(e)?"null"===n:!!n&&(n instanceof Function&&e instanceof n||(typeof e===n||(!("function"!==n||!/^\s*\bfunction\b/.test(""+e))||(Object.prototype.toString.call(e).slice(8,-1).toLowerCase()===n.toLowerCase()||("DateTime"===n||"TimeSpan"===n?e instanceof Date:("string"==typeof n&&"undefined number boolean string".indexOf(n),!1))))))},t._isNullOrUndefined=function(e){return void 0===e||null===e},t._isNumber=function(e,r){var o=n(5);return!!o._isValidCultureNumberString(e,r)&&(e=o._replaceCultureSymbolToNormal(e,r),t._isType(e,"number")||t._isType(e,"DateTime")||t._isType(e,"TimeSpan")||e&&!t._isType(e,"boolean")&&!isNaN(e)&&!isNaN(parseFloat(e))&&!(e.length>=2&&"0"===e[0]&&"x"===e[1]))},t._toDouble=function(e){var r=n(8);return t._isNullOrUndefined(e)||""===e?0:t._isType(e,"number")?e:t._isType(e,"string")&&!isNaN(e)?n(5)._parseLocale(e):t._isType(e,"boolean")?e?1:0:t._isType(e,"DateTime")?r._toOADate(e):t._isType(e,"TimeSpan")?Math.floor(r._toOADate(e)):parseFloat(e)},t._cloneObject=function(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||t._isNullOrUndefined(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e);var n,r,o;n=e instanceof Object?new e.constructor:new e.constructor(e.valueOf());for(r in e)e.hasOwnProperty(r)&&(o=e[r],e.hasOwnProperty(r)&&n[r]!==o&&(n[r]="object"==typeof o?t._cloneObject(o):o));return n.toString=e.toString,n.valueOf=e.valueOf,n},e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o=n(2),i=n(4)._isNullOrUndefined,a=n(6),l=n(7),s=l._padZeroLeft,u=l._padZeroRight,c=n(3).CultureManager,_=null,f=void 0,d=parseInt,h=parseFloat,g=!1,p=!0,m=Math.floor,v=Math.abs,C=Math.pow,w=Math.min;function y(e,t,n){return e.substr(t,n)}t=function(){return o._getResource(o.SR)()},r=function(){var e,n,r="##################0",o="################",a={1:"+",0:"","-1":"-"},x=4294967295,b=["0","#","?"],T={"\xa4":"\xa4",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GH\u20b5":"GH\u20b5","\u1265\u122d":"\u1265\u122d","\u0631.\u0633.\u200f":"\u0631.\u0633.\u200f",XDR:"XDR","\u062f.\u0625.\u200f":"\u062f.\u0625.\u200f","\u062f.\u0628.\u200f":"\u062f.\u0628.\u200f","\u062f.\u062c.\u200f":"\u062f.\u062c.\u200f","\u062c.\u0645.\u200f":"\u062c.\u0645.\u200f","\u20aa":"\u20aa","\u062f.\u0639.\u200f":"\u062f.\u0639.\u200f","\u062f.\u0627.\u200f":"\u062f.\u0627.\u200f","\u0641.\u062c.\u0642.\u200f":"\u0641.\u062c.\u0642.\u200f","\u062f.\u0643.\u200f":"\u062f.\u0643.\u200f","\u0644.\u0644.\u200f":"\u0644.\u0644.\u200f","\u062f.\u0644.\u200f":"\u062f.\u0644.\u200f","\u062f.\u0645.\u200f":"\u062f.\u0645.\u200f","\u0623.\u0645.\u200f":"\u0623.\u0645.\u200f","\u0631.\u0639.\u200f":"\u0631.\u0639.\u200f","\u0631.\u0642.\u200f":"\u0631.\u0642.\u200f","\u062c.\u0633.":"\u062c.\u0633.",S:"S","\xa3":"\xa3","\u0644.\u0633.\u200f":"\u0644.\u0633.\u200f","\u062f.\u062a.\u200f":"\u062f.\u062a.\u200f","\u0631.\u064a.\u200f":"\u0631.\u064a.\u200f","\u20b9":"\u20b9",TSh:"TSh","\u20ac":"\u20ac","\u20bc":"\u20bc","\u20bd":"\u20bd",K:"K","\u043b\u0432.":"\u043b\u0432.","\u20a6":"\u20a6",CFA:"CFA","\u09f3":"\u09f3","\xa5":"\xa5",KM:"KM","\u041a\u041c":"\u041a\u041c",USh:"USh","K\u010d":"K\u010d","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","\u0783.":"\u0783.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","\u20b1":"\u20b1",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","\u20a1":"\u20a1",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","\u20b2":"\u20b2","Bs.":"Bs.","\u0631\u064a\u0627\u0644":"\u0631\u064a\u0627\u0644",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","\u058f":"\u058f",ISK:"ISK","\u20be":"\u20be","\u200b":"\u200b","\u20b8":"\u20b8","\u17db":"\u17db","\u20a9":"\u20a9","\u0441\u043e\u043c":"\u0441\u043e\u043c",Kz:"Kz","\u20ad":"\u20ad",MTn:"MTn","\u0434\u0435\u043d":"\u0434\u0435\u043d","\u20ae":"\u20ae","\u0930\u0941":"\u0930\u0941","Afl.":"Afl.","\u07d6\u07d5.":"\u07d6\u07d5.","\u0440\u0443\u0431.":"\u0440\u0443\u0431.","z\u0142":"z\u0142","\u060b":"\u060b",R$:"R$",Db:"Db",RON:"RON","\u20b4":"\u20b4",MAD:"MAD","\u0dbb\u0dd4.":"\u0dbb\u0dd4.","Lek\xeb":"Lek\xeb",den:"den",RSD:"RSD","\u0434\u0438\u043d.":"\u0434\u0438\u043d.","\u0720.\u0723.\u200f":"\u0720.\u0723.\u200f","Rs.":"Rs.","\u0441\u043c\u043d":"\u0441\u043c\u043d","\u0e3f":"\u0e3f","m.":"m.","\u20ba":"\u20ba","\u2d37\u2d54":"\u2d37\u2d54","so\u02bbm":"so\u02bbm","\u0441\u045e\u043c":"\u0441\u045e\u043c","\u20ab":"\u20ab",HK$:"HK$",MOP:"MOP",NT$:"NT$"};function R(e,t,n,r){return t&&0!==t.length&&"i"!==t?A(e,t,n.NumberFormat,r):n&&n.name.length>0?e.toLocaleString():""+e}function A(e,t,n,r){return k(e,E(t,n),n,r)}function I(e,t){for(var n,r,o,i,a,l,s,u,c=m(v(e)),_={_integer:1,_decimal:0};c>=10;)c/=10,_._integer++;return n=""+e,r=n.search(/e/gi),o=n.indexOf(t),-1!==r?(a=y(n,0,r),l=y(n,r+1),s=0,-1!==o&&(s=y(a,o+1).length),u=h(l),i=s-u,i<0&&(i=0),_._decimal=i):(i=0,-1!==o&&(i=y(n,o+1).length),_._decimal=i),_}function M(e){var n,r={_symbol:e.charAt(0),_sign:0,_exp:0},o="";for(n=1;n<e.length;n++)if("+"===(o=e.charAt(n)))r._sign=1;else{if("-"!==o){if("0"===o){r._exp=e.length-n;break}throw Error(t().Exp_InvalidExponentFormat)}r._sign=-1}return r}function E(e,t){var n,r,o,i,a,l,s={_intPart:_,_decPart:_,_group:g,_scale:0,_percent:0,_permille:0,_exponent:_},u="",c=g,f=g,d=g,h=g,m=g,v=g,C=_,w=[];for(r=0;r<e.length;r++){if(n=e.charAt(r),c)u+=n,'"'===n&&(w.push(u),u="",c=g);else if(f){if("E"===C||"e"===C){if(!(["+","-","0"].indexOf(n)>=0)){f=g,r--;continue}u+=n}else if("+"===C||"-"===C){if("0"!==n){f=g,r--;continue}u+=n}else if("0"===C){if("0"!==n){f=g,m||(m=p,s._exponent=M(u)),r--;continue}u+=n}}else if("*"!==C&&"_"!==C&&"\\"!==C||""===u)if("*"===n||"_"===n||"\\"===n)v=g,""!==u&&(w.push(u),u=""),u+=n;else if("'"===n)v=g,""!==u&&(w.push(u),u=""),w.push(n);else if('"'===n)v=g,c=p,""!==u&&(w.push(u),u=""),u+=n;else if(b.indexOf(n)>=0)v=p,b.indexOf(C)<0&&""!==u&&(w.push(u),u=""),u+=n;else if("."!==n||d)if(n===t.percentSymbol)v=g,s._percent++,""!==u&&(w.push(u),u=""),w.push(n);else if(n===t.perMilleSymbol)v=g,s._permille++,""!==u&&(w.push(u),u=""),w.push(n);else if(n===t.percentGroupSeparator)if(v){for(""!==u&&(w.push(u),u=""),o=p,i="",a=r+1;a<e.length;a++)if(l=e.charAt(a),""===i)if('"'===l)i=l;else{if(b.indexOf(l)>=0){o=g;break}if(l===t.numberDecimalSeparator||";"===l)break}else'"'===l&&(i="");o?s._scale++:d||(l=e.charAt(r+1))&&b.indexOf(l)>=0&&(h=p)}else u+=n;else"E"===n||"e"===n?(v=g,f=p,""!==u&&(w.push(u),u=""),u+=n):(v=g,b.indexOf(C)>=0&&""!==u&&(w.push(u),u=""),u+=n);else""!==u&&(w.push(u),u=""),s._intPart=w,w=[],d=p,v=g;else u+=n,w.push(u),u="";C=n}return""!==u&&(f&&!m&&(s._exponent=M(u)),w.push(u)),h&&(s._group=p),d?s._decPart=w:s._intPart=w,s}function F(e,n,r,o){var i,a,l,s,u,c=n[0],_=1,f=0,d=g,h=e.length;for(i=0;i<h;i++)if("number"===(a=e[i].type)){for(l="",s=e[i].value,u=s.length-1;u>=0;){if(c<1||c>9)throw Error(t().Exp_InvalidNumberGroupSize);/\d/gi.test(s[u])?(d&&(l&&e.push({type:"number",value:l}),e.push({type:"groupSeparator",value:r}),l="",d=g),f++):f=0,l=s[u]+l,f===c&&(d=p,f=0,_<n.length&&(c=n[_],_++)),u--}l&&e.push({type:a,value:l})}else"fillingChar"===a&&(o.infillIndex=e.length-h),e.push({type:a,value:e[i].value});return e.splice(0,h)}function D(e,t,n,r,o,i){var a,l,c,_,f=U(e,-t);return isFinite(f)||(f=e),e=f,a=""+e,_=a.split(/e/i),a=_[0],c=_.length>1?d(_[1],10):0,_=a.split("."),a=_[0],l=_.length>1?_[1]:"",c>0?(l=u(l,c),a+=l.slice(0,c),l=y(l,c)):c<0&&(c=-c,a=e<0?i+s(a.replace(i,""),c+1):s(a,c+1),l=a.slice(-c,a.length)+l,a=a.slice(0,-c)),t>0?(l=l.length>t?l.slice(0,t):u(l,t),l=o+l):l="",a+l}function N(e,t,n,r){var o=e;return t>0&&(o=e*C(100,t)),n>0&&(o=e*C(1e3,n)),r>0&&(o=e/C(1e3,r)),o}function V(e){var t,n,r=_;if(e)for(r="",t=0;t<e.length;t++)n=e[t],/^(0|#|\?)+/g.test(n)&&(r+=n);return r}function O(e,t,n){var r,o={value:e,exponentValue:0},i=I(e,"."),a=i._integer,l=v(e),s=n?n.length:1;if(l>=1)a>s?(a-=s,o.value=e/C(10,a),o.exponentValue=a):o.exponentValue=0,-1===t._sign&&(t._sign=0);else if(l<1&&l>0){for(t._sign=-1,r=C(10,s);10*l<r;)l*=10,o.exponentValue++;o.value*=C(10,o.exponentValue)}return o}function H(e,t,n,r,o,i,l,u){var c,_,f,d,h,g,m,v,C,w,S,x,b=u.numberGroupSizes,R=u.numberGroupSeparator,A=u.negativeSign,I=u.percentSymbol,M=u.perMilleSymbol,E=r._exponent,D=y(t,0,1);for(D===A&&(t=y(t,1)),c=1===t.length&&"0"===t?0:t.length,t=0===c?"":t,_=0,f="",d=e.length-1;d>=0;d--)if(h="",g=e[d],/^(0|#|\?)+/g.test(g)){if(f!==n){for(m=g.length,v=c-_-1;v>=0&&m>0;v--)C=t.charAt(v),h=C+h,m--,_++;for(w=m-1;w>=0;w--)S=g[w],_++,"0"===S?h=S+h:"?"===S&&(""!==h&&(i.push({type:"number",value:h}),h=""),i.push({type:"numberPlaceholder",value:S}));f=g+f,f===n&&_<c&&(h=t.substr(0,c-_)+h),""!==h&&i.push({type:"number",value:h})}}else r._exponent&&!l.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(g)?(l.replaceExponent=p,x="",x+=E._symbol,x+=a[E._sign],x+=s(""+o,E._exp),i.push({type:"exponent",value:x})):"_"===g[0]?i.push({type:"placeholder",value:g[1]}):"*"===g[0]?l.hasInfilling||(i.push({type:"fillingChar",value:g[1]}),l.hasInfilling=!0,l.infillIndex=i.length-1):"\\"===g[0]?2===g.length&&i.push({type:"text",value:g[1]}):'"'===g[0]&&'"'===g[g.length-1]?g.length>2&&i.push({type:"text",value:g.substr(1,g.length-2)}):g===I?i.push({type:"percent",value:g}):g===M?i.push({type:"permille",value:g}):T[g]?i.push({type:"currency",value:g}):i.push({type:"text",value:g});D===A&&i.push({type:"text",value:D}),r._group===p&&F(i,b,R,l),i=i.reverse(),l.infillIndex=i.length-1-l.infillIndex}function P(e,t,n,i,l,u,c,_,f){var d,h,g,m,v,C,w,y,S,x,b,R,A,I=f.numberDecimalSeparator,M=f.percentSymbol,E=f.perMilleSymbol,F=t.indexOf(I),D=l._exponent;for((F>0||i!==r||n!==o)&&c.push({type:"decimalSeparator",value:I}),d=-1!==F?t.substring(F+1):"",h=0,g="",m=0;m<e.length;m++)if(v=e[m],/^(0|#|\?)+/g.test(v)){if(C="",g!==n){for(w=v.length,y=0,S=h;w>0&&d.length-h>0;)x=d.charAt(S),C+=x,w--,h++,y++,S++;for(b=y;w>0;)R=v[b],b++,h++,w--,"0"===R?C+=R:"?"===R&&(""!==C&&(c.push({type:"number",value:C}),C=""),c.push({type:"numberPlaceholder",value:R}));""!==C&&c.push({type:"number",value:C}),g+=v}}else D&&!_.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(v)?(_.replaceExponent=p,A="",A+=D._symbol,A+=a[D._sign],A+=s(""+u,D._exp),c.push({type:"exponent",value:A})):"_"===v[0]?c.push({type:"placeholder",value:v[1]}):"*"===v[0]?(c.push({type:"fillingChar",value:v[1]}),_.hasInfilling&&c.splice(_.infillIndex,1),_.hasInfilling=!0,_.infillIndex=c.length-1):"\\"===v[0]?2===v.length&&c.push({type:"text",value:v[1]}):'"'===v[0]&&'"'===v[v.length-1]?v.length>2&&c.push({type:"text",value:v.substr(1,v.length-2)}):v===M?c.push({type:"percent",value:v}):v===E?c.push({type:"permille",value:v}):T[v]?c.push({type:"currency",value:v}):c.push({type:"text",value:v})}function L(e,t){var n=e;return-1!==e.indexOf(t)&&(n=e.replace(/0+$/,"")),n}function k(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,p,m,v,C,y=[];return e=N(e,t._percent,t._permille,t._scale),o=t._intPart,i=t._decPart,o||i?(a=V(o),l=V(i),l||(l=""),t._exponent&&(u=O(e,t._exponent,a),e=u.value,s=u.exponentValue),c=I(e,"."),_=n.numberGroupSizes,f=n.numberGroupSeparator,d=n.numberDecimalSeparator,h=n.negativeSign,p=w(c._decimal,l.length),m=D(e,p,_,f,d,h),r||(m=L(m,d)),""===m?(y.push({type:"text",value:(o?o.join(""):"")+(i?i.join(""):"")}),y):(v={hasInfilling:g,infillIndex:-1,replaceExponent:g},C=m.split(d)[0],o&&H(o,C,a,t,s,y,v,n),"0"!==C&&""===a&&i&&y.push({type:"number",value:C}),i&&P(i,m,l,a,t,s,y,v,n),y)):y}function B(e,t){var n,r,o,a,s,u,c,f,g,p,m,v,C,w,S,x,b;return e=i(e)?"":l._trimEnd(e,""),e.match(/^[+-]?infinity$/i)?h(e):e.match(/^0x[a-f0-9]+$/i)?d(e,10):(n=t.NumberFormat,r=n.numberNegativePattern,o=W(e,n,r),a=o[0],s=o[1],""===a&&1!==r&&(o=W(e,n,1),a=o[0],s=o[1]),""===a&&(a="+"),s[0]===n.currencySymbol&&(s=y(s,1)),f=s.indexOf("e"),f<0&&(f=s.indexOf("E")),f<0?(c=s,u=_):(c=y(s,0,f),u=y(s,f+1)),m=c.indexOf("."),m<0?(g=c,p=_):(g=y(c,0,m),p=y(c,m+1)),g=g.split(",").join(""),v=",".replace(/\u00A0/g," "),","!==v&&(g=g.split(v).join("")),C=a+g,p!==_&&(C+="."+p),w=C[C.length-1],w===n.percentSymbol&&(C=y(C,0,C.length-1),C=l._trimEnd(C,""),S=C.indexOf("."),-1===S&&(S=C.length),x="",x+=y(C,0,S-2),x+=".",x+=y(C,S-2,2),x+=y(C,S+1),C=x),
u!==_&&(b=W(u,n,1),""===b[0]&&(b[0]="+"),C+="e"+b[0]+b[1]),C.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?h(C):NaN)}function W(e,t,n){var r=t.negativeSign,o=t.positiveSign,i=l;if(4!==n&&2!==n||(r=" "+r,o=" "+o),4===n||3===n){if(i._endsWith(e,r))return["-",y(e,0,e.length-r.length)];if(i._endsWith(e,o))return["+",y(e,0,e.length-o.length)]}else if(2===n||1===n){if(i._startsWith(e,r))return["-",y(e,r.length)];if(i._startsWith(e,o))return["+",y(e,o.length)]}else{if(0!==n)throw Error("");if(i._startsWith(e,"(")&&i._endsWith(e,")"))return["-",y(e,1,e.length-2)]}return["",e]}function z(e,n,r){if(0!==v(m(e)-e))throw Error(t().Exp_BadFormatSpecifier);var o=e>=0?e.toString(16):(x+e+1).toString(16);return o=n?o.toLowerCase():o.toUpperCase(),!i(r)&&o.length<r?s(o,r):o}function U(e,t){if(typeof t===f||0==+t)return Math.round(e);if(e=+e,t=+t,isNaN(e)||t%1!=0)return NaN;var n=e<0;return e=n?-e:e,e=(""+e).split("e"),e=Math.round(+(e[0]+"e"+(e[1]?+e[1]-t:-t))),e=n?-e:e,e=(""+e).split("e"),+(e[0]+"e"+(e[1]?+e[1]+t:t))}e="#dot#",n="#group#";function Y(e){var t=c._getCultureInfo().NumberFormat;return"string"==typeof e&&(t=c._getCultureInfo(e).NumberFormat),t}function G(e){var t,n,r,o="";if(Array.isArray(e)&&e.length>0)for(t=0;t<e.length;t++)if(n=e[t].type,r=e[t].value,"placeholder"===n)o+=" ";else{if("fillingChar"===n)continue;o+="numberPlaceholder"===n?" ":r}return o}function X(e,t){return"number"==typeof e&&(""+e).length>=t&&(e=e<1&&e>-1?+e.toFixed(t):+e.toPrecision(t)),e}return{_parseLocale:function(e){return B(e,c._getCultureInfo())},_parseInvariant:function(e){return B(e,c._getCultureInfo("invariant"))},_customCultureFormat:function(e,t,n,r){return n||(n=c._getCultureInfo()),R(e,t,n,r)},_replaceNormalToCultureSymbol:function(t,r){var o,i,a;return"string"!=typeof t?t:(o=Y(r),i=o.numberDecimalSeparator,a=o.numberGroupSeparator,"."!==i&&(t=t.replace(S("[.]"),e)),","!==a&&(t=t.replace(S("[,]"),n)),"."!==i&&(t=t.replace(S(e),i)),","!==a&&(t=t.replace(S(n),a)),t)},_replaceCultureSymbolToNormal:function(t,r){var o,i,a;return"string"!=typeof t?t:(o=Y(r),i=o.numberDecimalSeparator,a=o.numberGroupSeparator,"."!==i&&(t=t.replace(S("["+i+"]"),e)),","!==a&&(t=t.replace(S("["+a+"]"),n)),"."!==i&&(t=t.replace(S(e),".")),","!==a&&(t=t.replace(S(n),",")),t)},_isValidCultureNumberString:function(e,t){var n,r,o;return!("string"==typeof e&&(n=Y(t),r=n.numberDecimalSeparator,o=n.numberGroupSeparator,"."!==r&&"."!==o&&e.indexOf(".")>=0||","!==r&&","!==o&&e.indexOf(",")>=0))},_parseFloat:function(e,t){return h(this._replaceCultureSymbolToNormal(e,t))},_toHexString:z,_parseCustomNumberFormatter:E,_formatNumber:k,_formatObjectToSrting:G,_generalNumberInt:r,_generalNumberDec:o,_fixNumber:X}}();function S(e){return a._getReg(e)}e.exports=r}()},function(e,t,n){!function(){"use strict";var t=n(7),r=function(){function e(){}return e._getReg=function(t){var n=e._regDict[t];return n||(n=e._regDict[t]=RegExp(t,"g")),n.lastIndex=0,n},e._getRegIgnoreCase=function(t){var n=e._regDictIgnoreCase[t];return n||(n=e._regDictIgnoreCase[t]=RegExp(t,"gi")),n.lastIndex=0,n},e._getWildcardCriteria=function(t,n,r){var o,i,a,l,s,u;if(e._wildcardParseRecord[t])return e._wildcardParseResultBuffer[t];if(o="[~?*]+",e._getReg(o).test(t)){for(i=[],a=t.split(""),s={".":!0,"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0},u=0;u<a.length;u++)l=a[u],"~"===l&&u<a.length-1?(u++,l=a[u],"*"===l||"?"===l?i.push("\\"):n&&i.push("~"),i.push(l)):"?"===l?i.push("."):"*"===l?(i.push("."),r?i.push("+"):i.push("*")):s[l]?(i.push("\\"),i.push(l)):i.push(l);return i.join("")}return null},e._getWildcardCriteriaFullMatch=function(t,n,r){var o=e._getWildcardCriteria(t,n,r);return o&&(o="^"+o+"$"),o},e._getReplaceSymbol=function(e,n){for(var r="#"+e+"0#",o=1;n.indexOf(r)>0;)r=t._join(r,"#"+e+(o-1)+"#","#"+e+o+"#"),o++;return r},e._regDict={},e._regDictIgnoreCase={},e._wildcardParseRecord={},e._wildcardParseResultBuffer={},e._replaceRegString2NormalString=function(e){return e.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},e}();e.exports=r}()},function(e,t,n){!function(){"use strict";var t,r=n(4)._isNullOrUndefined;function o(e,t,n){return e.substr(t,n)}t={_contains:function(e,t,n){return n&&(e=e.toLowerCase(),t=t.toLowerCase()),""===t||e.indexOf(t)>=0},_indexOf:function(e,t,n){var r,o;return n?(r=e.toLowerCase(),o=t.toLowerCase(),r.indexOf(o)):e.indexOf(t)},_trimStart:function(e,t){if(!t)return e;for(var n=e;o(n,0,t.length)===t;)n=o(n,t.length);return n},_trimEnd:function(e,t){if(!t)return e;for(var n=e;o(n,n.length-t.length,t.length)===t;)n=o(n,0,n.length-t.length);return n},_insert:function(e,t,n){var i,a;if(t<0||t>e.length||r(n))throw Error();return i=o(e,0,t),a=o(e,t,e.length-t),i+n+a},_remove:function(e,t,n){var i,a;if(r(n)&&(n=e.length-t),t<0||n<0||t+n>e.length)throw Error();return i=o(e,0,t),a=o(e,t+n,e.length-t-n),i+a},_startsWith:function(e,t,n){return i(e,t,n,function(e,t){return e.slice(0,t.length)===t})},_endsWith:function(e,t,n){return i(e,t,n,function(e,t){return e.slice(-t.length)===t})},_replace:function(e,t,n,r){if(!t)throw Error();return n=(""+n).replace(/\$/g,"$$$$"),e.replace(RegExp(t,"g"+(r?"i":"")),n)},_replaceAllNoReg:function(e,t,r,o){return t=n(6)._replaceRegString2NormalString(t),this._replace(e,t,r,o)},_leftBefore:function(e,t){var n=e.indexOf(t);return n<0||n>=e.length?e:o(e,0,n)},_count:function(e,t){for(var n=0,r=e.indexOf(t);r>=0;)n+=1,r=e.indexOf(t,r+1);return n},_join:function(e,t,n){return e.split(t).join(n)},_format:function(e,t){var n,r,o=e;for(n=0;n<t.length;n++)r=RegExp("\\{"+n+"\\}","g"),o=o.replace(r,t[n]);return o},_padZero:function(e,t,n){var r,o=""+e;for(r=o.length;r<t;r++)o=n?"0"+o:o+"0";return o},_padZeroLeft:function(e,n){return t._padZero(e,n,!0)},_padZeroRight:function(e,n){return t._padZero(e,n,!1)},_compareStringIgnoreCase:function(e,t){return e===t||!e&&!t||e&&t&&e.toLowerCase()===t.toLowerCase()},_toUpperCase:function(e){return e.toUpperCase()},_escapeHtml:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r=n(6)._getReg("(?:&|<|>|\"|'|`)");return r.test(e)?e.replace(r,function(e){return t[e]}):e},_unescapeHtml:function(e){var t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},r=n(6)._getReg("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return r.test(e)?e.replace(r,function(e){return t[e]}):e}};function i(e,t,n,o){var i,a;if(r(t))throw Error();return""===t||!(t.length>e.length)&&(i=e,a=t,n&&(i=i.toLowerCase(),a=a.toLowerCase()),o(i,a))}e.exports=t}()},function(e,t,n){!function(){"use strict";var t=n(2),r=n(7),o=n(9),i=n(3).CultureManager,a=n(4)._isNullOrUndefined,l=r._padZeroLeft,s=null,u=parseInt,c=!1,_=!0,f=Math.floor,d=Math.abs,h=function(){return t._getResource(t.SR)()},g={},p=function(){function e(e,t,n){var r,o,i,a,l,u=c;for(l=n,l.slice(1).forEach(function(e){e&&(u=!0)}),u||(l=l.concat(t._getDateTimePattern())),r=1,o=l.length;r<o;r++)if((a=l[r])&&(u=_,i=w(e,a,t)))return i;return s}function t(e,r,o){var i,a,s,u,c,g,p,m,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O=o.DateTimeFormat,H=O.Calendar.convert;if(!r||!r.length)return o&&o.name.length?H?t(e,O.fullDateTimePattern,o):e.toLocaleString():""+e;i=O.eras,a="s"===r,s="",p=/([^d]|^)(d|dd)([^d]|$)/g;function P(){return c||g?c:(c=p.test(r),g=_,c)}m=0,C=v(),!a&&H&&(w=H.fromGregorian(e));function L(e,t){if(w)return w[t];switch(t){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();default:return}}for(y=-2,S=-2,x={_value:""},b=0;T=C.lastIndex,R=C.exec(r),A=r.slice(T,R?R.index:r.length),x._value="",m+=n(A,x),s+=x._value,R;b++)if(m%2!=1)switch(I=e.getFullYear(),M=e.getDay(),E=e.getHours(),F=e.getMinutes(),D=e.getSeconds(),N=e.getMilliseconds(),V=e.getTimezoneOffset(),R[0]){case"dddd":s+=O.dayNames[M];break;case"ddd":s+=O.abbreviatedDayNames[M];break;case"dd":c=_,s+=l(L(e,2),2);break;case"d":c=_,s+=L(e,2);break;case"MMMM":s+=O.monthGenitiveNames&&P()?O.monthGenitiveNames[L(e,1)]:O.monthNames[L(e,1)];break;case"MMM":s+=O.abbreviatedMonthGenitiveNames&&P()?O.abbreviatedMonthGenitiveNames[L(e,1)]:O.abbreviatedMonthNames[L(e,1)];break;case"MM":s+=l(L(e,1)+1,2);break;case"M":s+=L(e,1)+1;break;case"yyyy":case"yyy":s+=y>=0?i._formatEraPart("ee",e):l(w?w[0]:I,4);break;case"yy":s+=y>=0?i._formatEraPart("ee",e):l((w?w[0]:I)%100,2);break;case"y":s+=y>=0?i._formatEraPart("e",e):""+(w?w[0]:I)%100;break;case"hh":u=E%12,0===u&&(u=12),s+=l(u,2);break;case"h":u=E%12,0===u&&(u=12),s+=u;break;case"HH":s+=l(E,2);break;case"H":s+=""+E;break;case"mm":s+=l(F,2);break;case"m":s+=""+F;break;case"ss":s+=l(D,2);break;case"s":s+=""+D;break;case"tt":s+=E<12?O.amDesignator:O.pmDesignator;break;case"t":s+=(E<12?O.amDesignator:O.pmDesignator).charAt(0);break;case"f":case"0":s+=l(N,3).charAt(0);break;case"ff":case"00":s+=l(N,3).substr(0,2);break;case"fff":case"000":s+=l(N,3);break;case"z":u=V/60,s+=(u<=0?"+":"-")+f(d(u));break;case"zz":u=V/60,s+=(u<=0?"+":"-")+l(f(d(u)),2);break;case"zzz":u=V/60,s+=(u<=0?"+":"-")+l(f(d(u)),2)+":"+l(d(V%60),2);break;case"g":case"gg":case"ggg":if(!i)break;if(y===b-1){y=b;break}s+=i._formatEraPart(R[0],e),y=b;break;case"e":case"ee":if(!i){s+=l(w?w[0]:I,4);break}if(S===b-1){S=b;break}s+=i._formatEraPart(R[0],e),S=b;break;case"/":s+=O.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[ss]":s+=R[0];break;default:throw Error(h().Exp_InvalidDateFormat)}else s+=R[0];return""+s}function n(e,t){var n,r,o,i=0,a=c;for(n=0,r=e.length;n<r;n++)switch(o=e.charAt(n)){case'"':a?t._value+="'":i++,a=c;break;case"\\":a&&(t._value+="\\"),a=!a;break;default:t._value+=o,a=c}return i}function m(e,t){var n,r=new Date,o=e.DateTimeFormat.eras;return o&&t<100&&(n=o._getEraDate(r)._eraYear,(t+=n-n%100)>e.DateTimeFormat.Calendar.TwoDigitYearMax&&(t-=100)),t}function v(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[ss\]/g}function C(e,t){var r,i,a,l,u,c,_,f,d,g,p;if(e._parseRegExp){if(e._parseRegExp[t])return e._parseRegExp[t]}else e._parseRegExp={};for(r=t,r=r.replace("%M","M"),r=r.replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),i="^",a={_value:""},l=[],u=0,c=0,_=v();(f=_.exec(r))!==s;)if(a._value="",d=r.slice(u,f.index),u=_.lastIndex,c+=n(d,a),i+=a._value,c%2!=1){switch(f[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":i+="(\\D+)";break;case"tt":case"t":i+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"eee":case"ee":case"e":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":i+="(\\d\\d?)";break;case"yyy":case"yyyy":i+="(\\d{2}|\\d{4})";break;case"fff":case"000":i+="(\\d{3})";break;case"ff":case"00":i+="(\\d{2})";break;case"f":case"0":i+="(\\d)";break;case"zzz":i+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":i+="([+-]?\\d\\d?)";break;case"/":i+="(\\"+e.dateSeparator+")";break;default:throw Error(h().Exp_InvalidDateFormat)}o._add(l,f[0])}else i+=f[0];return a._value="",n(r.slice(u),a),i+=a._value,i+="$",g=(""+i).replace(/\s+/g,"\\s+"),p={_regExp:g,_groups:l,_exp:RegExp(g)},e._parseRegExp[t]=p,p}function w(e,t,n){var o,i,a,l,_,f,d,h,g,p,v,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H;if(e=e.trim(),o=n.DateTimeFormat,i=C(o,t),a=i._exp.exec(e),a===s)return s;for(l=i._groups,_=s,f=s,d=s,h=s,g=s,p=0,w=0,y=0,S=0,x=s,b=c,T=0,R=l.length;T<R;T++)if(A=a[T+1])switch(l[T]){case"dd":case"d":if((h=u(A,10))<1||h>31)return s;break;case"MMMM":if((d=n._getMonthIndex(A))<0||d>11)return s;break;case"MMM":if((d=n._getAbbrMonthIndex(A))<0||d>11)return s;break;case"M":case"MM":case"%M":if((d=u(A,10)-1)<0||d>11)return s;break;case"e":case"ee":if((f=m(n,u(A,10)))<0||f>9999)return s;break;case"y":case"yy":case"yyy":case"yyyy":if((f=u(A,10))<0||f>9999)return s;break;case"h":case"hh":case"H":case"HH":if((p=u(A,10))<0)return s;break;case"m":case"mm":if((w=u(A,10))<0||w>59)return s;break;case"s":case"ss":if((y=u(A,10))<0||y>59)return s;break;case"tt":case"t":if(I=A.toUpperCase(),!(b=I===o.pmDesignator.toUpperCase())&&I!==o.amDesignator.toUpperCase())return s;break;case"f":case"0":if((S=100*u(A,10))<0||S>999)return s;break;case"ff":case"00":if((S=10*u(A,10))<0||S>999)return s;break;case"fff":case"000":if((S=u(A,10))<0||S>999)return s;break;case"dddd":if((g=n._getDayIndex(A))<0||g>6)return s;break;case"ddd":if((g=n._getAbbrDayIndex(A))<0||g>6)return s;break;case"zzz":if(M=A.split(/:/),2!==M.length)return s;if((v=u(M[0],10))<-12||v>13)return s;if((E=u(M[1],10))<0||E>59)return s;x=60*v+(r._startsWith(A,"-")?-E:E);break;case"z":case"zz":if((v=u(A,10))<-12||v>13)return s;x=60*v;break;case"g":case"gg":case"ggg":if(!(F=A)||!o.eras)return s;if((_=o.eras._parseEraPart(l[T],F))<0)return s}if(D=/^(\d|\d\d):/.test(e),N=D?new Date(1899,11,30):new Date,O=o.Calendar.convert,O&&(V=O.fromGregorian(N)),O||(V=[N.getFullYear(),N.getMonth(),N.getDate()]),f===s?f=V[0]:f<100&&(o.eras?f=o.eras._getYearFromEra(_||0,f):f+=f>=30?1900:2e3),d===s&&(d=V[1]),h===s&&(h=V[2]),O){if((N=O.toGregorian(f,d,h))===s)return s}else{if(N.setFullYear(f,d,h),N.getDate()!==h)return s;if(g!==s&&N.getDay()!==g)return s}return b&&p<12&&(p+=12),N.setHours(p,w,y,S),x!==s&&(H=N.getMinutes()-(x+N.getTimezoneOffset()),N.setHours(N.getHours()+H/60,H%60)),N}return{_customCultureFormat:function(e,n,r){return r||(r=i._getCultureInfo()),t(e,n,r)},_localeFormat:function(e,n,r){return t(e,n,r||i._getCultureInfo())},_parseLocale:function(t,n,r){var o,a;return n||r||void 0===(a=g[t])?(o=n?[t,n]:[t],a=e(t,r||i._getCultureInfo(),o),n||r||(g[t]=a),a?new Date(a):a):a?new Date(a):a},_parseInvariant:function(t,n){return e(t,i._getCultureInfo("invariant"),[t,n])},_parseExact:w,_fromOADate:function(e){var t,n=e-25569,r=new Date(864e5*n),o=n>=0?1:-1,i=r.getTimezoneOffset(),a=(864e5*e*1440+o-3181192704e6+864e5*i)/1440,l=new Date(a),s=i>=0?1:-1,u=new Date(a+36e5*s),c=u.getTimezoneOffset();if(i!==c)if(t=new Date(a+60*(c-i)*1e3),i>c){if(-1===s||c===l.getTimezoneOffset())return t=999===t.getMilliseconds()?new Date(t.valueOf()+1):t}else if(i<c&&(1===s||c===l.getTimezoneOffset()))return t=999===t.getMilliseconds()?new Date(t.valueOf()+1):t;return l=999===l.getMilliseconds()?new Date(l.valueOf()+1):l},_fromOADateString:function(e){if("/OADate("===e.substr(0,8)){var t=parseFloat(e.substr(8,e.length-10));return this._fromOADate(t)}},_toOADateString:function(e){return"/OADate("+this._toOADate(e)+")/"},_toOADate:function(e){return a(e)?0:("number"==typeof e&&(e=new Date(e)),(1440*e.getTime()+3181192704e6-864e5*e.getTimezoneOffset())/124416e6)},_DT:function(e){var t,n,r,o=s,i=_;if(a(e)?o=this._fromOADate(0):e instanceof Date?o=new Date(e):"string"==typeof e?(t=this._parseLocale(e),t||(isNaN(e)?(t=new Date(e),isNaN(t.valueOf())&&(i=c),n=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,(r=n.exec(e.replace(/ |\n/g,"").trim()))&&4===r.length&&(-1!==r.indexOf(""+t.getFullYear())&&-1!==r.indexOf(""+(t.getMonth()+1))&&-1!==r.indexOf(""+t.getDate())||(i=c))):(t=p._fromOADate(parseFloat(e)))||(i=c)),o=t):"number"==typeof e?o=this._fromOADate(e):i=c,i)return o;throw h().Exp_InvalidCast},_isDate:function(e){return e&&(e.constructor===Date||e.getUTCDate&&e.setFullYear)}}}();e.exports=p}()},function(e,t){!function(){"use strict";var t=null,n=void 0,r=function(){function e(){}e._insert=function(e,t,n){e.splice(t,0,n)},e._add=function(e,t){e.push(t)},e._contains=function(e,t){return e.indexOf(t)>-1},e._remove=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)},e._removeByIndex=function(e,t){return e.slice(0,t).concat(e.slice(t+1))},e._indexOf=function(e,t,n){return e.indexOf(t,n)},e._clear=function(e,n,r){if(!(n<0))for(var o=0;o<r&&n+o<e.length;o++)e[n+o]=t},e._nextNonEmptyIndex=function(e,r){var o,i;for(r<0&&(r=-1),o=r+1,i=o;i<e.length;i++)if(e[i]!==n&&e[i]!==t)return i;return-1},e._getLength=function(e){return e&&e.length};function r(e,t){var n,o;for(n in t)t.hasOwnProperty(n)&&(o=t[n],Array.isArray(o)?(e[n]=[],r(e[n],t[n])):"object"==typeof o?(e[n]={},r(e[n],t[n])):e[n]=t[n])}return e._clone=function(e){var t=[];return r(t,e),t},e}();e.exports=r}()},function(e,t,n){!function(){"use strict";var t=n(2),r=n(5)._toHexString,o=Math.min,i=Math.max,a=Math.abs,l=parseInt,s=function(){function e(){}e._toString=function(e){var t=e.a,n=e.r,o=e.g,i=e.b;return 3===arguments.length&&(t=255,n=arguments[0],o=arguments[1],i=arguments[2]),4===arguments.length&&(t=arguments[0],n=arguments[1],o=arguments[2],i=arguments[3]),255===t?"#"+r(n,!0,2)+r(o,!0,2)+r(i,!0,2):"rgba("+n+","+o+","+i+","+t+")"},e._equal=function(e,t){return e.a===t.a&&e.r===t.r&&e.g===t.g&&e.b===t.b},e._getBrightness=function(e){return(299*e.r+587*e.g+114*e.b)/1e3},e._hueToRGB=function(e,t,n){return n<0&&(n+=240),n>240&&(n-=240),n<40?e+((t-e)*n+20)/40:n<120?t:n<160?e+((t-e)*(160-n)+20)/40:e};function t(t,n,r){return(255*e._hueToRGB(t,n,r)+120)/240&255}e._fromHLS=function(e,n,r){var o,i,a,s,u;return 0===r?o=i=a=l(255*n/240,10):(u=n<=120?l((n*(240+r)+120)/240):n+r-l((n*r+120)/240),s=2*n-u,o=t(s,u,e+80),i=t(s,u,e),a=t(s,u,e-80)),{a:255,r:o,g:i,b:a}},e._isTwoColorSimilar=function(e,t){var n,r=255-a(e.r-t.r),o=255-a(e.g-t.g),i=255-a(e.b-t.b),l=a(e.a-t.a);return r/=255,o/=255,i/=255,!!((n=(r+o+i)/3)>=.9&&l<=.05)},e._invertColor=function(t){var n=255^t.r,r=255^t.g,o=255^t.b;return e._toString(t.a,n,r,o)};function n(t){var n,r,o=e._ctx;return o||(n=document.createElement("canvas"))&&n.getContext&&(o=e._ctx=n.getContext("2d")),o?(o.clearRect(1,1,1,1),o.fillStyle=t,o.fillRect(1,1,1,1),r=o.getImageData(1,1,1,1),r?r.data:null):t}return e._fromString=function(t){var r,o,i,a,l;return t instanceof e?t:(r=0,o=0,i=0,a=0,t&&(l=n(t))&&(o=l[0],i=l[1],a=l[2],r=l[3]),{a:r,r:o,g:i,b:a})},e._applyTint=function(t,n){var r,o;return 0===n?t:(r=new u(t),o=l(n>0?(240-r._luminosity)*n:r._luminosity*n,10),e._fromHLS(r._hue,r._luminosity+o,r._saturation))},e._getLighterColor=function(t,n){var r=e._fromString(t),o=new u(r),i=o._getLighterColor(n);return e._toString(i)},e}(),u=function(){function e(e){var t,n,r,a,s=this,u=e.r,c=e.g,_=e.b,f=i(i(u,c),_),d=o(o(u,c),_),h=f+d;s._luminosity=l((240*h+255)/510,10),t=f-d,0===t?(s._saturation=0,s._hue=160):(s._luminosity<=120?s._saturation=l((240*t+h/2)/h,10):s._saturation=l((240*t+(510-h)/2)/(510-h),10),n=(40*(f-u)+t/2)/t,r=(40*(f-c)+t/2)/t,a=(40*(f-_)+t/2)/t,s._hue=u===f?l(a-r,10):c===f?l(80+n-a,10):l(160+r-n,10),s._hue<0&&(s._hue+=240),s._hue>240&&(s._hue-=240))}return e.prototype={constructor:e,_getLighterColor:function(e){var t=this,n=t._luminosity,r=t._newLuma(t._luminosity,500,!0);return s._fromHLS(t._hue,n+(r-n)*e,t._saturation)},_newLuma:function(e,t,n){return 0===t?e:n?t>0?(e*(1e3-t)+241*t)/1e3:e*(t+1e3)/1e3:(e+=240*t/1e3,e<0&&(e=0),e>240&&(e=240),e)}},e}();t._ColorHelper=s,e.exports=t}()},function(e,t){!function(){"use strict";var t=isNaN,n={},r="rowCount",o="colCount";function i(e){return e}function a(e,n,i,a,l,s,u,c,_,f,d){var h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P=i[r],L=i[o],k=n[r],B=n[o],W=a[r],z=a[o],U=1===L,Y=1===B;if(k===P&&B===L){for(E=0,F=0,D=0,N=0,w=P*L,h=0;h<P;h++)for(g=0;g<L;g++){if(m=s(i[h][g]),v=s(n[h][g]),e&&(t(m)||t(v)))return _;v=f(v),E+=m,F+=m*m,D+=v,N+=m*v}for(V=w*N-E*D,C=l?V/(w*F-E*E):N/F,y=l?(D*F-E*N)/(w*F-E*E):0,S=[],h=0;h<W;h++)for(S[h]=[],g=0;g<z;g++){if(m=s(a[h][g]),e&&t(m))return _;S[h][g]=0===V?n[0][0]:d(C*m+y)}return u?new u(S):S}if(U&&k===P||1===k&&B===L){for(m=[],v=[],I=L+1,M=L+2,h=0;h<P;h++){if(b=U?n[h][0]:n[0][h],y=s(b),e&&t(y))return _;v[h]=U?f(y):y}for(h=0;h<P;h++)for(m[h]=[],g=0;g<L;g++){if(y=s(i[h][g]),e&&t(y))return _;m[h][g]=y}for(O=[],C=0;C<I;C++)for(O[C]=[],w=0;w<M;w++)O[C][w]=0;for(p=0;p<P;p++)for(O[0][I]+=v[p],h=0;h<L;h++)for(b=h+1,O[0][b]+=m[p][h],O[b][0]=O[0][b],O[b][I]+=m[p][h]*v[p],g=h;g<L;g++)R=g+1,O[R][b]+=m[p][h]*m[p][g],O[b][R]=O[R][b];for(O[0][0]=P,H=l?0:1,x=H;x<I;x++){if(e){if(0===O[h][h]){for(A=!1,g=h+1;!A&&g<I;g++)if(0!==O[g][h]){for(p=0;p<M;p++)R=O[h][p],O[h][p]=O[g][p],O[g][p]=R;A=!0}if(!A)return c}}else{for(h=x;h<I&&0===O[h][x];)h++;if(h>=I)return c;for(T=H;T<M;T++)b=O[x][T],O[x][T]=O[h][T],O[h][T]=b}for(b=1/O[x][x],T=H;T<M;T++)O[x][T]*=b;for(h=H;h<I;h++)if(h!==x)for(b=-O[h][x],T=0;T<M;T++)O[h][T]+=b*O[x][T];l||(O[0][I]=0)}for(S=[],Y||(S[0]=[]),h=0;h<W;h++){for(Y&&(S[h]=[]),b=O[0][I],g=0;g<L;g++){if(b=Y?a[h][g]:a[g][h],y=s(b),e&&t(y))return _;b+=O[g+1][I]*y}Y?S[h][0]=d(b):S[0][h]=d(b)}return u?new u(S):S}return c}function l(e,t,n,r,o,l,s,u){return a(!0,e,t,n,r,o,l,u,s,i,i)}function s(e,t,n,l,s,u,c){var _,f;for(_=0;_<e[r];_++)for(f=0;f<e[o];f++)if(e[_][f]<=0)return u;return a(!1,e,t,n,l,i,s,c,null,Math.log,Math.exp)}n._trend=l,n._growth=s,e.exports=n}()},function(e,t){!function(){"use strict";e.exports={Exp_InvalidDateFormat:"Invalid date format pattern",Exp_InvalidExponentFormat:"invalid exponent format",Exp_InvalidSemicolons:"invalid format: too many semicolons",Exp_InvalidNumberGroupSize:"NumberGroupSize must be between 1 and 9.",Exp_BadFormatSpecifier:"Bad Format Specifier",Exp_InvalidNumberFormat:"Invalid number format pattern",Exp_InvalidCast:"InvalidCastException",Exp_Separator:"numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."}}()},function(e,t,n){!function(){"use strict";var t={};r(t,n(14)),r(t,n(15)),e.exports=t;function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}}()},function(e,t){!function(){"use strict";var t={};t.Key={left:37,right:39,up:38,down:40,tab:9,enter:13,shift:16,ctrl:17,space:32,altkey:18,home:36,end:35,pup:33,pdn:34,backspace:8,del:46,esc:27,a:65,c:67,v:86,x:88,z:90,y:89};function n(e,t){var n=this;n._owner=e,n._cmdDef=t,Object.defineProperty(n,"shortcutKey",{get:function(){return n._shortcutKey},set:function(e){var t,r,o,i=n._shortcutKey;i!==e&&(t=n._owner._shortcutKeys,r=t[i],r&&(o=r.indexOf(n))>=0&&r.splice(o,1),n._shortcutKey=e,e&&(r=t[e],r||(t[e]=r=[]),r.splice(0,0,n)))}})}n.prototype={canUndo:function(){return this._cmdDef.canUndo},execute:function(e,t,n){var r,o,i=this,a=!0;try{r=i._cmdDef.execute||i._cmdDef,o=r(e,t,1===n),a=!1!==o}catch(e){a=!1}return t&&a&&i._owner._commandExecuted({command:t,result:o,_actionType:n}),o}};function r(e){var t=this;t._context=e,t._listeners={},t._shortcutKeys={}}r.prototype={register:function(e,t,r,o,i,a,l){var s=this,u=new n(s,t);s[e]=u,r&&(u.shortcutKey=s.getShortcutKey(r,o,i,a,l))},getCommand:function(e){return this[e]},execute:function(e){var t=this[e.cmd];if(t)return t.execute(this._context,e,0)},setShortcutKey:function(e,t,n,r,o,i){var a,l,s,u,c=this;if(e)(a=c[e])&&(a.shortcutKey=c.getShortcutKey(t,n,r,o,i));else if(l=c.getShortcutKey(t,n,r,o,i),s=c.getCommands(l))for(u=s.length-1;u>=0;u--)s[u].shortcutKey=void 0},getShortcutKey:function(e,n,r,o,i){if(e){var a="A".charCodeAt(0)<=e&&e<="Z".charCodeAt(0)?String.fromCharCode(e):t.Key[e];return a||(a=e),a+(n?"+ctrl":"")+(r?"+shift":"")+(o?"+alt":"")+(i?"+window":"")}},getCommands:function(e){return this._shortcutKeys[e]},addListener:function(e,t){this._listeners[e]=t},removeListener:function(e){delete this._listeners[e]},_commandExecuted:function(e){var t,n=this._listeners;for(t in n)n.hasOwnProperty(t)&&n[t](e)}},t.CommandManager=r,e.exports=t}()},function(e,t){!function(){"use strict";function t(e,t,n){var r=this;r._context=e,t<0&&(t=2147483647),r._maxLength=t,r._allowUndo=n,r._undoStack=[],r._redoStack=[]}t.prototype={_addCommand:function(e,t){var n,r,o,i=this;if(e)if(1===t)i._redoStack.push(e);else{if(n=i._maxLength,r=i._undoStack.length,n>0&&r>=n)for(o=0;o<r-n+1;o++)i._undoStack.shift();i._undoStack.push(e),0===t&&(i._redoStack=[])}},canUndo:function(){return this._undoStack.length>0},undo:function(){var e,t,n=this,r=n._undoStack,o=!0;if(n._allowUndo&&n.canUndo()){e=r[r.length-1];try{t=n._context.commandManager()[e.cmd],t&&(o=t.execute(n._context,e,1))}catch(e){o=!1}!1!==o&&r.pop()}return o},canRedo:function(){return this._redoStack.length>0},redo:function(){var e,t,n=this,r=n._redoStack,o=!0;if(n._allowUndo&&n.canRedo()){e=r[r.length-1];try{t=n._context.commandManager()[e.cmd],t&&(o=t.execute(n._context,e,2))}catch(e){o=!1}!1!==o&&r.pop()}return o},clear:function(){this._undoStack=[],this._redoStack=[]}},e.exports.UndoManager=t}()},function(e,t,n){!function(){"use strict";var t={};r(t,n(17)),t.SR={},t.SR.en=n(18),e.exports=t;function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f=null,d=void 0,h=Math.abs,g={},p=n(1),m=p._StringHelper,v=p._DateTimeHelper,C=p._Types,w=C._isType,y=C._isArray,S=p._NumberHelper,x=S._generalNumberInt+"."+S._generalNumberDec,b=S._formatObjectToSrting,T=S._customCultureFormat,R=C._isNullOrUndefined,A=p.CultureManager,I="\u4e00\u5341",M="\u5341",E=function(){return p._getResource(g.SR)()},F=function(e){return A._getCultureInfo(e)},D=function(e){return F(e).DateTimeFormat},N=function(e){return F(e).NumberFormat},V=function(e){return e&&e.toLowerCase()},O=function(){throw Error(E().Exp_FormatIllegal)},H={_Empty:"",_format:function(){var e,t,n,r,o=[];for(e=0;e<arguments.length;e++)o[e]=arguments[e];if(0===arguments.length)return f;for(t=o[0],n=1;n<arguments.length;n++)r=RegExp("\\{"+(n-1)+"\\}","gm"),t=t.replace(r,arguments[n]);return t},_isNullOrEmpty:function(e){return!e||e===H._Empty}},P={_isDigit:function(e){var t=e.charCodeAt(0);return t>=48&&t<=57},_isWhiteSpace:function(e){var t=e.charCodeAt(0);return t>=9&&t<=13||32===t||133===t||160===t}},L=function(){function e(e,t){var n,r,o,i;if(ie.call(this,t),n=this,n._content=e,r=n._content,o=ee(r[0],"$",!1),i=r.indexOf("-"),!(o&&i>-1))throw Error(E().Exp_TokenIllegal);n._currencySymbol=X(r,1,i-1),r=m._remove(r,0,i+1),r.length>0&&(n._locateID=parseInt(r,16))}return e.Name="LocaleIDFormatPart",e.prototype={cultureInfo:function(){var e=this;return e._cultureInfo||(e._cultureInfo=F(e._locateID),e._currencySymbol&&e._currencySymbol!==H._Empty&&!e._cultureInfo.NumberFormat.isReadOnly&&(e._cultureInfo.NumberFormat.currencySymbol=e._currencySymbol)),e._cultureInfo},currencySymbol:function(){return this._currencySymbol?m._replace(this._currencySymbol,"\\.","'.'"):H._Empty},allowScience:function(){if(this._cultureInfo)return!(0===this._cultureInfo.name().indexOf("ja")||0===this._cultureInfo.name().indexOf("zh"))},toString:function(){return this._content?Z(this._content):H._Empty}},e}(),k=function(){function e(e,t){this.formatCached=e,this.cultureName=t,this.typeName=""}return e.prototype={format:function(e,t){return f},parse:function(e){return f},formatString:function(){return this.formatCached},toJSON:function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},fromJSON:function(e){if(e)for(var t in e)e[t]!==d&&(this[t]=e[t])}},e}(),B={_yearTwoDigit:"yy",_yearSingleDigit:"y",_yearFourDigit:"yyyy",_monthSingleDigit:"m",_monthTwoDigit:"mm",_monthAbbreviation:"mmm",_monthUnabbreviated:"mmmm",_monthJD:"mmmmm",_daySingleDigit:"d",_dayTwoDigit:"dd",_dayWeekDayAbbreviation:"aaa",_dayWeekDayUnabbreviated:"aaaa",_hoursSingleDigit:"h",_hoursTwoDigit:"hh",_minuteSingleDigit:"m",_minuteTwoDigit:"mm",_secondSingleDigit:"s",_secondTwoDigit:"ss",_eraYear:"e",_aMPMTwoDigit:"AM/PM",_aMPMSingleDigit:"A/P",_placeholderMonthJD:"@mmmmm",_defaultAbsoluteTime:new Date(1899,11,30,0,0,0,0)},W=[B._yearSingleDigit,B._yearTwoDigit,B._yearFourDigit,B._monthSingleDigit,B._monthTwoDigit,B._monthAbbreviation,B._monthUnabbreviated,B._monthJD,B._daySingleDigit,B._dayTwoDigit,B._dayWeekDayAbbreviation,B._dayWeekDayUnabbreviated,B._hoursSingleDigit,B._hoursTwoDigit,B._minuteSingleDigit,B._minuteTwoDigit,B._secondSingleDigit,B._secondTwoDigit,"ggg","gg","g","ee","e"],z=function(){function e(e,n){var r,o,i,a,l,s,u,c;for(ie.call(this,n),r=this,l=["<=","<>",">=",">","<","="],s=0,u=l.length;s<u;s++)if(o=l[s],m._startsWith(e,o,!0)){i=m._remove(e,0,o.length),c=parseFloat(i),isNaN(c)||(a=c);break}if(a===f&&a===d)throw Error(E().Exp_TokenIllegal);r.value=a,r._compareOperator=o,r.isMeetCondition=t(r)}e.Name="ConditionalFormatPart",e.prototype={toString:function(){return Z(this._compareOperator+""+this.value)}};function t(e){var t="var self = this;",n=e._compareOperator;return n="<>"===n?"!=":n,n="="===n?"===":n,t+="return value "+n+" self.value;",Function(["value"],t)}return e}(),U=function(){function e(e,t){ie.call(this,t);var n=this;if(n.token=e,n.type=parseInt(m._remove(e,0,5),10),n.type<0||n.type>3)throw Error(E().Exp_TokenIllegal)}e.Name="DBNumberFormatPart",e.prototype={_replaceNumberString:function(e,n,r){var o,i,a,l,s,u,c,_,f,d;if(!e||e===H._Empty)return e;for(o=e,i=e,a=-1,l=-1,s=!1,f=e.length-1;f>=0;f--)d=i[f],!isNaN(d)||ee(d,".",!1)&&!s?(ee(d,".",!1)&&(s=!0),-1===a&&(a=f),l=f):l>-1&&a>-1&&(u=X(i,l,a-l+1),c=parseFloat(u),isNaN(c)||(_=t(u,n,r),o=m._remove(o,l,a-l+1),o=m._insert(o,l,_)),a=-1,l=-1,s=!1);return l>-1&&a>-1&&(u=X(i,l,a-l+1),c=parseFloat(u),isNaN(c)||(_=t(u,n,r),o=m._remove(o,l,a-l+1),o=m._insert(o,l,_))),o},toString:function(){if(this.type>-1)return Z("DBNum"+this.type);throw Error()}};function t(e,t,r){var o,i,a=e.split(".");if(a){if(1===a.length)return n(a[0],t.numbers,r?t.letters:f);if(2===a.length)return o=n(a[0],t.numbers,r?t.letters:f),i=n(a[1],t.numbers),o+"."+i}throw Error(E().Exp_ValueIllegal)}function n(e,t,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C=e,w=0,y=0;if(2===arguments.length){for(i="",w=0;w<C.length;w++)o=X(C,w,1),y=parseInt(o,10),i+=t[y];return i}if(3===arguments.length){if(!r)return n(e,t);for(a=0,l="",s=C.length,u=!1,c=[],w=0;w<s;w++)_=r.length-1-w,_>-1?c.push(""+r[_]):c.push(H._Empty);for(f=[],d=c.length-1;d>=0;d--)f[c.length-d-1]=c[d];for(c=f,h=!1,d=0;d<s;d++)o=X(C,d,1),y=parseInt(o,10),p=H._Empty,s-d-16>0?(g=t[y],p="",h=!0):d!==s-1&&d!==s-5&&d!==s-9&&d!==s-13?"0"===o?(g="",p="",a+=1):"0"!==o&&0!==a?(g=t[0]+t[y],p=c[d],a=0):(g=t[y],p=c[d],a=0):"0"!==o&&0!==a?(g=t[0]+t[y],p=c[d],a=0):"0"!==o&&0===a||h?(g=t[y],p=c[d],a=0,h=!1):"0"===o&&a>=3?(g="",p="",a+=1):s>=11?(g="",a+=1):(g="",p=c[d],a+=1),m=g+p===H._Empty,m||(u=!1),d!==s-13||u||(p=c[d],u=!0),d!==s-9||u||(p=c[d],u=!0),d===s-1&&(p=c[d],u=!0),l=l+g+p;return v=parseInt(e,10),0===v?t[0]:l}}return e}(),Y=function(){function e(e,t,n,r,o){oe.call(this,t,n,r);var i=this;i._formatString=i._fixFormat(te(e)),i._absTimeParts=o,i._formatType=2,i._init()}e.prototype={_init:function(){var t,n,r,o=this,i={_value:o._formatString};if(e._evaluateFormat(i._value)){if(t=o._processAMPM(i),o.hasJD=o._replace(i._value,B._monthJD,'"'+B._placeholderMonthJD+'"',!0,!1,i,!1),o._replace(i._value,B._monthUnabbreviated,"MMMM",!0,!1,i,!1),o._replace(i._value,B._monthAbbreviation,"MMM",!0,!1,i,!1),o._replace(i._value,B._monthTwoDigit,"MM",!0,!1,i,!1),o._replace(i._value,B._monthSingleDigit,"M",!0,!1,i,!1),o._replace(i._value,B._dayWeekDayAbbreviation,"ddd",!0,!0,i,!0),o._replace(i._value,B._dayWeekDayUnabbreviated,"dddd",!0,!0,i,!0),t||(o._replace(i._value,B._hoursSingleDigit,"H",!0,!0,i,!1),o._replace(i._value,B._hoursTwoDigit,"HH",!0,!0,i,!1)),o._partDBNumberFormat&&o._partLocaleID&&(o._hasYearDelay=o._hasYearDelay||o._replace(i._value,B._yearFourDigit,'"@'+B._yearFourDigit+'"',!0,!1,i,!0),o._hasYearDelay=o._hasYearDelay||o._replace(i._value,B._yearTwoDigit,'"@'+B._yearTwoDigit+'"',!0,!1,i,!0)),o._absTimeParts)for(n=0;n<o._absTimeParts.length;n++)r=o._absTimeParts[n],o._replace(i._value,r._originalToken,"@"+r._originalToken,!0,!0,i,!0);o._validDateTimeFormatString=i._value}else O()},formatString:function(){return this._formatString},format:function(e){var t,n,r,o,i,a,l=this,s=H._Empty,u=f;try{if(u=v._DT(e),u?e=u:s=""+e,u&&(s=v._customCultureFormat(u,l._validDateTimeFormatString,l._partLocaleID&&l._partLocaleID.cultureInfo()||F(l.cultureName)),l.hasJD&&(t=F(l.cultureName).DateTimeFormat.monthNames[u.getMonth()],s=m._replace(s,B._placeholderMonthJD,X(t,0,1))),l._absTimeParts))for(n=24*(v._toOADate(u)-v._toOADate(B._defaultAbsoluteTime))*60*60*1e3,r=0;r<l._absTimeParts.length;r++)o=l._absTimeParts[r],i=o._getTimeSpan(n),R(i)||(a=o._originalToken.replace("[","\\[").replace("]","\\]"),s=m._replace(s,"@"+a,i))}catch(t){s=j(e)}return ce(s,e,l._partLocaleID,l._partDBNumberFormat,l.cultureName)},parse:function(e){
var t,n,r,o,i;if(!e||e===H._Empty)return f;if(t=this,n=e,"true"===(r=V(n)))return!0;if("false"===r)return!1;if(t._validDateTimeFormatString&&(o=v._parseExact(n,t._validDateTimeFormatString,F(t.cultureName))))return o;try{return(i=v._DT(n))&&!isNaN(i)?i:(i=new Date(n),isNaN(i.valueOf())?n:i)}catch(e){return n}},_fixFormat:function(e){var t,n,r,o=e,i="",a=!1;for(t=0;t<o.length;t++)n=o[t],'"'===n?a=!a:a||("Y"===n||"D"===n||"S"===n||"E"===n||"G"===n?n=V(n):"M"===n&&(r=o[t-1],ee("A",r,!0)||ee("P",r,!0)||(n=V(n)))),i+=n;return i},_processAMPM:function(e){var t,n=[B._aMPMTwoDigit,D(this.cultureName).amDesignator+"/"+D(this.cultureName).pmDesignator,B._aMPMSingleDigit],r=["tt","tt","t"];for(t=0;t<3;t++)if(m._contains(e._value,n[t],1))return e._value=m._replace(e._value,n[t],r[t],!0),!0;return!1},_replace:function(e,r,o,i,a,l,s){var u,c,_,f,d,h,g,p,v,C,w;if(i||a){for(u=[],c=!0,!n(e)&&t(e)&&(c=!1),_=!1,f=0;f<e.length;f++){if(d=e[f],t(d)?c=!1:n(d)&&(c=!0),i&&ee(d,r[0],s)&&c||a&&ee(d,r[0],s)&&!c){for(h=!0,g=0;g<r.length;g++)if(g+f>=e.length||!ee(r[g],e[g+f],s)){h=!1;break}if(p=f+r.length-1,h&&p+1<e.length){for(v=e[p],C=-1,C=p+1;C<e.length&&ee(v,e[C],s);C++);C>p+1&&(f=C,h=!1)}h&&!_&&u.splice(0,0,f)}'"'===d&&(_=!_)}if(l._value=e,u.length>0){for(f=0;f<u.length;f++)w=u[f],l._value=m._remove(l._value,w,r.length),l._value=m._insert(l._value,w,o);return!0}return!1}return!1}};function t(e){return m._indexOf(e,B._hoursSingleDigit[0],!0)>-1||m._indexOf(e,B._secondSingleDigit[0],!0)>-1}function n(e){return m._indexOf(e,B._yearTwoDigit[0],!0)>-1||m._indexOf(e,B._daySingleDigit[0],!0)>-1}return e._evaluateFormat=function(e){return re(e,W)},e}(),G=function(e,t){var n,r,o;if(ie.call(this,t),n=this,"h"===(r=V(e)[0]))o=3600;else if("m"===r)o=60;else{if("s"!==r)throw Error(E().Exp_TokenIllegal);o=1}n._getTimeSpan=function(e){return Math.floor(e/1e3/o)}};G.Name="ABSTimeFormatPart",t=function(){function e(e,t){ie.call(this,t),this.foreColor=e}return e.Name="ColorFormatPart",e.prototype.toString=function(){return Z(this.foreColor)},e}(),r=function(){function e(e,t,n,r){var o,i,a,l,s,u;function c(e,t){var n,r,o,i,a,l=[],s='"';if(e===f||""===e)return l;for(n=!1,r=[],o=!1,i=0;i<e.length;i++)a=e[i],a!==s||n||(o=!o),n||o||a!==t?r.push(a):(l.push(r.join("")),r=[]),n="\\"===a&&!n;return l.push(r.join("")),l}oe.call(this,t,n,r),o=this,o._isGeneralNumber=!1,o._formatType=1,o._fullFormatString=J(e),i=te(e),t&&(i=Q(i,o._partLocaleID._originalToken,o._partLocaleID.currencySymbol())),i=J(i),a=i.indexOf("/"),a>-1&&(l=c(i,"/"))&&2===l.length&&(o._fractionDenominatorFormat=l[1],(s=l[0])&&(u=s.lastIndexOf(" "),u>-1?(o._fractionIntegerFormat=X(s,0,u),o._fractionNumeratorFormat=X(s,u+1,s.length-u-1)):o._fractionNumeratorFormat=s)),o._numberFormatString=i}e.prototype={formatString:function(){return this._fullFormatString},format:function(e){var o,i,a,l,s,u,c,_,d,h,g,p,m,v,y,S,x,R,A,I,M,E;return w(e,"boolean")?(""+e).toUpperCase():(o=this,i=C._toDouble(e),isNaN(i)||!isFinite(i)||isNaN(e)?"string"==typeof e?e:f:(a=F(o.cultureName),o._fractionNumeratorFormat&&o._fractionDenominatorFormat?(h={value:0},g={value:0},p={value:0},m=o._getDenominatorLength(),n(i,m,h,g,p)?(v=t(g.value,p.value),v>1&&(g.value/=v,p.value/=v),o._fractionIntegerFormat?(d="",1===p.value&&(h.value+=g.value,g.value=0,p.value=0),y=b(T(h.value,o._fractionIntegerFormat,a)),y&&"0"!==y&&(d+=y,d+=" "),0===h.value&&i<0&&(d+=a.NumberFormat.negativeSign),0===i&&(d+="0"),s=o._fractionDenominatorFormat,u=parseFloat(s),!isNaN(u)&&u>0&&(0!==g.value&&0!==p.value&&(g.value*=u/p.value),p.value=u,s=s.replace(/^\d+/,r(u)),c=Math.ceil(g.value),_=c-g.value,g.value=_<=.5&&_>=0?parseFloat(""+c):parseFloat(""+(c-1))),S=o._fractionNumeratorFormat,x=parseFloat(S),isNaN(x)||0!==x||(R=S.length,A=""+g.value,I=A.length,R>I?S=S.substr(0,R-(R-I)):R<I&&(A=A.substr(0,I-(I-R)),g.value=parseInt(A,10))),M=o._getFormattedFractionString(g.value,p.value,S,s,a),0===g.value&&(M=M.replace(/./g," "),""===y)?"0 "+M:(d+=M,""===d?"0":d)):(d="",E=h.value*p.value+g.value,s=o._fractionDenominatorFormat,u=parseFloat(s),u>0?(E*=u/p.value,p.value=u,c=Math.ceil(E),_=c-E,E=_<=.5&&_>=0?parseFloat(""+c):parseFloat(""+(c-1)),d+=E+"/"+p.value):d+=o._getFormattedFractionString(E,p.value,o._fractionNumeratorFormat,o._fractionDenominatorFormat,a),0===E?"0":d)):""+i):(l=T(i,o._numberFormatString,a),l=_e(l,o._isGeneralNumber,o._partLocaleID,o._partDBNumberFormat,o.cultureName))))},parse:function(e){var t,n,r,o,i,a=this;return e&&e!==H._Empty?"true"===(t=V(e))||"false"!==t&&(e=a._trimSpecialSymbol(e),e=a._trimCurrencySymbol(e),n=a._trimPercentSign(e),r=n._isPer,o=n._str,a._isValidaNumberString(o)&&(o=m._replaceAllNoReg(o,N(a.cultureName).numberGroupSeparator,""),i=S._parseFloat(o,a.cultureName),!isNaN(i)&&isFinite(i))?(r&&(i/=100),i):f):f},_getDenominatorLength:function(){var e,t,n=this,r=n._fractionDenominatorFormat,o=0;if(r)for(e=r.length,t=0;t<e&&r[t].match(/[#?0\d]/);t++)o++;return o},_isValidaNumberString:function(e){var t,n="",r=0,o=0,i=0,a=!0,l=N(this.cultureName);for(t=e.length-1;t>-1;t--){if(e[t]===l.numberDecimalSeparator)r++,i>0&&(a=!1),n="";else if("e"===V(e[t]))o++,n="";else if(e[t]===l.numberGroupSeparator)a=3===n.length,i++,n="";else if("-"===e[t]||"+"===e[t]){if(t>0&&"e"!==V(e[t-1]))return!1}else{if(!P._isDigit(e[t]))return!1;n+=e[t]}if(r>1||o>1||!a)return!1}return!0},_trimSpecialSymbol:function(e){var t,n,r,o,i,a,l,s=e,u=[];for(t=0;t<s.length;t++)P._isDigit(s[t])&&u.push(t);for(n=N(this.cultureName),r=[n.currencyDecimalSeparator,n.currencyGroupSeparator,n.currencySymbol,n.nanSymbol,n.negativeInfinitySymbol,n.negativeSign,n.numberDecimalSeparator,n.numberGroupSeparator,n.percentDecimalSeparator,n.percentGroupSeparator,n.percentSymbol,n.perMilleSymbol,n.positiveInfinitySymbol,n.positiveSign],o=s.length-1;o>-1;o--)if(i=s[o],!P._isWhiteSpace(i)||r.indexOf(""+i)>-1){if(("-"===i||"+"===i)&&(a=o>0?""+s[o-1]:f,l=["e","E","(",N(this.cultureName).currencySymbol],l.indexOf(a)<0))break}else(o<u[0]||u[u.length-1]<o)&&(s=m._remove(s,o,1));return s},_trimCurrencySymbol:function(e){var t=N(this.cultureName).currencySymbol,n=m._startsWith(e,t)?m._remove(e,0,t.length):e;return n.indexOf(t)<0?n:e},_trimPercentSign:function(e){var t=N(this.cultureName).percentSymbol,n=!0,r=e;return m._startsWith(e,t)?r=m._remove(e,0,t.length):m._endsWith(e,t)?r=m._remove(e,e.length-t.length,t.length):n=!1,m._contains(r,t)&&(n=!1),{_str:r,_isPer:n}},_getFormattedFractionString:function(e,t,n,r,o){var i=b(T(e,n,o)),a="0."+t,l="#."+r,s=b(T(a,l,o,!0)),u=i+"/"+s.substr(s.indexOf(".")+1);return""===n&&(u=e+u),""===r&&(u+=t),u}};function t(e,t){var n,r,o;if(0===e)return h(t);if(0===t)return h(e);for(n=Math.max(e,t),r=Math.min(e,t),o=n%r;0!==o;)n=r,r=o,o=n%r;return h(r)}function n(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,g=0,p=0,m=0,v=0,C=Math.ceil;for(e>0?(v=e-C(e)+1,1===v?(v=0,g=e):g=C(e)-1):e<0&&(g=C(e),v=C(e)-e),i=Math.pow(10,t-1),a=Math.pow(10,t)-1,i<2&&(i=2),a<2&&(a=2),l=!1,s=0,u=i;u<=a&&(c=u*v,_=Math.round(c),f=_/u,d=h(f-v),!((!l||d<h(s-v))&&(l=!0,s=f,p=_,m=u,d<1e-5)));u++);return n.value=g,r.value=p,o.value=m,l}function r(e){return(""+e).replace(/\d/g,"?")}return e}(),o=function(){function e(e,t,n,r){oe.call(this,t,n,r),arguments.length>0?((e.indexOf("0")>=0||e.indexOf("#")>=0||e.indexOf(".")>=0||e.indexOf("@")>=0)&&O(),this._fullFormatString=e):this._fullFormatString="General",this._formatType=0}return e.prototype={_getDigitalFormat:function(){var e,t=this;return t._digitalFormat||(e=t._fullFormatString,e=Q(e,"General",x),t._digitalFormat=new r(e,t._partLocaleID,t._partDBNumberFormat,t.cultureName),t._digitalFormat._isGeneralNumber=!0),t._digitalFormat},_getExponentialDigitalFormat:function(){var e=this;return e._exponentialDigitalFormat||(e._exponentialDigitalFormat=new r("0.#####E+00",e._partLocaleID,e._partDBNumberFormat,e.cultureName),e._exponentialDigitalFormat._isGeneralNumber=!0),e._exponentialDigitalFormat},formatString:function(){return m._replace(this._fullFormatString,"@NumberFormat","General")},format:function(e){var t,n,r,o=this;if(C._isNumber(e,o.cultureName)){if(t=!o._partLocaleID||o._partLocaleID.allowScience(),(n=C._toDouble(e))!==d&&n!==f)return h(n)>99999999999&&t||h(n)<1e-11&&0!==n?o._getExponentialDigitalFormat().format(e):o._getDigitalFormat().format(e)}else{if(w(e,"string"))return r=m._replace(o.formatString(),'"',""),r=$(r),r?m._replace(r,"General",e):e;if(w(e,"boolean"))return(""+e).toUpperCase()}return""},parse:function(e){var t,n,r,o,i,a,l;return H._isNullOrEmpty(e)?f:"number"==typeof e?e:(t=!1,n=m._indexOf(e,"-"),n>0&&!ee(e.charAt(n-1),"E",!0)&&(t=!0),(m._contains(e,"/")||t||m._contains(e,":")||m._contains(e,"-"))&&(r=v._parseLocale(e))?r:(i="-"===e.charAt(0),a=i?m._remove(e,0,1):e,l="("===a.charAt(0)&&")"===e.charAt(e.length-1),o=this._getDigitalFormat().parse(a),o!==f&&o!==d?(l||i)&&w(o,"number")?-1*h(o):o:e))}},e}(),i=function(){function e(e,t,n,r){var o,i=this;oe.call(i,t,n,r),o=te(e,!1),t&&(o=Q(o,i._partLocaleID._originalToken,i._partLocaleID.currencySymbol())),o=J(o),o=$(o),i._formatString=o,i._formatType=3}return e.prototype={format:function(e){var t,n,r,o=this;try{return n=e instanceof Date?""+v._toOADate(e):j(e),r=o._parseFormat(o._formatString),t=o._toFormattedObject(n,r)}catch(e){return""}},parse:function(e){return e||""},formatString:function(){return this._formatString},_parseFormat:function(e){var t,n,r="",o=!1,i=f,a=[];for(n=0;n<e.length;n++)t=e.charAt(n),o?('"'!==t?r+=t:(r+=t,a.push(r),r="",o=!1),i=t):"*"!==i&&"_"!==i&&"\\"!==i||""===r?"*"!==t&&"_"!==t&&"\\"!==t?"@"!==t?'"'!==t?(r+=t,i=t):(i=t,""!==r&&a.push(r),r=t,o=!0):(i=t,""!==r&&(a.push(r),r=""),a.push(t)):(i=t,""!==r&&(a.push(r),r=""),r+=t):(r+=t,a.push(r),r="");return""!==r&&a.push(r),a},_toFormattedObject:function(e,t){var n,r,o=[],i=!1;for(n=t.length-1;n>=0;n--)r=t[n],"*"===r[0]?i||(i=!0,o.push({type:"fillingChar",value:r[1]})):"_"===r[0]?o.push({type:"placeholder",value:r[1]}):'"'===r[0]&&'"'===r[r.length-1]?r.length>2&&o.push({type:"text",value:r.substr(1,r.length-2)}):"@"===r[0]?o.push({type:"text",value:e}):o.push({type:"text",value:r});return o.reverse()}},e}();function X(e,t,n){return e.substr(t,n)}function j(e){return C._isNullOrUndefined(e)?"":"boolean"==typeof e?e?"TRUE":"FALSE":"string"==typeof e?e:""+e}a={_positive:0,_negative:1,_zero:2,_text:3},l=RegExp("([.+?*$^\\[\\](){}|/])","g");function K(e,t){if("\\"===e[t])throw Error(E().Exp_InvalidBackslash);if(t-1>0&&t-1<e.length&&"\\"===e[t-1]){if(t-2<0)return!0;if(t-2>0&&t-2<e.length)return"\\"!==e[t-2]}return!1}function Z(e){if(!e)throw Error(E().Exp_TokenIsNull);return"["+e+"]"}function J(e){var t,n,r,o;if(e===d||e===f||""===e)return e;for(t="",n=0,r=0;r<e.length;r++)o=e[r],"["===o?n++:"]"===o?--n<0&&(n=0):0===n&&(t+=o);return""+t}function q(e){return e=Q(e,"[",""),Q(e,"]","")}function Q(e,t,n){return!e||e===H._Empty||ee(t,n,!0)?e:(t=t.replace(l,"\\$1"),e.replace(RegExp(t,"g"),n))}function $(e){var t,n,r=e.length,o=!1,i="";for(t=0;t<r;t++)n=e.charAt(t),"\\"===n?(o=!o)||(i+=n):(o=!1,i+=n);return i}function ee(e,t,n){return n?V(e)===V(t):e===t}function te(e,t){var n,r,o,i;for(1===arguments.length&&(t=!0),n=!1,r="",o=0;o<e.length;o++){if('"'===(i=e[o]))n=!n;else if(!n&&!t&&"/"===i&&!K(e,o)){"_"===i&&o++;continue}r+=i}return r}function ne(e){var t,n,r,o="",i=!1;for(t=0,n=e.length;t<n;t++)r=e[t],'"'===r&&(i=!i),"E"===r||i||(o+=V(r));return o}function re(e,t){var n,r,o,i;if(!e||e===H._Empty)return!1;for(n=te(e),r=ne(n),o=0;o<t.length;o++){if(0===(i=r.indexOf(t[o])))return!0;if(i>0&&"_"!==r[i-1]&&"*"!==r[i-1])return!0}return!1}s=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"],["H:m:s.FFF","h:m:s.FFF tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],u=function(){return{pattern:s,formatter:["d-mmm","mmm-yy",D().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0",D().shortDatePattern+" h:mm",D().shortDatePattern+" h:mm:ss",D().shortDatePattern+" h:mm:ss.0"]}};function oe(e,t,n){this._partLocaleID=e,this._partDBNumberFormat=t,this.cultureName=n}function ie(e){this._originalToken=e}function ae(e){var n,r,o=q(e);return o&&o!==H._Empty?(r=o[0],["<",">","="].indexOf(r)>-1?(n=z,n.Name="ConditionalFormatPart"):m._startsWith(o,"DBNum",!0)?(n=U,n.Name="DBNumberFormatPart"):ee(o[0],"$",!1)&&o.indexOf("-")>-1?(n=L,n.Name="LocaleIDFormatPart"):se(o)?(n=G,n.Name="ABSTimeFormatPart"):o.indexOf("$")<0&&o.length>=3&&(n=t,n.Name="ColorFormatPart"),n):n}function le(e,t){var n,a=!1;return e=e?""+e:H._Empty,re(e,["general"])?n=o:Y._evaluateFormat(e)?n=Y:re(e,["E+","E-","#",".",",","%","0","/","?"])||t?(a=!0,n=r):(a=!0,n=i),{_isDigitalOrText:a,_type:n}}function se(e){var t,n=V(e),r=n[0];if("h"!==r&&"m"!==r&&"s"!==r)return!1;for(t=1;t<n.length;t++)if(r!==n[t])return!1;return!0}function ue(e,t,n){var r,o;return r=e?e.cultureInfo():F(n),o=r.NumberFormat.dbNumber,o?o[t]:f}function ce(e,t,n,r,o){var i,a=e;return!R(r)&&t instanceof Date&&(i=ue(n,r.type,o),a=r._replaceNumberString(a,i,!0),1===r.type&&(a=a.replace(RegExp(I,"g"),M)),a=a.replace("@"+B._yearFourDigit,v._localeFormat(t,B._yearFourDigit)),a=a.replace("@"+B._yearTwoDigit,v._localeFormat(t,B._yearTwoDigit)),a=r._replaceNumberString(a,i,!1)),a}function _e(e,t,n,r,o){var i,a,l,s,u,c,_;if(!R(r)&&(i=ue(n,r.type,o),!R(i))){for(a=!1,s=F(o),c=0,_=e.length;c<_;c++)"decimalSeparator"===e[c].type&&(a=!0,e[c].value=r._replaceNumberString(e[c].value,i,t),l=e[c].value),"number"===e[c].type&&(e[c].value=a?r._replaceNumberString(l+e[c].value,i,t).slice(1):r._replaceNumberString(e[c].value,i,t),"ja-JP"===s.name()&&e[c].value.length>1&&("\u4e00\u5343"===(u=e[c].value.substr(0,2))||"\u4e00\u767e"===u||"\u4e00\u5341"===u)&&(e[c].value=e[c].value.substr(1)));return e}return e}c=function(){function e(e,t){var n=this;0===arguments.length?(n.formatCached="General",n._numberFormat=new o):n._init(e,t)}var t=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"];function n(e){if(!e||e===H._Empty)throw Error(E().Exp_TokenIllegal)}function r(e){n(e);var t=q(e);return n(t),t}function i(e){return'"'+r(e)+'"'}return e.prototype={_init:function(e,t){var n,o,a,l,s,u,c,_,h,g,p,m,v,C,w;for(e!==f&&e!==d||O(),n=e,o=this,o.formatCached=e,a="",l="",s=!1,u=[],c=0;c<e.length;c++)_=e[c],"["===_?(s&&O(),l&&(a||(a=""),a+=l),l=""+_,s=!0):"]"===_?(s||O(),l?(l+=_,h=""+l,g=ae(""+l),g?"ABSTimeFormatPart"===g.Name?(u.push(new g(r(h),h)),a+=l):o.addPart(g,h):(p=i(h),a+=p,n=Q(e,h,p)),l=""):O(),s=!1):l+=_;l&&(s?O():a+=l),o.localeIDFormatPart&&(t=o.localeIDFormatPart.cultureInfo().name()),m=o.conditionalFormatPart,v=le(a,m),C=v._type,w=v._isDigitalOrText?n:a,C?o._numberFormat=new C(w,o.localeIDFormatPart,o.dbNumberFormatPart,t,u.length>0?u:f):O()},formatString:function(){var e,n,r,o=this,i="";for(e=0,n=4;e<n;e++)r=t[e],o[r]&&(i+=""+o[r]);return i+=o._numberFormat.formatString()},addPart:function(e,n){var o,i,a,l=this,s=r(n);for(o=0,i=4;o<i;o++)if(a=t[o],ee(a,e.Name,!0)){if(l[a])throw Error(E().Exp_DuplicatedDescriptor);l[a]=new e(s,n)}},format:function(e){return this._numberFormat.format(e)},parse:function(e){return this._numberFormat.parse(e)}},e}(),_=function(e){C._inherit(t,e);function t(e,t){var n=this;n._isSingleFormatterInfo=!0,n.PropertyChanged=[],H._isNullOrEmpty(e)&&(e="General"),n.formatCached=e,n.cultureName=t,n.init()}function n(e){var n=t[e];return n||(n=new t(e),t[e]=n),n}return t.prototype={toJSON:function(){var e=this,t={formatCached:e.formatCached};return e.cultureName&&(t.customerCultureName=e.cultureName),"general"===V(e.formatCached)&&delete t.formatCached,t},hasFormatedColor:function(){var e,t,n=this;for(e in a)if(a.hasOwnProperty(e)&&(t=n.getFormatter(a[e]))&&t.colorFormatPart)return!0;return!1},formatString:function(e){var t,n,r,o,i=this;if(0===arguments.length){for(t=H._Empty,n=0,r=i.formatters.length;n<r;n++)o=i.formatters[n],t+=o.formatString(),n!==r-1&&(t+=";");return t}if(!e)throw Error(E().Exp_ValueIsNull);return i.formatters=f,i.formatCached=e,i.init(),i._raisePropertyChanged("formatString"),i},getFormatter:function(e){var t=this;return t.formatters&&t.formatters[e]},getPreferredEditingFormatter:function(e){var t,r,o=D(this.cultureName);return w(e,"DateTime")?(t=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()?"":" h:mm:ss",n(o.shortDatePattern+t)):w(e,"TimeSpan")?n(o.longTimePattern):C._isNumber(e,this.cultureName)?(r=C._toDouble(e),n(r>=1e20||r<=1e-17&&r>0||r<=-1e20||r<0&&r>=-1e-17?"0.##E+00":x)):n("General")},getPreferredDisplayFormatter:function(e,r){var o,i,a,l,s,c,_,d,h,g,p,y,S,x,b,T,R,A,I,M=this;if(r||(r={value:f}),r.value=f,H._isNullOrEmpty(e))return new t;if(o=e,i=r.value=M.parse(o),w(i,"DateTime")||w(i,"TimeSpan")){for(a=u(),l=a.pattern,s=a.formatter,c=0;c<l.length;c++)for(_=l[c],d=0;d<_.length;d++)if(h=_[d],(g=v._parseLocale(e,h))&&g-i==0)return new t(s[c])}else if(C._isNumber(i,M.cultureName)){if(p=N(M.cultureName),y=p.currencySymbol,S=p.numberDecimalSeparator,x=p.percentSymbol,b=p.numberGroupSeparator,T="E",R=m._contains,A=R(o,S),I=A?".00":"",o[0]===y)return n(H._format("{0}#,##0{1};[Red]({0}#,##0{1})",y,I));if(R(o,T,1))return n("0.00E+00");if(""+o[0]===x||""+o[o.length-1]===x)return n(H._format("0{0}%",I));if(R(o,b))return n(H._format("#,##0{0}",I))}return n("General")},format:function(e,t){var n,r,o,i,l;if(w(e,"boolean"))return(""+e).toUpperCase();if(n=this._getFormatInfo(e)){r=n.colorFormatPart,t&&r&&(t.conditionalForeColor=t.value=r.foreColor),o=0,i=C._isNumber(e,self.cultureName),i&&(o=C._toDouble(e)),l=H._Empty;try{l=i&&n===this.getFormatter(a._negative)?n.format(h(o)):n.format(e),t&&(t.content=y(l)?l:[{type:"text",value:l}]),y(l)&&(l=S._formatObjectToSrting(l))}catch(t){w(e,"string")&&(l=""+e)}return l}return i&&o<0?"-":w(e,"string")?""+e:e===d||e===f?H._Empty:""+e},parse:function(e){var t=this;return t.formatters&&t.formatters.length>0?t.formatters[0].parse(e):f},init:function(){var e,t,n,r=this,o=r.formatCached;for(H._isNullOrEmpty(o)&&O(),r.formatters=[],e=o.split(";"),r._isSingleFormatterInfo=1===e.length,(!e||e.length<1||e.length>4)&&O(),t=0;t<e.length;t++)n=new c(e[t],r.cultureName),r.formatters.push(n);r.getFormatter(a._positive)||O()},_getFormatInfo:function(e){var t,n,r,o,i,l,s,u,c=this,_=c.getFormatter(a._positive),d=c.getFormatter(a._text);return"string"==typeof e&&isNaN(e)?d||_:C._isNumber(e,c.cultureName)||w(e,"boolean")?(t=c.getFormatter(a._negative),n=c.getFormatter(a._zero),r=C._toDouble(e),o=_&&_.conditionalFormatPart,i=o&&_.conditionalFormatPart.isMeetCondition(r),l=t&&t.conditionalFormatPart,s=l&&t.conditionalFormatPart.isMeetCondition(r),c._isSingleFormatterInfo||(o?i:r>0)||0===r&&!c.getFormatter(a._zero)?u=_:(l?s:r<0)?u=t:n?u=n:t&&(u=t),u):f},_raisePropertyChanged:function(e){var t,n,r=this;if(r.PropertyChanged)for(t=0;t<r.PropertyChanged.length;t++)"function"==typeof(n=r.PropertyChanged[t])&&n(r,e)}},t}(k),g.GeneralFormatter=_,g.FormatterBase=k,e.exports=g}()},function(e,t){!function(){"use strict";e.exports={Exp_TokenIsNull:"token is null",Exp_InvalidBackslash:"the '\\' cannot be evaluated",Exp_FormatIllegal:"format is illegal.",Exp_ValueIsNull:"value is null",Exp_DuplicatedDescriptor:"The type of descriptor was added.",Exp_TokenIllegal:"token is illegal.",Exp_ValueIllegal:"value is illegal.",Exp_InvalidCast:"InvalidCastException"}}()},function(e,t,n){!function(){"use strict";e.exports=n(20)}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s=n(1),u=s._Types._isNullOrUndefined,c=s._ColorHelper,_=c._getLighterColor,f=c._fromString,d=s._ArrayHelper,h=d._indexOf,g={},p=g.__invalidValuePlaceHolder={},m=null,v=void 0,C=Math.floor,w=Math.PI,y=Math.sin,S=Math.cos,x=Math.min,b=Math.max,T=Math.round,R=Math.pow,A=Math.sqrt,I=Math.abs,M=Math.ceil,E="undefined",F="string",D=isNaN,N=parseFloat,V=Number.MAX_VALUE,O="#969696",H="#CB0000",P="#646464",L="#DCDCDC",k="white",B="black",W="blue",z="green",U="red",Y="left",G="right",X="center",j="top",K="bottom",Z="middle",J="px Arial";function q(e,t){this.x=e,this.y=t}function Q(e,t,n,r){var o=this;o.x=e,o.y=t,o.width=n,o.height=r}function $(e,t){var n,r,o,i=e[0],a=i&&i.value?i.value:i;for(r=1,o=e.length;r<o;r++)i=e[r],n=i&&i.value?i.value:i,(t&&a>n||!t&&a<n)&&(a=n);return a}function ee(e,t,n,r,o,i,a){i&&(e.strokeStyle=i),a&&(e.lineWidth=a),e.beginPath(),e.moveTo(t,n),e.lineTo(r,o),e.stroke()}function te(e,t,n,r,o,i,a,l,s,u,c,_){t?ee(e,n,r,o,i,c,_):ee(e,a,l,s,u,c,_)}function ne(e){return c._getBrightness(c._fromString(e))<127.5?k:B}function re(e,t,n,r,o,i,a){var l={};return a?(l.left=t+o+i,l.width=r-2*o,l.top=e+o,l.height=n-2*o):(l.left=e+o,l.width=n-2*o,l.top=t+o,l.height=r-2*o),l}function oe(e,t){var n,r,o=0;for(n=0,r=e.length;n<r;n++)o+=t&&!t(e[n])?0:e[n];return o}function ie(e,t,n,r){var o,i,a,l,s=[];for(i=0,a=0,l=e.length;i<l;i++)t?t(e[i])?s[a++]=n?n(e[i]):e[i]:s[a++]=0:(o=N(e[i]),!D(o)&&isFinite(o)&&(s[a++]=o));return r&&r(s),s}function ae(e,t,n,r,o,i){var a=T(t+r),l=T(n+o);t=T(t),n=T(n),r=T(a-t),o=T(l-n),e.beginPath(),e.fillStyle=i,e.fillRect(t,n,r,o),e.fill()}function le(e,t,n){return e=x(e,t),e=b(e,n)}function se(e,t,n,r,o){e.save(),e.rect(t,n,r,o),e.clip()}function ue(e,t,n,r,o,i){var a,l,s,c,_,f,d=n+o/2,h=r+i/2,g=5,p=x(o,i)/2-g,m=-.5*w,v=d+p*S(m),C=h+p*y(m),b=[],T=[];if(!(p<=0)){for(l=ie(t.values,function(e){return!u(e)&&!D(e)&&isFinite(e)},function(e){return I(e)},function(e){1===e.length&&(e[1]=1-e[0])}),s=l.length,c=ce(s,t.colors),_=oe(l),e.save(),f=0;f<s;f++)a=m+l[f]/_*2*w,e.beginPath(),e.moveTo(d,h),e.lineTo(v,C),e.arc(d,h,p,m,a,!1),e.lineTo(d,h),e.fillStyle=c[f],e.fill(),b.push(v),T.push(C),m=a,v=d+p*S(m),C=h+p*y(m);for(f=0;f<s;f++)ee(e,d,h,b[f],T[f],k);e.restore()}}function ce(e,t){var n,r,o,i,a,l,s=[],u=t.length;if(e<=u)s=t.slice(0,e);else{for(0===u?(s.push("darkgray"),u=1):s=t.slice(0),n=[],o=e-u+1,i=0;i<u;i++)n[i]=f(s[i]);for(i=u;i<e;i++){r=n[i%u];for(a in r)r.hasOwnProperty(a)&&(l=r[a],r[a]=C(l-l/o*(i/u)));r.a=255,s[i]=c._toString(r)}}return s}function _e(e,t,n){this.x=e,this.y=t,this.value=n}function fe(e,t,n,r,o,i){var a,l,s,c,_,f,d,h,g,p,v,C,w,y,S,R,A,I,M,F,N,V,O,P,L,k,B,z,U,Y,G,X;for(e.save(),a=t.points,l=t.mini,s=t.maxi,c=t.line1,_=t.line2,f=t.colorPositive,d=t.colorNegative,h=5,a=ie(a,function(e){return!u(e)&&!D(e)&&isFinite(e)}),f=u(f)?"#787878":f,d=u(d)?H:d,M=$(a,!1),s=u(s)?M:s,p=b(s,M),F=$(a,!0),l=u(l)?F:l,g=x(l,F),g=g>0?0:g,p=p<0?0:p,v=0,v=v>p?p:v,v=v<g?g-1:v,C=a.length,N=re(n,r,o,i,h),w=N.left,y=N.top,S=N.width,R=N.height,A=S/(C-1),I=(p-g)/R,V=[],B=y+(p-v)/I,Y=0;Y<C;Y++)O=a[Y],z=w+A*Y,U=y+(p-O)/I,0===Y&&V.push(new _e(z,B,v)),Y>0&&O*a[Y-1]<0&&(L=V[V.length-1])&&(k=de(L.x,L.y,z,U,B),V.push(new _e(k,B,v))),V.push(new _e(z,U,O)),Y===C-1&&V.push(new _e(z,B,v));for(e.beginPath(),G=0,X=V.length;G<X;G++)(P=V[G])&&(0===G?e.moveTo(P.x,P.y):e.lineTo(P.x,P.y),L=V[G-1],P.value===v&&L&&(e.fillStyle=L.value>v?f:d,e.fill(),G!==X-1&&(e.beginPath(),e.moveTo(P.x,P.y))));j(c),j(_),e.restore();function j(t){var n,r,o;t===m&&typeof t!==E||(n=le(t,p,g),r=0!==I?(p-n)/I:R/2,o=T(y+r)-.5,ee(e,w,o,w+S,o,W))}}function de(e,t,n,r,o){return((t-o)*n+(o-r)*e)/(t-r)}function he(e,t,n,r,o,i){var a,l,s,c,_,f,d,h,g,p,m,v,C,y,S,R,A,I,M,E,F,D,N,P,k,B,W=t.points1,z=t.points2,U=t.minX,Y=t.maxX,G=t.minY,X=t.maxY,j=t.hLine,K=t.vLine,Z=t.xMinZone,J=t.xMaxZone,q=t.yMinZone,Q=t.yMaxZone,$=t.tags,ee=t.drawSymbol,te=t.drawLines,ne=t.color1,oe=t.color2,ie=t.dash,le=4,ue=re(n,r,o,i,5),ce=ue.left,_e=ue.top,fe=ue.width,de=ue.height;function he(t,n,r,o){h=t[n],p=h.x,m=h.y,h=t[n+1],v=h.x,C=h.y,y=ce+(p-_)*fe/(f-_),R=ce+(v-_)*fe/(f-_),S=_e+(c-m)*de/(c-s),A=_e+(c-C)*de/(c-s),te&&me(e,y,S,R,A,r,ie),ee&&(0===n&&o(y,S),o(R,A))}function pe(e,t,n,r,o){var i=ge(e,!0),a=ge(e,!1);s=u(G)?i.y:t,c=u(X)?a.y:n,_=u(U)?i.x:r,f=u(Y)?a.x:o,f=_>=f?_+1:f,c=s>=c?s+1:c}function Ce(t,n,r){e.beginPath(),e.arc(t-le/2,n-le/2,le/2,0,2*w,!1),e.fillStyle=r,e.fill()}function we(t,n){e.beginPath(),e.strokeStyle=ne,e.arc(t-le/2,n-le/2,le/2,0,2*w,!1),e.stroke()}function ye(t,n){e.beginPath(),e.strokeStyle=oe,e.strokeRect(t-le/2,n-le/2,le,le)}if(W&&!(W.length<=0)&&(a=ve(W),!(a.length<=0||z&&z.length>0&&(l=ve(z),l.length<=0)))){for(se(e,n,r,o,i),e.beginPath(),ee=!!u(ee)||ee,ne=u(ne)?O:ne,oe=u(oe)?H:oe,pe(a,G,X,U,Y),!u(Z)&&!u(J)&&!u(q)&&!u(Q)&&_<=Z&&Z<=f&&_<=J&&J<=f&&s<=q&&q<=c&&s<=Q&&Q<=c&&(N=b(_,Z),P=x(f,J),k=b(s,q),B=x(c,Q),N>=P&&(P=N+1),k>=B&&(B=k+1),ae(e,ce+(N-_)*fe/(f-_),_e+(c-B)*de/(c-s),(P-N)*fe/(f-_),(B-k)*de/(c-s),L)),I=-V,M=-V,E=V,F=V,d=0,g=a.length;d<g-1;d++)he(a,d,ne,we),$&&(0===d&&(S>M&&(I=y,M=S),S<F&&(E=y,F=S)),A>M&&(I=R,M=A),A<F&&(E=R,F=A));if(l&&l.length>0)for(pe(l,s,c,_,f),d=0,g=l.length;d<g-1;d++)he(l,d,oe,ye);$&&(Ce(I,M,H),Ce(E,F,"#0000FF")),!u(j)&&s<=j&&j<=c&&(D=T(_e+(c-j)*de/(c-s))-.5,me(e,ce,D,ce+fe,D,H)),!u(K)&&_<=K&&K<=f&&(D=T(ce+(K-_)*fe/(f-_))-.5,me(e,D,_e,D,_e+de,H)),e.restore()}}function ge(e,t){var n,r,o=t?1:-1,i=t?x:b,a=new q(o*V,o*V),l=e.length;for(r=0;r<l;r++)n=e[r],a.x=i(a.x,n.x),a.y=i(a.y,n.y);return a}function pe(e,t,n,r){return n/r*(t-e)+e}function me(e,t,n,r,o,i,a){var l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x;if(a){for(l=A(R(r-t,2)+R(o-n,2)),s=0,u=6,c=2,_=4,f=[],t<=r?(d=t,h=r,g=t,p=n):(d=r,h=t,g=r,p=o),m=(o-n)/(r-t),v=n-m*t,f.push(new q(g,p)),C=[u,_,c,_];s<l;)for(w=0,y=C.length;w<y;w++)(s+=C[w])<=l&&(g=pe(d,h,s,l),p=m*g+v,f.push(new q(g,p)));for(S=0,x=f.length;S<x-1;S+=2)ee(e,f[S].x,f[S].y,f[S+1].x,f[S+1].y,i)}else ee(e,t,n,r,o,i)}function ve(e){var t,n,r,o=[],i=e.length;if(i>0)if(t=e[0].length,i<t){if(i>=2)for(n=0;n<t;n++)o.push(new q(e[0][n],e[1][n]))}else if(t>=2)for(r=0;r<i;r++)o.push(new q(e[r][0],e[r][1]));return o}function Ce(e,t,n,r,o,i){var a,l,s,c,f,d,h,g,p,m,v=t.measure,w=t.target,y=t.maxi,S=t.good,x=t.bad,b=t.forecast,R=t.tickUnit,A=t.colorScheme,I=t.vertical,M=5;function E(t,a,l,u,_){var f,d,h;e.fillStyle=t,f=s,d=c*(a/l),d>c&&(d=c),h=I?new Q(n+o*u,f-d,o*_,d):new Q(f,r+i*u,d,i*_),e.fillRect(h.x,h.y,h.width,h.height)}if(!(u(y)||y<0)){if(v=u(v)||v<0?0:v,S=u(S)||S<0?0:S,x=u(x)||x<0?0:x,w=u(w)?0:w,b=u(b)?0:b,R=u(R)?0:R,A=u(A)?"#A0A0A0":A,a="#252525",v>y&&(v=y,a=H),S>y&&(S=y,a=H),x>y&&(x=y,a=H),w>y&&(w=0,a=H),b>y&&(b=y,a=H),l=re(n,r,o,i,M,i-2*M,I),s=l.left,c=l.width,e.save(),E(_(A,1.66),1,1,.2,.6),E(_(A,1.33),S,y,.2,.6),E(A,x,y,.2,.6),E(a,v,y,.375,.25),b>0&&(f=s,d=c*(b/y),d>c&&(d=c),te(e,I,n+.5*o,f,n+.5*o,f-d,f,r+.5*i,f+d,r+.5*i,"#3690BF",3)),w>0&&(h=T(s-(I?1:-1)*c*(w/y))-.5,te(e,I,n+.2*o,h,n+.8*o,h,h,r+.2*i,h,r+.8*i,H,1)),R>0)for(g=C(y/R),m=0;m<=g;m++)p=T(s-c/y*R*(I?1:-1)*m)-.5,te(e,I,n,p,n+.05*o,p,p,r+i,p,r+.95*i,P,1);e.restore()}}function we(e,t,n,r,o,i){var a,l,s,c,_,f,d,h,g,p,m,v,C,w,y,S,R,A,I,M,E,F,D=t.spreadData,N=t.showAverage,V=t.scaleStart,O=t.scaleEnd,L=t.style,k=t.colorScheme,B=t.vertical,W=5,z=D.length;if(!(z<=0)){for(a=D[0].key,l=D[z-1].key,V=u(V)?a:V,O=u(O)?l:O,L=u(L)?4:L,
k=u(k)?P:k,s=re(n,r,o,i,W,i-2*W,B),c=s.left,_=s.width,f=s.top,d=s.height,se(e,n,r,o,i),e.beginPath(),e.strokeStyle=k,e.fillStyle=k,e.lineWidth=2,p=$(D,!1),v=0,C=D.length;v<C;v++)if(w=D[v],y=w.key,S=w.value,h=c+(B?-1:1)*_*(y-V)/(O-V),B?(h=x(h,c),h=b(h,c-_)):(h=b(h,c),h=x(h,c+_)),h=T(h),1===L)m=S/2*d/p,m=m<.5?.5:m,R=f+d/2-m,A=f+d/2+m,te(e,B,R,h,A,h,h,R,h,A);else if(4===L)m=S*d/p,m=m<1?1:m,te(e,B,f,h,f+m,h,h,f+d,h,f+d-m);else if(6===L)te(e,B,f,h,f+d,h,h,f,h,f+d);else for(I=2,M=1;M<=S;M++){switch(L){case 2:g=f+d/2-W-(S/2-M)*d/p;break;case 3:E=ye(S,d,I+1,w.randomNumbers),g=f+d-W-E[M-1];break;case 5:default:g=f+d-M*d/p}g=T(g),e.beginPath(),e.fillRect(B?g:h,B?h:g,I,I)}N&&(F=Se(D),h=c-(B?1:-1)*_*(F-V)/(O-V),te(e,B,f-W,h,f+d+W,h,h,f-W,h,f+d+W,H)),e.restore()}}function ye(e,t,n,r){for(var o,i=[],a=b(100,10*e),l=0,s=[],u=0;i.length<e;)o=C(r[u++]*t),(l>a||xe(o,s))&&(i.push(o),s.push([o-n,o+n])),l++;return i}function Se(e){var t,n,r,o=0,i=0;for(t=0,n=e.length;t<n;t++)r=e[t],i+=r.value,o+=r.key*r.value;return 0===i?0:o/i}function xe(e,t){var n,r,o;for(n=0,r=t.length;n<r;n++)if(o=t[n],o[0]<=e&&e<=o[1])return!1;return!0}function be(e,t,n,r,o,i,a){var l,s,c,f,d,h,g,p,C,w,y,S,x,b,R,A,I,M,E,F=t.points,N=t.colorRange,V=t.labelRange,O=t.maximum,L=t.targetRed,k=t.targetGreen,B=t.targetBlue,Y=t.targetYellow,G=t.color,j=t.highlightPosition,K=t.vertical,q=t.textOrientation,Q=t.textSize,$=5;function te(t,n,r){var o,i;n!==m&&n!==v&&(n=n>O?O:n,r&&!r(n)||(n=n<0?0:n,i=n/O*h,K?(o=T(d-i)-.5,ee(e,g,o,g+p,o,t)):(o=T(d+i)-.5,ee(e,o,g,o,g+p,t))))}if(!(u(F)||(l=F.length)<=0)){if(G=u(G)?P:G,u(N)||N.length!==l||Te(N))for(N=[],s=0;s<l;s++)N.push(_(G,1+s/l));for(c=oe(F,function(e){return e>0}),O=u(O)||O<c?c:O,q=u(q)?0:q,Q=u(Q)||Q<=0?10:Q,Q=D(Q)?Q:Q*a.zoomFactor,f=re(n,r,o,i,$,i-2*$,K),d=f.left,h=f.width,g=f.top,p=f.height,e.save(),C=d,A=0,I=l;A<I;A++)(R=F[A])<=0||(w=R/O*h,K?(y=n+.15*o,x=.7*o,S=C-w,b=w):(y=C,x=w,S=r+.15*i,b=.7*i),M=A+1===j?H:N[A],e.save(),e.fillStyle=M,e.fillRect(y,S,x,b),E=V&&V[A],E&&(e.save(),e.fillStyle=ne(M),e.textBaseline=Z,e.textAlign=X,e.font=Q+J,e.rect(y,S,x,b),e.clip(),1===q?(e.translate(y+x/2,S),e.rotate(Math.PI/2),e.fillText(E,b/2,0)):e.fillText(E,y+x/2,S+b/2),e.restore()),C+=(K?-1:1)*w,e.restore());te(U,L,function(e){return e>0}),te(z,k),te(W,B),te("yellow",Y),e.restore()}}function Te(e){for(var t=0,n=e.length;t<n;t++)if(u(e[t]))return!0;return!1}function Re(e,t,n,r,o,i){ee(e,Me(t),Me(n),Me(r),Me(o),u(i)?B:i,1)}function Ae(e,t,n,r,o){var i,a,l,s,u,c=.4*r;switch(t=Me(t),n=Me(n),e.beginPath(),e.moveTo(t,n),i=c/2,a=A(3)*c/2,l=c/A(3),o){case 0:s=[-i,0,i],u=[a,l,a];break;case 2:s=[-i,0,i],u=[-a,-l,-a];break;case 3:s=[a,l,a],u=[-i,0,i];break;case 1:s=[-a,-l,-a],u=[-i,0,i];break;default:s=[],u=[]}s.forEach(function(r,o){e.lineTo(Me(t+r),Me(n+u[o]))}),e.lineTo(t,n),e.closePath(),e.fillStyle=k,e.fill()}function Ie(e,t,n,r,o,i,a){var l,s,c,_,f,d,h,g,p,m,v,C,w=n.value,y=n.colorScheme,S=5,x=5,b=.7,T=!1;w=N(w),D(w)||(w>1?(w=1,T=!0):w<-1&&(w=-1,T=!0),y=u(y)?"grey":y,t.save(),0===e?(h=i-2*S,g=a*b,w>=0?(T&&(l=new q(r+S+h-x,o+a/2)),s=new Q(r+S,o+a*(1-b)/2,h*w,g),c=new q(r+S,o+1),_=new q(r+S,o+a),f=1):(p=I(h*w),T&&(l=new q(r+S+x,o+a/2)),s=new Q(r+i-S-p,o+a*(1-b)/2,p,g),c=new q(r+i-S,o+1),_=new q(r+i-S,o+a),f=3),d=a):1===e&&(m=a-2*S,v=i*b,w>=0?(C=m*w,s=new Q(r+(1-b)/2*i,o+a-S-C,v,C),T&&(l=new q(r+i/2,o+a-S-C+x),f=0),c=new q(r+1,o+a-S),_=new q(r+i,o+a-S)):(w=I(w),s=new Q(r+(1-b)/2*i,o+S,v,m*w),T&&(l=new q(r+i/2,o+S+m-x),f=2),c=new q(r+1,o+S),_=new q(r+i,o+S)),d=i),t.beginPath(),s&&(ae(t,s.x,s.y,s.width,s.height,y),se(t,s.x,s.y,s.width,s.height)),l&&Ae(t,l.x,l.y,d,f),t.restore(),c&&Re(t,c.x,c.y,_.x,_.y),t.restore())}function Me(e){return T(e)-.5}function Ee(e,t,n,r,o,i){Ie(0,e,t,n,r,o,i)}function Fe(e,t,n,r,o,i){Ie(1,e,t,n,r,o,i)}function De(e,t,n,r,o,i,a){var l,s,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,M,E,F=t.variance,V=t.reference,P=t.mini,L=t.maxi,k=t.mark,W=t.tickUnit,q=t.legend,Q=t.colorPositive,$=t.colorNegative,ee=t.vertical,te=.5,re=.5-te/2,oe=5,ie=H,ue=O,ce=13*a.zoomFactor;F=N(F);function _e(t,a,s,u,c,_,h,p,m,v,C,w,x,b){var T,R,I,M,E,F;ee?(T=n+re*o,R=0===a?y-S:y,I=o*te,M=S,ae(e,T,R,I,M,t)):(T=0===a?y:y-S,R=r+re*i,I=S,M=i*te,ae(e,T,R,I,M,t)),g&&(se(e,T,R,I,M),ee?Ae(e,n+o/2,l+s,d,c):Ae(e,l+u,r+i/2,d,_),e.restore()),q&&(F=0,g&&(F=.4*d*A(3)/2+oe+2),e.save(),e.beginPath(),e.font=ce+J,e.fillStyle=B,ee?(e.textAlign=X,E=ce+S+h,fe(E,b,t,p,m,T,R,I,M,ee),e.fillText(f,n+o/2,y+x*(S-F))):(e.textBaseline=Z,E=e.measureText(f).width+S+v,fe(E,b,t,C,w,T,R,I,M,ee),e.fillText(f,y+x*(F-S),r+i/2)),e.restore())}function fe(t,n,r,o,i,a,l,s,u,c){c?e.textBaseline=o:e.textAlign=o,t>0&&n<S&&(e.rect(a,l,s,u),e.clip(),c?e.textBaseline=i:e.textAlign=i,e.fillStyle=ne(r))}function de(t,n,r,o,i,a,l,s,u,c){ee?Re(e,t,n,r,o,u):Re(e,i,a,l,s,c)}if(!(D(F)||($=u($)?U:$,Q=u(Q)?z:Q,W=u(W)?0:W,L=u(L)?1:L,P=u(P)?-1:P,h=!u(V),h||(V=0),ee?(l=r+i-oe,s=i-2*oe,c=o-4*oe,_=-1):(l=n+oe,s=o-2*oe,c=i-4*oe,_=1),q&&(p=N(t.variance),D(p)||(m=""+p,v=m.substr(m.indexOf(".")+1).length,f=v>=2?(100*p).toFixed(v-2)+"%":(100*p).toFixed(0)+"%")),F>L&&(F=L,g=!0),F<P&&(F=P,g=!0),V=le(V,L,P),g&&(d=le(c,60,15)),C=I(L-P),w=s/C,y=l+_*I(P-V)*w,S=I(F-V)*w,S>I(C)*w&&(S=I(C+P)*w),x=l+_*s,ee&&y<x||!ee&&y>x))){if(se(e,n,r,o,i),F>V?_e(Q,0,oe-s,s-oe,0,1,r-y,K,j,y-n-o,Y,G,-1,I(L-F)*w):(S>I(C)*w&&(S=I(C+P)*w,y=l),_e($,1,-oe,oe,2,3,y-r-i,j,K,n-y,G,Y,1,I(P-F)*w)),h&&(b=l+_*(Math.abs(P-V)*w),de(n,b,n+o,b,b,r,b,r+i)),W>0)for(e.beginPath(),T=C/W,R=0;R<=T;R++)M=l+s/T*R*_,de(n,M,n+.1*o,M,M,r+.9*i,M,r+i,ue,ue);!u(k)&&P<=k&&k<=L&&(e.beginPath(),E=l-(ee?1:-1)*I(P-k)*w,de(n,E,n+.33*o,E,E,r+.66*i,E,r+i,ie,ie),e.fill()),e.restore()}}t="7ns",r="5ns",o="tukey",i="bowley",a="sigma3";function Ne(e,n,l,s,c,_){var f,d,h,g,p,v,C,w,y,S,T,R,A,M,E,V,L,k,B,W,z,U,Y,G,X,j,K,Z,J,q,Q,ee,ne,le,ue,ce,_e,fe,de,he,ge,pe,me,ve,Ce,we,ye,Se,xe,be,Te,Re=n.points,Ae=n.boxPlotClass,Ie=n.showAverage,Me=n.scaleStart,Ee=n.scaleEnd,Fe=n.acceptableStart,De=n.acceptableEnd,Ne=n.style,Ve=n.colorScheme,Oe=n.vertical,He=5,Pe=$(Re,!1),Le=$(Re,!0);function ke(t,n,r,o,i,a,l,s,u){Oe?ae(e,n,r,o,i,t):ae(e,a,l,s,u,t)}function Be(t,n,r,o){te(e,Oe,X+j*t,r,X+j*n,r,r,X+j*t,r,X+j*n,o)}if(!(u(Re)||(Re=ie(Re),Re.length<=0))){for(Ae=Ae===m||typeof Ae!==F?r:Ae.toLocaleLowerCase(),Ae!==r&&Ae!==t&&Ae!==o&&Ae!==i&&Ae!==a&&(Ae=r),Me=N(Me),Me=D(Me)?Le:Me,Ee=N(Ee),Ee=D(Ee)?Pe:Ee,Fe=N(Fe),De=N(De),Ve!==m&&typeof Ve===F||(Ve="#D2D2D2"),(Ne===m||0!==Ne&&1!==Ne)&&(Ne=0),f=H,Me>Le&&(Ve=f,Me=Le),Ee<Pe&&(Ve=f,Ee=Pe),se(e,l,s,c,_),e.lineWidth=2,d=re(l,s,c,_,He,_-2*He,Oe),h=d.left,g=d.width,p=d.top,v=d.height,C=Oe?-1:1,w=n.perc02,y=n.perc09,S=n.perc10,T=n.perc90,R=n.perc91,A=n.perc98,M=n.q1,E=n.q3,V=E-M,L=Le,k=Pe,B=1.5*V,W=1.5*V,z=n.stDev,U=oe(Re)/b(1,Re.length),Y=0,G=0,X=p+.1*v,j=.7*v,K=I(Ee-Me),Z=0,J=Re.length;Z<J;Z++)q=Re[Z],q<M&&q>=M-1.5*V&&q-(M-1.5*V)<B&&(B=q-(M-1.5*V),L=q),q>E&&q<=E+1.5*V&&E+1.5*V-q<W&&(W=E+1.5*V-q,k=q),Q=!1,Y=h+C*(g*((q-Me)/K)),Ae===o&&(q<=M-1.5*V||q>=E+1.5*V)&&(Q=!0,G=q<=M-3*V||q>=E+3*V?0:1),Ae===t&&(q<=w||q>=A)&&(Q=!0,G=1),Ae===a&&(q<=U-2*z||q>=U+2*z)&&(Q=!0,G=q<=U-3*z||q>=U+3*z?0:1),ee=O,Q&&(1===Ne?1===G?Be(.2,.8,Y,ee):Be(.3,.7,Y,ee):(ne=.1*v,ne<2&&(ne=2),e.beginPath(),e.strokeStyle=ee,le=p+.45*v,ue=Y,e.arc(Oe?le:ue,Oe?ue:le,ne/2,0,2*Math.PI),e.stroke()));switch((Me>Fe||Ee<De)&&(Ve="#C0FF00"),Fe=b(Me,Fe),De=x(Ee,De),Fe>De?Ve=f:Fe<De&&(ce=h+C*(g*((Fe-Me)/K)),_e=h+C*(g*((De-Me)/K)),fe=p+.9*v,te(e,Oe,fe,ce,fe,_e,ce,fe,_e,fe,P)),de=h+C*(g*((M-Me)/K)),he=I(h+C*(g*((E-Me)/K))-de),ge=n.median,pe=h+C*(g*((ge-Me)/K)),Ae){case t:Ce=w,we=A;break;case o:Ce=L,we=k;break;case a:de=h+C*(g*((U-z-Me)/K)),he=I(h+C*(g*((U+z-Me)/K))-de),pe=h+C*(g*((U-Me)/K)),ye=U-2*z,Ce=ye>Me?ye:Le,ye=U+2*z,we=ye<Ee?ye:Pe,Ie=!1;break;case r:case i:default:Ce=Le,we=Pe}me=h+C*(g*((Ce-Me)/K)),ve=h+C*(g*((we-Me)/K)),Se=O,1===Ne?ke("#F2F2F2",X,ve,j,me-ve,me,X,ve-me,j):(xe=p+.45*v,te(e,Oe,xe,me,xe,ve,me,xe,ve,xe,Se)),ke(Ve,X,de-he,j,he,de,X,he,j),te(e,Oe,X,pe,X+j,pe,pe,X,pe,X+j,Se),0===Ne&&(te(e,Oe,X+.3*j,ve,X+.7*j,ve,ve,X+.3*j,ve,X+.7*j,Se),te(e,Oe,X+.3*j,me,X+.7*j,me,me,X+.3*j,me,X+.7*j,Se)),Ae!==t&&Ae!==i||(Ae===t?(Ce=y,we=R):(Ce=S,we=T),be=h+C*(g*((Ce-Me)/K)),Te=h+C*(g*((we-Me)/K)),Be(.3,.7,Te,Se),Be(.3,.7,be,Se)),Ie&&(Y=h+C*(g*((U-Me)/K)),Be(.2,.8,Y,f)),e.restore()}}function Ve(e,t,n,r,o){t=T(t),n=T(n),r=T(r),o=T(o),t===r&&(r-=.5,t=r),n===o&&(o-=.5,n=o),e.moveTo(t,n),e.lineTo(r,o)}function Oe(e,t,n,r,o,i,a,l,s,u,c){e.beginPath(),e.strokeStyle=n,t?Ve(e,r,o,i,a):Ve(e,l,s,u,c),e.stroke()}function He(e,t,n,r,o){e.rect(t,n,r,o),e.clip()}function Pe(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,h=i.labelText,g=i.fontSize,p=i.startBox,m=i.endBox,v=i.boxColor,C=i.isInRightOrTopOfBox;e.save(),e.beginPath(),e.font=g+J,u=1,f=B,i.vertical?(c=X,C?(a=g+m-(p-n),a>0&&p-m-n<m?(_=j,f=ne(v),s=p-m+u,He(e,t,p-m,r,m)):(_=K,s=p-m-u)):(a=g-(n+o-p),a>0&&n+o-p<m?(He(e,t,p-m,r,m),_=K,f=ne(v),s=p-u):(_=j,s=p+u)),e.textAlign=c,e.textBaseline=_,e.fillStyle=f,e.fillText(h,t+r/2,s)):(_=Z,d=e.measureText(h),C?(a=d.width+m-(t+r-p),a>0&&t+r-(p+m)<m?(He(e,p,n,m,o),c=G,f=ne(v),l=p+m-u):(c=Y,l=p+m+u)):(a=d.width-(p-t),a>0&&p-t<m?(He(e,p,n,m,o),l=p+u,c=Y,f=ne(v)):(c=G,l=p-u)),e.textAlign=c,e.textBaseline=_,e.fillStyle=f,e.fillText(h,l,n+o/2)),e.restore()}function Le(e,t,n,r,o,i,a){var l,s,c,f,d,h,g,p,v,C,w,y,S,T,R,A,M,E,V,O,H,P,k,W,z,U,Y,G,X,j,K,Z,J,q,Q=t.points,$=t.labels,ee=t.pointIndex,te=t.minimum,ne=t.maximum,oe=t.colorPositive,ie=t.colorNegative,le=t.vertical,ue=5,ce=13*a.zoomFactor;if(!u(Q)&&!((l=Q.length)<=0||(ee=parseInt(ee),D(ee)||ee<=0||ee>l))){for($=u($)?[]:$,oe!==m&&typeof oe===F||(oe="#8CBF64"),ie!==m&&typeof ie===F||(ie="#D6604D"),s=oe,c=_(oe,1.3),f=ie,d=_(ie,1.3),h=1,g=0,p=0,v=0,C=0,w=[],y=0,S=0,T=Q.length;S<T;S++)R=Q[S],w[h]=[],A=w[h],D(R)?(A[0]=0,A[1]=g,A[2]=0):(A[0]=I(R),g=R+g,A[1]=R>0?p:g,A[2]=R),A[3]=h,v=x(p,v),C=b(p,C),h===l&&(y=v<0?-v:0,A[1]=R>0?0:R),p=R+p,h++;g-=R,te=N(te),D(te)||te>0||te>v?(M=v,te=v):(M=te,y=-te),ne=N(ne),D(ne)||ne<0||ne<C?E=C:(E=ne,y=-te),V=re(n,r,o,i,ue,i-2*ue,le),O=V.left,H=V.width,P=V.top,k=V.height,W=le?-1:1,z=E-M,U=H/z,se(e,n,r,o,i),e.beginPath(),e.lineWidth=1,Y=w[ee],G=Y[2],X=O+W*(Y[1]+y)*U,j=Y[0]*U,K=1===ee||ee===l?G>=0?s:f:G>=0?c:d,le?ae(e,P,X-j,k,j,K):ae(e,X,P,j,k,K),le?(1!==ee&&(ee!==l?Oe(e,G>0,L,n,X,P+k,X,n,X-j,P+k,X-j):(Z=O-(g+y)*U,Oe(e,!0,L,n,Z,P+k,Z))),ee!==l&&Oe(e,G>0,L,P,X-j,n+o,X-j,P,X,n+o,X)):(1!==ee&&(ee!==l?Oe(e,G>0,L,X,r,X,P+k,X+j,r,X+j,P+k):(J=O+(g+y)*U,Oe(e,!0,L,J,r,J,P+k))),ee!==l&&Oe(e,G>0,L,X+j,P,X+j,r+i,X,P,X,r+i)),q=$[ee-1],$.length>0&&!u(q)&&""!==q&&Pe(e,n,r,o,i,{labelText:q,vertical:le,isInRightOrTopOfBox:G>0,fontSize:ce,startBox:X,endBox:j,boxColor:K}),Oe(e,le,B,n,O-y*U,n+o,O-y*U,O+y*U,r,O+y*U,r+i),e.restore()}}function ke(e,t,n,r,o,i,a){var l,s,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,R,A,I,E,V,P,L=t.points,k=t.pointIndex,B=t.colorRange,W=t.target,z=t.target2,U=t.highlightPosition,Y=t.label,G=t.vertical,X=5,j=13*a.zoomFactor;function K(e){return e=N(e),e=D(e)?0:e,e=e<0?0:e,e=e>1?1:e}if(!u(L)&&!((l=L.length)<=0||(k=parseInt(k),D(k)||k<=0||k>l))){for(B=u(B)?[]:B,W=K(W),z=K(z),Y=parseInt(Y),Y=D(Y)?0:Y,s=1,c=0,_=[],f=0,d=L.length;f<d;f++)h=L[f],_[s]=[],g=_[s],h<0||D(h)||u(h)?(g[0]=1===s?0:c,g[1]=0):(c+=h,g[0]=1===s?0:c-h,g[1]=h),s++;p=re(n,r,o,i,X,i-2*X,G),m=p.left,v=p.width,C=p.top,w=p.height,y=G?-1:1,S=v/c,se(e,n,r,o,i),e.beginPath(),e.lineWidth=1,x=_[k],b=x[1],R=m+y*x[0]*S,A=x[1]*S,I=k===U?H:0===B.length||typeof B[k-1]!==F?O:B[k-1],G?ae(e,C,R-A,w,A,I):ae(e,R,C,A,w,I),1===Y?E=(x[0]+b)/c*1e3:2===Y&&(E=b/c*1e3),V=T(E)/10+"%",1!==Y&&2!==Y||""===V||Pe(e,n,r,o,i,{labelText:V,vertical:G,isInRightOrTopOfBox:(x[0]+x[1])*S<v/2,fontSize:j,startBox:R,endBox:A,boxColor:I}),P=["#8CBF64","#EE5D5D"],[W,z].forEach(function(t,a){var l=M(m+y*v*t);Oe(e,G,P[a],n,l,n+o,l,l,r,l,r+i)}),e.restore()}}function Be(e,t){switch(t){case 2:return e%4==0&&e%100!=0||e%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function We(e,t,n){var r,o,i,a,l,s;return e<0&&(e=0),e>1&&(e=1),r=f(t),o=f(n),i=r.a*(1-e)+o.a*e,a=r.r*(1-e)+o.r*e,l=r.g*(1-e)+o.g*e,s=r.b*(1-e)+o.b*e,"rgba("+parseInt(a,10)+","+parseInt(l,10)+","+parseInt(s,10)+","+N(i/255)+")"}function ze(e,t,n){return e===t&&e===n?1:e<=t?0:e>=n?1:(e-t)/(n-t)}function Ue(e,t,n,r,o,i){var a=(i+o)/2;return o<=r&&r<=a?We(ze(r,o,a),e,t):We(ze(r,a,i),t,n)}function Ye(e){var t=V,n=-V;return e.forEach(function(e){e!==m&&e!==v&&(t>e&&(t=e),n<e&&(n=e))}),{min:t,max:n}}function Ge(e,t,n,r,o,i,a){var l,s,u;r?e.forEach(function(e,o){0!==e&&e!==m&&e!==v&&(t[n+o]=r[o]||t[n+o])}):(l=Ye(e),s=l.min,u=l.max,e.forEach(function(e,r){0!==e&&e!==m&&e!==v&&(t[n+r]=Ue(o,i,a,e,s,u))}))}function Xe(e,t,n,r,o,i){var a,l,s,u,c=t.year,_=t.month,f=t.values,d=t.emptyColor||"lightgray",h=t.startColor,g=t.middleColor,p=t.endColor,m="white",v=6,C=7,w=2,y=(o-(v+1)*w)/v,S=(i-(C+1)*w)/C,x=[],b=new Date(c,_-1,1).getDay();for(a=0;a<v*C;a++)a<b?x[a]=m:a<b+Be(c,_)?x[a]=d:x[a]=m;for(Ge(f,x,b,t.colors,h,g,p),e.save(),e.rect(n,r,o,i),e.clip(),e.beginPath(),l=0,s=0;s<v;s++)for(u=0;u<C;u++)e.fillStyle=x[l++],e.fillRect(n+s*y+(s+1)*w,r+u*S+(u+1)*w,y,S);e.restore()}function je(e){var t,n=e.getFullYear(),r=e.getMonth(),o=e.getDate();for(t=1;t<r+1;t++)o+=Be(n,t);return o}function Ke(e,t,n,r,o,i,a){var l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F=t.year,D=t.values,N=t.emptyColor||"lightgray",V=t.startColor,O=t.middleColor,H=t.endColor,P="white",L=7,k=parseInt(366/L)+2,B=[],W=new Date(F,0,1).getDay(),z=je(new Date(F,11,31));for(l=0;l<k*L;l++)B[l]=l<W?P:l<W+z?N:P;for(Ge(D,B,W,t.colors,V,O,H),e.save(),e.rect(n,r,o,i),e.clip(),s=a.zoomFactor,u=15*s,c=n+u,_=r,f=o-u,d=i,e.save(),e.translate(n+u/2,_+d),e.rotate(-Math.PI/2),e.font=13*s+J,e.fillStyle="black",e.textBaseline="middle",e.textAlign="center",e.fillText(F,d/2,0),e.restore(),h=2,g=(f-(k+1)*h)/k,p=(d-(L+1)*h)/L,m=0,y=[],C=0;C<k;C++)for(v=0;v<L;v++)w={x:c+C*g+(C+1)*h,y:_+v*p+(v+1)*h,w:g,h:p},y[m]=w,e.fillStyle=B[m++],e.fillRect(w.x,w.y,w.w,w.h);for(S=[],x={},b=0;b<12;b++)x[b]=je(new Date(F,b,1))-1+W;for(T=x[11]+Be(F,12)-1,m=0,C=0;C<k;C++)for(v=0;v<L;v++)W<=m&&m<W+z&&(R=new Date(F,0,m-W+1),A=R.getMonth(),I=x[A],w=y[m],I<=m&&m<7+I&&S.push({x1:w.x,y1:w.y-h/2,x2:w.x,y2:w.y+w.h+h/2}),m!==I&&0!==R.getDay()||S.push({x1:w.x-h/2,y1:w.y,x2:w.x+w.w+h/2+(m===I?h:0),y2:w.y}),T-7<m&&m<=T&&S.push({x1:w.x+w.w,y1:w.y-h/2,x2:w.x+w.w,y2:w.y+w.h+h/2}),m!==T&&6!==R.getDay()||S.push({x1:w.x-h/2-(m===T?h:0),y1:w.y+w.h,x2:w.x+w.w+h/2,y2:w.y+w.h})),m++;for(e.strokeStyle="black",e.lineWidth=2,M=0;M<S.length;M++)E=S[M],e.beginPath(),e.moveTo(E.x1,E.y1),e.lineTo(E.x2,E.y2),e.stroke();e.restore()}l=function(){function e(){var e=this;e._minItemHeight=2,e._cachedMinDatetime=V,e._cachedMaxDatetime=-V,e._cachedMinValue=V,e._cachedMaxValue=-V}e.prototype={constructor:e,paint:function(e,t,n,r,o,i){var a,l,s,u=this;u.options=t,u.setting=t.settings,a=t.values,l=t.dateValues,s=t.zoomFactor,e.save(),e.rect(n,r,o,i),e.clip(),e.beginPath(),0===t.sparklineType&&u._paintLines(e,n,r,o,i,a,l,s),u._paintDataPoints(e,n,r,o,i,a,l,s),u._paintAxis(e,n,r,o,i,a,l,s),e.restore()},_getSpace:function(e){return 0===this.options.sparklineType?3+this._getLineWeight(e)+1:3},_getCachedIndexMaping:function(e,t){var n,r,o,i,a,l,s,u,c,_=this._cachedIndexMapping;if(_)return _;if(_=this._cachedIndexMapping=[],n=e.length,this.options.displayDateAxis){for(i=t.length,a=x(n,i),l=[],a>0&&(l=t.slice(0,a)),l.sort(function(e,t){return e===t?0:(e===p&&(e=0),t===p&&(t=0),e-t)}),s=l.length,r=0;r<s;r++)if(typeof(u=l[r])!==E&&u!==m){for(c=h(t,u);d._contains(_,c);)c=h(t,u,c+1);isNaN(u)||(o=e[c])!==v&&o!==m&&isNaN(o)&&o!==p||_.push(c)}}else for(r=0;r<n;r++)typeof(o=e[r])!==E&&o!==m&&isNaN(o)&&o!==p||_.push(r);return _},_getValue:function(e,t){var n=t[e];return typeof n===E||n===m?1===this.setting.options.displayEmptyCellsAs&&(n=0):n===p&&(n=0),n},_paintLines:function(e,t,n,r,o,i,a,l){var s,u,c,_,f,d,h,g,p,v,C,w,y,S,x,b=this,T=b._getCachedIndexMaping(i,a),R=T.length-1;for(R<0&&(R=0),_=b.setting.options,f=b.linePos=[],C=_.displayEmptyCellsAs,s=0;s<R;s++)if(typeof(d=b._getValue(T[s],i))!==E&&d!==m){if(g=s+1,typeof(h=b._getValue(T[g],i))===E||h===m)if(1===C)h=0;else if(2===C)for(g=s+2;g<=R;g++)if(typeof(w=i[T[g]])!==E&&w!==m){h=w;break}typeof h!==E&&h!==m?(p=b._getDataPointPosition(T[s],{Width:r,Height:o},i,a,l),v=b._getDataPointPosition(T[g],{Width:r,Height:o},i,a,l),y=p.Width/2,u={X:p.X+y,Y:p.Y+y},c={X:v.X+y,Y:v.Y+y},f[s]={P1:u,P2:c}):s++}if((S=f.length)>0)for(e.strokeStyle=b.options.getColor(_.seriesColor),e.lineCap="round",e.lineWidth=b._getLineWeight(l),s=0;s<S;s++)(x=f[s])&&(e.beginPath(),u=x.P1,c=x.P2,e.moveTo(t+u.X,n+u.Y),e.lineTo(t+c.X,n+c.Y),e.stroke(),e.closePath())},_getDataPointColor:function(e,t,n){var r,o,i,a=this,l=a.options,s=a.setting.options,u=m,c=a._getValue(e,t),_=a._getCachedIndexMaping(t,n),f=_.length,d=l.getColor.bind(a);return typeof c!==E&&c!==m&&(a._cachedMinValue!==V&&a._cachedMaxValue!==-V||a._getMaxMinValue(t),c===a._cachedMinValue&&s.showLow&&(u=d(s.lowMarkerColor)),c!==a._cachedMaxValue||!s.showHigh||typeof u!==E&&u!==m||(u=d(s.highMarkerColor)),typeof u!==E&&u!==m||(l.displayDateAxis?0===(r=h(_,e))&&s.showFirst&&(u=d(s.firstMarkerColor)):0===e&&s.showFirst&&(u=d(s.firstMarkerColor))),typeof u!==E&&u!==m||(l.displayDateAxis?(o=h(_,e))===f-1&&s.showLast&&(u=d(s.lastMarkerColor)):e===f-1&&s.showLast&&(u=d(s.lastMarkerColor))),c<0&&s.showNegative&&(typeof u===E||u===m)&&(u=d(s.negativeColor)),typeof u!==E&&u!==m||(i=l.sparklineType,0===i?s.showMarkers&&(u=d(s.markersColor)):1===i?u=d(s.seriesColor):2===i&&(u=d(s.seriesColor)))),u===v||u===m?"Transparent":u},_paintDataPoints:function(e,t,n,r,o,i,a,l){var s,u,c,_,f,d,h,g,p,m,v=this,y={Width:r,Height:o},S=v._getCachedIndexMaping(i,a),x=S.length,b=v.options.sparklineType;for(m=0;m<x;m++)s=S[m],u=v._getDataPointColor(s,i,a),c=v._getDataPointPosition(s,y,i,a,l),e.fillStyle!==u&&(e.fillStyle=u),0===b?(e.save(),_=t+c.X+c.Width/2,f=n+c.Y+c.Height/2,e.translate(_,f),e.rotate(45*w/180),e.fillRect(0-c.Width/2,0-c.Height/2,c.Width,c.Height),e.restore()):(d=t+c.X+c.Width/4,d=C(d),h=n+c.Y,g=c.Width/2,p=c.Height,e.fillRect(d,h,g,p))},_paintAxis:function(e,t,n,r,o,i,a,l){var s,u,c,_,f,d,h,g=this,p=g.setting&&g.setting.options;p&&p.displayXAxis&&g._hasAxis(i,a)&&(s={Width:r,Height:o},u=g._getSpace(l),c=s.Width-g._getSpace(l),_=C(g._getAxisY(s,i,l))+.5,f=_,d=g.options.getColor(p.axisColor),h=l,h<1&&(h=1),e.strokeStyle!==d&&(e.strokeStyle=d),e.lineWidth!==h&&(e.lineWidth=h),e.beginPath(),e.moveTo(t+u,n+_),e.lineTo(t+c,n+f),e.stroke())},_hasAxisNormal:function(e){var t,n=this._getActualMaxValue(e);return n===-V||(t=this._getActualMinValue(e))===V||(n===t||n*t<=0)},_hasAxis:function(e,t){var n,r,o,i,a,l=this._hasAxisNormal(e);if(2!==this.options.sparklineType)return l;if(n=this._getCachedIndexMaping(e,t),r=n.length,!l&&r>0)for(a=0;a<r;a++)if(o=n[a],typeof(i=e[o])!==E&&i!==m)return!0;return l},_getMinDatetime:function(e,t){var n=this._cachedMinDatetime;return(isNaN(n)||n===V)&&this._getMaxMindatetimes(e,t),this._cachedMinDatetime},_getMaxDatetime:function(e,t){var n=this._cachedMaxDatetime;return(isNaN(n)||n===-V)&&this._getMaxMindatetimes(e,t),this._cachedMaxDatetime},_getMaxMindatetimes:function(e,t){var n,r,o,i,a=this,l=new Date(0,0,0),s=V,u=a._getCachedIndexMaping(e,t),c=u.length;for(i=0;i<c;i++)n=u[i],r=t[n],isNaN(r)||(o=a._getValue(n,e))!==m&&typeof o===E||isNaN(o)||typeof r!==E&&r!==m&&(r>l&&(l=r),r<s&&(s=r));a._cachedMaxDatetime=l,a._cachedMinDatetime=s},_calcItemWidth:function(e,t,n,r){var o,i,a,l,s,u,c,_,f=this,d=f._getMinDatetime(t,n),h=f._getMaxDatetime(t,n),g=[],p=f._getCachedIndexMaping(t,n),m=p.length;for(o=0;o<m;o++)a=p[o],(i=n[a])&&!isNaN(i)&&g.push(i);if(g.sort(function(e,t){return e-t}),(l=g.length)>1&&d!==h){for(s=V,u=0,o=1;o<l;o++)c=g[o],i=c-g[o-1],i<s&&i>0&&(s=i),u+=i;return _=(e.Width-f._getSpace(r)-f._getSpace(r))*s/u/2,_<2&&(_=2),_}return(e.Width-f._getSpace(r)-f._getSpace(r))/2},_getItemWidth:function(e,t,n,r){var o,i=this;return i.options.displayDateAxis?i._calcItemWidth(e,t,n,r):(o=i._getCachedIndexMaping(t,n).length,(e.Width-i._getSpace(r)-i._getSpace(r))/o)},_getItemX:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d=this,g=d._getSpace(o);return d.options.displayDateAxis?(i=d._getItemWidth(e,n,r,o),a=d._getMaxDatetime(n,r),l=d._getMinDatetime(n,r),a===l?g+i/2:(s=r[t])?(u=e.Width-g-d._getSpace(o),u-=i,c=a-l,g+C((s-l)/c*u)):0):(i=d._getItemWidth(e,n,r,o),_=h(d._getCachedIndexMaping(n,r),t),f=g+i*_,C(f))},_getCanvasSize:function(e,t){var n,r=this,o=e.Width-r._getSpace(t)-r._getSpace(t);return o=b(o,0),n=e.Height-r._getSpace(t)-r._getSpace(t),n=b(n,0),{Width:o,Height:n}},_getMaxMinValue:function(e){var t,n,r=this,o=e.length;for(n=0;n<o;n++)typeof(t=e[n])!==E&&t!==m&&("number"!=typeof t&&(t=0),t<r._cachedMinValue&&(r._cachedMinValue=t),t>r._cachedMaxValue&&(r._cachedMaxValue=t))},_getActualMaxValue:function(e){var t,n,r=this;return r._cachedMaxValue!==-V&&r._cachedMaxValue||r._getMaxMinValue(e),t=r.setting.options,n=t.maxAxisType,0===n?r._cachedMaxValue:1===n?t.groupMaxValue:2===n?t.manualMax:r._cachedMaxValue},_getActualMinValue:function(e){var t,n,r=this;return r._cachedMinValue!==V&&r._cachedMinValue||r._getMaxMinValue(e),t=r.setting.options,n=t.minAxisType,0===n?r._cachedMinValue:1===n?t.groupMinValue:2===n?t.manualMin:void 0},_getItemHeightNormal:function(e,t,n,r){var o=this._getCanvasSize(e,r),i=this._getActualMaxValue(n),a=this._getActualMinValue(n),l=i-a,s,u;if(i===a){if(0===i)return 0;l=I(i)}return s=n[t],s||(s=0),u=o.Height/l,s*u},_getItemHeight:function(e,t,n,r){var o,i,a,l=this,s=l.options.sparklineType;if(0===s)return l._getItemHeightNormal(e,t,n,r);if(1===s){if(o=n[t],1===l.setting.options.displayEmptyCellsAs&&(typeof o===E||o===m))return 0;if((i=l._getItemHeightNormal(e,t,n,r))>-l._minItemHeight&&i<l._minItemHeight){if(o>0)return i+l._minItemHeight;if(o<0)return i-l._minItemHeight}return i}return 2===s?typeof(o=n[t])===E||o===m||0===o||isNaN(o)?0:(a=l._getCanvasSize(e,r),o>=0?a.Height/2:-a.Height/2):void 0},_getAxisYNormal:function(e,t,n){var r,o,i=this,a=i._getCanvasSize(e,n),l=i._getActualMaxValue(t),s=i._getActualMinValue(t);if(l===-V||s===V)return e.Height/2;if(r=l-s,l===s){if(0===l)return e.Height/2;r=l,l<0&&(l=0)}return o=a.Height/r,i._getSpace(n)+l*o},_getAxisY:function(e,t,n){return 2===this.options.sparklineType?e.Height/2:this._getAxisYNormal(e,t,n)},_getItemVisibleHeightNormal:function(e,t,n,r){var o,i,a,l=this,s=l._getCanvasSize(e,r),u=l._getActualMaxValue(n),c=l._getActualMinValue(n),_=u-c;if(u===c){if(0===u)return 0;_=u}return o=s.Height/_,i=l._getValue(t,n),typeof i!==E&&i!==m||(i=0),u!==c&&u*c>0?(a=0,a=i>=0?(i-c)*o:(i-u)*o):i*o},_getItemVisibleHeight:function(e,t,n,r){var o,i,a,l=this,s=l.options.sparklineType;return 0===s?l._getItemVisibleHeightNormal(e,t,n,r):1===s?(o=l._getItemVisibleHeightNormal(e,t,n,r),i=l._minItemHeight,o>-i&&o<i&&(a=l._getValue(t,n),typeof a!==E&&a!==m||(a=0),0!==a)?a>0?o+i:o-i:o):2===s?l._getItemHeight(e,t,n,r):void 0},_getDataPointPositionNormal:function(e,n,r,o,i){var a,l,s,u,c,_,f,d,h,g=this,p=g._getItemWidth(n,r,o,i),m=g._getItemX(n,e,r,o,i);return p<0&&(p=0),p=C(p),p%2==1&&(p+=1),a=g._getItemHeight(n,e,r,i),l=g._getAxisY(n,r,i),s=g._getActualMaxValue(r),u=g._getActualMinValue(r),c=0,s<0&&u<0?c=b(g._getSpace(i),l):(c=l,a>=0&&(c=l-a)),_=g._getItemVisibleHeight(n,e,r,i),f=new t(m,c,p,I(_)),0!==a&&(d=g._getSpace(i),f.Y<d&&f.Bottom<d+1?f.Height=C(f.Height+1):(h=n.Height-g._getSpace(i),f.Bottom>h&&f.Y>h-1&&(f.Y=h-_,f.Height=_))),f},_getLineWeight:function(e){var t=this.setting.options.lineWeight*e;return t<1&&(t=1),t},_getDataPointPosition:function(e,n,r,o,i){var a,l,s,u,c,_=this,f=_._getLineWeight(i);return f++,f<2&&(f=2),a=_._getDataPointPositionNormal(e,n,r,o,i),0===_.options.sparklineType&&(a.X=a.X+(a.Width-f)/2,l=_._getValue(e,r),typeof l!==E&&l!==m?(l>=0?a.Y-=f/2:a.Y=a.Bottom-f/2,a.Width=f,a.Height=f):(a.Width=0,a.Height=0)),_.setting.options.rightToLeft&&(s=a.X,u=n.Width-s,c=u-a.Width,a=new t(c,a.Y,a.Width,a.Height)),a}};function t(e,t,n,r){var o=this;o.X=e,o.Y=t,o.Width=n,o.Height=r,o.Left=o.X,o.Right=o.Left+o.Width,o.Top=o.Y,o.Bottom=o.Y+o.Height}return e}(),g.SparklineRender=l,g.SparklineExRenders={PIESPARKLINE:ue,AREASPARKLINE:fe,SCATTERSPARKLINE:he,BULLETSPARKLINE:Ce,SPREADSPARKLINE:we,STACKEDSPARKLINE:be,HBARSPARKLINE:Ee,VBARSPARKLINE:Fe,VARISPARKLINE:De,BOXPLOTSPARKLINE:Ne,CASCADESPARKLINE:Le,PARETOSPARKLINE:ke,MONTHSPARKLINE:Xe,YEARSPARKLINE:Ke},e.exports=g}()},function(e,t,n){!function(){"use strict";e.exports=n(22)}()},function(e,t,n){!function(){"use strict";var t,r,o=void 0,i=null,a="number",l="string",s="boolean",u=n(1),c=u._DateTimeHelper,_=c._toOADate,f={all:0,byCurrentColumn:1,byOtherColumns:2},d={average:1,count:2,counta:3,max:4,min:5,product:6,stdev:7,stdevp:8,sum:9,vars:10,varp:11};function h(e){return e&&e.text!==o}t=function(){function e(){}return e.quickSort=function(e){var t,n=I(e),r=[];for(t=0;t<n;t++)r[t]={index:t,value:e[t]};return this.quickSortImp(r)},e.quickSortImp=function(e){var t,n,r,o,i,a,l,s;if(I(e)<=1)return e;for(t=this,n=Math.floor(I(e)/2),r=e[n],o=[],i=[],a=[],l=0;l<I(e);l++)s=t.sortCompare(e[l].value,r.value),s<0?o.push(e[l]):s>0?i.push(e[l]):a.push(e[l]);return t.quickSortImp(o).concat(a,t.quickSortImp(i))},e.isEquals=function(e,t){return!(!R(e)&&""!==e||!R(t)&&""!==t)||(e instanceof Date&&t instanceof Date?e.valueOf()===t.valueOf():A(e)===l&&A(t)===l?e.toLowerCase()===t.toLowerCase():e===t)},e._toOADate=_,e.isGreaterThan=function(e,t){var n=A(e),r=A(t);return n===s?e=e?1:0:e instanceof Date&&(e=this._toOADate(e)),r===s?t=t?1:0:t instanceof Date&&(t=this._toOADate(t)),n===r||n!==a&&r!==a?n===l&&r===l?e.toLowerCase()>t.toLowerCase():e>t:A(t)===a},e.sortCompare=function(e,t){var n=this,r=0,o=R(e)||""===e||A(e)===a&&isNaN(e),i=R(t)||""===t||A(t)===a&&isNaN(t);return r=o&&i?0:o?1:i?-1:n.isEquals(e,t)?0:n.isGreaterThan(e,t)?1:-1},e}();function g(e,n){var r,u;if(e===i||e===o)return!1;if(A(e)===a)n.value=e;else if(A(e)===s)n.value=e?1:0;else if(e instanceof Date)n.value=t._toOADate(e);else{if(A(e)!==l)return!1;if(e=e.trim(),0===I(e))return!1;if(r=!1,"%"===e.charAt(I(e)-1)&&(r=!0,e=e.substr(0,I(e)-1)),I(e)>=2&&"0"===e[0]&&"x"===e[1])return!1;if(u=(+e).valueOf(),isNaN(u)||!isFinite(u)){if(u=new Date(e),isNaN(u))return!1;u=t._toOADate(u)}r&&(u/=100),n.value=u}return!0}function p(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h=e._inPreview;for(h||(e._filteredRowMap=[],e._filteredRowIndexes=[]),t=h?e._filteredPreviewRowMap:e._filteredRowMap,n=e._filteredInfoByRangeSet,r=e._filteredInfoSet,o=h?e._filteredPreviewRowIndexes:e._filteredRowIndexes,i=e._filteredColumns,a=e._filteredPreviewColumnSet,l=e._filteredPreviewByRangColumnSet,s=I(e.data),c=0;c<s;c++){for(_=!1,f=0;f<I(i)&&(d=i[f],h&&d===e._previewCol||(r[d]?(u=e.getExclusiveRowIndex(e.columnNames[d],c),_=!r[d][u]):n[d]&&(_=!n[d][c]),!_));f++);!_&&h&&(a?(u=e.getExclusiveRowIndex(e.columnNames[d],c),_=!a[u]):l&&(_=!l[c])),_||(t[c]=!0)}for(f=0;f<I(t);f++)t[f]&&o.push(f)}function m(e){var t,n,r=e._columnsSet={};for(e._columnDataCache=[],e._exclusiveDataCache=[],e._exclusiveToFullMap=[],e._fullToExclusivelMap=[],t=e.columnNames,n=0;n<I(t);n++)r[(t[n]+"").toUpperCase()]=n}function v(e,n){var r,o,i,a,l,s,u,c,_=e._columnDataCache,f=e._exclusiveDataCache,d=e._exclusiveDataIndex,g=e._exclusiveToFullMap,p=e._fullToExclusivelMap,m=e.data,v=p[n]=[];for(e._sortedColumnDataCache=[],_[n]=[],f[n]=[],d[n]={},g[n]=[],r=0;r<I(m);r++)if(o=m[r][n],i=h(o)?o.text.trim():o,_[n].push(i),void 0===v[r])for(a=[r],f[n].push(i),g[n].push(a),l=I(g[n])-1,d[n][i]=l,v[r]=l,s=r+1;s<I(m);s++)u=m[s][n],c=h(u)?u.text.trim():u,void 0===v[s]&&t.isEquals(c,i)&&(a.push(s),v[s]=l)}function C(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,g,p=e._data2SortedMapping,m=e.getColumnIndex(t),v=[];if(!m)return v;if(r=e._inPreview?e._filteredPreviewByRangColumn:e._filteredInfoByRange[m],o=e._filteredRowMap,!r)return v;for(p[m]||e._sortOneCol(m),i=[],a=p[m],l=0;l<I(a);l++)s=e.data[l][m],u=h(s)?s.value:s,i[a[l]]=u;for(c=e._sorted2DataMapping[m],l=0;l<I(r);l++){for(_=r[l],f=!1,d=e._getStartEndIndex(i,_),g=d.start;g<=d.end;g++)if(o[c[g]]){f=!0;break}f!==n&&v.push(_)}return v}function w(e,t){var n,r,o,i,a=[];if(e.getColumnIndex(t)>=0){for(n=I(e.getData(t)),r=e._inPreview?e._filteredPreviewRowMap:e._filteredRowMap,o=0;o<n;o++)r[o]||(i=e.getExclusiveRowIndex(t,o),-1===a.indexOf(i)&&a.push(i));return a}}function y(e,t){var n,r,o,i,a,l,s,u=[],c=e.getColumnIndex(t);if(c>=0)for(n=e._filteredPreviewColumnSet||e._filteredPreviewByRangColumnSet,r=e._filteredInfoSet[c]||e._filteredInfoByRangeSet[c],o=e._inPreview&&c===e._previewCol?n:r,i=!!e._filteredInfoByRangeSet[c],a=I(i?e.getData(t):e.getExclusiveData(t)),l=0;l<a;l++)o&&!o[l]&&(s=i?e.getExclusiveRowIndex(t,l):l,-1===u.indexOf(s)&&u.push(s));return u}function S(e,t){var n,r,o,i,a,l,s,u,c,_=[],f=e.columnNames;for(n=0,r=I(f);n<r;n++)if(f[n]!==t)for(o=y(e,f[n]),i=0;i<I(o);i++)for(a=e.getRowIndexes(f[n],o[i]),l=0;l<I(a);l++)-1===_.indexOf(a[l])&&_.push(a[l]);for(n=0,r=I(e.data);n<r;n++)-1!==_.indexOf(n)?_.splice(_.indexOf(n),1):_.push(n);for(s=I(e.getExclusiveData(t)),u=[],n=0;n<s;n++)u.push(n);for(n=0,r=I(_);n<r;n++)c=e.getExclusiveRowIndex(t,_[n]),-1!==u.indexOf(c)&&u.splice(u.indexOf(c),1);return u}function x(e,t,n,r){var o,i,a,l,s,u,c,_,f=e.getColumnIndex(t),d=e._data2SortedMapping;for(d[f]||e._sortOneCol(f),o=[],i=d[f],a=0;a<I(i);a++)l=e.data[a][f],s=h(l)?l.value:l,o[i[a]]=s;for(u={},a=0;a<I(n);a++)for(c=e._getStartEndIndex(o,n[a]),_=0;_<I(i);_++)i[_]>=c.start&&i[_]<=c.end&&(u[_]=!0);r?(e._filteredPreviewByRangColumnSet=u,e._filteredPreviewByRangColumn=n):(e._filteredInfoByRange[f]=n,e._filteredInfoByRangeSet[f]=u,delete e._filteredInfoSet[f],delete e._filteredInfoIndexes[f]),p(e)}function b(e,t,n,r){var o,i=e.getColumnIndex(t),a={};for(o=0;o<I(n);o++)a[n[o]]=!0;r?e._filteredPreviewColumnSet=a:(e._filteredInfoSet[i]=a,e._filteredInfoIndexes[i]=n,delete e._filteredInfoByRange[i],delete e._filteredInfoByRangeSet[i]),p(e)}function T(e,t){e._inPreview=!1,e._filteredPreviewColumnSet={},e._filteredPreviewRowIndexes=[],e._filteredPreviewRowMap=[],e._filteredPreviewByRangColumnSet=[],t&&e.onFiltered()}r=function(){function e(e,t){var n,r=this;for(r._columnsSet={},r._columnDataCache=[],r._exclusiveDataCache=[],r._exclusiveDataIndex=[],r._exclusiveToFullMap=[],r._fullToExclusivelMap=[],r._filteredInfoSet=[],r._filteredInfoIndexes=[],r._filteredInfoByRangeSet=[],r._filteredInfoByRange=[],r._filteredRowMap=[],r._filteredRowIndexes=[],r._filteredColumns=[],r._filteredPreviewRowIndexes=[],r._filteredPreviewRowMap=[],r._inPreview=!1,r._listeners=[],r._suspendCount=0,r._sortedColumnDataCache=[],r._sorted2DataMapping=[],r._data2SortedMapping=[],r._setDataSource(e,t),n=0;n<I(r.data);n++)r._filteredRowMap[n]=!0,r._filteredRowIndexes.push(n)}return e.prototype={constructor:e,inPreview:function(){return this._inPreview},_setDataSource:function(e,t){var n=this;n.data=e,n.columnNames=t,m(n)},onDataChanged:function(e){var t,n,r,o,i,a,l,s,u,c,_=this,f=Array(I(_.columnNames)),d=_._filteredInfoIndexes,g=_._exclusiveDataCache,m=_._filteredInfoSet,C=_._columnDataCache;for(t=0;t<I(e);t++)n=e[t],r=n.data,o=n.row,i=_.getColumnIndex(n.columnName),_.data[o][i]=r,a=h(r)?r.text:r,C[i]&&(C[i][o]=a),f[i]=!0;for(l=0;l<I(f);l++)if(f[l]){for(s=d[l],d[l]=s?[]:void 0,m[l]=s?{}:void 0,u=[],t=0;s&&t<I(s);t++)u.push(g[l][s[t]]);for(v(_,l),t=0;t<I(u);t++)c=_._exclusiveDataIndex[l][u[t]],d[l].push(c),m[l][c]=!0}p(_),_._notifyListeners(e,"onDataChanged")},_notifyListeners:function(){var e,t,n,r=arguments,o=r[I(r)-1];for(r.length-=1,e=this._listeners||[],t=0;t<I(e);t++)n=e[t],n[o]&&n[o].apply(n,r)},onColumnNameChanged:function(e,t){var n=this,r=n._columnsSet,o=n.getColumnIndex(e);o<0||(n.columnNames[o]=t,delete r[e.toUpperCase()],r[t.toUpperCase()]=o,n._notifyListeners(e,t,"onColumnNameChanged"))},onRowsAdded:function(e,n,r){
var a,l,s,u,c,_,f,d,h,g,p,m,v,C=this,w=I(C.columnNames),y=C.data,S=C._columnDataCache,x=C._exclusiveDataCache,b=C._exclusiveToFullMap,T=C._fullToExclusivelMap,R=C._filteredInfoSet,A=C._filteredInfoIndexes,M=C._filteredRowMap,E=C._filteredRowIndexes,F=C._filteredColumns;for(C._sortedColumnDataCache=[],a=0;a<n;a++)y.splice(e,0,Array(w));for(l=0;l<w;l++){for(a=0;a<n;a++)S[l]&&S[l].splice(e,0,o);if(s=x[l]){for(c=i,_=0;_<I(s);_++){for(f=b[l][_],d=0;d<I(f);d++)f[d]>=e&&(f[d]+=n);t.isEquals(s[_],i)&&(c=f,u=_)}for(c||(c=[],s.push(i),u=I(s)-1,C._exclusiveDataIndex[l][i]=u,b[l].push(c),R[l]&&-1===F.indexOf(l)&&(R[l][u]=!0,A[l].push(u))),h=e;h<e+n;h++)c.push(h);for(g=e;g<e+n;g++)T[l].splice(g,0,u)}}for(p=!0,a=0;a<I(F);a++)l=F[a],m=T[l][e],!0!==R[l][m]&&(p=!1);for(a=0;a<I(E);a++)E[a]>=e&&(E[a]+=n);for(g=I(y)-1;g>=e+n;g--)M[g]=M[g-n];for(v=I(F)>0,g=e;g<e+n;g++)p&&E.push(g),M[g]=!v;r||C._notifyListeners(e,n,!0,"onRowsChanged")},onRowsRemoved:function(e,t){this._onRowsRemovedCore(e,t,!0)},_onRowsRemovedCore:function(e,t,n){var r,o,i,a,l,s,u,c,_=this,f=_._filteredInfoIndexes,d=_._exclusiveDataCache,h=_._filteredInfoSet,g=_.data,m=I(_.columnNames),C=_._columnDataCache;for(g.splice(e,t),r=0;r<m;r++){if(C[r]&&C[r].splice(e,t),o=f[r],i=[],o&&n){for(a=0;a<I(o);a++){for(l=_.getRowIndexes(_.columnNames[r],o[a]),s=!0,u=0;u<I(l);u++)if(l[u]<e||l[u]>=e+t){s=!1;break}s||i.push(d[r][o[a]])}f[r]=[],h[r]={}}if(v(_,r),o&&n)for(a=0;a<I(i);a++)c=_._exclusiveDataIndex[r][i[a]],f[r].push(c),h[r][c]=!0}n&&p(_),_._notifyListeners(e,t,!1,"onRowsChanged")},onColumnsRemoved:function(e,t){var n,r,o,i,a,l,s,u,c=this,_=c.data,f=[],d=c._filteredColumns,h=e+t;for(n=e;n<h;n++)r=c.columnNames[n],o=n,f.push(r),-1!==d.indexOf(o)&&c.doUnfilter(r);for(i=c._filteredInfoSet||c._filteredInfoByRangeSet,a=c._filteredInfoIndexes||c._filteredInfoByRange,l=c._columnsSet,n=0;n<I(_);n++)_[n].splice(e,t);c._sortedColumnDataCache=[],c.columnNames.splice(e,t),c._columnDataCache.splice(e,t),c._exclusiveDataCache.splice(e,t),c._exclusiveDataIndex.splice(e,t),c._exclusiveToFullMap.splice(e,t),c._fullToExclusivelMap.splice(e,t),i.splice(e,t),a.splice(e,t);for(s in l)l[s]>=e+t&&(l[s]-=t);for(n=0;n<I(f);n++)r=f[n],delete l[r.toUpperCase()],e=c.getColumnIndex(r),u=d.indexOf(e),-1!==u&&d.splice(u,1),c._notifyListeners(f[n],"onColumnRemoved")},_getSortedColumnDataCache:function(){return this._sortedColumnDataCache},_getSorted2DataMapping:function(){return this._sorted2DataMapping},_sortOneCol:function(e){var n,r,o,i,a,l,s,u,c,_,f,d=this,g=d.data;for(d._columnDataCache[e]||v(d,e),n=I(g),r=[],o=0;o<n;o++)i=g[o][e],a=h(i)?i.value:i,r.push(a);for(l=t.quickSort(r),s=d._sortedColumnDataCache[e]=[],u=d._sorted2DataMapping[e]=[],c=d._data2SortedMapping[e]=[],_=0;_<I(l);_++)f=l[_],s.push(f.value),u.push(f.index),c[f.index]=_},getColumnIndex:function(e){var t=this._columnsSet[e.toUpperCase()];return void 0===t?-1:t},getFilteredRowIndexes:function(){var e=this;return e._inPreview?e._filteredPreviewRowIndexes:e._filteredRowIndexes},getFilteredOutRowIndexes:function(){var e,t=this,n=I(t.data),r=t._inPreview?t._filteredPreviewRowMap:t._filteredRowMap,o=[];for(e=0;e<n;e++)r[e]||o.push(e);return o},getData:function(e,t){var n,r,o,i,a,l,s,u=this,c=u._columnDataCache,_=u.getColumnIndex(e);if(_>=0){if(t){for(u._sortedColumnDataCache[_]||u._sortOneCol(_),n=c[_],r=u._sortedColumnDataCache[_],o=u._getStartEndIndex(r,t),i=o.start,a=o.end,l=[],s=i;s<=a;s++)l.push(n[u._sorted2DataMapping[_][s]]);return l}return c[_]||v(u,_),c[_]}return[]},aggregateData:function(e,t,n){var r,i,a,l,s,u,c,_,f,d=this,h=d.getColumnIndex(e);return h<0?o:(d._sortedColumnDataCache[h]||d._sortOneCol(h),a=d._sortedColumnDataCache[h],l=I(a),s=d._getStartEndIndex(a,n),r=s.start,i=s.end,5===t?r>=l?o:a[r]:4===t?i<0?o:a[i]:3===t?i<r?0:i-r+1:(u=d._calcSpecialData(a,t,r,i),c=u.data1,_=u.data2,f=u.data3,1===t?c/=_:7===t||10===t?(c=(f*_-c*c)/(f*(f-1)),c=7===t?Math.sqrt(c):c):8!==t&&11!==t||(c=(f*_-c*c)/(f*f),c=8===t?Math.sqrt(c):c),c))},_calcSpecialData:function(e,t,n,r){var a,l,s,u=6===t?1:0,c=0,_=0;for(a=n;a<=r;a++)(l=e[a])===i&&l===o||(s={value:i},g(l,s)&&(l=s.value,1===t?(u+=l,c++):2===t?u++:9===t?u+=l:6===t?u*=l:7!==t&&8!==t&&10!==t&&11!==t||(u+=l,c+=l*l,_++)));return{data1:u,data2:c,data3:_}},_getStartEndIndex:function(e,n){var r,i,a,l,s=I(e);if(n){if(n.min===-1/0)r=0;else for(a=0;a<s;a++)if(l=e[a],t.isEquals(n.min,l)||t.isGreaterThan(l,n.min)){r=a;break}if(r===o&&(r=s),i===1/0)i=s-1;else{for(a=s-1;a>=0;a--)if(l=e[a],t.isEquals(l,n.max)||t.isGreaterThan(n.max,l)){i=a;break}i===o&&(i=-1)}}else r=0,i=s-1;return{start:r,end:i}},getExclusiveData:function(e){var t=this,n=t._exclusiveDataCache,r=t.getColumnIndex(e);return r>=0?(n[r]||v(t,r),n[r]):[]},getRowIndexes:function(e,t){var n=this,r=n.getColumnIndex(e);return r>=0?(n._fullToExclusivelMap[r]||v(n,r),n._exclusiveToFullMap[r][t]):[]},getExclusiveRowIndex:function(e,t){var n=this,r=n._fullToExclusivelMap,o=n.getColumnIndex(e);return o>=0?(r[o]||v(n,o),r[o][t]):-1},getFilteredIndexes:function(e){var t=[],n={};return this._getFilteredExclusiveIndexes(e,t,n),t},_getFilteredExclusiveIndexes:function(e,t,n){var r,o,i,a=this,l=a._inPreview?a._filteredPreviewRowIndexes:a._filteredRowIndexes;for(r=0;r<I(l);r++)o=l[r],i=a.getExclusiveRowIndex(e,o),n[i]?n[i]++:(n[i]=1,t.push(i))},getFilteredRanges:function(e){return C(this,e,!1)},getFilteredOutRanges:function(e){return C(this,e,!0)},getFilteredOutIndexes:function(e,t){var n=this;return 0===t?w(n,e):1===t?y(n,e):S(n,e)},attachListener:function(e){this._listeners.push(e)},detachListener:function(e){var t,n=this._listeners||[];for(t=0;t<I(n);t++)if(n[t]===e){n.splice(t,1);break}},suspendFilteredEvents:function(){this._suspendCount++},resumeFilteredEvents:function(){var e=this;0===--e._suspendCount&&e.onFiltered()},doFilter:function(e,t,n){this._doFilterInternal(e,t,n),this.onFiltered()},_doFilterInternal:function(e,t,n){var r=this,o=r._filteredColumns,i=r.getColumnIndex(e);i<0||(n?(r._inPreview=!0,r._previewCol=i):r._inPreview&&T(r,!1),o.indexOf(i)<0&&o.push(i),t.ranges?x(r,e,t.ranges,n):b(r,e,t.exclusiveRowIndexes,n))},clearPreview:function(){T(this,!0)},doUnfilter:function(e){this._doUnfilterInternal(e),this.onFiltered()},_doUnfilterInternal:function(e){var t,n,r=this;r._inPreview&&T(r,!1),(t=r.getColumnIndex(e))<0||(delete r._filteredInfoByRange[t],delete r._filteredInfoByRangeSet[t],delete r._filteredInfoSet[t],delete r._filteredInfoIndexes[t],p(r),(n=r._filteredColumns.indexOf(t))>=0&&r._filteredColumns.splice(n,1))},onFiltered:function(){var e=this;0===e._suspendCount&&e._notifyListeners({rowIndexes:e.getFilteredRowIndexes(),isPreview:e._inPreview},"onFiltered")},getListener:function(){return this._listeners}},e}();function R(e){return e===i||e===o}function A(e){return typeof e}function I(e){return e?e.length:0}e.exports={FilteredOutDataType:f,SlicerAggregateType:d,GeneralSlicerData:r,_SortHelper:t}}()}])}),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.CalcEngine=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";var t=n(1);n(3),n(4),n(5),t.SR={},t.SR.en=n(6),e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U,Y,G,X,j,K,Z,J,q,Q,$,ee,te,ne,re,oe,ie,ae=n(2),le={},se=le.Functions={},ue="number",ce="string",_e="boolean",fe="TRUE",de="FALSE",he="#NULL!",ge="#DIV/0!",pe="#VALUE!",me="#REF!",ve="#NAME?",Ce="#N/A",we="#NUM!",ye=[he,ge,pe,me,ve,Ce,we],Se=[0,7,15,23,29,42,36];le.ErrorList=ye,t=ae._Types,r=t._isArray,o=t._extend,i=le.BAND_INDEX_CONST=-2147483648,a=le.MAX_ROW_COUNT=1048576,l=le.MAX_COLUMN_COUNT=16384,s=ae._Types._inherit,u=ae._DateTimeHelper,c=ae._StringHelper;function xe(e){return e&&e.toUpperCase()}_=function(){return ae._getResource(le.SR)()},f=["o","n","s","b","d"],d=le._createRange=function(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}},h=null,g=void 0,p=Math.abs,le.BangSource={},le.RefErrorSource={},le.supportRowColumnFormula=!1,m=ae._addElements,v=ae._deleteElements,C=function(){function e(t){var n=e._parseCore(t);if(!n)throw _().Exp_NotSupported;this._error=n.error,this._code=n.code}return e.prototype.toString=function(){return this._error},e.prototype.clone=function(){return new e(this._error)},e.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},e.parse=function(t){try{return new e(t)}catch(e){return g}},e._parseCore=function(e){var t,n;if(e)for(t=0;t<ye.length;t++)if((n=ye[t])===e||n===xe(e))return{error:n,code:Se[t]};return g},e}(),le.CalcError=C,w=le.Errors={},w.Null=new C(he,0),w.DivideByZero=new C(ge,7),y=w.Value=new C(pe,15),S=w.Reference=new C(me,23),x=w.Name=new C(ve,29),b=w.NotAvailable=new C(Ce,42),T=w.Number=new C(we,36),R=le._createCellIdentity=function(e,t){return{row:e,col:t}},A=le._createRangeIdentity=function(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}},I=le._createCellExpression=function(e,t,n,r,o,i){var a=new D(1);return a.row=n,a.column=r,a.rowRelative=o,a.columnRelative=i,a._isCell=!0,e&&(a.source=e),t&&(a.endSource=t),a},M=le._createRangeExpression=function(e,t,n,r,o,a,l,s,u,c){var _=new D(1),f;return _.isFullRow=r===i,_.isFullRow&&0===n&&o===le.MAX_ROW_COUNT-1&&(n=o=i),_.isFullColumn=n===i,n>o&&(f=n,n=o,o=f,f=l,l=u,u=f),r>a&&(f=r,r=a,a=f,f=s,s=c,c=f),_.row=n,_.column=r,_.endRow=o,_.endColumn=a,_.rowRelative=l,_.columnRelative=s,_.endRowRelative=u,_.endColumnRelative=c,e&&(_.source=e),t&&(_.endSource=t),_};function be(e,t,n,r){return-1===e&&r>127||-1===t&&n>127||n*r>127}E=le.CalcArray=function(e){this.array=e},E.prototype={getRowCount:function(){return this.array.length},getColumnCount:function(){return this.array[0].length},getValue:function(e,t){var n=this.array;return e.row!==g&&(e=e.row,t=e.column),e<0||t<0||e>=n.length||t>=n[0].length?y:this.array[e][t]},getValueByIndex:function(e){var t=this.getColumnCount(),n=Math.floor(e/t),r=e%t;return this.getValue(n,r)},toArray:function(e,t,n,r,o){var i,a,l,s,u=this,c=1,_=1,f=[],d=Fe.CalcConvertedError;for(t=t===g||t,c=u.getRowCount(),_=u.getColumnCount(),l=0;l<c;l++)for(t||(a=[],f.push(a)),s=0;s<_;s++){if(i=u.getValue(l,s),n&&Fe._isError(i))return f=[i],f.isError=!0,f;if(i=Fe._convertValue(i,e,!1,o),r&&i===d)return f=[i],f.isError=!0,f;t?f.push(i):a.push(i)}return f.rowCount=c,f.colCount=_,f.rangeCount=1,f},slice:function(e,t,n,r){var o,i,a,l=this,s=l.array,u=[];for(e=e<0?0:e,t=t<0?0:t,n=e+n>l.getRowCount()?l.getRowCount()-e:n,r=t+r>l.getColumnCount()?l.getColumnCount()-t:r,i=0;i<n;i++)for(o=[],u.push(o),a=0;a<r;a++)o.push(s[i+e][a+t]);return new E(u)}},F=le.CalcReference=function(e,t){var n=this;n._source=e,t?(n._identities=t,n._rangeCount=t.length):n._rangeCount=1},F.prototype={getRangeCount:function(){return this._rangeCount},getRow:function(e){return this._identities?this._identities[e||0].row:0},getColumn:function(e){return this._identities?this._identities[e||0].col:0},getRowCount:function(e){return this._identities?this._identities[e||0].rowCount:this._source.getRowCount()},getColumnCount:function(e){return this._identities?this._identities[e||0].colCount:this._source.getColumnCount()},getValue:function(e,t){var n,r,o;if(e.row!==g?(n=e.row,r=e.col):(n=arguments[1],r=arguments[2],t=arguments[0]),t=t||0,n>=0||r>=0){if(!(o=this._identities))return this._source.getValue(n,r);if(t<o.length)return this._source.getValue(n+o[t].row,r+o[t].col)}return S},getValueByIndex:function(e){var t=this.getColumnCount(),n=Math.floor(e/t),r=e%t;return this.getValue(n,r)},isHiddenRow:function(e,t,n){return this._source.isHiddenRow(t+this.getRow(e),n)},isSubtotal:function(e,t,n){var r,o=this._source;return 0===e&&t<o.getRowCount()&&n<o.getColumnCount()&&((r=o.getCalcSourceModel().getExpression(t,n))&&7===r.type&&("SUBTOTAL"===r.functionName||"AGGREGATE"===r.functionName))},getSource:function(){return this._source},create:function(e){return new F(this._source,e)},toArray:function(e,t,n,r,o){return this._source.referenceToArray(this,e,t,n,r,o)}},le.ExpressionType={unknow:0,reference:1,number:2,string:3,boolean:4,error:5,array:6,function:7,name:8,operator:9,parentheses:10,missingArgument:11,expand:12,structReference:13},D=le.Expression=function(){function e(e){var t=this;t.type=e,1===e&&(t._getRangeType=function(){return t.isFullRow&&t.isFullColumn?3:t.isFullRow?1:t.isFullColumn?2:0},t.getRange=function(e,n){return N(t,e,n)},t.offset=function(e,n,r){if(t._isCell)return I(t.source,t.endSource,t.row+(t.rowRelative||r?e:0),t.column+(t.columnRelative||r?n:0),t.rowRelative,t.columnRelative);var o=M(t.source,t.endSource,t.row+(t.rowRelative||r?e:0),t.column+(t.columnRelative||r?n:0),t.endRow+(t.isFullColumn||!t.endRowRelative&&!r?0:e),t.endColumn+(t.isFullRow||!t.endColumnRelative&&!r?0:n),t.rowRelative,t.columnRelative,t.endRowRelative,t.endColumnRelative);return o.isFullRow=t.isFullRow,o.isFullColumn=t.isFullColumn,o},t.offset2=function(e,n,r,o){var i=M(t.source,t.endSource,t.row+(t.isFullColumn?0:e),t.column+(t.isFullRow?0:n),t.endRow+(t.isFullColumn?0:r),t.endColumn+(t.isFullRow?0:o),t.rowRelative,t.columnRelative,t.endRowRelative,t.endColumnRelative);return i.isFullRow=t.isFullRow,i.isFullColumn=t.isFullColumn,i})}return e.prototype.offset=function(e,t,n){var r,o,i,a=this,l=a.type;if(10===l)return $(a.value.offset(e,t,n));if(7===l){for(r=a.arguments,o=[],i=0;i<r.length;i++)o.push(r[i].offset(e,t,n));return q(a.function,o)}return 9===l?Q(a.operatorType,a.value.offset(e,t,n),a.value2&&a.value2.offset(e,t,n)):this},e}(),N=le.getRangeForReference=function(e,t,n){var r={row:-1,col:-1,rowCount:-1,colCount:-1},o,i,s,u;return e.isFullRow?(r.col=-1,r.colCount=-1):(e.columnRelative?(s=e.column+n,s=s>=l?s%l:s):s=e.column,e._isCell?(r.col=s,r.colCount=1):(e.endColumnRelative?(u=e.endColumn+n,u=u>=l?u%l:u):u=e.endColumn,r.col=s<=u?s:u,r.colCount=p(u-s)+1)),e.isFullColumn?(r.row=-1,r.rowCount=-1):(e.rowRelative?(o=e.row+t,o=o>=a?o%a:o):o=e.row,e._isCell?(r.row=o,r.rowCount=1):(e.endRowRelative?(i=e.endRow+t,i=i>=a?i%a:i):i=e.endRow,r.row=o<=i?o:i,r.rowCount=p(i-o)+1)),r},V=le.CalcSource=function(){function e(t){this.id=e.sourceId++,this._service=t,this._calcSourceModel=null}return e.sourceId=1,e}(),V.prototype={getCalcService:function(){return this._service},_getCalcServiceInternal:function(){return this._service},setCalcService:function(e){this._service=e},getCalcSourceModel:function(){return this._calcSourceModel},setCalcSourceModel:function(e){this._calcSourceModel=e},getValue:function(e,t){return h},getName:function(){return""},setValue:function(e,t){},getReference:function(e){return new F(this,e)},getSources:function(e){return[this]},referenceToArray:function(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,p,m,v,C,w=this,S=1,x=1,b=[],T=e.getRangeCount();if(0===T)return b.isError=!0,[];for(f=w.getRowCount(),d=w.getColumnCount(),n=n===g||n,p=0;p<T;p++){if(n||(_=[],b.push(_)),0===(S=e.getRowCount(p)))return b.isError=!0,[];if(0===(x=e.getColumnCount(p)))return b.isError=!0,[];for(s=e.getRow(p),u=e.getColumn(p),S=Math.min(s+S,f)-s,x=Math.min(u+x,d)-u,v=0;v<S;v++)for(a=s+v,n||(m=[],_.push(m)),C=0;C<x;C++){if(l=u+C,c=w.getValue(a,l),r&&Fe._isError(c))return b=[c],b.isError=!0,b;if(c=Fe.convertValue(c,t,!0,i),o&&c===Fe.CalcConvertedError)return b=[y],b.isError=!0,b;c===h&&i||(n?b.push(c):m.push(c))}}return n||1!==T||(b=b[0]),b.rowCount=S,b.colCount=x,b.rangeCount=T,b},getSheetReference:function(){var e=this;return e._reference=e._reference||new F(e),e._reference},setFormula:function(e,t){},setArrayFormula:function(e,t){},getRowCount:function(){return 1e3},getColumnCount:function(){return 100},isHiddenRow:function(e,t){return!1},getParserContext:function(e,t,n){return new le.ParserContext(this,e,t,n)},startCalculation:function(){},endCalculation:function(){},getEvaluatorContext:function(e,t,n){return new le.EvaluateContext(this,e,t,n)},getCustomFunction:function(e){return h},getCustomName:function(e){return h},refresh:function(){},toJSON:function(e,t){}},O=le.CalcSourceModel=function(){function e(e,t){var n=this;n._lastNonNullRow=0,n._lastNonNullColumn=0,n._volatitleCells=[],n.dataTable={},n.dataTableByName={},n._rowDataArray=[],n._columnDataArray=[],n._defaultDataNode=h,n._source=t,n._service=e,n._removedVolatileCount=0}return e}(),O.prototype={getNode:function(e,t,n){var r,o=this,i=h;return e>=0&&t>=0?(r=o.dataTable[e],n&&!r&&(r=o.dataTable[e]={},e>o._lastNonNullRow&&(o._lastNonNullRow=e)),r&&(i=r[t],n&&!i&&(i=r[t]={},t>o._lastNonNullColumn&&(o._lastNonNullColumn=t)))):-1===e&&t>=0?(i=o._columnDataArray[t],n&&!i&&(i=o._columnDataArray[t]={},t>o._lastNonNullColumn&&(o._lastNonNullColumn=t))):e>=0&&-1===t?(i=o._rowDataArray[e],n&&!i&&(i=o._rowDataArray[e]={},t>o._lastNonNullColumn&&(o._lastNonNullColumn=t))):-1===e&&-1===t&&(i=o._defaultDataNode,n&&!i&&(i=o._defaultDataNode={})),i},getNodeByName:function(e,t){var n=this,r=n.dataTableByName[e];return t&&!r&&(r=n.dataTableByName[e]={}),r},_getExpr:function(e,t){var n=this.getNode(e,t);return n&&n._expr},_getWorkingExpr:function(e,t){var n=this.getNode(e,t);return n&&n._workingExpr},getExpr:function(e,t){return this._getExpr(e,t)},getArray:function(e,t){return this.__getArrayInfo(e,t)},__getArrayInfo:function(e,t){var n=this.getNode(e,t);return n&&n._arrayInfo},_getArrayInfo:function(e,t){var n=this.getWorkingNode(e,t);return n&&n._arrayInfo},getWorkingExpression:function(e,t){var n=this.getWorkingNode(e,t);return n&&n._workingExpr},getExpression:function(e,t){var n=this.getWorkingNode(e,t);return n&&n._expr},getWorkingExpressionByName:function(e){var t=this.getNodeByName(e);return t&&t._workingExpr},getExpressionByName:function(e){var t=this.getNodeByName(e);return t&&t._expr},clearAll:function(){var e=this;e.clear(-1,-1,-1,-1),e.dataTable={},e.dataTableByName={},e._rowDataArray=[],e._columnDataArray=[],e._defaultDataNode=h},clear:function(e,t,n,r){this._clear(e,t,n,r)},addRows:function(e,t){var n,r=this,o=r.rC();if(!(e<0||e>o||t<0))for(m(r.dataTable,o,e,t),m(r._rowDataArray,o,e,t),n=0;n<t;n++)r.dataTable[e+n]&&(r.dataTable[e+n]={rs:"n"})},deleteRows:function(e,t){var n=this,r=n.rC();e<0||e>=r||t<=0||(e+t>r&&(t=r-e),v(n.dataTable,r,e,t),v(n._rowDataArray,r,e,t))},addColumns:function(e,t){var n,r,o=this,i=o.rC(),a=o.cC();if(!(e<0||e>a||t<0)){for(n=0;n<i;n++)(r=o.dataTable[n])&&e<a&&m(r,a,e,t);m(this._columnDataArray,a,e,t)}},deleteColumns:function(e,t){var n,r,o=this,i=o.rC(),a=o.cC();if(!(e<0||e>=a||t<0)){for(n=0;n<i;n++)(r=this.dataTable[n])&&v(r,a,e,t);v(this._columnDataArray,a,e,t)}},_setExpr:function(e,t,n){var r=this.getNode(e,t,!!n);r&&(r._expr=n)},_clearAllExpr:function(e,t){var n=this.getNode(e,t,!0);n&&(n._expr=g,n._workingExpr&&(n._workingExpr=g),n._arrayInfo&&(n._arrayInfo=g),n.isVolatile&&this._removeVolatile(n))},_copyExpr:function(e,t,n,r,o){var i,a=this.getNode(t,n);a&&a._expr&&(i=e.getNode(r,o,!0),a._arrayInfo&&(i._arrayInfo=d(r,o,a._arrayInfo.rowCount-(t-a._arrayInfo.row),a._arrayInfo.colCount-(n-a._arrayInfo.col))),i._expr=a._expr,a._workingExpr&&(i._workingExpr=a._workingExpr),a.isVolatile&&(i.isVolatile=!0))},_containsNode:function(e,t){var n=this.dataTable[e];return n&&n[t]},_setWorkingExpr:function(e,t,n){var r=this.getNode(e,t,!!n);r&&(r._workingExpr=n)},_setArrayInfo:function(e,t,n){var r=this.getNode(e,t,!!n);r&&(r._arrayInfo=n)},_getCalc:function(e,t){var n=this.getNode(e,t);return n&&n.calc},_setCalc:function(e,t,n){var r=this.getNode(e,t,!0);r&&(r.calc&&r.calc.isVolatile&&this._removeVolatile(r),r.calc=n,n&&(n.node=r))},_removeCalc:function(e,t,n){var r=this.getNode(e,t,!0);r&&r.calc&&(r.calc.isVolatile&&this._removeVolatile(r),this._service._removeDirty(r.calc,n),r.calc=g)},_setNode4Swap:function(e,t,n,r,o){var i,a=this;n>=0&&r>=0?(i=a.dataTable[n],i||(i=a.dataTable[n]={}),i[r]=o,o&&o.calc&&delete o.calc):n>=0&&-1===r&&e>=0&&-1===t?a._rowDataArray[n]=o:r>=0&&-1===n&&t>=0&&-1===e&&(a._columnDataArray[r]=o)},_swapNode:function(e,t,n,r){var o=this,i=o.getNode(e,t),a=o.getNode(n,r);i&&i._expr?o._setNode4Swap(e,t,n,r,i):a&&a._expr&&o._setNode4Swap(e,t,n,r,h),a&&a._expr?o._setNode4Swap(n,r,e,t,a):i&&i._expr&&o._setNode4Swap(n,r,e,t,h)},_getAllVolatitles:function(){return this._volatitleCells},_setVolatile:function(e){e.isVolatile||(e.isVolatile=!0,this._volatitleCells.push(e))},_removeVolatile:function(e){var t,n,r,o,i;if(e.isVolatile=g,t=this,++t._removedVolatileCount>100){for(t._removedVolatileCount=0,n=[],r=t._volatitleCells,o=t._volatitleCells.length,i=0;i<o;i++)r[i].isVolatile&&n.push(r[i]);t._volatitleCells=n}},_clearCore:function(e,t){var n,r;for(n=0;n<e.length;n++)(r=e[n])&&(1&t)>0&&(r._arrayInfo&&(r._arrayInfo=g),r._expr&&(r._expr=g),r._workingExpr&&(r._workingExpr=g))},getCalcService:function(){return this._service},setCalcService:function(e){this._service=e},_getCalcServiceInternal:function(){return this._service},getSource:function(){return this._source},hasFormula:function(e,t){return e=e!==g?e:-1,t=t!==g?t:-1,!!this.getExpression(e,t)},setFormula:function(e,t,n,r,o,i){var a,l,s,u,c,_=this;if(n&&0===n.length&&(n=h),!o&&_._intersectWithArrayFormula(e,t,1,1)&&_._throwArrayPartException(),a=_.getFormula(e,t),i||a!==n&&(""!==a||n)&&(a||""!==n)){if(l=_._getCalcServiceInternal(),s=h,l)try{u=e>=0?e:0,c=t>=0?t:0,s=r||(n?l.parse(_._source,n,u,c,!1,o,o):h),_._setExpression(e,t,s,g,!1)}catch(e){if(!o)throw e}e>=0&&t>=0&&_._source.setFormula(e,t,n)}},getFormula:function(e,t,n){var r,o,i=this._getCalcServiceInternal();return i&&(r=this.getExpression(e,t))?(o=this._getArrayInfo(e,t),e=o?o.row:e,t=o?o.col:t,i.unparse(this._source,r,e,t,n)):h},setFormulaByName:function(e,t,n){var r,o,i,a;if(e&&(e=xe(e),r=this,t&&0===t.length&&(t=h),(o=r.getFormulaByName(e))!==t&&(""!==o||t)&&(o||""!==t))){if(i=r._getCalcServiceInternal(),a=h,i)try{a=t?i.parse(r._source,t,0,0,!1,n):h,r._setExpressionByName(e,a,g,!1)}catch(e){if(!n)throw e}r._source.setFormula({name:e},t)}},getFormulaByName:function(e){var t,n=this._getCalcServiceInternal();return n&&e&&(t=this.getExpressionByName(xe(e)))?n.unparse(this._source,t,0,0):h},_throwArrayPartException:function(){throw _().Exp_ArrayFromulaPart},rC:function(){return Math.min(this._source.getRowCount())},cC:function(){return Math.min(this._source.getColumnCount())},setArrayFormula:function(e,t,n,r,o,i){var a,l,s,u,c=this;if(o&&0===o.length&&(o=h),c._intersectWithArrayFormula(e,t,n,r)&&c._throwArrayPartException(),e=e<0?0:e,t=t<0?0:t,(a=c._getCalcServiceInternal())&&(c._clear(e,t,n,r),o)){try{l=o?a.parse(c._source,o,e,t,!1,i,i):h}catch(e){if(!i)throw e;return}for(s=e;s<e+n;s++)for(u=t;u<t+r;u++)c._setExpression(s,u,l,d(e,t,n,r),!1);e>=0&&t>=0&&c._source.setArrayFormula(e,t,n,r,a.unparse(c._source,l,e,t))}},getWorkingNode:function(e,t){var n,r=this,o=r._source;return e>=o.getRowCount()||t>=o.getColumnCount()?n:(e>=0&&t>=0?(n=r.getNode(e,t),n||(n=r.getNode(e,-1)),n||(n=r.getNode(-1,t))):n=e>=0&&-1===t?r.getNode(e,-1):-1===e&&t>=0?r.getNode(-1,t):r.getNode(-1,-1),n)},_setExpression:function(e,t,n,r,o){var i,a,l,s,u,c,_,f=this,d=f._getCalcServiceInternal();d._hasAsync&&d._evaluator.asyncManager.endCalcCell(),i=r!==g&&null!==r,a=new le.EvaluateContext(f._source,R(i?r.row:e,i?r.col:t),i),l=ee(a,n,i,i?e-r.row:0,i?t-r.col:0),l=l===n?g:l,r!==g&&(s=r),e>=0&&t>=0?((o===g||o)&&(u=e>=0?e:0,c=t>=0?t:0,_=n?d.unparse(f._source,n,u,c):g,f._source.setFormula(e,t,_)),f._setCellExpression(e,t,n,l,s)):e>=0&&-1===t?f._setRowExpression(e,n,l):-1===e&&t>=0&&f._setColumnExpression(t,n,l),d.autoCalculation&&!d.IsSuspended()&&d.recalculateAll(!1)},_setExpressionByName:function(e,t,n,r){var o,i=this,a=i._getCalcServiceInternal(),l=new le.EvaluateContext(i._source,R(0,0),!1),s=ee(l,t,!1,0,0);s=s===t?g:s,(r===g||r)&&(o=t?a.unparse(i._source,t,0,0):g,i._source.setFormulaByName(e,o)),i._setNameExpression(e,t,s),a.autoCalculation&&!a.IsSuspended()&&a.recalculateAll(!1)},getRowExpression:function(e){return this.getExpression(e,-1)},getColumnExpression:function(e){return this.getExpression(-1,e)},_setNameExpression:function(e,t,n){var r,o=this,i=o._getNameIDCalc(e,!0);i&&(i._stopListening(),r=this.getNodeByName(e,!0),r._expr=t,n=t&&n?n:void 0,r._workingExpr=n,i._startListening(),o._service._addDirty(i,3))},_setCellExpression:function(e,t,n,r,o){var i=this,a=i._getCellCalc(e,t,!0);a&&(i._service.onClearExpr(i._source,R(e,t)),a._stopListening(),i._setExpr(e,t,n),n?((r||i._getWorkingExpr(e,t))&&i._setWorkingExpr(e,t,r),(o||i._getArrayInfo(e,t))&&i._setArrayInfo(e,t,o)):(i._setWorkingExpr(e,t,g),i._setArrayInfo(e,t,g)),a._startListening(),i._service._addDirty(a,0))},_setRowExpression:function(e,t,n){var r=this,o=r._getRowCalc(e,!0);o&&(o._stopListening(),r._setExpr(e,-1,t),(n||r._getWorkingExpr(e,-1))&&r._setWorkingExpr(e,-1,n),o._startListening(),r._service._addDirty(o,1))},_setColumnExpression:function(e,t,n){var r=this,o=r._getColumnCalc(e,!0);o&&(o._stopListening(),r._setExpr(-1,e,t),(n||r._getWorkingExpr(-1,e))&&r._setWorkingExpr(-1,e,n),o._startListening(),r._service._addDirty(o,2))},_clear:function(e,t,n,r){var o,i,a,l,s,u=this,c=e<0?0:e,_=t<0?0:t,f=e<0?u.rC():n,p=t<0?u.cC():r,m=c+f-1,v=_+p-1,C=function(e,t){if(o=u._getWorkingExpr(e,t),i=u._getExpr(e,t),o||i){a=u.__getArrayInfo(e,t);var n=a?d(a.row,a.col,a.rowCount,a.colCount):g;u._setExpression(e,t,h,n,!0)}};for(l=c;l<=m&&l>=0;l++)for(t<0&&C(l,-1),s=_;s<=v&&s>=0;s++)l===c&&e<0&&C(-1,s),C(l,s);e<0&&t<0&&C(e,t)},_intersectWithArrayFormula:function(e,t,n,r){return this._getFormulaExps(e,t,n,r,!0,!0)},_getFormulaExps:function(e,t,n,r,o,i){var a,l,s,u,c,_,f=this,h=e<0?0:e,g=t<0?0:t,p=e<0?f.rC():n,m=t<0?f.cC():r,v=h+(0===p?1:p)-1,C=g+(0===m?1:m)-1,w=!1,y=[],S=[],x=f.dataTable;for(s=h;s<=v&&s>=0&&!(s>f._lastNonNullRow);s++)if(l=x[s])for(u=g;u<=C&&u>=0&&!(u>f._lastNonNullColumn);u++)if(a=l[u])if(c=a._arrayInfo){if(c.row<h||c.row+c.rowCount-1>v||c.col<g||c.col+c.colCount-1>C){if(o)return!0;w=!0}if(s!==c.row&&s!==h)continue;y.push(d(c.row,c.col,c.rowCount,c.colCount)),_=a._expr,S.push(_),u=c.col+c.colCount-1}else i||(_=a._expr)&&(y.push({row:s,col:u}),S.push(_));return!o&&{hasPart:w,ranges:y,formulas:S}},_getNameIDCalc:function(e,t){var n=this,r=h,o=n.getNodeByName(e,t);return o&&!(r=o.calc)&&t&&(r=new j(n,e),o.calc=r,r.node=o),r},_getCellCalc:function(e,t,n){var r,o,i,a=this,l=h;if(e>=0&&t>=0){if(r=a.dataTable,!(o=r[e])){if(!n)return l;o=r[e]={},e>a._lastNonNullRow&&(a._lastNonNullRow=e)}if(!(i=o[t]))return n&&(i=o[t]={},l=new U(a,e,t),i.calc=l,l.node=i,t>a._lastNonNullColumn&&(a._lastNonNullColumn=t)),l;l=i.calc,!l&&n&&(l=new U(a,e,t),i.calc=l,l.node=i,e>a._lastNonNullRow&&(a._lastNonNullRow=e),t>a._lastNonNullColumn&&(a._lastNonNullColumn=t))}return l},_getRowCalc:function(e,t){var n=this,r=h;return e>=0&&!(r=n._getCalc(e,-1))&&t&&(r=new Y(n,e),n._setCalc(e,-1,r),e>n._lastNonNullRow&&(n._lastNonNullRow=e)),r},_getColumnCalc:function(e,t){var n=this,r=h;return e>=0&&!(r=n._getCalc(-1,e))&&t&&(r=new G(n,e),n._setCalc(-1,e,r),e>n._lastNonNullColumn&&(n._lastNonNullColumn=e)),r},_getRangeCalc:function(e){var t=this;return!t._rangeCalc&&e&&(t._rangeCalc=new K(t)),t._rangeCalc},_getNameCalc:function(e,t){var n,r=this;return r._nameCalcs||(r._nameCalcs={}),n=r._nameCalcs[e],!n&&t&&(n=r._nameCalcs[e]=new X(r,e)),n},_addColumnsToDirty:function(e,t){var n,r,o=this,i=Math.min(o._lastNonNullColumn,e+t-1);for(n=e;-1!==n&&n<=i;n++)o.isDirty(-1,n)&&(r=o._getColumnCalc(n,!0),o._service._addDirty(r,2))},_addRowsToDirty:function(e,t){var n,r,o=this,i=Math.min(o._lastNonNullRow,e+t-1);for(n=e;-1!==n&&n<=i;n++)o.isDirty(n,-1)&&(r=o._getRowCalc(n,!0),o._service._addDirty(r,1))},_addCellsToDirty:function(e,t,n,r){var o,i,a,l,s=this,u=Math.min(s._lastNonNullRow,e+n-1),c=Math.min(s._lastNonNullColumn,t+r-1);for(o=e;o<=u;o++)for(i=t;i<=c;i++)s._containsNode(o,i)&&(a=s._getCellCalc(o,i,!0),s._service._addDirty(a,0));s._addRowsToDirty(e,n),s._addColumnsToDirty(t,r),(l=s._getRangeCalc(!1))&&l._addListenersToDirty(e,t,n,r)},_addVolatitlesToDirty:function(){var e,t,n,r,o,i=this,a=i._getAllVolatitles();for(n=0;n<a.length;n++)(r=a[n])&&r.isVolatile&&r instanceof U&&!i._service._isDirtyCell(r)&&(o=i._getCellCalc(r.row,r.column,!0),i._service._addDirty(o,0),e=i._getRowCalc(r.row,!1),e&&!i._service._isDirtyRow(e)&&i._addRowsToDirty(r.row,1),(t=i._getColumnCalc(r.column,!1))&&!i._service._isDirtyRow(t)&&i._addColumnsToDirty(r.column,1))},_checkAndUpdateVolatitles:function(){for(var e,t,n,r,o,i=this,a=i._getAllVolatitles(),l=!0,s=5;l&&s;){for(l=!1,s--,n=0;n<a.length;n++)(r=a[n])&&r.isVolatile&&r instanceof U&&!i._service._isDirtyCell(r)&&i.recalculateCell(r.row,r.column)&&(l=!0,o=i._getCellCalc(r.row,r.column,!0),i._service._addDirty(o,0),e=i._getRowCalc(r.row,!1),e&&!i._service._isDirtyRow(e)&&i._addRowsToDirty(r.row,1),(t=i._getColumnCalc(r.column,!1))&&!i._service._isDirtyRow(t)&&i._addColumnsToDirty(r.column,1));l&&i._service._recalculateImp(!0)}},isDirty:function(e,t){return!(!this._getCalc(e,t)&&!this._getExpr(e,t))},recalculateCell:function(e,t){var n,r,o,i,a,l,s,u,c,_=this,f=_._source,d=_.getWorkingExpression(e,t)||_.getExpression(e,t);if(d){if(n=R(e,t),r=f.getValue(e,t),o=!1,u=_._getArrayInfo(e,t),u&&(o=!0,i=u.row,a=u.col,l=u.rowCount,s=u.colCount),_._service._hasAsync&&_._service._evaluator.asyncManager.startCalcCell(_._source,n),c=_._service._evaluateParsedFormula(_._source,d,n,o,!0,u&&A(i,a,l,s)),r===c)return;return!(r instanceof Date&&c instanceof Date&&r.valueOf()===c.valueOf())&&(f.setValue(e,t,c,r),_._service._hasAsync&&_._service._evaluator.asyncManager.endCalcCell(_._source,n),!0)}return!1},recalculateNameID:function(e){var t,n,r=this,o=r._source,i=r.getWorkingExpressionByName(e)||r.getExpressionByName(e);if(i){if(t=o.getValueByName?o.getValueByName(e):o.getValue({name:e}),n=r._service._evaluateParsedFormula(r._source,i,{name:e},!1,!0),t===n)return;if(t instanceof Date&&n instanceof Date&&t.valueOf()===n.valueOf())return;o.setValueByName?o.setValueByName(e,n):o.setValue({name:e},n)}},_dealWithExpression:function(e,t,n,r,o,i,a){for(var l,s,u,c,_,f,d,p,m,v,C,w,y,S,x,b,T,R,A,E,F,D,V,O,H,P,L,k,B,W,z,U,Y,G=this;12===r.type;)r=r.value;for(;10===r.type;)r=r.value;for(;12===r.type;)r=r.value;if(o){for(;12===o.type;)o=o.value;for(;10===o.type;)o=o.value;for(;12===o.type;)o=o.value}if(13===r.type){if((l=r.getRange(t,n,!0))===h)return;r=1===l.rowCount&&1===l.colCount?I(h,h,l.row,l.col,!1,!1):M(h,h,l.row,l.col,l.row+l.rowCount-1,l.col+l.colCount-1,!1,!1,!1,!1)}if(o&&o!==r&&8===o.type&&(T=xe(o.value),x=o.source||a||G._source,R=x.getCustomName(T),R?b=x.getCalcSourceModel():(b=G._service.getGlobalSourceModel()||x.getCalcSourceModel(),(R=b.getSource().getCustomName(T))||(A=x.getCalcSourceModel()._getNameCalc(T,!0),A._processCellListener(e,i))),E=b._getNameCalc(T,!0),E._processCellListener(e,i),o=null,R&&G._dealWithExpression(e,t,n,R,h,i,b.getSource())),1===r.type&&r.endSource)for(F=r,D=F.source.getSources(F.endSource),V=0;V<D.length;V++)O=M(D[V],h,F.row,F.column,F.endRow,F.endColumn,F.rowRelative,F.columnRelative,F.endRowRelative,F.endColumnRelative),O.isFullRow=F.isFullRow,O.isFullColumn=F.isFullColumn,G._dealWithExpression(e,t,n,O,h,i);else if(1===r.type){if(x=r.source!==le.BangSource&&r.source||G._source,!(b=x.getCalcSourceModel()))return;if(H=r,P=e.row===g||e.column===g,L=H._getRangeType(),k=N(r,t,n),c=k.row,f=k.col,p=k.rowCount,m=k.colCount,_=c+p-1,d=f+m-1,0===L){if(0<=t&&0<=n)if(be(void 0,void 0,p,m))B=b._getRangeCalc(!0),P?B._processIDListerner(c,f,p,m,e,i):B._processCellListener(c,f,p,m,e,i);else for(y=c;y<=_;y++)for(S=f;S<=d;S++)v=b._getCellCalc(y,S,!0),P?v&&v._processIDListerner(e,i):v&&v._processCellListener(e,i);else if(0<=t&&-1===n){for(y=c;y<=_;y++)for(S=f;S<=d;S++)H.columnRelative||H.endColumnRelative?(C=b._getRowCalc(y,!0))&&C._processRowListener2(e,-S,i):(v=b._getCellCalc(y,S,!0))&&v._processRowListener(e,i)
;for(y=c;y<=_;y++)for(S=f;S<=d;S++)H.rowRelative||H.endRowRelative?(w=b._getColumnCalc(S,!0))&&w._processColumnListener2(e,-y,i):(v=b._getCellCalc(y,S,!0))&&v._processColumnListener(e,i)}}else if(1===L){if(0<=t&&0<=n)for(y=c;y<=_;y++)C=b._getRowCalc(y,!0),P?C._processIDListerner(e,i):C._processCellListener(e,i);else if(0<=t&&-1===n);else if(-1===t&&0<=n)if(H.rowRelative||H.endRowRelative);else for(c=H.row,_=H.endRow,y=c;y<=_;y++)C=b._getRowCalc(y,!0),C._processColumnListener(e,i)}else if(2===L)if(0<=t&&0<=n)for(S=f;S<=d;S++)w=b._getColumnCalc(S,!0),P?w&&w._processIDListerner(e,i):w&&w._processCellListener(e,i);else if(0<=t&&-1===n);else if(-1===t&&0<=n)for(S=f;S<=d;S++)(w=b._getColumnCalc(S,!0))&&w._processColumnListener(e,i)}else if(9===r.type)G._dealWithExpression(e,t,n,r.value,o&&9===o.type&&o.value,i),r.value2&&G._dealWithExpression(e,t,n,r.value2,o&&9===o.type&&o.value2,i);else if(8===r.type){if(x=r.source||a||G._source,T=xe(r.value),R=x.getCustomName(T),R?b=x.getCalcSourceModel():(b=G._service.getGlobalSourceModel()||x.getCalcSourceModel(),(R=b.getSource().getCustomName(T))||(A=x.getCalcSourceModel()._getNameCalc(T,!0),A._processCellListener(e,i))),!(E=b._getNameCalc(T,!0)))return;E._processCellListener(e,i),R&&G._dealWithExpression(e,t,n,R,h,i,b.getSource())}else if(7===r.type){if(W=r.function){if(W.isVolatile()&&(i?G._setVolatile(e):G._removeVolatile(e)),!W.precedentReference())return;W instanceof se.AsyncFunction&&(G._service._hasAsync=!0)}for(z=r.arguments.length,V=0;V<z;V++)G._dealWithExpression(e,t,n,r.arguments[V],o&&7===o.type&&o.arguments[V],i)}else if(25===r.type||26===r.type){if(U=r,x=r.source||G._source,b=x.getCalcSourceModel(),!(Y=b._getNameIDCalc(U.value,!0)))return;Y._processCellListener(e,i)}},_dealWithNameIDExpression:function(e,t){var n=this.getNodeByName(e);n&&(n._workingExpr||n._expr)&&this._dealWithExpression(this._getNameIDCalc(e),0,0,n._workingExpr||n._expr,n._expr,t)},_dealWithCellExpression:function(e,t,n,r,o){var i,a,l,s,u,c=this,_=e+n,f=t+r;for(s=e;s<_;s++)for(u=t;u<f;u++)i=c._getWorkingExpr(s,u),a=c._getExpr(s,u),(i||a)&&(l=c.__getArrayInfo(s,u),l?c._dealWithExpression(c._getCellCalc(s,u),l.row,l.col,i||a,a,o):c._dealWithExpression(c._getCellCalc(s,u),s,u,i||a,a,o))},_dealWithColumnExpression:function(e,t,n){var r,o,i=e+t;for(r=e;-1!==r&&r<i;r++)(o=this.getColumnExpression(r))&&this._dealWithExpression(this._getColumnCalc(r,!1),-1,r,o,o,n)},_linkCellExpression:function(e,t,n,r){this._dealWithCellExpression(e,t,n,r,!0)},_unlinkCellExpression:function(e,t,n,r){this._dealWithCellExpression(e,t,n,r,!1)},_linkRowExpression:function(e,t){},_unlinkRowExpression:function(e,t){},_linkColumnExpression:function(e,t){this._dealWithColumnExpression(e,t,!0)},_unlinkColumnExpression:function(e,t){this._dealWithColumnExpression(e,t,!1)},_iterateEachCell:function(e,t,n,r,o,i){var a,l,s,u=e+n,c=t+r;for(a=e;a<u;a++)for(l=t;l<c;l++)(s=this._getCellCalc(a,l,!1))&&(o&&s._addListenersToAdjust(),i&&s._addListenersToDirty())},_iterateEachRow:function(e,t,n,r){var o,i,a,l=this._rowDataArray;if(l)for(o=e;-1!==o&&o<e+t&&o<l.length;o++)(i=l[o])&&i.calc&&(a=i.calc,n&&a._addListenersToAdjust(),r&&a._addListenersToDirty())},_iterateEachColumn:function(e,t,n,r){var o,i,a,l=this._columnDataArray;if(l)for(o=e;-1!==o&&o<e+t&&o<l.length;o++)(i=l[o])&&i.calc&&(a=i.calc,n&&a._addListenersToAdjust(),r&&a._addListenersToDirty())},_addDependents:function(e,t,n,r,o,i){var a,l,s;(o||i)&&(a=this,0<=e&&0<=t?(a._iterateEachCell(e,t,n,r,o,i),a._iterateEachRow(e,n,o,i),a._iterateEachColumn(t,r,o,i),a._rangeCalc&&(o&&a._rangeCalc._addListenersToAdjust(e,t,n,r),i&&a._rangeCalc._addListenersToDirty(e,t,n,r))):0<=e&&-1===t?(a._iterateEachCell(e,0,n,a.cC(),o,i),a._iterateEachRow(e,n,o,i),a._rangeCalc&&(o&&a._rangeCalc._addListenersToAdjust(e,t,n,r),i&&a._rangeCalc._addListenersToDirty(e,t,n,r))):-1===e&&0<=t?(a._iterateEachCell(0,t,a.rC(),r,o,i),a._iterateEachColumn(t,r,o,i),a._rangeCalc&&(o&&a._rangeCalc._addListenersToAdjust(e,t,n,r),i&&a._rangeCalc._addListenersToDirty(e,t,n,r))):-1===e&&-1===t&&(l=a.rC(),s=a.cC(),a._iterateEachCell(0,0,l,s,o,i),a._iterateEachRow(0,l,o,i),a._iterateEachColumn(0,s,o,i),a._rangeCalc&&(o&&a._rangeCalc._addListenersToAdjust(e,t,n,r),i&&a._rangeCalc._addListenersToDirty(e,t,n,r))))},getAllNodes:function(){var e,t,n,r,o=[],i=this.dataTable,a=this._rowDataArray,l=this._columnDataArray,s=this._defaultDataNode;s&&o.push(s);for(t in a)(e=a[t])&&o.push(e);for(t in l)(e=l[t])&&o.push(e);for(n in i)if(r=i[n])for(t in r)(e=r[t])&&o.push(e);return o},toJSON:function(e){this._source.toJSON(e,this.dataTable,this._lastNonNullRow,this._lastNonNullColumn)}},H="cellListeners",P="rowListeners",L="columnListeners",k="rowSliceListeners",B="columnSliceListeners",W="nameIDListeners",z=le.BaseCalc=function(){function e(e){this.cellListeners={},this.rowListeners={},this.columnListeners={},this.nameIDListeners={},this._sourceModel=e}return e}(),z.prototype={hasListeners:function(){var e,t,n,r=this,o=r._listeners;for(e=0;e<o.length;e++)if(t=r[o[e]])for(n in t)if(t[n])return!0;return!1},_processCellListener:function(e,t){var n=this.cellListeners,r=e._sourceModel,o=null===r?"":r._source.id+",",i=o+e.row+","+e.column;n[i]=t?e:g},_processRowListener:function(e,t){var n=this.rowListeners,r=e._sourceModel,o=null===r?"":r._source.id+",",i=o+e.row+",-1";n[i]=t?e:g},_processColumnListener:function(e,t){var n=this.columnListeners,r=e._sourceModel,o=null===r?"":r._source.id+",",i=o+"-1,"+e.column;n[i]=t?e:g},_processIDListerner:function(e,t){var n,r,o,i;e instanceof j&&(n=this.nameIDListeners,r=e._sourceModel,o=null===r?"":r._source.id+",",i=o+e.name,n[i]=t?e:g)},_addListenersToAdjust:function(){var e,t,n,r,o=this._listeners;for(t=0;t<o.length;t++)if(n=this[o[t]])for(r in n)(e=n[r])&&e._addToAdjust()},_addListenersToDirty:function(){var e,t,n,r,o=this._listeners;for(t=0;t<o.length;t++)if(n=this[o[t]])for(r in n)!(e=n[r])||e._preDirty||e._nextDirty||e._addToDirty()},_adjustDelayOfListeners:function(e){var t,n,r,o,i=this._listeners,a=e?1:-1;for(n=0;n<i.length;n++)if(r=this[i[n]])for(o in r)(t=r[o])&&(t.delay+=a)},_addToAdjust:function(){},_addToDirty:function(){},_stopListening:function(){},_startListening:function(){}},U=le.CellCalc=function(e){s(t,e);function t(t,n,r){e.call(this,t);var o=this;o.row=n,o.column=r,o.delay=0,o._listeners=[H,P,L,W]}return t}(z),o(U.prototype,{_startListening:function(){var e=this;e._sourceModel._linkCellExpression(e.row,e.column,1,1)},_stopListening:function(){var e=this;e._sourceModel._unlinkCellExpression(e.row,e.column,1,1)},_addToAdjust:function(){this._sourceModel._getCalcServiceInternal()._getOperatorAdjustor()._addAdjust(this,0)},_addToDirty:function(){this._sourceModel._getCalcServiceInternal()._addDirty(this,0)}});function Te(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function Re(e,t,n){var r,o=e[t];if(o)for(r=0;r<o.length;r++)if(o[r]===n)return void o.splice(r,1)}Y=le.RowCalc=function(e){s(t,e);function t(t,n){e.call(this,t);var r=this;r.row=n,r._listeners=[H,P,k,L,W]}return t}(z),o(Y.prototype,{incrementDelay2:function(e,t){},decrementDelay2:function(e,t){},_startListening:function(){this._sourceModel._linkRowExpression(this.row,1)},_stopListening:function(){this._sourceModel._unlinkRowExpression(this.row,1)},_processRowListener2:function(e,t,n){n?Te(this,k,{row:e,columnOffset:t,columnCount:1}):Re(this,k,{row:e,columnOffset:t,columnCount:1})},_addToAdjust:function(){this._sourceModel._getCalcServiceInternal()._getOperatorAdjustor()._addAdjust(this,1)},_addToDirty:function(){this._sourceModel._getCalcServiceInternal()._addDirty(this,1)}}),G=le.ColumnCalc=function(e){s(t,e);function t(t,n){e.call(this,t);var r=this;r.column=n,r._listeners=[H,P,L,B,W]}return t}(z),o(G.prototype,{incrementDelay2:function(e,t){},decrementDelay2:function(e,t){},_startListening:function(){this._sourceModel._linkColumnExpression(this.column,1)},_stopListening:function(){this._sourceModel._unlinkColumnExpression(this.column,1)},_processColumnListener2:function(e,t,n){this._processColumnListener(e,n)},_addToAdjust:function(){this._sourceModel._getCalcServiceInternal()._getOperatorAdjustor()._addAdjust(this,2)},_addToDirty:function(){this._sourceModel._getCalcServiceInternal()._addDirty(this,2)}}),X=le.NameCalc=function(e){s(t,e);function t(t,n){e.call(this,t),this.name=n,this._listeners=[H,P,L]}return t}(z),o(X.prototype,{updateListening:function(e,t){var n,r,o,i,a,l,s,u,c=this,_=c._listeners;for(o=0;o<_.length;o++)if(i=c[_[o]]){a=[];for(l in i)(n=i[l])&&a.push(n);for(s=a.length,u=0;u<s;u++)n=a[u],r=n.node,n._stopListening(),r&&(!r._arrayInfo||r._arrayInfo.row===n.row&&r._arrayInfo.col===n.column)&&n._sourceModel._setExpression(n.row,n.column,r._expr,r._arrayInfo,!0)}},updateListeningOnRemoved:function(){var e,t,n,r,o,i,a,l,s,u,c=this,_=c._listeners,f=c._sourceModel,d=f._getCalcServiceInternal();for(i=0;i<_.length;i++)if(a=c[_[i]])for(l in a)(e=a[l])&&(t=e._sourceModel,n=e.row,r=e.col,n=n===g?-1:n,r=r===g?-1:r,o=t.getExpr(n,r),s=t._getArrayInfo(n,r),o&&(u=d._getOperatorAdjustor().adjustFormulaOnRemoveName(f,o,c.name))!==o&&t._setExpression(n,r,u,s,!0))},_addToDirty:function(){var e,t,n,r,o=this._listeners;for(t=0;t<o.length;t++)if(n=this[o[t]])for(r in n)(e=n[r])&&e._addToDirty()}}),j=le.NameIDCalc=function(e){s(t,e);function t(t,n){e.call(this,t);var r=this;r.name=n,r.delay=0,r._listeners=[H,P,L,W]}return t}(z),o(j.prototype,{_startListening:function(){var e=this;e._sourceModel._dealWithNameIDExpression(e.name,!0)},_stopListening:function(){var e=this;e._sourceModel._dealWithNameIDExpression(e.name,!1)},_addToAdjust:function(){this._sourceModel._getCalcServiceInternal()._getOperatorAdjustor()._addAdjust(this,3)},_addToDirty:function(){this._sourceModel._getCalcServiceInternal()._addDirty(this,3)}}),K=le.RangeCalc=function(){function e(e){this._sourceModel=e,this._listeners=[H,P,L,W]}return e}(),o(K.prototype,{processListener:function(e,t,n,r,o,i,a){var l,s,u=this,c=u[e],_=t+","+n+","+r+","+o;if(e!==W||i instanceof j){if(c||(u[e]=c={}),!(l=c[_])){if(!a)return;l=c[_]=[],l.row=t,l.col=n,l.rowCount=r,l.colCount=o}if(a){for(s=0;s<l.length;s++)if(l[s]===i)return;l.push(i)}else for(s=0;s<l.length;s++)l[s]===i&&l.splice(s,1)}},_processCellListener:function(e,t,n,r,o,i){this.processListener(H,e,t,n,r,o,i)},_processRowListener:function(e,t,n,r,o,i,a,l,s){this.processListener(P,e,t,n,r,o,s)},_processColumnListener:function(e,t,n,r,o,i,a,l,s){this.processListener(L,e,t,n,r,o,s)},_processIDListerner:function(e,t,n,r,o,i){this.processListener(W,e,t,n,r,o,i)},_addListenersToAdjust:function(e,t,n,r){this.visit(0,e,t,n,r)},visit:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p=this._listeners;for(l=0;l<p.length;l++)if(s=this[p[l]])for(a in s)if((u=s[a])&&(c=u.row,_=u.col,f=u.rowCount,d=u.colCount,(-1===c||-1===t||c<t+r&&t<c+f)&&(-1===_||-1===n||_<n+o&&n<_+d)))for(h=u.length,g=0;g<h;g++)i=u[g],0===e?i._addToAdjust():i._addToDirty()},_addListenersToDirty:function(e,t,n,r){this.visit(1,e,t,n,r)},_adjustDelayOfListeners:function(e,t,n){var r,o,i,a,l,s,u,c=this._listeners,_=n?1:-1;for(o=0;o<c.length;o++)if(i=this[c[o]])for(a in i)if(l=i[a],(r=l)&&(-1===r.row||r.row<=e&&e<r.row+r.rowCount)&&(-1===r.col||r.col<=t&&t<r.col+r.colCount))for(s=l.length,u=0;u<s;u++)l[u].delay+=_},_startListening:function(){},_stopListening:function(){}}),Z=le.CalcService=function(){function e(){var e=this;e._sourceModels={},e.autoCalculation=!0,e.maximumIterations=1e3,e.maximumChange=.01,e._parser=new le.Parser,e._evaluator=new le.Evaluator(e),e.useR1C1=!1,e._suspended=0,e._adjustSuspended=0,e._operatorAdjustor=le.CalcOperatorAdjustor&&new le.CalcOperatorAdjustor}return e}(),Z.prototype={dispose:function(){var e=this;e._sourceModels={},e._globalSourceModel=h},cloneFrom:function(e){var t=this;t.useR1C1=e.useR1C1,t._suspended=e._suspended,t._ignoreDirty=e._ignoreDirty},_getOperatorAdjustor:function(){return this._operatorAdjustor},getSourceModel:function(e){var t=this._sourceModels[e.id];return t||(t=this._sourceModels[e.id]=new O(this,e),e.setCalcSourceModel(t),e.setCalcService(this)),t},getGlobalSourceModel:function(e){return this._globalSourceModel||(e=e||new V,this._globalSourceModel=new O(this,e),e.setCalcSourceModel(this._globalSourceModel)),this._globalSourceModel},setSourceModel:function(e,t){this._sourceModels[e.id]=t,t.setCalcService(this)},getAllSouceModels:function(){var e,t=[],n=this._sourceModels;for(e in n)t.push(n[e]);return t},removeSource:function(e){this._sourceModels[e.id]&&(this._operatorAdjustor._adjustFormulasOnRemoveSheet(e),delete this._sourceModels[e.id])},clearSource:function(){this._sourceModels={},this.clearDirties()},ignoreDirty:function(){return this._ignoreDirty},suspend:function(e){this._suspended++,this._ignoreDirty=!!e||e},resume:function(e){var t=this;t._suspended--,t._suspended<0&&(t._suspended=0),t.IsSuspended()||(t._parseCache=h,t._ignoreDirty=!1,t.recalculateAll(e))},suspendAdjust:function(){this._adjustSuspended++},resumeAdjust:function(){var e=this;--e._adjustSuspended<0&&(e._adjustSuspended=0)},isAdjustSuspended:function(){return this._adjustSuspended>0},clearDirties:function(){var e,t,n,r=this,o=[r._head,r._headRows,r._headCols,r._headNamIDs];for(n=0;n<o.length;n++)for(e=o[n];e;)t=e._nextDirty,t?(e._nextDirty=t._preDirty=g,e=t):e=h;r._head=r._tail=r._headRows=r._tailRows=r._headCols=r._tailCols=r._headNamIDs=r._tailNameIDs=h},resumeWithoutCalc:function(){this._suspended=0,this.clearDirties()},IsSuspended:function(){return this._suspended>0},recalculate:function(e,t,n,r){var o=this.getSourceModel(e);-1===n?o._addCellsToDirty(t,0,1,o.cC()):-1===t?o._addCellsToDirty(0,n,o.rC(),1):o._addCellsToDirty(t,n,1,1),this.IsSuspended()||this.recalculateAll(!1,r)},recalculateByName:function(e,t){var n,r;t&&(n=this.getSourceModel(e),r=n._getNameIDCalc(xe(t),!0),this._addDirty(r,3),this.IsSuspended()||this.recalculateAll(!1))},recalcRange:function(e,t,n,r,o){var i=this.getSourceModel(e);-1===n?i._addCellsToDirty(t,0,r,i.cC()):-1===t?i._addCellsToDirty(0,n,i.rC(),o):i._addCellsToDirty(t,n,r,o),this.IsSuspended()||this.recalculateAll(!1)},recalculateAll:function(e,t){var n,r,o,i,a,l=this;if(!l.IsSuspended()){t||l._evaluator.startCache(),r=l._sourceModels;for(o in r)n=r[o],n.getSource().startCalculation(),!1!==e?(i=n.cC(),a=n.rC(),n._addColumnsToDirty(0,i),n._addRowsToDirty(0,a),n._addCellsToDirty(0,0,a,i)):t||n._addVolatitlesToDirty();if(l._recalculateImp(),!t)for(o in r)n=r[o],n._checkAndUpdateVolatitles();for(o in r)n=r[o],n.getSource().endCalculation();t||l._evaluator.endCache()}},_cacheHeadDirtyColumns:function(e,t){for(var n=e.length,r=t;r;)e[n]=r,n++,r=r._nextDirty},_recalculateImp:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,p,m,v,C,w,y,S,x,b,T,R,A,I;if(void 0===e&&(e=!0),t=this,r=!1,e){for(p=[],t._headCols&&t._cacheHeadDirtyColumns(p,t._headCols);t._headRows;){for(o=t._headRows._sourceModel,c=o.cC(),a=0;a<c;a++)t._addDirty(o._getCellCalc(t._headRows.row,a,!0),0);t._removeDirty(t._headRows,1)}for(;t._headCols;){if(o=t._headCols._sourceModel,(u=o.rC())>0)for(i=0;i<u;i++)t._addDirty(o._getCellCalc(i,t._headCols.column,!0),0);else t._headCols._addListenersToDirty();t._removeDirty(t._headCols,2)}for(_=t._head;_;_=_._nextDirty){for(o=_._sourceModel,l=_.row,s=_.column,f=o._getRowCalc(l,!1),d=o._getColumnCalc(s,!1),h=o._getRangeCalc(!1),_._addListenersToDirty(),f&&f._addListenersToDirty(),d&&d._addListenersToDirty(),h&&h._addListenersToDirty(l,s,1,1);t._headRows;){for(o=t._headRows._sourceModel,c=o.cC(),a=0;a<c;a++)t._addDirty(o._getCellCalc(t._headRows.row,a,!0),0);t._removeDirty(t._headRows,1)}for(;t._headCols;){for(m=!1,v=0;v<p.length;v++)if(p[v]===t._headCols){m=!0;break}if(m)t._removeDirty(t._headCols,2);else{for(p[p.length]=t._headCols,o=t._headCols._sourceModel,u=o.rC(),i=0;i<u;i++)t._addDirty(o._getCellCalc(i,t._headCols.column,!0),0);t._removeDirty(t._headCols,2)}}}for(C=t._headNamIDs;C;C=C._nextDirty)C._addListenersToDirty()}for(_=t._head;_;_=n)o=_._sourceModel,w=o.rC(),y=o.cC(),n=_._nextDirty,_.row<w&&_.column<y?(le.supportRowColumnFormula&&(d=o._getColumnCalc(_.column,!1))&&(d.delay=0),_.delay=0):t._removeDirty(_,0);for(C=t._headNamIDs;C;C=C._nextDirty)C.delay=0;for(_=t._head;_;_=_._nextDirty)o=_._sourceModel,i=_.row,a=_.column,f=o._getRowCalc(i,!1),d=o._getColumnCalc(a,!1),h=o._getRangeCalc(!1),_._adjustDelayOfListeners(!0),f&&f._adjustDelayOfListeners(!0),d&&d._adjustDelayOfListeners(!0),h&&h._adjustDelayOfListeners(i,a,!0);for(C=t._headNamIDs;C;C=C._nextDirty)C._adjustDelayOfListeners(!0);do{for(r=!1,_=t._head;_;_=n)if(n=_._nextDirty,0===_.delay){if(o=_._sourceModel,i=_.row,a=_.column,f=o._getRowCalc(i,!1),(d=o._getColumnCalc(a,!1))&&d.delay)continue;h=o._getRangeCalc(!1),o.recalculateCell(i,a),t._removeDirty(_,0),_._adjustDelayOfListeners(!1),f&&f._adjustDelayOfListeners(!1),d&&d._adjustDelayOfListeners(!1),h&&h._adjustDelayOfListeners(i,a,!1),r=!0}for(C=t._headNamIDs;C;C=C._nextDirty)0===C.delay&&(o=C._sourceModel,o.recalculateNameID(C.name),t._removeDirty(C,3),C._adjustDelayOfListeners(!1),r=!0)}while(r);if(t._head){S=!0;for(x in t._sourceModels)b=t._sourceModels[x],T=b.getSource(),T.clearValueCache&&T.clearValueCache();for(v=0;S&&v<t.maximumIterations;v++)for(S=!1,_=t._head;_;_=n)n=_._nextDirty,R=_._sourceModel,i=_.row,a=_.column,A=R.getSource().getValue(i,a),R.recalculateCell(i,a),I=R.getSource().getValue(i,a),t._iterationChange(A,I)>=t.maximumChange&&(S=!0);for(_=t._head;_;_=n)n=_._nextDirty,_._nextDirty=g,n&&(n._preDirty=g);t._head=t._tail=g}},_iterationChange:function(e,t){var n,r;return e=e||0,t=t||0,n=parseFloat(e),r=parseFloat(t),p(r-n)},initParserContext:function(e){this._parserContext||(this._parserContext=e.getParserContext(this.useR1C1))},getParserContext:function(e){var t=this,n=t._parserContext;return n||(e?t._parserContext=n=e.getParserContext(t.useR1C1):n=new le.ParserContext(h,t.useR1C1,R(0,0),h)),n.setSource(e),n},parse:function(e,t,n,r,o,i,a){var l,s,u=this,c=u._parseCache,_=u.getParserContext(e);return _.useR1C1=!a&&u.useR1C1,_.ignoreError=i,_.row=n,_.column=r,_.culture=o,c?(_.useR1C1||(_.useR1C1=!0,t=u._parser.a1ToR1C1(_,t)),(l=c[t])?l:(s=u._parser.parse(_,t),c[t]=s,s)):u._parser.parse(_,t)},unparse:function(e,t,n,r,o,i){var a,l=this.getParserContext(e);return l.useR1C1=this.useR1C1,l.row=n,l.column=r,l.culture=o,i&&(l._toStandard=!0,l.useR1C1=!1),a=this._parser.unparse(l,t),l._toStandard=!1,a},_isDirtyCell:function(e){return!!e._preDirty||e===this._head},_addDirty:function(e,t){var n=this,r,o;if(0===t)r=n._head,o=n._tail;else if(1===t)r=n._headRows,o=n._tailRows;else if(2===t)r=n._headCols,o=n._tailCols;else{if(3!==t)return;r=n._headNamIDs,o=n._tailNameIDs}e&&!e._preDirty&&e!==r&&(r?o._nextDirty=e:0===t?n._head=e:1===t?n._headRows=e:2===t?n._headCols=e:n._headNamIDs=e,e._preDirty=o,e._nextDirty=h,0===t?n._tail=e:1===t?n._tailRows=e:2===t?n._tailCols=e:n._tailNameIDs=e)},_removeDirty:function(e,t){var n,r,o,i=this;if(0===t)n=i._head;else if(1===t)n=i._headRows;else if(2===t)n=i._headCols;else{if(3!==t)return;n=i._headNamIDs}e&&(e._preDirty||e===n)&&(r=e._preDirty,o=e._nextDirty,r?r._nextDirty=o:0===t?i._head=o:1===t?i._headRows=o:2===t?i._headCols=o:i._headNamIDs=o,o?o._preDirty=r:0===t?i._tail=r:1===t?i._tailRows=r:2===t?i._tailCols=r:i._tailNameIDs=r,e._preDirty=h,e._nextDirty=h)},_isDirtyRow:function(e){return e._preDirty||e===this._headRows},isDirtyColumn:function(e){return e._preDirty||e===this._headCols},_evaluateParsedFormula:function(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,p=n.row||0,m=n.col||0,v=i?i.row:p,C=i?i.col:m,w=e.getEvaluatorContext(n,r,i),S=4===arguments.length&&r,x=this._evaluator.evaluateExpression(t,w,o,S,S);if(r&&arguments.length<=5)return x;if(Fe._isReference(x)){if(a=x.getRowCount(0),l=x.getColumnCount(0),1!==x.getRangeCount())return y;try{if(s=r?p-v:p-x.getRow(0),u=r?m-C:m-x.getColumn(0),c=R(0,0),1===a&&1===l);else if(1===a&&l>1&&u>=0&&u<l)c.col=u;else if(a>1&&1===l&&s>=0&&s<a)c.row=s;else{if(!(r&&s<a&&u<l))return r?b:y;c.row=s,c.col=u}x=x.getValue(c,0)}catch(e){return y}}else if(Fe._isArray(x))if(r){if(_=x,f=_.getRowCount(),d=_.getColumnCount(),1!==f&&p-v>=f||1!==d&&m-C>=d)return b;x=x.getValue(1===f?0:p-v,1===d?0:m-C)}else x=x.getValueByIndex(0);return x===g||x===h?!1===o?x:0:x},_getParserContext:function(e,t,n){var r=this,o=r._parserContext;return o||(r._parserContext=o=e.getParserContext(r.useR1C1)),o.useR1C1=r.useR1C1,o.row=t,o.column=n,o},evaluate:function(e,t,n,r){var o=this,i=t instanceof D?t:o.parse(e,t,n,r);return o._evaluator.evaluateExpression(i,e.getEvaluatorContext(R(n,r),!1),!1)},onClearExpr:function(e,t){this._evaluator&&this._evaluator.asyncManager.clearCell(e,t)}},J=le._createErrorExpression=function(e,t,n){var r=new D(5);return t&&(r.source=t),n&&(r.endSource=n),r.value=e,r},le._referenceErrorExpr=J(S),q=le._createFunctionExpression=function(e,t){var n=new D(7);return n.arguments=t,e instanceof D?(n.function=e.function,n.functionName=e.functionName):(n.function=e.name&&e,n.functionName=e.name||e),n};function Ae(e,t){var n=new D(12);return n.value=e,n.needExpendIndexs=t,n}Q=le._createOperatorExpression=function(e,t,n){var r=new D(9);return r.operatorType=e,r.value=t,r.value2=n,r},$=le._createParenthesesExpression=function(e){var t=new D(10);return t.value=e,t};function Ie(e){var t=new D(3);return t.value=e,t}function Me(e){var t=new D(2);return t.value=e,t}function Ee(e,t,n,r,o){return{expr:e,acceptsArray:t,acceptsRef:n,index:r,context:o}}ee=le._mappingArray=function(e,t,n,r,o,s,u){var c,_,f,d,g,p,m,v,C,w,S,T,A,E,F,D,N,V,O,H,P,L,k,B,W,z,U,Y,G,X,j,K,Z,ee,te,ne,re,oe,ie,ae,se=e.row,ue=e.column,ce=[],_e=0,fe=e.arrayIdentity?e.arrayIdentity.row:se,de=e.arrayIdentity?e.arrayIdentity.col:ue;for(ce[_e]={expr:t,acceptsArray:s||!1,acceptsRef:u||!1,index:-1},c=0,_=0,f=!1,d=r,g=o,p=!1;_e>=0;){if(m=ce[_e--],v=m.acceptsArray,C=m.acceptsRef,t=m.expr,w=h,t){if(7===t.type){if(T=t,E=T.arguments.length,!T.function){if(!e){w=J(x);continue}T.function=e.getFunction(T.functionName)}if(A=T.function,F=m.index,D=m.neeedExpendindexs,F<0?(m.arrayArgumentEvaluateMode=p,m.arrayFormulaCatchValue=n,A&&A.arrayArgumentEvaluateMode&&(p=A.arrayArgumentEvaluateMode),m.args=[]):(A&&A.acceptsArray(F)?c--:f&&(D||(D=[],m.neeedExpendindexs=D),T.arguments[F],D.push(F)),m.args.push(S)),F===E-1){if(p=m.arrayArgumentEvaluateMode,n=m.arrayFormulaCatchValue,N=m.args,V=!1,N&&N.length>0)for(O=0;O<N.length;O++)if(N[O]!==T.arguments[O]){V=!0;break}w=V?q(T,N):t,D&&D.length>0&&(w=Ae(w,D),f=!0),C&&v||!A||!A.returnReference||!A.returnReference()||(f=!0)}else 0===F&&A&&3===A.arrayArgumentEvaluateMode&&3===p&&(p=0),f=!1,F++,m.index=F,A&&A.acceptsArray(F)&&c++,ce[++_e]=m,ce[++_e]={expr:T.arguments[F],acceptsArray:!!A&&A.acceptsArray(F),acceptsRef:!!A&&A.acceptsReference(F),index:-1}}else if(1===t.type&&t._isCell)_&&(H=t.source!==le.BangSource&&t.source||e.source,P=H.getRowCount(),L=H.getColumnCount(),k=t.rowRelative?(t.row+fe)%a%P:t.row,B=t.columnRelative?(t.column+de)%l%L:t.column,k=k<0?k+P:k,B=B<0?B+L:B,t=I(t.source&&H,h,k,B,!1,!1));else if(1===t.type||13===t.type){if(13===t.type){if(W=t,!(z=W.getRange(se,ue))){w=t,S=t;continue}t=M(W.source()===e.source?h:W.source(),h,z.row,z.col,z.row+z.rowCount-1,z.col+z.colCount-1)}U=t.source!==le.BangSource&&t.source,Y=t,_&&(H=U||e.source,P=a,L=l,G=Y.rowRelative?(Y.row+fe)%P:Y.row,X=Y.columnRelative?(Y.column+de)%L:Y.column,j=Y.endRowRelative?(Y.endRow+fe)%P:Y.endRow,K=Y.endColumnRelative?(Y.endColumn+de)%L:Y.endColumn,G=G<0?G+P:G,X=X<0?X+L:X,j=j<0?j+P:j,K=K<0?K+L:K,G>j&&(Z=G,G=j,j=Z),X>K&&(Z=X,X=K,K=Z),P=H.getRowCount(),L=H.getColumnCount(),G>=P?(G%=P,j%=P):j>=P&&(j=P-1),X>=L?(X%=L,K%=L):K>=L&&(K=L-1),t.row===i&&(G=j=i),t.column===i&&(X=K=i),t=M(U,t.endSource,G,X,j,K,!1,!1,!1,!1)),C&&(v||!n&&1!==p&&3!==p)||se<0||ue<0||(c>0&&!n&&1!==p&&3!==p||0===c||2===p?(z=Y.getRange(se,ue),n||(C||v)&&1===p?!Y.isFullColumn&&1!==z.rowCount&&d>=z.rowCount||!Y.isFullRow&&1!==z.colCount&&g>=z.colCount?w=J(b):(k=(Y.isFullColumn?0:z.row)+(1===z.rowCount?0:d),B=(Y.isFullRow?0:z.col)+(1===z.colCount?0:g),w=I(U,t.endSource,k,B,!1,!1)):z.rowCount>1&&z.colCount>1||z.rowCount>1&&!Y.isFullColumn&&(se<z.row||se>=z.row+z.rowCount)||z.colCount>1&&!Y.isFullRow&&(ue<z.col||ue>=z.col+z.colCount)?w=J(y):(k=Y.isFullColumn||z.rowCount>1?se:z.row,B=Y.isFullRow||z.colCount>1?ue:z.col,w=I(U,t.endSource,k,B,!1,!1))):f=!0)}else if(9===t.type)ee=t.operatorType>=15,-1===m.index?(m.index=t.value2?0:1,ce[++_e]=m,ce[++_e]=Ee(t.value,ee,ee,-1)):0===m.index?(S!==t.value&&(w=Q(t.operatorType,S,t.value2),m.expr=w),f&&(D=[],D.push(0),m.neeedExpendindexs=D,f=!1),m.index=1,ce[++_e]=m,ce[++_e]=Ee(t.value2,ee,ee,-1)):(w=t.value2&&S!==t.value2?Q(t.operatorType,t.value,S):t,D=m.neeedExpendindexs,f&&(D||(D=[]),D.push(1)),D&&(w=Ae(w,D),f=!0));else if(10===t.type)-1===m.index?(m.index=0,ce[++_e]=m,ce[++_e]=Ee(t.value,v,C,-1)):t.value!==S&&(w=$(S));else if(8===t.type)1===m.index?(_--,w=S,m.context&&(e=m.context)):(_++,ce[++_e]=Ee(t,v,C,1,e),ne=e,t.source?(re=t.source===le.BangSource?e.source:t.source,ne=new le.EvaluateContext(re),ne.cloneFrom(e),te=re.getCustomName(t.value)):(te=e.getName(t.value),e.source.getCustomName(t.value)||(ne=new le.GloableEvaluateContext(e.source),ne.cloneFrom(e))),te||(te=J(x)),e=ne||e,ce[++_e]=Ee(te,v,C,-1,e));else if(6===t.type)if(oe=t,!v&&(c>0||n||1===p||3===p))f=!0;else if(!v&&0===c)if(d>=oe.value.RowCount&&oe.value.RowCount>1||g>=oe.value.colCount&&oe.value.colCount>1)w=J(b);else try{1===oe.value.RowCount&&(d=0),1===oe.value.colCount&&(g=0),ie=oe.value.getValue(d,g),"string"==typeof ie?w=Ie(ie):"number"==typeof ie&&(w=Me(ie)),ae=new le.Parser,w=ae.parse(e.source.getParserContext(e.useR1C1,R(0,0)),""+oe.value.getValue(d,g))}catch(e){w=J(b)}}else;w===h?w=t:w!==t&&(V=!0),S=w}return w};function Fe(){}function De(e,t){return typeof e===ue||e instanceof Date||!t&&(typeof e===_e||!isNaN(e)&&!isNaN(parseFloat(e)))}Fe._isNumber=De;function Ne(e){return e instanceof C}Fe._isError=Ne;function Ve(e){return Ne(e)&&e._code===Se[5]}Fe._isNotAvailableError=Ve;function Oe(e){return e instanceof E}Fe._isArray=Oe;function He(e){return e instanceof F}Fe._isReference=He;function Pe(e){return isNaN(e)||!isFinite(e)?T:e}Fe._toResult=Pe;function Le(e,t,n,o,i,a){var l,s,u;if(e&&e.length&&e.rowCount&&e.colCount)return e;if(Oe(e))l=e.toArray(t,n,o,i,a),l.isArray=!0;else if(He(e))l=e.toArray(t,n,o,i,a),l.isReference=!0;else if(r(e)&&e.length>0){if(l=[],r(e[0]))return Fe._convertArray(e,t,!0);for(s=0;s<e.length;s++)u=ke(e[s],t,!1),u===Fe.CalcConvertedError&&(l.isConvertError=!0),l.push(u);l.rowCount=1,l.colCount=e.length,l.rangeCount=1}else e=ke(e,t,!0),o&&Ne(e)?(l=[y],l.isError=!0):e===Fe.CalcConvertedError?(l=[Fe.CalcConvertedError],l.isConvertError=!0):n?(l=[],l.push(e)):(l=[[]],l[0].push(e)),l.rowCount=1,l.colCount=1,l.rangeCount=1;return l}Fe._toArray=Le;function ke(e,t,n,r){var o,i,a;if(Ne(e))return e;if(o={value:h},i=Fe.CalcConvertedError,r&&0!==t&&(e===h||e===g||""===e))return i;switch(t){case 1:case 5:n&&5!==t?e=Ge(e,o)?o.value:i:typeof e===ue||(e=e instanceof Date?u._toOADate(e):i);break;case 4:typeof e===ce?(a=ae._DateTimeHelper._parseLocale(e),e=a!==g&&a!==h?u._toOADate(a):i):n?e=Ge(e,o)?o.value:i:typeof e===ue||e instanceof Date||(e=i);break;case 3:n?e=Ge(e,o)?o.value:i:typeof e!==_e&&(e=i);break;case 2:e=e===h||e===g?"":""+e}return e}Fe._convertValue=ke;function Be(e,t,n){var r,o,i,a,l,s,u,c,_,d,p,m,v;if(!e||!e.length||!e[0].length)return r=[],r.isError=!0,[[y]];if(0===t)return e;if(o=f[t],i=e.length,a=e[0].length,c={value:h},_=!1,d=!1,p=Fe.CalcConvertedError,!(r=e[o]))for(r=[],e[o]=r,m=0;m<i;m++)for(l=e[m],s=r[m]=[],v=0;v<a;v++)if(u=l[v],Ne(u))_||(r.isError=!0,_=!0),s.push(u);else{switch(t){case 1:case 5:n&&5!==t?Ge(u,c)?u=c.value:(d||(d=!0,r.isConvertError=!0),u=0):typeof u===ue||u instanceof Date||(d||(d=!0,r.isConvertError=!0),u=p);break;case 3:n?Xe(u,c)?u=c.value:(d||(d=!0,r.isConvertError=!0),u=!1):typeof u!==_e&&(d||(d=!0,r.isConvertError=!0),u=p);break;case 2:u=u===h||u===g?"":""+u}s.push(u)}return r}Fe._convertArray=Be;function We(e){return isNaN(e)||!isFinite(e)}Fe._isNaNOrInfinite=We;function ze(e){var t=Ye(e);if(p(t)<1e21)return parseInt(t,10);throw _().Exp_InvalidCast}Fe._toInt=ze;function Ue(e,t){return!!Ge(e,t)&&p(t.value)<1e21&&(t.value=parseInt(t.value,10),!0)}Fe._tryToInt=Ue;function Ye(e){var t={value:0};if(Ge(e,t))return t.value;throw _().Exp_InvalidCast}Fe._toDouble=Ye,te={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12};function Ge(e,t){var n,r,o,i,a,l,s=h;if(!e)return t.value=0,!0;n=typeof e;try{if(n===ue)s=e;else if(n===ce){if(e=e.trim(),0===e.length)return t.value=0,!0;if(r=le.Parser.numberDecimalSeparator,o=le.Parser.numberGroupSeparator,"."!==r&&"."!==o&&e.indexOf(".")>=0||","!==r&&","!==o&&e.indexOf(",")>=0)return!1;if(i=!1,"%"===e.charAt(e.length-1)&&(i=!0,e=e.substr(0,e.length-1)),"$"===e[0])return!1;if(e.indexOf(r)!==e.lastIndexOf(r))return!1;if(e.length>=2&&"0"===e[0]&&"x"===e[1])return!1;if(s=(+e).valueOf(),Fe._isNaNOrInfinite(s)){if(a=e.charCodeAt(0),a|=32,e.length>4&&a>=96&&a<=122&&(l=e[0]+e[1]+e[2],l=l.toUpperCase(),!te[l]))return!1;if("/"===e[0]||"/"===e[e.length-1])return!1;if(s=new Date(e),Fe._isNaNOrInfinite(s.valueOf()))return!1;s=u._toOADate(s)}i&&(s/=100)}else if(n===_e)s=e?1:0;else{if(!(e instanceof Date))return!1;s=u._toOADate(e)}}catch(e){return!1}return t.value=s,!0}Fe._tryToDouble=Ge;function Xe(e,t){try{if(e)if(typeof e===_e);else if(e instanceof Date)e=0!==u._toOADate(e);else{if(!De(e))return!1;e=0!==e}else e=!1}catch(e){return!1}return t.value=e,!0}Fe._tryToBool=Xe;function je(e){if(!e)return!1;if(typeof e===_e)return e;if(e instanceof Date)return 0!==u._toOADate(e);if(De(e))return 0!==e;if(Ne(e))return!1;throw _().Exp_InvalidCast}Fe._toBool=je;function Ke(e){try{if(e===g||e===h)return"";if(typeof e===_e)return e?fe:de;if(typeof e===ce)return e;if(e instanceof Date)return""+u._toOADate(e);if(Oe(e))throw _().Exp_InvalidCast;return""+e}catch(e){throw _().Exp_InvalidCast}}Fe._toString=Ke;function Ze(e){var t={value:h};if(Je(e,t))return t.value;throw _().Exp_InvalidCast}Fe._toDateTime=Ze;function Je(e,t){var n,r,o,i;if(e)if(e instanceof Date)t.value=new Date(e);else if(typeof e===ce){if(!(n=ae._DateTimeHelper._parseLocale(e)))if(isNaN(e)){if(n=new Date(e),isNaN(n.valueOf()))return!1;try{if(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,o=c._trimEnd(c._trimStart(e.replace(/ |\n/g,"")," ")," "),(i=r.exec(o))&&4===i.length&&(-1===i.indexOf(""+n.getYear())||-1===i.indexOf(""+n.getMonth())||-1===i.indexOf(""+n.getDate())))return!1}catch(e){return!1}}else if(!(n=ae._DateTimeHelper._fromOADate(parseFloat(e))))return!1;t.value=n}else{if(typeof e!==ue)return!1;t.value=ae._DateTimeHelper._fromOADate(e)}else t.value=ae._DateTimeHelper._fromOADate(0);return!0}Fe._tryToDateTime=Je,Fe.CalcConvertedError={},le.Convert=Fe,ne=function(){function e(){}return e._approxEqual=function(e,t){var n=16777216;return e===t||p(e-t)<p(e)/(n*n)},e.getArrayValue=function(e,t,n){return e?t<e.getRowCount()&&n<e.getColumnCount()?e.getValue(t,n):n>=e.getColumnCount()&&1===e.getColumnCount()&&t<e.getRowCount()?e.getValue(t,0):t>=e.getRowCount()&&1===e.getColumnCount()&&n<e.getColumnCount()?e.getValue(0,n):y:y},e.tryExtractToSingleValue=function(e){var t,n=!0;return(He(e)||Oe(e))&&(t=Le(e,0,!1,!0),t.isError?e=t[0]:1===t.rowCount&&1===t.colCount?e=t[0][0]:(e=t,n=!1)),{value:e,success:n}},e}(),le._Helper=ne,re=function(){function e(){}return e.getLength=function(e,t){return Oe(e)?e.getRowCount()*e.getColumnCount():He(e)?(t=t||0,e.getRowCount(t)*e.getColumnCount(t)):void 0},e.getRowCount=function(e,t){return Oe(e)?e.getRowCount():He(e)?(t=t||0,e.getRowCount(t)):void 0},e.getColumnCount=function(e,t){return Oe(e)?e.getColumnCount():He(e)?(t=t||0,e.getColumnCount(t)):void 0},e.getValueByIndex=function(e,t,n){if(Oe(e))return e.getValueByIndex(t);if(He(e)){n=n||0;var r=e.getColumnCount(n);return e.getValue(n,parseInt(t/r,10),t%r)}},e.getValue=function(e,t,n,r){return Oe(e)?e.getValue(t,n):He(e)?(r=r||0,e.getValue(r,t,n)):void 0},e}(),le.CalcArrayHelper=re,function(e){
e[e.normal=0]="normal",e[e.allwaysExpand=1]="allwaysExpand",e[e.neverExpand=2]="neverExpand"}(se.ArrayArgumentEvaluateMode||(se.ArrayArgumentEvaluateMode={})),oe=function(){function e(e,t,n,r){var o=this,i=arguments.length;o.name=e,o.minArgs=i<2?0:t,o.maxArgs=i<3?0:n,o._description=r,o.typeName=""}return e.prototype={description:function(){var e=this,t=_()._builtInFunctionsResource;return e._description?e._description:t&&t[e.name]},acceptsArray:function(e){return!1},acceptsReference:function(e){return!1},acceptsError:function(e){return!1},acceptsMissingArgument:function(e){return!1},isVolatile:function(){return!1},isContextSensitive:function(){return!1},isBranch:function(){return!1},findTestArgument:function(){return-1},findBranchArgument:function(e){return-1},expandRows:function(){return!0},expandColumns:function(){return!0},precedentReference:function(){return!0},returnReference:function(){return!1},evaluate:function(e){},evaluateWithContext:function(e,t){var n=this,r=t;return n.isContextSensitive()&&(r=t.slice(),r.unshift(e)),n.evaluate.apply(n,r)},toJSON:function(){var e,t={};for(e in this)this.hasOwnProperty(e)&&(t[e]=this[e]);return t},fromJSON:function(e){if(e)for(var t in e)e[t]!==g&&(this[t]=e[t])}},e._create=function(e,t,n){var r,o=new se.Function(e,0,255);if(t&&"function"==typeof t&&(o.evaluate=t),n)for(r in n)n.hasOwnProperty(r)&&"override"!==r&&(o[r]=n[r]);return o},e}(),se.Function=oe,ie=function(e){s(t,e);function t(t,n,r,o){e.call(this,t,n,r,o)}return t}(oe),o(ie.prototype,{isContextSensitive:function(){return!0},evaluate:function(e,t){return this.evaluateAsync.apply(self,arguments)},evaluateAsync:function(e,t){self.evaluate.apply(self,arguments)},defaultValue:function(){return 0},evaluateMode:function(){return 0},evaluateWhenArgumentsIsSame:function(){return!0},interval:function(){return 1e4}}),se.AsyncFunction=ie,se.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},se._builtInFunctions={},se._customFunctions={};function qe(e,t){return se._customFunctions[xe(e)]=t,t}se.defineGlobalCustomFunction=qe;function Qe(e){if(!e)return et();e=xe(e);var t=se._builtInFunctions,n=se._customFunctions;return t&&t[e]||n&&n[e]}se.findGlobalFunction=Qe;function $e(e){if(!e)return se._builtInFunctions={},void(se._customFunctions={});e=xe(e);var t=se._builtInFunctions,n=se._customFunctions;t[e]?delete t[e]:n[e]&&delete n[e]}se.removeGlobalFunction=$e;function et(){var e,t=se._builtInFunctions,n=se._customFunctions,r=[];for(e in t)r.push(t[e]);for(e in n)r.push(n[e]);return r}e.exports=le}()},function(e,t){e.exports=GC.Spread.Common},function(e,t,n){!function(){"use strict";var e,t,r,o,i,a,l,s,u,c,_,f,d,h,g,p=n(2),m=n(1),v=p._Types._inherit,C=p._Types._extend,w=void 0,y=null,S="string",x="boolean",b="TRUE",T="FALSE",R="ARRAY",A=m.ErrorList,I=m.Expression,M=p._StringHelper,E=function(){return p._getResource(m.SR)()},F="Exp_FormulaInvalidChar",D="Exp_NoSyntax";function N(){throw E().Exp_FormulaInvalid}function V(e,t,n){throw M._format(E()[n||F],[e,t])}m.OperatorType={Plus:0,Negate:1,Percent:2,Add:3,Sub:4,Mul:5,Div:6,Exp:7,Concat:8,EqualTo:9,NotEqualTo:10,LessThan:11,LessThanOrEqualTo:12,GreaterThan:13,GreaterThanOrEqualTo:14,Range:15,Union:16,Intersect:17},e=m._OperatorTypeStringMap=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],t={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},m.FormulaTokenType={Operand:0,Function:1,Subexpression:2,Argument:3,OperatorPrefix:4,OperatorInfix:5,OperatorPostfix:6,Whitespace:7},m.FormulaTokenSubtype={Nothing:0,Start:1,Stop:2,Text:3,Number:4,Logical:5,Error:6,RangeOrName:7,Concatenation:8,Intersection:9,Union:10,RangeOp:11,ExternalReference:12},r=".",o=",",i=";",a=",",l=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1];function O(e){return e<=255}function H(e){return e<=127}s=m.isDigit=function(e){return e>=48&&e<=57},m._isLetter=function(e){var t=e.charCodeAt(0);return!O(t)||(H(t)?(t|=32)>=96&&t<=122:0===l[t]||1===l[t])},u=m._isLetterOrDigit=function(e){var t=e.charCodeAt(0);return!O(t)||(H(t)?t<=57?t>=48:(t|=32)>=96&&t<=122:0===l[t]||1===l[t])},m.isNumber=function(e){var t=e.charCodeAt(0);return H(t)?t>=48&&t<=57:8===l[t]||10===l[t]};function P(e,t,n,r,o,i){var a,l,s=e.length,u=n===r?0:1,c=[];for(a=t+1;a<s;a++)if(l=e[a],l===o&&(c.push(l),a++,l=e[a]),l===n&&u++,l===r)if(u--,n===r&&a+2<s&&e[a+1]===n)c.push(n),a++;else{if(0===u)return{result:c,endIndex:a};c.push(l)}else c.push(l);i&&V(r,n,D)}function L(e,t,n){var r,o,i,a,l=e.length,s=l-t;for(r=0;r<A.length;r++)if(o=A[r],i=o.length,t+i<=l&&(a=e.slice(t,t+i),i<=s&&o===a.join("").toUpperCase()))return{result:a,endIndex:t+i-1};n&&V([e[t],t])}function k(e,t,n){var r,o,i=e.length,a=0,l=[];for(r=t;r<i;r++)if(o=e[r],s(o.charCodeAt(0)))0===a?a=2:3===a?a=4:1===a?a=2:5!==a&&6!==a||(a=7),l.push(o);else if(o===n){if(2===a)a=4;else{if(0!==a&&1!==a)return{};a=3}l.push(".")}else if("+"===o||"-"===o){if(0===a)a=1;else{if(5!==a)return{num:l,endIndex:r-1};a=6}l.push(o)}else if("E"===o||"e"===o){if(2!==a&&4!==a)return{};a=5,l.push(o)}else if(2===a||4===a||7===a)return{num:l,endIndex:r-1};return 2===a||4===a||7===a?{num:l,endIndex:i-1}:{}}c=function(e,t){return e.push.apply(e,t),e},_=m.FormulaToken=function(){function e(e,t,n,r,o){var i,a,l;o=o||0,i=this,i._value=e,a=Array.isArray(e)?e.join(""):e,i._type=t,i._index=n,i._endIndex=r||n+e.length-1,0===t&&0===o&&e?(l=a.toUpperCase())!==b&&l!==T||(o=5,a=l):1===t&&a!==R&&(a=a.toUpperCase()),i._stringValue=a,i._subType=o,i._children=[]}return e}(),f=m.TokenResolver=function(){function e(e){this.priority=e||5e3}return e.prototype.resolveToken=function(e,t,n,r){},e.prototype.unparse=function(e,t,n,r){},e}(),d={"+":0,"-":1},h=m.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},m.Parser=function(){function e(){}return e.prototype={setParserOption:function(t){var n,l;t!==w&&p.CultureManager._getCultureInfo()?(l=t.NumberFormat?t.NumberFormat:p.CultureManager._getCultureInfo().NumberFormat,n=t?l:{}):(n={},l=n),o=e.listSeparator=n.listSeparator||",",r=n.numberDecimalSeparator||".",!t&&e.numberDecimalSeparator||(e.numberGroupSeparator=l.numberGroupSeparator||",",e.numberDecimalSeparator=l.numberDecimalSeparator||"."),i=e.arrayGroupSeparator=n.arrayGroupSeparator||";",a=e.arrayListSeparator=n.arrayListSeparator||","},parse:function(e,t){var n,r;return this.setParserOption(e.culture),n=t.split(""),this._charArray=n,r=this.parseToTokens(e,n,!e.ignoreError),this.buildExpressionTree(e,r,!e.ignoreError)},unparse:function(e,t,n){return n=n||[],this._unparseCore(e,t,n),n.join("")},_unparseCore:function(e,t,n){var r,o;for(this.setParserOption(e.culture),r=e.getResolvers(),o=0;o<r.length&&!r[o].unparse(e,this,t,n);o++);},parseToTokens:function(e,t,n){var l,u,f,d,g,p,m,v,C,w,y,S,x,b,T,A,I,M,E,F,D,N;for(void 0===n&&(n=!0),l=this,u=function(e,t,n){return t.length>0?(e.push(new _(t,0,n)),[]):t},f=t.length,d=[],g=[],p=-1,m=[],w=0;w<f&&" "===t[w];)w++;for("="===t[w]&&w++,C=w,S=w;S<f;S++)if(x=t[S],(b=x.charCodeAt())>=97&&b<=122||b>=65&&b<=90)m.push(x);else if(34===b)T=P(t,S,'"','"',"",n),T?(d.push(new _(T.result,0,S,S+T.result.length+2,3)),S=T.endIndex,C=S+1):(c(m,t.slice(S,f)),S=f-1);else if(39===b)T=P(t,S,"'","'","",n),T?(m.push("'"),c(m,T.result),m.push("'"),S=T.endIndex):(m.push("'"),S=f-1);else if(91===b)if(T=P(t,S,"[","]","'",n))m.push("["),c(m,T.result),m.push("]"),S=T.endIndex;else{if(l._isR1C1&&0===m.length&&("R"===m[0]||"r"===m[0]||"C"===m[0]||"c"===m[0]))continue;c(m,t.slice(S,f)),S=f-1}else{if(13===b||10===x)continue;if(35===b)A=L(t,S),A?(d.push(new _(A.result,0,S,S+A.result.length-1,6)),C=S+1,S=A.endIndex):m.push(x);else if(33===b)m.length,I=d.length,I>0&&0===d[I-1]._type?(M=d[I-1],M._value.push.apply(M._value,m),d[I-1]=new _(M._value,0,M._index,S,12)):d.push(new _(m,0,C,S,12)),m=[],C=S+1;else if(43===b||45===b)E=0===d.length?null:d[d.length-1],0!==m.length?(d.push(new _(m,0,C)),d.push(new _(x,5,S)),m=[],C=S+1):(E&&7===E._type&&d.pop(),!E||2!==E._subType&&6!==E._type&&0!==E._type?(d.push(new _(x,4,S)),C=S+1):(d.push(new _(x,5,S)),C=S+1));else if(x===r||s(b))m.length>0?m.push(x):(F=k(t,S,r),F.num?(D=F.endIndex,N=F.num,D<=f-2&&"!"===t[D+1]?(c(m,N),C=S):(d.push(new _(N,0,S,D,4)),C=S+1),S=D):m.push(x));else if(123===b)m.length>0&&n&&V(x,S),v=new _(R,1,S,S,1),d.push(v),g[++p]=v,C=S+1;else if(x===i&&p>=0&&g[p].value===R)m=u(d,m,C),p<0&&n&&V(x,S),d.push(new _(i,3,S,S)),C=S+1;else if(125===b)m=u(d,m,C),D<0&&n&&V(x,S),y=g[p--],y=new _(x,y._type,S,S,2),d.push(y),C=S+1;else if(32===b)m=u(d,m,C),C=S+1;else if(x===o||x===a||x===i)m=u(d,m,C),p<0||1!==g[p]._type?d.push(new _(o,5,S,S,10)):d.push(new _(x,3,S,S)),C=S+1;else if(37===b)m=u(d,m,C),d.push(new _(t[S],6,S,S)),C=S+1;else if(S+2<=f&&h[x+t[S+1]])m=u(d,m,C),d.push(new _(t.slice(S,S+2),5,S,S+1,5)),S++,C=S+1;else if(h[x])m=u(d,m,C),d.push(new _(x,5,S,S)),C=S+1;else if("("===x)m.length>0?(v=new _(m,1,C,S,1),m=[]):v=new _(x,2,S,S,1),d.push(v),g[++p]=v,C=S+1;else if(")"===x){if(m=u(d,m,C),p<0){n&&V(x,S);continue}y=g[p--],y=new _(x,y._type,S,S,2),d.push(y),C=S+1}else":"===x?(m=u(d,m,C),d.push(new _(x,5,S,S,11)),C=S+1):"\r"===x||"\n"===x||m.push(x)}return u(d,m,C),d},buildExpressionTree:function(e,t,n){var r=this._buildExpressionNodes(e,t,n),o=this._buildExpressionsToTree(e,r,n);return n&&this._checkExpression(o),o},_checkExpression:function(e){for(var t,n,r;10===e.type;)e=e.value;if(t=this,9===e.type)e.value||N(),t._checkExpression(e.value),e.value2&&t._checkExpression(e.value2);else if(7===e.type)for(n=0;n<e.arguments.length;n++)r=e.arguments[n],r||N(),t._checkExpression(r)},_buildExpressionsToTree:function(e,n,r){var o,i,a,l,s,u,c=this._parseToBinaryOperatorList(e,n,r);for(l=3;l<c.length;)if(s=c[l],u=c[l-2],9!==u.type&&N(),s&&9===s.type){for(;l>=3&&t[s.value]>=t[u.value];)i=c[l-3],a=c[l-1],o=m._createOperatorExpression(u.operatorType,i,a),c.splice(l-3,3,o),(l-=2)>=3&&(u=c[l-2]);l+=2}else l++;if(1===c.length)return c[0];for(l=c.length-2;l>0;l-=2)i=c[l-1],a=c[l+1],9!==c[l].type&&N(),o=m._createOperatorExpression(c[l].operatorType,i,a),c.splice(l-1,3,o);return o},_parseToBinaryOperatorList:function(e,t,n){var r,i,a,l,s,u,c,_,f,d,h,g,p,v;for(t=Array.isArray(t)?t:[t],r=[],i=t.length,a=0;a<i;a++){if(l=t[a],s=l,9===l.type){if(0===l.operatorType||1===l.operatorType)if(a===i-1)n&&N();else{for(u=a;9===t[u].type&&t[u].operatorType<=1;)u++;for(c=this._buildExpressionsToTree(e,t[u]),_=u-1;_>=a;_--)s=m._createOperatorExpression(t[_].operatorType,c),c=s;s=c,a=u}else if(2===l.operatorType){if(0!==a){s=m._createOperatorExpression(l.operatorType,this._buildExpressionsToTree(e,r[r.length-1])),r[r.length-1]=s;continue}n&&N()}}else if(10===l.type)l.value=this._buildExpressionsToTree(e,l.value),s=l;else if(7===l.type){if(f=0,d=l.arguments,h=[],g=[],d.length>0){for(p=0;p<=d.length;p++)v=d[p],p===d.length||0===v.type&&v.value===o?(f===p?h.push(new I(11)):h.push(this._buildExpressionsToTree(e,g)),f=p+1,g=[]):g.push(v);l.arguments=h}s=l}r.push(s)}return r},_buildExpressionNodes:function(e,t,n){var r,o,i=[];for(r=0,o=t.length;r<o;)r=this.resolveToken(e,t,i,r,n);return i},resolveToken:function(e,t,n,r,o){var i,a,l,s,u,c,_=t[r],f=e.getResolvers();for(i=0;i<f.length;i++)if(a=f[i].resolveToken(e,this,t,r)){l=a.expr,s=r-1,l&&a.index!==w?r=a.index-1:l=a,u=n.length>0?n[n.length-1]:y,u&&0!==l.type&&7!==l.type&&l.type<9&&0!==u.type&&7!==u.type&&u.type<9&&(c=t[s]._endIndex)<_._index-1&&n.push(m._createOperatorExpression(17," ")),n.push(l);break}return r+1},resolveSubTokens:function(e,t,n,r){for(var o=[];n<t.length&&2!==t[n]._subType;)n=this.resolveToken(e,t,o,n,r);return{exprs:o,index:n+1}}},e}(),m.ParserContext=function(){function e(e,t,n,r){var o=this;o._toStandard=!1,o.ignoreError=!1,o.source=y,o.useR1C1=t,o.row=n&&n.row||0,o.column=n&&n.col||0,o.baseIdentity=n,o.option=r,o.source=e,o._resolves=[],o.addResolver(new g)}return e.prototype={getExternalSource:function(e,t){var n,r=this.source._getCalcServiceInternal(),o=r.getAllSouceModels();for(n=0;n<o.length;n++)if(M._compareStringIgnoreCase(o[n].getSource().getName(),t))return o[n].getSource();return y},getExternalSourceToken:function(e){return e.getName()},getTableByName:function(e){return y},getTableByIndex:function(e,t){return y},setSource:function(e){this.source=e},getResolvers:function(){return this._resolves},addResolver:function(e){var t,n=this._resolves;for(t=0;;t++)if(!n[t]||e.priority>n[t].priority){n.splice(t,0,e);break}},getFunction:function(e){return this.source&&this.source.getCustomFunction(e)||m.Functions.findGlobalFunction(e)}},e}(),g=m.DefaultTokenResolver=function(){f.call(this)},v(g,f),C(g.prototype,{resolveToken:function(e,t,n,r){var o,a,l,s,u,c,_,f=n[r],g=f._stringValue,p=f._value,v=f._type;if(0===v)0===f._subType?(l=g.toUpperCase(),l===b||l===T?(f._subType=5,f._stringValue=l,o=new I(4),o.value=l===b):(o=new I(8),o.value=g)):4===f._subType?(o=new I(2),o.value=parseFloat(g),o.originalValue=g):3===f._subType?(o=new I(3),o.value=g):5===f._subType?(o=new I(4),o.value=g===b):6===f._subType?(o=new I(5),o.value=m.CalcError.parse(g)):7===f._subType&&(o=new I(8),o.value=g);else if(1===v){if(g===R){for(o=new I(6),r++,l=[[]],a=0,s=0,u=0;r<n.length&&2!==n[r]._subType;){if(f=n[r],r<n.length-1&&4===f._type&&"-"===f._stringValue&&4===n[r+1]._subType&&(r++,f=n[r],p.unshift("-"),f._stringValue="-"+f._stringValue),3===f._type){if(f._stringValue===i){if(s!==u)throw M._format(E().Exp_InvalidArrayColumns,[f._index]);l.push([]),a++,u=0}}else{if(0!==f._type||4!==f._subType&&3!==f._subType&&5!==f._subType&&6!==f._subType)throw E().Exp_InvalidArray;c=f._stringValue,4===f._subType?c=parseFloat(c):5===f._subType?c="TRUE"===c.toUpperCase():6===f._subType&&(c=m.CalcError.parse(c)),l[a].push(c),0===a&&s++,u++}r++}if(s!==u)throw M._format(E().Exp_InvalidArrayColumns,[f._index]);return r++,o.value=new m.CalcArray(l),{expr:o,index:r}}if(p.length>0)return"@"===p[0]&&(f._stringValue=p.slice(1).join(""),g=f._stringValue),o=new I(7),o.functionName=g,o.function=e.getFunction(o.functionName)||m.Functions.findGlobalFunction(o.functionName),(_=t.resolveSubTokens(e,n,r+1))?(o.arguments=_.exprs,{expr:o,index:_.index}):(o.arguments=[],o)}else if(4===v||6===v||5===v)o=m._createOperatorExpression(4===v?d[g]:h[g],g);else if(2===v){if(o=new I(10),_=t.resolveSubTokens(e,n,r+1))return o.value=_.exprs,{expr:o,index:_.index};N()}else 3===v&&(o=new I(0),o.value=g);return o},unparse:function(e,t,n,r){var i,a=this;if(6===n.type||4===n.type||2===n.type||5===n.type||3===n.type)a._unparseConstantExpression(e,n,r);else if(9===n.type)a._unparseOperatorExpressions(e,t,n,r);else if(10===n.type)r.push("("),t._unparseCore(e,n.value,r),r.push(")");else{if(7!==n.type)return!1;for(c(r,(n.function&&n.function.name||n.functionName).split("")),r.push("("),i=0;i<n.arguments.length;i++)0!==i&&r.push(o),t._unparseCore(e,n.arguments[i],r);r.push(")")}return!0},_unparseOperatorExpressions:function(t,n,r,o){var i=r.operatorType;2===i?(n._unparseCore(t,r.value,o),o.push("%")):0===i||1===i?(o.push(e[i]),n._unparseCore(t,r.value,o)):(n._unparseCore(t,r.value,o),o.push(e[i]),n._unparseCore(t,r.value2,o))},_unparseConstantExpression:function(e,t,n){var o,l,s,u,c,_,f,d,h=this,g=E().Exp_InvalidArray;if(3===t.type)n.push('"'),n.push(M._replace(t.value,'"','""')),n.push('"');else if(2===t.type)o=t.originalValue||""+t.value,"."!==r&&(o=o.replace(".",r)),n.push(o);else if(4===t.type)n.push(t.value?b:T);else if(6===t.type){if(n.push("{"),l=t.value,l.getRowCount()<=0)throw g;for(s=0,u=l.getRowCount();s<u;s++)for(s>=1&&n.push(i),c=0,_=l.getColumnCount();c<_;c++){if(0!==c&&n.push(a),(f=l.getValue(s,c))===w||f===y)throw g;d=typeof f,f instanceof I?h.context(e,f,n):d===S?(n.push('"'),n.push(f),n.push('"')):d===x?n.push(f?b:T):"number"===d&&"."!==r?n.push((""+f).replace(".",r)):n.push(""+f)}n.push("}")}else 5===t.type?n.push(""+t.value):t.type}})}()},function(e,t,n){!function(){"use strict";var e,t,r,o,i,a,l,s,u,c,_,f,d,h=n(1),g=h.Errors,p=n(2),m=p._Types._inherit,v=null,C=void 0,w=Math.pow,y=Math.min,S=Math.max,x="string",b=function(){return p._getResource(h.SR)()},T=b().Exp_Format,R=h.Convert,A=R._tryToDouble,I=R._isError,M=R._toArray,E=g.Reference,F=g.Value,D=h.CalcArray,N=g.Name,V=g.NotAvailable,O=g.DivideByZero;function H(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}}e=function(){function e(e,t,n,r){var o=this;o._asyncId=0,o._asyncCount=0,o._expandArrayToMultiCallCount=0,o.source=e,o.arrayFormulaMode=!!n,o.identity=t||h._createCellIdentity(0,0),o.arrayIdentity=r,o.row=r?r.row:o.identity.row||0,o.column=r?r.col:o.identity.col||0,o.rowOffset=r?o.identity.row-r.row:o.row,o.columnOffset=r?o.identity.col-r.col:o.column}return e}(),e.prototype={_getActualSource:function(e){return e===h.BangSource?this.source:e},getValue:function(e,t){return e?this._getActualSource(e).getValue(t):E},getReference:function(e,t){return e?this._getActualSource(e).getReference(t):E},getSheetRangeReference:function(e){return e&&e.source&&e.endSource?this._getActualSource(e.source).getSheetRangeReference(e):E},getFunction:function(e){var t=this;return t.source?t.source.getCustomFunction(e):v},getName:function(e){var t,n=this,r=n.source?n.source.getCustomName(e):v;return!r&&n.source&&(t=n.source._getCalcServiceInternal().getGlobalSourceModel(),r=t&&t.getSource().getCustomName(e)),r},_isExpandArrayToMultiCall:function(){return this._expandArrayToMultiCallCount>0},_beginExpandArrayToMultiCall:function(){this._expandArrayToMultiCallCount++},_endExpandArrayToMultiCall:function(){this._expandArrayToMultiCallCount--},SetAsyncResult:function(e,t){this.source._getCalcServiceInternal()._evaluator.SetAsyncResult(e,t)},cloneFrom:function(e){var t=this;t.acceptsReference=e.acceptsReference,t.arrayFormulaMode=e.arrayFormulaMode}},h.EvaluateContext=e,t=function(){function e(e,t){this.id=e._asyncId++,this.ctx=e,this.row=e.row+(e.arrayFormulaMode&&e.rowOffset||0),this.col=e.column+(e.arrayFormulaMode&&e.columnOffset||0),this.node=t}return e.prototype.setAsyncResult=function(e){this.node._result=e,this.node._hasResult=!0,this.ctx.SetAsyncResult(this,e),this.ctx.source.refresh()},e}(),h.AsyncEvaluateContext=t,r=function(e){m(t,e);function t(t,n,r,o,i,a,l,s){e.call(this,t,n,r,o,i,a,l,s),this._globalSource=t._getCalcServiceInternal().getGlobalSourceModel().getSource()}return t.prototype.getName=function(e){var t=this;return t._globalSource?t._globalSource.getCustomName(e):v},t}(e),h.GloableEvaluateContext=r,h.Evaluator=function(){function e(e){this._aync={},this._aync2={},this.asyncManager=new i(this),this.service=e}return e}(),h.Evaluator.prototype={evaluateExpression:function(e,t,n,r,o){var i=this.evaluate(e,t,!!r,!!o);return i===C||i===v?!1===n?i:0:((h.Convert._isArray(i)&&!r||R._isReference(i)&&!o)&&(i=this.getOneValue(t,i)),p._NumberHelper._fixNumber(i,15))},evaluate:function(e,t,n,r){var o,i,a;if(!e)throw b().Exp_ExprIsNull;for(;10===e.type;)e=e.value;if(o=this,a=v,12===e.type&&(a=e.needExpendIndexs,e=e.value),e.type>=2&&e.type<=6)i=o.evaluateConst(e,t,n);else if(1===e.type||13===e.type)i=o.evaluateReference(e,t,r,n);else if(8===e.type)i=o.evaluateName(e,t,n,r);else if(9!==e.type||e.value2){if(9===e.type)i=o.evaluateBinaryOperation(e,t,n,r,a);else if(7===e.type)i=o.evaluateFunction(e,t,n,r,a);else if(11===e.type)i=C;else if(t.evaluate)return t.evaluate(e,n,r)}else i=o.evaluateUnaryOperation(e,t,n,r,a);return i},evaluateConst:function(e,t,n){var r=e.value;return R._isArray(r)?n||t&&(t.arrayFormulaMode||t._isExpandArrayToMultiCall())?r:r.getValue(0,0):r},evaluateReference:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p;if(!t)return F;if(o=(13===e.type?e.source():e.source)||t.source,i=t.row,a=t.column,!(l=e.getRange&&e.getRange(i,a)))return 13===e.type?F:E;if(s=l.row<0?0:l.row,u=l.col<0?0:l.col,c=l.rowCount,_=l.colCount,n||t.arrayFormulaMode)return e.endSource?t.getSheetRangeReference({source:e.source,endSource:e.endSource,row:s,col:u,rowCount:c,colCount:_}):t.getReference(o,l);if(r&&(c>1||_>1)){for(f=[],d=0;d<c;d++)for(f[d]=[],h=0;h<_;h++)f[d][h]=o.getValue(d+s,h+u);return new D(f)}if(c>1||_>1)if(g=i>=l.row&&i<l.row+c,p=a>=l.col&&a<l.col+_,g&&p)s=i,u=a;else{if(!g&&!p)return F;if(g&&1===_)s=i;else{if(!p||1!==c)return F;u=a}}else if(-1===l.row&&-1===c){if(1!==_)return F;s=i}else if(-1===l.col&&-1===_){if(1!==c)return F;u=a}return o.getValue(s,u)},evaluateName:function(e,t,n,r){var o,i;return t?(e.source&&(o=e.source,t=o.getEvaluatorContext(t.identity,t.arrayFormulaMode,t.arrayIdentity)),i=t.getName(e.value),i?this.evaluate(i,t,n,r):N):N},evaluateUnaryOperation:function(e,t,n,r,o){var i,a=!1;return o&&o.length>0&&(n=!0,a=!0),i=this.evaluate(e.value,t,n,a),R._isError(i)?i:i===h.missingArgument?V:this.evaluateWithArgs(e,function(t){return l(e.operatorType,t[0])},t,o,[i],n,r)},evaluateBinaryOperation:function(e,t,n,r,o){var i,a,s,u,c=[n,n],_=e.operatorType>=15,f=[_,_];if(o&&o.length>0)for(i=0;i<o.length;i++)c[o[i]]=!0,f[o[i]]=!0;for(a=[e.value,e.value2],s=[],i=0;i<2;i++){if(u=this.evaluate(a[i],t,c[i],f[i]),R._isError(u))return u;if(u===h.missingArgument)return V;s[i]=u}return this.evaluateWithArgs(e,function(t){return l(e.operatorType,t[0],t[1])},t,o,s,n,r)},startCache:function(){this._functionResultCaches={},this.service._hasAsync&&this.asyncManager.startCalc()},endCache:function(){this._functionResultCaches=v},evaluateFunction:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,g,p,m,C,w,y,S,x,b,T,A;if(!e||!e.function||"string"==typeof e.function)return N;if(i=e.arguments.length,a=this,l=t._asyncCount,s=e.function,_=v,s instanceof d.AsyncFunction&&this.asyncManager.startCalcFunction(s,e.arguments,t),0===i)u=[];else{for(u=[],f=[],g=[],p=0;p<i;p++)f[p]=s.acceptsArray(p),g[p]=s.acceptsReference(p);if(o&&o.length>0){for(_=[],p=0;p<i;p++)_[p]=!0;for(p=0;p<o.length;p++)m=o[p],f[m]=!0,g[m]=!0,_[m]=!(s.acceptsReference(m)&&!s.acceptsArray(m))}for(s.isBranch()&&(t.arrayFormulaMode||t._isExpandArrayToMultiCall())&&(f[s.findTestArgument()]=!0,g[s.findTestArgument()]=!0),w=-1,y=-1,s.isBranch()&&(w=s.findTestArgument(),s.acceptsArray(w)&&t._beginExpandArrayToMultiCall(),C=a.evaluate(e.arguments[w],t,f[w],g[w]),s.acceptsArray(w)&&t._endExpandArrayToMultiCall(),R._isReference(C)||R._isArray(C)||(y=s.findBranchArgument(C))),p=0;p<i;p++){if(w===p)c=C;else{if(y>=0&&p!==y){u[p]=null;continue}s.acceptsArray(p)&&t._beginExpandArrayToMultiCall(),c=a.evaluate(e.arguments[p],t,f[p],g[p]),s.acceptsArray(p)&&t._endExpandArrayToMultiCall()}if(!s.acceptsArray(p)&&R._isArray(c)||!s.acceptsReference(p)&&R._isReference(c))if(S=R._isArray(c)?c:v,x=R._isReference(c)?c:v,S&&1===S.getRowCount()&&1===S.getColumnCount())c=S.getValue(0,0);else if(x&&1===x.getRowCount(0)&&1===x.getColumnCount(0))c=x.getValue(0,0,0);else{if(b=[],T=!1,o)for(A=0;A<o.length;A++)b.push(o[A]),o[A]===p&&(T=!0);T||(b.push(p),o=b)}if(R._isError(c)&&!s.acceptsError(p))return c;c!==h.missingArgument||s.acceptsMissingArgument(p)||(c=v),u[p]=c}}return a.evaluateWithArgs(e,function(e,n){var o,i,u=J(e,s._argsLimit);return e=u._args,s.isContextSensitive()?(t.acceptsReference=r||t._isExpandArrayToMultiCall(),s instanceof d.AsyncFunction?(a._ayncFunctionResultCaches=a._ayncFunctionResultCaches||{},s.evaluateWhenArgumentsIsSame()?a.evaluateAsyncFunction(t,n,s,l,e):a.evaluateWithCache(s,e,function(){return a.evaluateAsyncFunction(t,n,s,l,e)},a._ayncFunctionResultCaches)):s.evaluateWithContext(t,e)):(i=function(){return u._isExecuteFunc?s.evaluate.apply(s,e):u._result},o=t.arrayFormulaMode?a.evaluateWithCache(s,e,i,a._functionResultCaches):i())},t,o,u,n,r,_)},evaluateAsyncFunction:function(e,n,r,o,i){var a,l,s=this.asyncManager.getNode();return s._hasResult?a=s._result:s.canEvaluate()?(l=new t(e,s),a=r.evaluateWithContext(l,i),a===C?a=s._result!==C?s._result:r.defaultValue():1===s.evaluateMode&&(s._hasResult=!0)):a=s._result!==C?s._result:r.defaultValue(),s._result=a,this.asyncManager.endCalcFunction(),a},evaluateWithCache:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,g,p;if(r)if(o=!1,i=r[e.name+t.length])for(a=0;a<i.length;a++){if(l=i[a],o=!1,l.args.length===t.length)for(o=!0,s=0;s<t.length;s++)if(u=l.args[s],c=t[s],u!==c){if(!(u instanceof h.CalcReference&&c instanceof h.CalcReference)){o=!1;break}if(_=u._rangeCount,u._source!==c._source||_!==c._rangeCount){o=!1;break}for(f=0;f<_;f++)if(u.getRow(f)!==c.getRow(f)||u.getColumn(f)!==c.getColumn(f)||u.getRowCount(f)!==c.getRowCount(f)||u.getColumnCount(f)!==c.getColumnCount(f)){o=!1;break}}if(o)return l.flag++,l.value}else i=r[e.name+t.length]=[];if(d=n(),r&&d!==C){if((g=i.length)>=100){for(p=[],a=0;a<g;a++)i[a].flag>0&&p.push(i[a]);p.sort(function(e,t){return t.flag-e.flag}),g=Math.min(50,p.length),i=p.slice(0,g),r[e.name+t.length]=i}i.push({args:t,value:d,flag:0})}return d},SetAsyncResult:function(e){var t=e.ctx;t.source._getCalcServiceInternal().recalculate(t.source,e.row,e.col,!0)},evaluateWithArgs:function(e,t,n,r,o,i,a,l){var s,u,c,_,f,d,g,p,m,v,C,w,y,S;if(r&&r.length>0){if(!(s=this._expandArgs(n,e,o,r,l)))return V;for(u=[],_=s[0].length,f=s[0][0].length,d=0;d<_;d++)for(u[d]=[],g=0;g<f;g++)try{for(p=[],m=0;m<o.length;m++)p[m]=s[m][d][g];if(c=t(p,e),R._isReference(c)){if(7===e.type&&(v=e.function,v.returnReference&&v.returnReference()))return c;c=this.getOneValue(n,c)}u[d][g]=c}catch(e){u[d][g]=F}return new h.CalcArray(u)}try{if(c=t(o,e),n.arrayFormulaMode&&n._isExpandArrayToMultiCall())return c;if(R._isArray(c)&&!i)return this.getOneValue(n,c);if(R._isReference(c)&&!a){if(C=c,i&&1===C.getRangeCount()){for(w=[],y=0;y<C.getRowCount(0);y++)for(w[y]=[],S=0;S<C.getColumnCount(0);S++)w[y][S]=C.getValue(0,y,S);return new h.CalcArray(w,C.getColumnCount(0))}return this.getOneValue(n,c)}return c}catch(e){return F}},getOneValue:function(e,t){var n,r,o,i,a,l;return R._isReference(t)?(o=t,i=o.getRowCount(0),a=o.getColumnCount(0),o.getRangeCount()>1||!e.arrayFormulaMode&&i>1&&a>1?t=F:(-1!==e.rowOffset||-1!==e.columnOffset?(n=1===i?0:e.arrayFormulaMode?e.rowOffset:e.rowOffset-o.getRow(0),r=1===a?0:e.arrayFormulaMode?e.columnOffset:e.columnOffset-o.getColumn(0)):(n=1===i?0:e.row-o.getRow(0),r=1===a?0:e.column-o.getColumn(0)),t=n>=i||r>=a?V:o.getValue(0,n,r))):R._isArray(t)&&(l=t,!e.arrayFormulaMode||-1===e.rowOffset&&-1===e.columnOffset?t=l.getValue(0,0):(n=1===l.getRowCount()?0:e.rowOffset,r=1===l.getColumnCount()?0:e.columnOffset,t=n>=l.getRowCount()||r>=l.getColumnCount()?V:l.getValue(n,r))),R._isReference(t)||R._isArray(t)?this.getOneValue(e,t):t},_expandArgs:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,m,w,y,S,x=1,b=1,T=-1,A=!0,I=!0,M=null,E=null,F=1,D=1,N=7===t.type?t:v;if(N&&!N.function.expandRows()&&(A=!1),N&&!N.function.expandColumns()&&(I=!1),N&&N.function.isBranch()&&(e.arrayFormulaMode||e._isExpandArrayToMultiCall())){if(T=N.function.findTestArgument(),i=[],a=!1,r)for(l=0;l<r.length;l++)i.push(r[l]),r[l]===T&&(a=!0);if(a||R._isArray(n[T])||R._isReference(n[T])){for(s=0;s<N.arguments.length;s++)s!==T&&p._ArrayHelper._indexOf(i,s)<0&&(R._isArray(n[s])||R._isReference(n[s]))&&i.push(s);r=i}}for(u=0;u<r.length;u++){if(c=n[r[u]],M=R._isArray(c)?c:null,E=R._isReference(c)?c:null,F=0,D=0,M)F=M.getRowCount(),D=M.getColumnCount();else if(E){if(E.getRangeCount()>1)return v;F=A?E.getRowCount(0):1,D=I?E.getColumnCount(0):1}x=F>x?F:x,b=D>b?D:b}for(_=[],f=0,d=r[f],h=0;h<n.length;h++){if(_[h]=[],g=n[h],M=v,E=v,F=D=1,h===d){if(M=R._isArray(g)?g:v,E=R._isReference(g)?g:v,(M||E)&&(F=M&&M.getRowCount()||(A?E.getRowCount(0):1),D=M&&M.getColumnCount()||(I?E.getColumnCount(0):1),(1!==F&&F!==x||1!==D&&D!==b)&&(-1===T||h===T)&&!e.arrayFormulaMode))return v;f++,d=f<r.length?r[f]:-1}else if(o===C&&(M=R._isArray(g)?g:v,E=R._isReference(g)?g:v,(M||E)&&(F=M&&M.getRowCount()||(A?E.getRowCount(0):1),D=M&&M.getColumnCount()||(I?E.getColumnCount(0):1),(1!==F&&F!==x||1!==D&&D!==b)&&(-1===T||h===T)&&!e.arrayFormulaMode)))return v;for(E&&(m=E.getRow(0),w=E.getColumn(0),x=m+x-m,b=w+b-w),y=0;y<x;y++)for(_[h][y]=[],S=0;S<b;S++)1!==F&&y>=F||1!==D&&S>=D?_[h][y][S]=V:M?_[h][y][S]=M.getValue(1===F?0:y,1===D?0:S):E?!o||o[h]?_[h][y][S]=E.getValue(0,1===F?0:y,1===D?0:S):_[h][y][S]=E.create([H(E.getRow(0)+(1===F?0:y),E.getColumn(0)+(1===D?0:S),1,1)]):_[h][y][S]=g}return _}},o=function(){function e(e,t){this.id=e,this._result=C,this._hasResult=!1,this._children=[],t!==C&&(this.evaluateMode=t)}return e}(),o.prototype={canEvaluate:function(){var e,t=this._children;for(e=0;e<t.length;e++)if(!t[e]._hasResult)return!1;return!0}},i=function(){function e(e){var t=this;t._stack=[],t._stackIndex=-1,t._nodes={},t._cellFunctionId=-1,t._evaluator=e,t._nodeCount=0}return e}(),i.prototype={startCalc:function(){var e,t,n,r,o,i,a,l,s;if(this._nodeCount)for(t in this._nodes)if(n=this._nodes[t])for(r in n)if(o=n[r])for(i in o)if((a=o[i])&&(e=a.length)>0)for(l=0;l<e;l++)s=a[l],0===s.evaluateMode&&(s._hasResult=!1)},startCalcCell:function(e,t){var n,r,i,a,l=this,s=e.getName(),u=t.row,c=t.col;if(l._cellFunctionId=-1,l.source=e,n=l._nodes[s],n||(n=l._nodes[s]={}),r=n[u],r||(r=n[u]={}),i=r[c])return void(l.cellNodes=i);a=new o(-1),i=r[c]=[],l._nodeCount++,l._stackIndex=-1,l.cellNodes=i,l.row=u,l.col=c,i.root=a,l._stack[++l._stackIndex]=a,l.evaluateMode=-1},startCalcFunction:function(e,t,n){var r,i,a,l,s,u,c,_,f,d,h=this;if(h._cellFunctionId++,h.isNewNode=!1,r=h.cellNodes[h._cellFunctionId])return h.currentNode=r,r;if(h.isNewNode=!0,i=h.evaluateMode,a=e.evaluateMode(),"REFRESH"===e.name?(a=t[1]?h._evaluator.evaluate(t[1],n,!1,!1):0,h.evaluateMode=a):-1!==i&&(a=i),r=new o(h._cellFunctionId,a),h.cellNodes[h._cellFunctionId]=r,h._stack[h._stackIndex]._children.push(r),r.parent=h._stack[h._stackIndex],h._stack.push(r),h._stackIndex++,h.currentNode=r,2===a&&-1===i){for(l=6e4,s=h.intervals,u=e.interval()||l,"REFRESH"===e.name&&(r.isRefresh=!0,u=t[2]?h._evaluator.evaluate(t[2],n,!1,!1):l),s||(h.intervals=s={}),c=s[u],c||(c=s[u]=[],c.intervalObj=window.setInterval(function(){var e,t,n=h.intervals[u];for(_=0;_<n.length;_++)e=n[_],t=e.node,t._hasResult=!1,t.isRefresh&&P(t),h._evaluator.service.recalculate(e.source,e.row,e.col,!0),h.source.refresh()},u)),f=!1,_=0;_<c.length;_++)if(d=c[_],d.source===h.source&&d.node===r&&d.row===h.row&&d.col===h.col){f=!0;break}f||c.push({source:h.source,node:r,row:h.row,col:h.col})}return r},getNode:function(){return this.currentNode},endCalcFunction:function(){this.isNewNode&&(this._stack.pop(),this._stackIndex--),this.currentNode=this.currentNode.parent},endCalcCell:function(){},clearCell:function(e,t){var n,r,o,i,a,l,s,u,c,_,f,d,h=this;if(h._nodeCount){n=e.getName(),r=t.row,o=t.col,h._cellFunctionId=-1,h.source=e,i=h._nodes[n],i&&(a=i[r])&&(l=a[o])&&(a[o]=C,h._nodeCount--),s=h.intervals;for(u in s)if(c=s[u]){for(_=[],f=0;f<c.length;f++)d=c[f],d.source===e&&d.row===t.row&&d.col===t.col||_.push(d);_.length?_.length!==c.length&&(_.intervalObj=c.intervalObj,s[u]=_):(s[u]=C,window.clearInterval(c.intervalObj))}}},setAsyncResult:function(e,t){e._result=t},addRows:function(e,t,n){this._addRemoveRows(e,t,n,!0)},deleteRows:function(e,t,n){this._addRemoveRows(e,t,n,!1)},_addRemoveRows:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m=this;if(m._nodeCount){if(o=e.getName(),i=m._nodes[o]){a={};for(l in i)(s=i[l])&&(u=parseInt(l),r?(c=u>=t?u+n:u,a[c]=s):u<t?a[u]=s:u>=t+n&&(a[u-n]=s));m._nodes[o]=a}_=m.intervals;for(f in _)if(d=_[f]){for(h=[],g=0;g<d.length;g++)p=d[g],p.source===e&&r&&p.row>=t?p.row+=n:p.source===e&&!r&&(p.row<t||p.row>=t+n)&&(p.row=p.row<t?p.row:p.row-n,h.push(p))
;r||h.length===d.length||(h.intervalObj=d.intervalObj,_[f]=h)}}},addColumns:function(e,t,n){this._addRemoveColumns(e,t,n,!0)},deleteColumns:function(e,t,n){this._addRemoveColumns(e,t,n,!1)},_addRemoveColumns:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C=this;if(C._nodeCount){if(o=e.getName(),i=C._nodes[o])for(a in i)if(l=i[a]){s={};for(u in l)(c=l[u])&&c.length&&(_=parseInt(u),r?(f=_>=t?_+n:_,s[f]=c):_<t?s[_]=c:_>=t+n&&(s[_-n]=c));i[a]=s}d=C.intervals;for(h in d)if(g=d[h]){for(p=[],m=0;m<g.length;m++)v=g[m],v.source===e&&r&&v.col>=t?v.col+=n:v.source===e&&!r&&(v.col<t||v.col>=t+n)&&(v.col=v.col<t?v.col:v.col-n,p.push(v));r||p.length===g.length||(p.intervalObj=g.intervalObj,d[h]=p)}}},changeSourceName:function(e,t){var n,r=this;r._nodeCount&&(n=r._nodes[e])&&(r._nodes[t]=n,delete r._nodes[e])}};function P(e){var t,n;for(n=0;n<e._children.length;n++)t=e._children[n],t._hasResult=!1,t._children.length>0&&P(t)}a=function(e){var t,n=!0;return e&&e.getValue&&(t=M(e,0,!1,!0),t.isError?e=t[0]:1===t.rowCount&&1===t.colCount?e=t[0][0]:(e=t,n=!1)),{value:e,success:n}},l=h.evaluateOperator=function(e,t,n){return I(t)?t:I(n)?n:e<=2?L(e,t):e<=14?k(e,t,n):U(e,t,n)};function L(e,t){if(!t)return 0;var n=a(t);return n.success?B(e,n.value):void 0}function k(e,t,n){var r,o,i,l,s,u,c,_,f,d,g,p,m,v,C,w;if(r=e<=7?B:8===e?W:z,o=a(t),i=a(n),o.success&&i.success)return r(e,o.value,i.value);if(t=o.value,n=i.value,l=o.success?-1:t.rowCount,s=o.success?-1:t.colCount,u=i.success?-1:n.rowCount,c=i.success?-1:n.colCount,_=-1,f=-1,o.success||i.success)o.success?(_=u,f=c):(_=l,f=s);else{if(1!==l&&1!==u&&l!==u||1!==s&&1!==c&&s!==c)return V;_=1===l?u:l,f=1===s?c:s}for(d=[],g=0;g<_;g++)for(d[g]=[],p=0;p<f;p++)!o.success&&(1!==l&&l<_||1!==s&&s<f)||!i.success&&(1!==u&&u<_||1!==c&&c<f)?d[g][p]=V:(m=1===l?0:g,v=1===s?0:p,C=1===u?0:g,w=1===c?0:p,d[g][p]=r(e,o.success?t:t[m][v],i.success?n:n[C][w]));return new h.CalcArray(d)}function B(e,t,n){var r,o,i;if(""===t||""===n)return F;if(r={value:0},!A(t,r))return 0===e&&"string"==typeof t?t:F;if(o=r.value,n!==C){if(!A(n,r))return F;i=r.value}else i=0;return 0===e?o:1===e?-o:2===e?o/100:3===e?o+i:4===e?o-i:5===e?o*i:6===e?i?o/i:O:7===e?!o&&i<0?O:w(o,i):void 0}function W(e,t,n){if(8===e)return I(t)?t:I(n)?n:(t=t||"",n=n||"",R._toString(t)+R._toString(n))}function z(e,t,n){var r,o,i,a,l,s,u,c;if(I(t))return t;if(I(n))return n;if(r=typeof t===x,o=typeof n===x,i=r||o,a=i?"":0,t=t===v||t===C?a:t,n=n===v||n===C?a:n,l=function(){return t===n?0:r&&o?t.toUpperCase().localeCompare(n.toUpperCase()):r?1:o?-1:h._Helper._approxEqual(t,n)?0:t-n},!i){if(s={value:0},u={value:0},!A(t,s)||!A(n,u))return F;t=s.value,n=u.value}return c=l(),9===e&&0===c||10===e&&0!==c||11===e&&c<0||12===e&&c<=0||13===e&&c>0||14===e&&c>=0}function U(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,p;if(!t||!n||(1!==t.getRangeCount()||1!==n.getRangeCount())&&16!==e||t.endSource||n.endSource)return F;if(!(r=t.getSource())||r!==n.getSource())return F;if(16===e)o=t._identities.concat(n._identities);else{if(i=15===e?y:S,a=15===e?S:y,l=t.getRow(0),s=t.getColumn(0),u=n.getRow(0),c=n.getColumn(0),_=i(l,u),f=i(s,c),d=a(l+t.getRowCount(0),u+n.getRowCount(0))-_,p=a(s+t.getColumnCount(0),c+n.getColumnCount(0))-f,d<1||p<1)return g.Null;o=[H(_,f,d,p)]}return new h.CalcReference(r,o)}s=R._toDouble,u=R._toInt,c=R._toString,_=R._tryToDateTime,f=R._toBool;function Y(e,t){var n,r,o,i=!0;switch(t._argType){case 0:n=s(e),r=!0;break;case 1:n=parseFloat(e),r=!0;break;case 2:n=u(e),r=!0;break;case 3:n=parseInt(e),r=!0;break;case 4:n=M(e,t._valueType,t._toOneDimension||!1,t._breakOnError||!1,t._breakOnConvertError||!1,t._ignoreBlank),n.isError&&(n=n[0],i=!1),n.isConvertError&&(n=F,i=!1);break;case 5:n=c(e),t._acceptsEmptyString&&""===n&&(n=F,i=!1);break;case 6:o={value:v},_(e,o)?n=o.value:(n=F,i=!1);break;case 7:n=f(e);break;case 8:n=K(e),!n||t._complexCondition&&0===n._getReal()&&0===n._getImag()?(n=h.Errors.Number,i=!1):n={_real:n._getReal(),_imag:n._getImag()};break;default:n=e}return r&&isNaN(n)&&(n=F,i=!1),{_retValue:n,_isExecuteFunc:i}}d=h.Functions;function G(e,t,n){this._real=e,this._imag=t,this._suffix=n||"i"}G.prototype={_getReal:function(){return this._real},_getImag:function(){return this._imag},_getSuffix:function(){return this._suffix},_toString:function(e){e=e||"i";var t=this,n=t._real,r=t._imag,o="";return 0===n&&0!==r||(o+=""+n),-1===r?o+="-":0!==n&&r>0&&(o+="+"),-1!==r&&0!==r&&1!==r&&(o+=""+r),0!==r&&(o+=e),o}},d._Complex=G;function X(e,t){return e.charAt(t)}function j(e,t){for(var n=e.length,r=!1;t<n&&!isNaN(X(e,t));)t++,r=!0;for(t<n&&"."===X(e,t)&&t++;t<n&&!isNaN(X(e,t));)t++,r=!0;if(t<n&&("E"===X(e,t)||"e"===X(e,t)))for(t++,r=!1,t<n&&("+"===X(e,t)||"-"===X(e,t))&&t++;t<n&&!isNaN(X(e,t));)t++,r=!0;return{_digitFlag:r,_index:t}}function K(e){function t(e){var t,n,r,o,i=0,a=0,l=!1,s=0,u=0,c=0,_=e.length;if(!e)throw b().Exp_ArgumentNull;if(0===_)throw T;if(c<_&&("+"===X(e,c)||"-"===X(e,c))&&c++,o=j(e,c),c=o._index,t=o._digitFlag,c<_&&("+"===X(e,c)||"-"===X(e,c))?(s=c,c++,o=j(e,c),c=o._index,n=o._digitFlag,c<_&&("i"===X(e,c)||"j"===X(e,c))&&(r=X(e,c),c++,l=!0),u=c-s):c<_&&("i"===X(e,c)||"j"===X(e,c))?(r=X(e,c),c++,u=c,n=t,l=!0,t=!1):s=c,c<_)throw T;if(s>0){if(!t)throw T;i=parseInt(e.substr(0,s),10)}if(u>0){if(!l)throw T;if(1===u||2===u&&"+"===X(e,s))a=1;else if(2===u&&"-"===X(e,s))a=-1;else{if(!n)throw T;a=parseInt(e.substr(s,u-1),10)}}return new G(i,a,r)}try{return e?"number"==typeof e?new G(parseFloat(e),0):"string"==typeof e?t(e):null:new G(0,0)}catch(e){return null}}d._convertToComplex=K;function Z(e,t,n){var r,o,i,a,l;for(Array.isArray(t)||(t=[t]),r=e._retValue,o=0;o<t.length;o++)if(i=t[o].split(" "),a=i[0],l=parseInt(i[1]),"<"===a&&r<l||">"===a&&r>l||"<="===a&&r<=l||">="===a&&r>=l||"="===a&&r===l||"!="===a&&r!==l||"checkLength"===a&&r.length>l)return e._retValue=n===C?h.Errors.Number:n,void(e._isExecuteFunc=!1)}function J(e,t){var n,r,o,i,a,l=[];if(!t)return{_args:e,_isExecuteFunc:!0};if(t._isAllArgsSameLimit)for(o=0;o<e.length;o++)l.push(t);else l=Array.isArray(t)?t:[t];for(r=0;r<l.length;r++){if(i=l[r],i._acceptsRealValue&&!e[r])throw b().Exp_ArgumentNull;if(a=e[r]!==C){if(n=Y(e[r],i),i._argCondition&&Z(n,i._argCondition,i._conditionErrorValue),!n._isExecuteFunc)break;e[r]=i._needArgExistsValue?{_isArgExists:a,_value:n._retValue}:n._retValue}else e[r]=i._needArgExistsValue?{_isArgExists:a,_value:i._defaultValue}:i._defaultValue}return n?{_args:e,_isExecuteFunc:n._isExecuteFunc,_result:n._retValue}:void 0}}()},function(e,t,n){!function(){"use strict";var t,r,o=n(2),i=n(1),a=o._DateTimeHelper._toOADate,l=o._ArrayHelper._getLength,s=o._RegexHelper,u=o._Types,c=u._inArray,_=u._isNullOrUndefined,f=void 0,d=isNaN,h=Math.abs,g=Math.exp,p=Math.log,m=Math.pow,v=i.Errors,C=v.Value,w=v.Number,y=v.DivideByZero,S=v.NotAvailable,x=v.Null,b=i.Convert,T=b.CalcConvertedError,R=b._tryToDouble,A=b._toInt,I=b._toDouble,M=b._isNumber,E=b._toArray,F=b._toResult,D=b._isError,N=i.Functions,V=i._Helper,O=V._approxEqual,H=parseInt,P=null,L=Math.floor,k=function(){return o._getResource(i.SR)()};function B(e){this._args=e}B.prototype={_acceptsArgs:function(e){var t,n,r,o,i=this._args;if(u._isArray(i)||(i=[i]),-1===i[0])return!0;for(t=0;t<i.length;t++)if(n=i[t],U(n)){if(n=n.split(" "),r=n[0],o=parseInt(n[1]),"!="===r&&e!==o||">"===r&&e>o||">="===r&&e>=o||"%="===r&&e%2===o)return!0}else if(e===n)return!0;return!1},_checkArgs:function(){return this._args}};function W(e,t,n){if(_(e))throw k().Exp_InvalidFunctionName;if(e=e.toUpperCase(),N._builtInFunctions[e])throw k().Exp_InvalidOverrideFunction;var r=N._builtInFunctions[e];if(r){if(!n||!n.override)throw k().Exp_OverrideNotAllowed}else N._builtInFunctions[e]=r=new N.Function(e,0,255);return t&&"function"==typeof t&&(r.evaluate=t),u._each(n,function(e,t){var o;c(e,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","precedentReference","expandColumns","expandRows"])>=0?(o=new B(t),r[e]=function(e){return o._acceptsArgs(e)}):c(e,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive"])>=0?(o=new B(t),r[e]=function(){return o._checkArgs()}):n.hasOwnProperty(e)&&"override"!==e&&(r[e]=t)}),r}N._defineBuiltInFunction=function(e,t,n,r,o,i,a,l){return l||(l={}),n!==f&&(l.minArgs=n),r!==f&&(l.maxArgs=r),i!==f&&(l.acceptsReference=i),a!==f&&(l.acceptsArray=a),o!==f&&(l._argsLimit=o),l._acceptsMissingArgument!==f&&(l.acceptsMissingArgument=l._acceptsMissingArgument),l._isVolatile!==f&&(l.isVolatile=l._isVolatile),l._isContextSensitive!==f&&(l.isContextSensitive=l._isContextSensitive),l._precedentReference!==f&&(l.precedentReference=l._precedentReference),l._arrayArgumentEvaluateMode!==f&&(l.arrayArgumentEvaluateMode=l._arrayArgumentEvaluateMode),l._acceptsError!==f&&(l.acceptsError=l._acceptsError),W(e,t,l)},N._MAX_DOUBLE_VALUE=1.79769e308;function z(e){return"boolean"==typeof e}N._isBoolean=z;function U(e){return"string"==typeof e}N._isString=U;function Y(e){return"number"==typeof e}N._isNumber=Y;function G(e){return e%400==0||e%4==0&&e%100!=0||1900===e}N._isLeapYear=G;function X(e,t){switch(t){case 0:case 2:case 4:return 360;case 1:return G(e.getFullYear())?366:365;case 3:return 365;default:return-1}}N._annualYearBasis=X;function j(e,t){return e-t}N._compareDateTime=j;function K(e,t){return c(t,[0,2,4,6,7,9,11])>=0?31:c(t,[3,5,8,10])>=0?30:1===t?G(e)?29:28:void 0}N._getDaysInMonth=K;function Z(e,t,n,r){var o,i,a=n.getFullYear(),l=n.getMonth(),s=n.getDate(),u=r.getFullYear(),c=r.getMonth(),_=r.getDate();return e?(o=2===l&&K(a,l)===s,i=2===c&&K(u,c)===_,t?(o&&(s=30),i&&(_=30)):o&&i&&(s=30,_=30),31===_&&s>=30&&(_=30)):31===_&&(_=1,t&&c++),31===s&&(s=30),360*(u-a)+30*(c-l)+_-s}function J(e,t,n){var r,o,i=1;return j(e,t)>0&&(o=e,e=t,t=o,i=-1),r=c(n,[1,2,3])>=0?i*A(a(t)-a(e)):c(n,[4,5])>=0?i*Z(!1,5===n,e,t):i*Z(!0,6===n,e,t)}N._daysBetweenBasis=J;function q(e){var t,n,r;return 0===e?n=0:(r=.5*h(e),r>=3?n=1:r<1?(t=r*r,n=((((((((.000124818987*t-.001075204047)*t+.005198775019)*t-.019198292004)*t+.059054035642)*t-.151968751364)*t+.319152932694)*t-.5319230073)*t+.797884560593)*r*2):(r-=2,n=(((((((((((((-45255659e-12*r+.00015252929)*r-19538132e-12)*r-.000676904986)*r+.001390604284)*r-.00079462082)*r-.002034254874)*r+.006549791214)*r-.010557625006)*r+.011630447319)*r-.009279453341)*r+.005353579108)*r-.002141268741)*r+.000535310849)*r+.999936657524)),e>0?.5*(n+1):.5*(1-n)}N._st_normsdist=q;function Q(e,t,n,r,o){var i,a,s,u,c,f,d,h,g,p,m,v,w,S=n<100,x=2===n||102===n,b=x||3===n||103===n,R=5===n||105===n,A=4===n||104===n||R,I=9===n||109===n,D=1===n||101===n||I||r,N=6===n||106===n,V=N?1:0,O=!1,H=0;for(i=0;i<l(e);i++){if(p=e[i],b?m=E(p,0,!1,!1,!1,x):A?m=E(p,5,!1,!0,!1,!0):D?m=E(p,5,!1,I,!1,!0):N&&(m=E(p,5,!1,!1,!1,!0)),m.isError)return m[0];if(m.isConvertError)return C;for(v=m.rangeCount,w=m.isReference,a=0;a<v;a++)for(s=v>1?m[a]:m,w&&(u=p.getRow(a),c=p.getColumn(a)),f=0;f<l(s);f++)if(t||!w||!p.isHiddenRow(a,f,S))for(h=s[f],d=0;d<l(h);d++)!t&&w&&p.isSubtotal(a,f+u,d+c)||(g=h[d])!==T&&(b&&!_(g)&&(!x||""!==g&&M(g,!0))?V++:A&&(!O||R&&g<V||!R&&g>V)?V=g:D?r?(o.sumx+=g,o.sumx2+=g*g,o.n++):(V+=g,H++):N&&(V*=g,H++),O=!0)}return D?I?V:r?void 0:0===H?y:F(V/H):N?F(H>0?V:0):V}N._st_includeSubstotals=Q;function $(e,t,n){var r,o=n%100,i=7===o||8===o,a=7===o||10===o?1:0,l={sumx:0,sumx2:0,n:0};return Q(e,t,n,!0,l),l.n<=a?y:(r=Math.max(0,(l.n*l.sumx2-l.sumx*l.sumx)/(l.n*(l.n-a))),F(i?Math.sqrt(r):r))}N._st_devVarIncludeSubtotals=$;function ee(e,t,n){var r,o,i,a,s,u,c,_,f,d,h,g,p,m=1===t||3===t||5===t||7===t,v=1===t||2===t||3===t||4===t||0===t,w=2===t||3===t||6===t||7===t,y=2===n,S=y||3===n,x=12===n,b=13===n,T=14===n,R=15===n,A=16===n,I=17===n,M=18===n,F=19===n,N=T||R||A||I||M||F,V=[];if(N&&2!==l(e))return C;for(r=0;r<l(e);r++){if(d=e[r],h=S?E(d,0,!1,!1,!1,!0):E(d,5,!1,!1,!1,!0),h.isConvertError)return C;for(g=h.rangeCount,p=h.isReference,o=0;o<g;o++)for(i=g>1?h[o]:h,p&&(a=d.getRow(o),s=d.getColumn(o)),u=0;u<l(i);u++)if(!p||!d.isHiddenRow(o,u,!m))for(_=i[u],c=0;c<l(_);c++)if(!(p&&v&&d.isSubtotal(o,u+a,c+s)||(f=_[c],w&&D(f)))){if(!w&&D(f))return f;"object"==typeof f&&0===Object.keys(f).length||V.push(f)}}return x||b||N?de(V,n):7===n||8===n||10===n||11===n?$(V,!1,n):Q(V,!1,n)}N._st_includeAggregate=ee;function te(e){var t=[],n;for(n=0;n<l(e);n++){if(!e[n].length)return e;re(e[n],t)}return t}function ne(e){e.sort(function(e,t){return e-t})}function re(e,t){var n,r;for(n=0;n<l(e);n++)(r=e[n])!==T&&t.push(r);ne(t)}function oe(){var e=te(arguments[0]),t=l(e);return 0===t?w:t%2==0?(I(e[t/2-1])+I(e[t/2]))/2:e[H(""+t/2)]}function ie(){var e,t,n,r=P,o=0,i=te(arguments[0]),a=l(i);for(e=0;e<a;e++){for(n=0,t=0;t<a;t++)t!==e&&i[t]===i[e]&&n++;n>o&&(o=n,r=i[e])}return 0===o?S:r}function ae(e,t){return se(!0,e,t)}function le(e,t){return se(!1,e,t)}function se(e,t,n){var r,o=[];return re(t,o),r=l(o),n<=0||r<n?w:e?o[r-n]:o[n-1]}function ue(e,t){var n,r,o;return e=E(e,1,!0,!0,!1,!0),t=I(t),e.isError?e[0]:e.isConvertError||d(t)?C:(n=[],re(e,n),!l(n)||t<0||t>1?w:(r=t*(l(n)-1),o=r%1,r=H(""+r),0===o?n[r]:I(n[r])+o*(I(n[r+1])-I(n[r]))))}function ce(e,t){var n=c(t,[0,1,2,3,4]);return n<0?w:ue(e,.25*n)}function _e(e,t){var n,r,o,i,a=l(e);return ne(e),a?(n=t*(a+1)-1,r=n%1,n<0||a-1<n?w:(o=L(n),i=e[o],0===r?i:i+r*(e[o+1]-i))):w}function fe(e,t){var n=c(t,[1,2,3]);return n<0?w:_e(e,.25*(n+1))}function de(e,t){var n=12===t,r=13===t,o=14===t,i=15===t,a=16===t,l=17===t,s=18===t,u=19===t;return n?oe(e):r?ie(e):o?ae(e[0],e[1]):i?le(e[0],e[1]):a?ue(e[0],e[1]):l?ce(e[0],e[1]):s?_e(e[0],e[1]):u?fe(e[0],e[1]):x}N._st_includeAggregateMulti=de;function he(e){var t=1,n;for(n=e;n>1;n--)t*=n;return t}N._fact=he;function ge(e,t,n){var r=e.getDate(),o=t.getDate(),i=e.getMonth(),a=t.getMonth(),l=e.getFullYear(),s=t.getFullYear();return r=31===r?30:r,n?o=31===o?30:o:31===o&&(r<30?(o=1,++a>12&&(a=1,s++)):o=30),30*(12*(s-l)+a-i)+o-r}N._days360=ge;function pe(e,t,n){var r,o,i,l,s,u,c,_,f,d=J(e,t,n);return d<0&&(d=-d,o=e,e=t,t=o),1===n?(i=e.getFullYear(),l=t.getFullYear(),s=new Date(e),s.setFullYear(s.getFullYear()+1),j(t,s)>0?(_=l+1-i,s=new Date(i,0,1),u=new Date(l+1,0,1),c=A(a(u)-a(s))-365*(l+1-i)):(_=1,c=G(i)&&e.getMonth()<3||G(l)&&256*t.getMonth()+t.getDate()>=541?1:0),f=I(c)/I(_),r=365+f):r=X(new Date,n),d/r}function me(e,t,n){return n<0||n>4?w:pe(e,t,n)}N._yearfrac=me;function ve(e,t,n){var r;return 0===e?r=t<=n:1===e?r=t>=n:2===e?r=t!==n:3===e?r=t<n:4===e?r=t===n:5===e&&(r=t>n),r}function Ce(e,t){var n,r=-1,o=!0,a={value:0},l=s._getWildcardCriteriaFullMatch(t);return 4===e&&l&&(n=function(e){var t=s._getRegIgnoreCase(l);return t.lastIndex=0,t.test(e)}),_(t)?r=0:l?o=!1:R(""+t,a)?r=a.value:o=!1,function(a){var s,u;return!(a instanceof i.CalcError)&&(_(a)&&(a=""),s={value:0},o&&R(a,s)?""!==a&&ve(e,s.value,r):(!l||!M(a,!0))&&(u=_(t)?"":(""+t).toUpperCase(),l&&n?n(""+a):ve(e,(""+a).toUpperCase(),u)))}}t={},r={_approxFloor:function(e){var t=Math.floor(e);return O(e,t+1)?t+1:t},_parseCriteria:function(e){var n,r,o,i,a,s,u=e,c=t;if(c||(t=c={}),n=c[u])return n;if(M(e))return n=c[u]=Ce(4,e);for(r="=><",o=_(e)?"":(""+e).toUpperCase(),i="\0",a=0;a<2&&a<l(o);a++){if(s=o[a],-1===r.indexOf(s)){if("<"===i)return c[u]=n=Ce(3,o.substring(1)),n;if(">"===i)return c[u]=n=Ce(5,o.substring(1)),n;break}if("="===s)return n="<"===i?Ce(0,o.substring(2)):">"===i?Ce(1,o.substring(2)):Ce(4,"\0"===i?o.substring(1):e),c[u]=n,n;if("\0"===i)i=s;else{if("<"===i)return n=">"===s?Ce(2,o.substring(2)):Ce(3,o.substring(1)),c[u]=n,n;if(">"===i)return c[u]=n=Ce(5,o.substring(1)),n}}return c[u]=n=Ce(4,e),n},_pow10:function(e){var t=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][e];return _(t)?m(10,parseFloat(e)):t},_approxCeiling:function(e){var t=Math.ceil(e);return O(e,t-1)?t-1:t},_round:function(e,t){var n=r._pow10(h(t));return e=t<0?e/n:e*n,e=e<0?r._approxCeiling(e-.5):r._approxFloor(e+.5),e=t<0?e*n:e/n,F(e)},_combin:function(e,t){if(e<0||t<0||e<t)return w;var n=1,r;for(t=Math.min(e-t,t),r=1;r<=t;r++)n*=e-r+1,n/=r;return F(n)},_pow1p:function(e,t){var n=h(e)>.5?m(1+e,t):g(t*p(1+e));return isFinite(n)?d(n)&&(n=5e-324):n===Number.POSITIVE_INFINITY?n=N._MAX_DOUBLE_VALUE:n===Number.NEGATIVE_INFINITY&&(n=-N._MAX_DOUBLE_VALUE),n},_sinhCosh:function(e,t){return(g(e)+(t?-1:1)*g(-e))/2},_log:function(e,t){return d(e)?e:d(t)?t:1!==t&&1===e||0!==t&&t!==Number.POSITIVE_INFINITY?p(e)/p(t):NaN}},N._MathHelper=r,e.exports=N}()},function(e,t){!function(){"use strict";function t(e,t){return{description:e,parameters:t}}function n(e,t){return{name:e,repeatable:t}}e.exports={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",_builtInFunctionsResource:{ABS:t("This function calculates the absolute value of the specified value.",[n("value")]),ACCRINT:t("This function calculates the accrued interest for a security that pays periodic interest.",[n("issue"),n("first"),n("settle"),n("rate"),n("par"),n("frequency"),n("basis")]),ACCRINTM:t("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[n("issue"),n("maturity"),n("rate"),n("par"),n("basis")]),ACOS:t("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[n("value")]),ACOSH:t("This function calculates the inverse hyperbolic cosine of the specified value.",[n("value")]),ADDRESS:t("This function uses the row and column numbers to create a cell address in text.",[n("row"),n("column"),n("absnum"),n("a1style"),n("sheettext")]),AMORDEGRC:t("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[n("cost"),n("datepurchased"),n("firstperiod"),n("salvage"),n("period"),n("drate"),n("basis")]),AMORLINC:t("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[n("cost"),n("datepurchased"),n("firstperiod"),n("salvage"),n("period"),n("drate"),n("basis")]),AND:t("Check whether all arguments are True, and returns True if all arguments are True.",[n("logical1"),n("logical2")]),ASIN:t("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[n("value")]),ASINH:t("This function calculates the inverse hyperbolic sine of a number.",[n("value")]),ATAN:t("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[n("value")]),ATAN2:t("This function calculates the arctangent of the specified x- and y-coordinates.",[n("x"),n("y")]),ATANH:t("This function calculates the inverse hyperbolic tangent of a number.",[n("value")]),AVEDEV:t("This function calculates the average of the absolute deviations of the specified values from their mean.",[n("value1"),n("value2",!0)]),AVERAGE:t("This function calculates the average of the specified numeric values.",[n("value1"),n("value2",!0)]),AVERAGEA:t("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[n("value1"),n("value2",!0)]),AVERAGEIF:t("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[n("value1"),n("value2",!0),n("condition")]),AVERAGEIFS:t("This function calculates the average of all cells that meet multiple specified criteria.",[n("value1"),n("condition1"),n("value2",!0),n("condition2...")]),BESSELI:t("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[n("value"),n("order")]),BESSELJ:t("This function calculates the Bessel function of the first kind.",[n("value"),n("order")]),BESSELK:t("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[n("value"),n("order")]),BESSELY:t("This function calculates the Bessel function of the second kind.",[n("value"),n("order")]),BETADIST:t("This function calculates the cumulative beta distribution function.",[n("x"),n("alpha"),n("beta"),n("lower"),n("upper")]),BETAINV:t("This function calculates the inverse of the cumulative beta distribution function.",[n("prob"),n("alpha"),n("beta"),n("lower"),n("upper")]),BIN2DEC:t("This function converts a binary number to a decimal number",[n("number")]),BIN2HEX:t("This function converts a binary number to a hexadecimal number.",[n("number"),n("places")]),BIN2OCT:t("This function converts a binary number to an octal number.",[n("number"),n("places")]),BINOMDIST:t("This function calculates the individual term binomial distribution probability.",[n("x"),n("n"),n("p"),n("cumulative")]),CEILING:t("This function rounds a number up to the nearest multiple of a specified value.",[n("value"),n("signif")]),CHAR:t("This function returns the character specified by a number.",[n("value")]),CHIDIST:t("This function calculates the one-tailed probability of the chi-squared distribution.",[n("value"),n("deg")]),CHIINV:t("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[n("prob"),n("deg")]),CHITEST:t("This function calculates the test for independence from the chi-squared distribution.",[n("obs_array"),n("exp_array")]),CHOOSE:t("This function returns a value from a list of values.",[n("index"),n("value1"),n("value2",!0)]),CLEAN:t("This function removes all non-printable characters from text.",[n("text")]),CODE:t("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[n("text")]),COLUMN:t("This function returns the column number of a reference.",[n("reference")]),COLUMNS:t("This function returns the number of columns in an array.",[n("array")]),COMBIN:t("This function calculates the number of possible combinations for a specified number of items.",[n("k"),n("n")]),COMPLEX:t("This function converts real and imaginary coefficients into a complex number.",[n("realcoeff"),n("imagcoeff"),n("suffix")]),CONCATENATE:t("This function combines multiple text strings or numbers into one text string.",[n("text1"),n("text2"),n("....")]),CONFIDENCE:t("This function returns confidence interval for a population mean.",[n("alpha"),n("stdev"),n("size")]),CONVERT:t("This function converts a number from one measurement system to its equivalent in another measurement system.",[n("number"),n("from-unit"),n("to-unit")]),CORREL:t("This function returns the correlation coefficient of the two sets of data.",[n("array1"),n("array2")]),COS:t("This function returns the cosine of the specified angle.",[n("angle")]),COSH:t("This function returns the hyperbolic cosine of the specified value.",[n("value")]),COUNT:t("This function returns the number of cells that contain numbers.",[n("value1"),n("value2",!0)]),COUNTA:t("This function returns the number of number of cells that contain numbers, text, or logical values.",[n("value1"),n("value2",!0)]),COUNTBLANK:t("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[n("cellrange")]),COUNTIF:t("This function returns the number of cells that meet a certain condition",[n("cellrange"),n("condition")]),COUNTIFS:t("This function returns the number of cells that meet multiple conditions.",[n("cellrange"),n("condition")]),COUPDAYBS:t("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[n("settlement"),n("maturity"),n("frequency"),n("basis")]),COUPDAYS:t("This function returns the number of days in the coupon period that contains the settlement date.",[n("settlement"),n("maturity"),n("frequency"),n("basis")]),COUPDAYSNC:t("This function calculates the number of days from the settlement date to the next coupon date.",[n("settlement"),n("maturity"),n("frequency"),n("basis")]),COUPNCD:t("This function returns a date number of the next coupon date after the settlement date.",[n("settlement"),n("maturity"),n("frequency"),n("basi")]),COUPNUM:t("This function returns the number of coupons due between the settlement date and maturity date.",[n("settlement"),n("maturity"),n("frequency"),n("basis")]),COUPPCD:t("This function returns a date number of the previous coupon date before the settlement date.",[n("settlement"),n("maturity"),n("frequency"),n("basis")]),COVAR:t("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[n("array1"),n("array2")]),CRITBINOM:t("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[n("n"),n("p"),n("alpha")]),CUMIPMT:t("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[n("rate"),n("nper"),n("pval"),n("startperiod"),n("endperiod"),n("paytype")]),CUMPRINC:t("This function returns the cumulative principal paid on a loan between the start and end periods.",[n("rate"),n("nper"),n("pval"),n("startperiod"),n("endperiod"),n("paytype")]),DATE:t("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[n("year"),n("month"),n("day")]),DATEDIF:t("This function returns the number of days, months, or years between two dates.",[n("date1"),n("date2"),n("outputcode")]),DATEVALUE:t("This function returns a DateTime object of the specified date.",[n("date_string")]),DAVERAGE:t("This function calculates the average of values in a column of a list or database that match the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DAY:t("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[n("date")]),DAYS360:t("This function returns the number of days between two dates based on a 360-day year.",[n("startdate"),n("enddate"),n("method")]),DB:t("This function calculates the depreciation of an asset for a specified period using the fixed\u2011declining balance method",[n("cost"),n("salvage"),n("life"),n("period"),n("month")]),DCOUNT:t("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[n("database"),n(" field"),n(" criteria")]),DCOUNTA:t("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[n("database"),n(" field"),n(" criteria")]),DDB:t("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[n("cost"),n("salvage"),n("life"),n("period"),n("factor")]),DEC2BIN:t("This function converts a decimal number to a binary number.",[n("number"),n("places")]),DEC2HEX:t("This function converts a decimal number to a hexadecimal number",[n("number"),n("places")]),DEC2OCT:t("This function converts a decimal number to an octal number",[n("number"),n("places")]),DEGREES:t("This function converts the specified value from radians to degrees",[n("angle")]),DELTA:t("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[n("value1"),n("value2")]),DEVSQ:t("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[n("value1"),n("value2",!0)]),DGET:t("This function extracts a single value from a column of a list or database that matches the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DISC:t("This function calculates the discount rate for a security.",[n("settle"),n("mature"),n("pricep"),n("redeem"),n("basis")]),DMAX:t("This function returns the largest number in a column of a list or database that matches the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DMIN:t("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DOLLAR:t("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[n("value"),n("digits")]),DOLLARDE:t("This function converts a fraction dollar price to a decimal dollar price.",[n("fractionaldollar"),n("fraction")]),DOLLARFR:t("This function converts a decimal number dollar price to a fraction dollar price.",[n("decimaldollar"),n("fraction")]),DPRODUCT:t("This function multiplies the values in a column of a list or database that match the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DSTDEV:t("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DSTDEVP:t("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DSUM:t("This function adds the numbers in a column of a list or database that match the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DURATION:t("This function returns the Macaulay duration for an assumed par value of $100.",[n("settlement"),n("maturity"),n("coupon"),n("yield"),n("frequency"),n("basis")]),DVAR:t("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[n("database"),n(" field"),n(" criteria")]),DVARP:t("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[n("database"),n(" field"),n(" criteria")]),EDATE:t("This function calculates the date that is the indicated number of months before or after a specified date.",[n("startdate"),n("months")]),EFFECT:t("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[n("nomrate"),n("comper")]),EOMONTH:t("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[n("startdate"),n("months")]),ERF:t("This function calculates the error function integrated between a lower and an upper limit.",[n("limit"),n("upperlimit")]),ERFC:t("This function calculates the complementary error function integrated between a lower limit and infinity.",[n("lowerlimit")]),"ERROR.TYPE":t("This function returns a number corresponding to one of the error values.",[n("errorvalue")]),EURO:t("This function returns the equivalent of one Euro based on the ISO currency code.",[n("code")]),EUROCONVERT:t("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[n("currency"),n("source"),n("target"),n("fullprecision"),n("triangulation")]),EVEN:t("This function rounds the specified value up to the nearest even integer.",[n("value")]),
EXACT:t("This function returns true if two strings are the same; otherwise, false.",[n("text1"),n("text2")]),EXP:t("This function returns e raised to the power of the specified value.",[n("value")]),EXPONDIST:t("This function returns the exponential distribution or the probability density.",[n("value"),n("lambda"),n("cumulative")]),FACT:t("This function calculates the factorial of the specified number.",[n("number")]),FACTDOUBLE:t("This function calculates the double factorial of the specified number.",[n("number")]),FALSE:t("This function returns the value for logical FALSE.",[]),FDIST:t("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[n("value"),n("degnum"),n("degden")]),FIND:t("This function finds one text value within another and returns the text value\u2019s position in the text you searched.",[n("findtext"),n("intext"),n("start")]),FINV:t("This function returns the inverse of the F probability distribution.",[n("p"),n("degnum"),n("degden")]),FISHER:t("This function returns the Fisher transformation for a specified value.",[n("value")]),FISHERINV:t("This function returns the inverse of the Fisher transformation for a specified value.",[n("value")]),FIXED:t("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[n("num"),n("digits"),n("notcomma")]),FLOOR:t("This function rounds a number down to the nearest multiple of a specified value.",[n("value"),n("signif")]),FORECAST:t("This function calculates a future value using existing values.",[n("value"),n("Yarray"),n("Xarray")]),FREQUENCY:t("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[n("dataarray"),n("binarray")]),FTEST:t("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[n("array1"),n("array2")]),FV:t("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[n("rate"),n("numper"),n("paymt"),n("pval"),n("type")]),FVSCHEDULE:t("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[n("principal"),n("schedule")]),GAMMADIST:t("This function returns the gamma distribution.",[n("x"),n("alpha"),n("beta"),n("cumulative")]),GAMMAINV:t("This function returns the inverse of the gamma cumulative distribution.",[n("p"),n("alpha"),n("beta")]),GAMMALN:t("This function returns the natural logarithm of the Gamma function, G(x).",[n("value")]),GCD:t("This function returns the greatest common divisor of two numbers.",[n("number1"),n("number2")]),GEOMEAN:t("This function returns the geometric mean of a set of positive data.",[n("value1"),n("value2",!0)]),GESTEP:t("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[n("number"),n("step")]),GROWTH:t("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[n("y"),n("x"),n("newx"),n("constant")]),HARMEAN:t("This function returns the harmonic mean of a data set.",[n("value1"),n("value2",!0)]),HEX2BIN:t("This function converts a hexadecimal number to a binary number.",[n("number"),n(" places")]),HEX2DEC:t("This function converts a hexadecimal number to a decimal number.",[n("number")]),HEX2OCT:t("This function converts a hexadecimal number to an octal number.",[n("number"),n(" places")]),HLOOKUP:t("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[n("value"),n("array"),n("row"),n("approx")]),HOUR:t("This function returns the hour that corresponds to a specified time.",[n("time")]),HYPGEOMDIST:t("This function returns the hypergeometric distribution.",[n("x"),n("n"),n("M"),n("N")]),IF:t("This function performs a comparison and returns one of two provided values based on that comparison.",[n("valueTest"),n("valueTrue"),n("valueFalse")]),IFERROR:t("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[n("value"),n("error")]),IMABS:t("This function returns the absolute value or modulus of a complex number.",[n("complexnum")]),IMAGINARY:t("This function returns the imaginary coefficient of a complex number.",[n("complexnum")]),IMARGUMENT:t("This function returns the argument theta, which is an angle expressed in radians.",[n("complexnum")]),IMCONJUGATE:t("This function returns the complex conjugate of a complex number.",[n("complexnum")]),IMCOS:t("This function returns the cosine of a complex number.",[n("complexnum")]),IMDIV:t("This function returns the quotient of two complex numbers.",[n("complexnum"),n("complexdenom")]),IMEXP:t("This function returns the exponential of a complex number.",[n("complexnum")]),IMLN:t("This function returns the natural logarithm of a complex number.",[n("complexnum")]),IMLOG2:t("This function returns the base-2 logarithm of a complex number.",[n("complexnum")]),IMLOG10:t("This function returns the common logarithm of a complex number.",[n("complexnum")]),IMPOWER:t("This function returns a complex number raised to a power.",[n("complexnum"),n("powernum")]),IMPRODUCT:t("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[n("complexnum1"),n("complexnum2",!0)]),IMREAL:t("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[n("complexnum")]),IMSIN:t("This function returns the sine of a complex number in the x+yi or x+yj text format.",[n("complexnum")]),IMSQRT:t("This function returns the square root of a complex number in the x+yi or x+yj text format.",[n("complexnum")]),IMSUB:t("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[n("complexnum1"),n("complexnum2")]),IMSUM:t("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[n("complexnum1"),n("complexnum2",!0)]),INDEX:t("This function returns a value or the reference to a value from within an array or range.",[n("return"),n("row"),n("col"),n("area")]),INDIRECT:t("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[n("ref_text"),n("a1_style")]),INT:t("This function rounds a specified number down to the nearest integer.",[n("value")]),INTERCEPT:t("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[n("dependent"),n("independent")]),INTRATE:t("This function calculates the interest rate for a fully invested security.",[n("settle"),n("mature"),n("invest"),n("redeem"),n("basis")]),IPMT:t("This function calculates the payment of interest on a loan.",[n("rate"),n("per"),n("nper"),n("pval"),n("fval"),n("type")]),IRR:t("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[n("arrayvals"),n("estimate")]),ISBLANK:t("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[n("cellreference")]),ISERR:t("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[n("cellreference")]),ISERROR:t("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[n("cellreference")]),ISEVEN:t("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[n("cellreference")]),ISLOGICAL:t("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[n("cellreference")]),ISNA:t("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[n("cellreference")]),ISNONTEXT:t("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[n("cellreference")]),ISNUMBER:t("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[n("cellreference")]),ISODD:t("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[n("cellreference")]),ISPMT:t("This function calculates the interest paid during a specific period of an investment.",[n("rate"),n("per"),n("nper"),n("pv")]),ISREF:t("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[n("cellreference")]),ISTEXT:t("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[n("cellreference")]),KURT:t("This function returns the kurtosis of a data set.",[n("value1"),n("value2"),n("value3"),n("value4",!0)]),LARGE:t("This function returns the nth largest value in a data set, where n is specified.",[n("array"),n("n")]),LCM:t("This function returns the least common multiple of two numbers.",[n("number1"),n("number2")]),LEFT:t("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[n("mytext"),n("num_chars")]),LEN:t("This function returns the length of the number of characters in a text string.",[n("value")]),LINEST:t("This function calculates the statistics for a line.",[n("y"),n("x"),n("constant"),n("stats")]),LN:t("This function returns the natural logarithm of the specified number.",[n("value")]),LOG:t("This function returns the logarithm base Y of a number X.",[n("number"),n("base")]),LOG10:t("This function returns the logarithm base 10 of the number given.",[n("value")]),LOGEST:t("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[n("y"),n("x"),n("constant"),n("stats")]),LOGINV:t("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[n("prob"),n("mean"),n("stdev")]),LOGNORMDIST:t("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[n("x"),n("mean"),n("stdev")]),LOOKUP:t("This function searches for a value and returns a value from the same location in a second area.",[n("lookupvalue"),n("lookupvector"),n("resultvector")]),LOWER:t("This function converts text to lower case letters.",[n("string")]),MATCH:t("This function returns the relative position of a specified item in a range.",[n("value1"),n("array"),n("type")]),MAX:t("This function returns the maximum value, the greatest value, of all the values in the arguments.",[n("value1"),n("value2",!0)]),MAXA:t("This function returns the largest value in a list of arguments, including text and logical values.",[n("value1"),n("value2",!0)]),MDETERM:t("This function returns the matrix determinant of an array.",[n("array")]),MDURATION:t("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[n("settlement"),n("maturity"),n("coupon"),n("yield"),n("frequency"),n("basis")]),MEDIAN:t("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[n("value1"),n("value2",!0)]),MID:t("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[n("text"),n("start_num"),n("num_chars")]),MIN:t("This function returns the minimum value, the least value, of all the values in the arguments.",[n("value1"),n("value2",!0)]),MINA:t("This function returns the minimum value in a list of arguments, including text and logical values.",[n("value1"),n("value2",!0)]),MINUTE:t("This function returns the minute corresponding to a specified time.",[n("time")]),MINVERSE:t("This function returns the inverse matrix for the matrix stored in an array.",[n("array")]),MIRR:t("This function returns the modified internal rate of return for a series of periodic cash flows.",[n("arrayvals"),n("payment_int"),n("income_int")]),MMULT:t("This function returns the matrix product for two arrays.",[n("array1"),n("array2")]),MOD:t("This function returns the remainder of a division operation.",[n("dividend"),n("divisor")]),MODE:t("This function returns the most frequently occurring value in a set of data.",[n("value1"),n("value2",!0)]),MONTH:t("This function returns the month corresponding to the specified date value.",[n("date")]),MROUND:t("This function returns a number rounded to the desired multiple.",[n("number"),n("multiple")]),MULTINOMIAL:t("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[n("value1"),n("value2",!0)]),N:t("This function returns a value converted to a number.",[n("value")]),NA:t("This function returns the error value #N/A that means not available.",[]),NEGBINOMDIST:t("This function returns the negative binomial distribution.",[n("x"),n("r"),n("p")]),NETWORKDAYS:t("This function returns the total number of complete working days between the start and end dates.",[n("startdate"),n("enddate"),n("holidays")]),NOMINAL:t("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[n("effrate"),n("comper")]),NORMDIST:t("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[n("x"),n("mean"),n("stdev"),n("cumulative")]),NORMINV:t("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[n("prob"),n("mean"),n("stdev")]),NORMSDIST:t("This function returns the standard normal cumulative distribution function.",[n("value")]),NORMSINV:t("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[n("prob")]),NOT:t("This function reverses the logical value of its argument.",[n("value")]),NOW:t("This function returns the current date and time.",[]),NPER:t("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[n("rate"),n("paymt"),n("pval"),n("fval"),n("type")]),NPV:t("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[n("discount"),n("value1"),n("value2",!0)]),OCT2BIN:t("This function converts an octal number to a binary number.",[n("number"),n("places")]),OCT2DEC:t("This function converts an octal number to a decimal number.",[n("number")]),OCT2HEX:t("This function converts an octal number to a hexadecimal number.",[n("number"),n("places")]),ODD:t("This function rounds the specified value up to the nearest odd integer.",[n("value")]),ODDFPRICE:t("This function calculates the price per $100 face value of a security with an odd first period.",[n("settle"),n("maturity"),n("issue"),n("first"),n("rate"),n("yield"),n("redeem"),n("freq"),n("basis")]),ODDFYIELD:t("This function calculates the yield of a security with an odd first period.",[n("settle"),n("maturity"),n("issue"),n("first"),n("rate"),n("price"),n("redeem"),n("freq"),n("basis")]),ODDLPRICE:t("This function calculates the price per $100 face value of a security with an odd last coupon period.",[n("settle"),n("maturity"),n("last"),n("rate"),n("yield"),n("redeem"),n("freq"),n("basis")]),ODDLYIELD:t("This function calculates the yield of a security with an odd last period.",[n("settle"),n("maturity"),n("last"),n("rate"),n("price"),n("redeem"),n("freq"),n("basis")]),OFFSET:t("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[n("reference"),n("rows"),n("cols"),n("height"),n("width")]),OR:t("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[n("argument1"),n("argument2...")]),PEARSON:t("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[n("array_ind"),n("array_dep")]),PERCENTILE:t("This function returns the nth percentile of values in a range.",[n("array"),n("n")]),PERCENTRANK:t("This function returns the rank of a value in a data set as a percentage of the data set.",[n("array"),n("n"),n("sigdig")]),PERMUT:t("This function returns the number of possible permutations for a specified number of items.",[n("k"),n("n")]),PI:t("This function returns PI as 3.1415926536.",[]),PMT:t("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[n("rate"),n("nper"),n("pval"),n("fval"),n("type")]),POISSON:t("This function returns the Poisson distribution.",[n("nevents"),n("mean"),n("cumulative")]),POWER:t("This function raises the specified number to the specified power.",[n("number"),n("power")]),PPMT:t("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[n("rate"),n("per"),n("nper"),n("pval"),n("fval"),n("type")]),PRICE:t("This function calculates the price per $100 face value of a periodic interest security",[n("settlement"),n("maturity"),n("rate"),n("yield"),n("redeem"),n("frequency"),n("basis")]),PRICEDISC:t("This function returns the price per $100 face value of a discounted security.",[n("settle"),n("mature"),n("discount"),n("redeem"),n("basis")]),PRICEMAT:t("This function returns the price at maturity per $100 face value of a security that pays interest.",[n("settle"),n("mature"),n("issue"),n("rate"),n("yield"),n("basis")]),PROB:t("This function returns the probability that values in a range are between two limits.",[n("array"),n("probs"),n("lower"),n("upper")]),PRODUCT:t("This function multiplies all the arguments and returns the product.",[n("value1"),n("value2",!0)]),PROPER:t("This function capitalizes the first letter in each word of a text string.",[n("text")]),PV:t("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[n("rate"),n("numper"),n("paymt"),n("fval"),n("type")]),QUARTILE:t("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[n("array"),n("quart")]),QUOTIENT:t("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[n("numerator"),n("denominator")]),RADIANS:t("This function converts the specified number from degrees to radians.",[n("value")]),RAND:t("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:t("This function returns a random number between the numbers you specify.",[n("lower"),n("upper")]),RANK:t("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[n("number"),n("array"),n("order")]),RATE:t("This function returns the interest rate per period of an annuity.",[n("nper"),n("pmt"),n("pval"),n("fval"),n("type"),n("guess")]),RECEIVED:t("This function returns the amount received at maturity for a fully invested security.",[n("settle"),n("mature"),n("invest"),n("discount"),n("basis")]),REPLACE:t("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[n("old_text"),n("start_char"),n("num_chars"),n("new_text")]),REPT:t("This function repeats text a specified number of times.",[n("text"),n("number")]),RIGHT:t("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[n("text"),n("num_chars")]),ROMAN:t("This function converts an Arabic numeral to a Roman numeral text equivalent.",[n("number"),n("style")]),ROUND:t("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[n("value"),n("places")]),ROUNDDOWN:t("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[n("value"),n("places")]),ROUNDUP:t("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[n("value"),n("places")]),ROW:t("This function returns the number of a row from a reference.",[n("reference")]),ROWS:t("This function returns the number of rows in an array.",[n("array")]),RSQ:t("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y\ufffds and known x\ufffds.",[n("array_dep"),n("array_ind")]),SEARCH:t("This function finds one text string in another text string and returns the index of the starting position of the found text.",[n("string1"),n("string2")]),SECOND:t("This function returns the seconds (0 to 59) value for a specified time.",[n("time")]),SERIESSUM:t("This function returns the sum of a power series.",[n("x"),n("n"),n("m"),n("coeff")]),SIGN:t("This function returns the sign of a number or expression.",[n("cellreference")]),SIN:t("This function returns the sine of the specified angle.",[n("angle")]),SINH:t("This function returns the hyperbolic sine of the specified number.",[n("value")]),SKEW:t("This function returns the skewness of a distribution.",[n("number1"),n("number2",!0)]),SLN:t("This function returns the straight-line depreciation of an asset for one period.",[n("cost"),n("salvage"),n("life")]),SLOPE:t("This function calculates the slope of a linear regression.",[n("array_dep"),n("array_ind")]),SMALL:t("This function returns the nth smallest value in a data set, where n is specified.",[n("array"),n("n")]),SQRT:t("This function returns the positive square root of the specified number.",[n("value")]),SQRTPI:t("This function returns the positive square root of a multiple of pi (p).",[n("multiple")]),STANDARDIZE:t("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[n("x"),n("mean"),n("stdev")]),STDEVA:t("This function returns the standard deviation for a set of numbers, text, or logical values.",[n("value1"),n("value2",!0)]),STDEVP:t("This function returns the standard deviation for an entire specified population (of numeric values).",[n("value1"),n("value2",!0)]),STDEVPA:t("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[n("value1"),n("value2",!0)]),STEYX:t("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[n("array_dep"),n("array_ind")]),SUBSTITUTE:t("This function substitutes a new string for specified characters in an existing string.",[n("text"),n("old_piece"),n("new_piece"),n("instance")]),SUBTOTAL:t("This function calculates a subtotal of a list of numbers using a specified built-in function.",[n("functioncode"),n("value1"),n("value2",!0)]),SUM:t("This function returns the sum of cells or range of cells.",[n("value1"),n("value2",!0)]),SUMIF:t("This function adds the cells using a given criteria.",[n("array"),n("condition"),n("sumrange")]),SUMIFS:t("This function adds the cells in a range using multiple criteria.",[n("array"),n("conditionarray"),n("condition",!0)]),SUMPRODUCT:t("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[n("array1"),n("array2",!0)]),SUMSQ:t("This function returns the sum of the squares of the arguments.",[n("value1"),n("value2",!0)]),SUMX2MY2:t("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[n("array_x"),n("array_y")]),SUMX2PY2:t("This function returns the sum of the sum of squares of corresponding values in two arrays.",[n("array_x"),n("array_y")]),SUMXMY2:t("This function returns the sum of the square of the differences of corresponding values in two arrays.",[n("array_x"),n("array_y")]),SYD:t("This function returns the sum-of-years\ufffd digits depreciation of an asset for a specified period.",[n("cost"),n("salvage"),n("life"),n("period")]),T:t("This function returns the text in a specified cell.",[n("value")]),TAN:t("This function returns the tangent of the specified angle.",[n("angle")]),TANH:t("This function returns the hyperbolic tangent of the specified number.",[n("value")]),TBILLEQ:t("This function returns the equivalent yield for a Treasury bill (or T-bill)",[n("settle"),n("mature"),n("discount")]),TBILLPRICE:t("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[n("settle"),n("mature"),n("discount")]),TBILLYIELD:t("This function returns the yield for a Treasury bill (or T-bill).",[n("settle"),n("mature"),n("priceper")]),TDIST:t("This function returns the probability for the t-distribution.",[n("x"),n("deg"),n("tails")]),TEXT:t("This function formats a number and converts it to text.",[n("value"),n("text")]),TIME:t("This function returns the TimeSpan object for a specified time.",[n("hour"),n("minutes"),n("seconds")]),TIMEVALUE:t("This function returns the TimeSpan object of the time represented by a text string.",[n("time_string")]),TINV:t("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[n("prog"),n("deg")]),TODAY:t("This function returns the date and time of the current date.",[]),TRANSPOSE:t("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[n("array")]),TREND:t("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[n("y"),n("x"),n("newx"),n("constant")]),TRIM:t("This function removes extra spaces from a string and leaves single spaces between words.",[n("text")]),TRIMMEAN:t("This function returns the mean of a subset of data excluding the top and bottom data.",[n("array"),n("percent")]),TRUE:t("This function returns the value for logical TRUE.",[]),TRUNC:t("This function removes the specified fractional part of the specified number.",[n("value"),n("precision")]),TTEST:t("This function returns the probability associated with a t-test.",[n("array1"),n("array2"),n("tails"),n("type")]),TYPE:t("This function returns the type of value.",[n("value")]),UPPER:t("This function converts text to uppercase letters.",[n("string")]),VALUE:t("This function converts a text string that is a number to a numeric value.",[n("text")]),VAR:t("This function returns the variance based on a sample of a population, which uses only numeric values.",[n("value1"),n("value2",!0)]),VARA:t("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[n("value1"),n("value2",!0)]),VARP:t("This function returns variance based on the entire population, which uses only numeric values.",[n("value1"),n("value2",!0)]),VARPA:t("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[n("value1"),n("value2",!0)]),VDB:t("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[n("cost"),n("salvage"),n("life"),n("start"),n("end"),n("factor"),n("switchnot")]),VLOOKUP:t("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[n("value"),n("array"),n("colindex"),n("approx")]),WEEKDAY:t("This function returns the number corresponding to the day of the week for a specified date.",[n("date"),n("type")]),WEEKNUM:t("This function returns a number that indicates the week of the year numerically.",[n("date"),n("weektype")]),WEIBULL:t("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[n("x"),n("alpha"),n("beta"),n("cumulative")]),WORKDAY:t("This function returns the number of working days before or after the starting date.",[n("startdate"),n("numdays"),n("holidays")]),XIRR:t("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[n("values"),n("dates"),n("guess")]),XNPV:t("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[n("rate"),n("values"),n("dates")]),YEAR:t("This function returns the year as an integer for a specified date.",[n("date")]),YEARFRAC:t("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[n("startdate"),n("enddate"),n("basis")]),YIELD:t("This function calculates the yield on a security that pays periodic interest.",[n("settle"),n("maturity"),n("rate"),n("price"),n("redeem"),n("frequency"),n("basis")]),YIELDDISC:t("This function calculates the annual yield for a discounted security.",[n("settle"),n("maturity"),n("price"),n("redeem"),n("basis")]),YIELDMAT:t("This function calculates the annual yield of a security that pays interest at maturity.",[n("settle"),n("maturity"),n("issue"),n("issrate"),n("price"),n("basis")]),ZTEST:t("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[n("array"),n("x"),n("sigma")]),HBARSPARKLINE:t("This function returns a data set used for representing a Hbar sparkline",[n("value"),n("colorScheme")]),VBARSPARKLINE:t("This function returns a data set used for representing a Vbar sparkline",[n("value"),n("colorScheme")]),VARISPARKLINE:t("This function returns a data set used for representing a variance sparkline",[n("variance"),n("reference"),n("mini"),n("maxi"),n("mark"),n("tickunit"),n("legend"),n("colorPositive"),n("colorNegative"),n("vertical")]),PIESPARKLINE:t("This function returns a data set used for representing a pie sparkline",[n("range|percentage"),n("color",!0)]),AREASPARKLINE:t("This function returns a data set used for representing a area sparkline",[n("points"),n("mini"),n("maxi"),n("line1"),n("line2"),n("colorPositive"),n("colorNegative")]),SCATTERSPARKLINE:t("This function returns a data set used for representing a scatter sparkline",[n("points1"),n("points2"),n("minX"),n("maxX"),n("minY"),n("maxY"),n("hLine"),n("vLine"),n("xMinZone"),n("xMaxZone"),n("yMinZone"),n("yMaxZone"),n("tags"),n("drawSymbol"),n("drawLines"),n("color1"),n("color2"),n("dash")]),LINESPARKLINE:t("This function returns a data set used for representing a line sparkline",[n("data"),n("dataOrientation"),n("dateAxisData"),n("dateAxisOrientation"),n("setting")]),
COLUMNSPARKLINE:t("This function returns a data set used for representing a column sparkline",[n("data"),n("dataOrientation"),n("dateAxisData"),n("dateAxisOrientation"),n("setting")]),WINLOSSSPARKLINE:t("This function returns a data set used for representing a win/loss sparkline",[n("data"),n("dataOrientation"),n("dateAxisData"),n("dateAxisOrientation"),n("setting")]),BULLETSPARKLINE:t("This function returns a data set used for representing a bullet sparkline",[n("measure"),n("target"),n("maxi"),n("good"),n("bad"),n("forecast"),n("tickunit"),n("colorScheme"),n("vertical")]),SPREADSPARKLINE:t("This function returns a data set used for representing a spread sparkline",[n("points"),n("showAverage"),n("scaleStart"),n("scaleEnd"),n("style"),n("colorScheme"),n("vertical")]),STACKEDSPARKLINE:t("This function returns a data set used for representing a stacked sparkline",[n("points"),n("colorRange"),n("labelRange"),n("maximum"),n("targetRed"),n("targetGreen"),n("targetBlue"),n("tragetYellow"),n("color"),n("highlightPosition"),n("vertical"),n("textOrientation"),n("textSize")]),BOXPLOTSPARKLINE:t("This function returns a data set used for representing a boxplot sparkline",[n("points"),n("boxPlotClass"),n("showAverage"),n("scaleStart"),n("scaleEnd"),n("acceptableStart"),n("acceptableEnd"),n("colorScheme"),n("style"),n("vertical")]),CASCADESPARKLINE:t("This function returns a data set used for representing a cascade sparkline",[n("pointsRange"),n("pointIndex"),n("labelsRange"),n("minimum"),n("maximum"),n("colorPositive"),n("colorNegative"),n("vertical")]),PARETOSPARKLINE:t("This function returns a data set used for representing a pareto sparkline",[n("points"),n("pointIndex"),n("colorRange"),n("target"),n("target2"),n("highlightPosition"),n("label"),n("vertical")]),MONTHSPARKLINE:t("This function returns a data set used for representing a month sparkline",[n("year"),n("month"),n("dataRange"),n("emptyColor"),n("startColor"),n("middleColor"),n("endColor")]),YEARSPARKLINE:t("This function returns a data set used for representing a year sparkline",[n("year"),n("dataRange"),n("emptyColor"),n("startColor"),n("middleColor"),n("endColor")]),"CEILING.PRECISE":t("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[n("number"),n("signif")]),"COVARIANCE.S":t("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[n("array1"),n("array2")]),"FLOOR.PRECISE":t("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[n("number"),n("signif")]),"PERCENTILE.EXC":t("This function returns the nth percentile of values in a range.",[n("array"),n("n")]),"QUARTILE.EXC":t("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[n("array"),n("quart")]),"RANK.AVG":t("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[n("number"),n("array"),n("order")]),"MODE.MULT":t("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[n("number1"),n("number2",!0)]),"STDEV.P":t("This function returns the standard deviation for an entire specified population (of numeric values).",[n("value1"),n("value2",!0)]),"VAR.P":t("This function returns variance based on the entire population, which uses only numeric values.",[n("value1"),n("value2",!0)]),"COVARIANCE.P":t("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[n("array1"),n("array2")]),"MODE.SNGL":t("This function returns the most frequently occurring value in a set of data.",[n("value1"),n("value2",!0)]),"PERCENTILE.INC":t("This function returns the nth percentile of values in a range.",[n("array"),n("n")]),"QUARTILE.INC":t("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[n("array"),n("quart")]),"RANK.EQ":t("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[n("number"),n("array"),n("order")]),STDEV:t("This function returns standard deviation is estimated based on a sample.",[n("number1"),n("number2",!0)]),"STDEV.S":t("This function returns standard deviation is estimated based on a sample.",[n("number1"),n("number2",!0)]),"VAR.S":t("This function returns the variance based on a sample of a population, which uses only numeric values.",[n("value1"),n("value2",!0)]),"BETA.INV":t("This function calculates the inverse of the cumulative beta distribution function.",[n("prob"),n("alpha"),n("beta"),n("lower"),n("upper")]),"BINOM.DIST":t("This function calculates the individual term binomial distribution probability.",[n("x"),n("n"),n("p"),n("cumulative")]),"BINOM.INV":t("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[n("n"),n("p"),n("alpha")]),"CHISQ.DIST.RT":t("This function calculates the one-tailed probability of the chi-squared distribution.",[n("value"),n("deg")]),"CHISQ.INV.RT":t("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[n("prob"),n("deg")]),"CHISQ.TEST":t("This function calculates the test for independence from the chi-squared distribution.",[n("obs_array"),n("exp_array")]),"CONFIDENCE.NORM":t("This function returns confidence interval for a population mean.",[n("alpha"),n("stdev"),n("size")]),"EXPON.DIST":t("This function returns the exponential distribution or the probability density.",[n("value"),n("lambda"),n("cumulative")]),"F.DIST.RT":t("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[n("value"),n("degnum"),n("degden")]),"F.INV.RT":t("This function returns the inverse of the F probability distribution.",[n("p"),n("degnum"),n("degden")]),"F.TEST":t("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[n("array1"),n("array2")]),"GAMMA.DIST":t("This function returns the gamma distribution.",[n("x"),n("alpha"),n("beta"),n("cumulative")]),"GAMMA.INV":t("This function returns the inverse of the gamma cumulative distribution.",[n("p"),n("alpha"),n("beta")]),"LOGNORM.INV":t("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[n("prob"),n("mean"),n("stdev")]),"NORM.DIST":t("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[n("x"),n("mean"),n("stdev"),n("cumulative")]),"NORM.INV":t("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[n("prob"),n("mean"),n("stdev")]),"NORM.S.INV":t("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[n("prob")]),"PERCENTRANK.INC":t("This function returns the rank of a value in a data set as a percentage of the data set.",[n("array"),n("n"),n("signif")]),"POISSON.DIST":t("This function returns the Poisson distribution.",[n("nevents"),n("mean"),n("cumulative")]),"T.INV.2T":t("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[n("prog"),n("deg")]),"T.TEST":t("This function returns the probability associated with a t-test.",[n("array1"),n("array2"),n("tails"),n("type")]),"WEIBULL.DIST":t("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[n("x"),n("alpha"),n("beta"),n("cumulative")]),"Z.TEST":t("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[n("array"),n("x"),n("sigma")]),"T.DIST.RT":t("This function returns the right-tailed t-distribution.",[n("x"),n("deg")]),"T.DIST.2T":t("This function returns the two-tailed t-distribution.",[n("x"),n("deg")]),"ISO.CEILING":t("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[n("number"),n("signif")]),"BETA.DIST":t("This function returns the beta distribution.",[n("x"),n("alpha"),n("beta"),n("cumulative"),n("lower"),n("upper")]),"GAMMALN.PRECISE":t("This function returns the natural logarithm of the gamma function.",[n("value")]),"ERF.PRECISE":t("This function returns the error function.",[n("lowerlimit")]),"ERFC.PRECISE":t("This function returns the complementary ERF function.",[n("lowerlimit")]),"PERCENTRANK.EXC":t("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[n("array"),n("n"),n("signif")]),"HYPGEOM.DIST":t("This function returns the hypergeometric distribution.",[n("x"),n("n"),n("M"),n("N"),n("cumulative")]),"LOGNORM.DIST":t("This function returns the log normal distribution of x.",[n("x"),n("mean"),n("stdev"),n("cumulative")]),"NEGBINOM.DIST":t("This function returns the negative binomial distribution.",[n("x"),n("r"),n("p"),n("cumulative")]),"NORM.S.DIST":t("This function returns the standard normal distribution.",[n("z"),n("cumulative")]),"T.DIST":t("This function returns the t-distribution.",[n("x"),n("deg"),n("cumulative")]),"F.DIST":t("This function returns the F probability distribution.",[n("x"),n("degnum"),n("degden"),n("cumulative")]),"CHISQ.DIST":t("This function returns the chi-squared distribution.",[n("x"),n("deg"),n("cumulative")]),"F.INV":t("This function returns the inverse of the F probability distribution.",[n("probability"),n("degnum"),n("degden")]),"T.INV":t("This function returns the left-tailed inverse of the t-distribution.",[n("probability"),n("deg")]),"CHISQ.INV":t("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[n("probability"),n("deg")]),"CONFIDENCE.T":t("This function returns the confidence interval for a Student's t distribution.",[n("alpha"),n("stdev"),n("size")]),"NETWORKDAYS.INTL":t("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[n("startdate"),n("enddate"),n("weekend"),n("holidays")]),"WORKDAY.INTL":t("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[n("startdate"),n("numdays"),n("weekend"),n("holidays")]),REFRESH:t("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[n("formula"),n("evaluateMode"),n("interval")]),DAYS:t("This function returns the number of days between two dates.",[n("startdate"),n("enddate")]),ISOWEEKNUM:t("This function returns the number of the ISO week number of the year for a given date.",[n("date")]),BITAND:t('This function returns a bitwise "AND" of two numbers.',[n("number1"),n("number2")]),BITLSHIFT:t('This function returns a bitwise "OR" of two numbers.',[n("number1"),n("number2")]),BITOR:t('This function returns a bitwise "OR" of two numbers.',[n("number1"),n("number2")]),BITRSHIFT:t('This function returns a bitwise "OR" of two numbers.',[n("number1"),n("number2")]),BITXOR:t('This function returns a bitwise "XOR" of two numbers.',[n("number1"),n("number2")]),IMCOSH:t("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[n("complexnum")]),IMCOT:t("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[n("complexnum")]),IMCSC:t("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[n("complexnum")]),IMCSCH:t("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[n("complexnum")]),IMSEC:t("This function returns the secant of a complex number in x+yi of x+yj text format.",[n("complexnum")]),IMSECH:t("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[n("complexnum")]),IMSINH:t("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[n("complexnum")]),IMTAN:t("This function returns the tangent of a complex number in x+yi or x+yj text format.",[n("complexnum")]),PDURATION:t("This function returns the number of periods required by an investment to reach a specified value.",[n("rate"),n("pval"),n("fval")]),RRI:t("This function returns an equivalent interest rate for the growth of an investment.",[n("nper"),n("pval"),n("fval")]),ISFORMULA:t("This function tests whether contains a formula of a referenced cell.",[n("cellreference")]),IFNA:t("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[n("value"),n("value_if_na")]),IFS:t("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[n("valueTest"),n("valueTrue"),n("....")]),SWITCH:t("This function evaluates one value for a list of values, and returns the result corresponding to the first matching value, otherwise returns the default value",[n("convertvalue"),n("matchvalue"),n("matchtrue"),n("matchfalse")]),XOR:t("This function returns a logical exclusive or of all arguments.",[n("logical"),n("....")]),AREAS:t("This function returns the number of areas in a reference.",[n("reference")]),FORMULATEXT:t("This function returns a formula as a string.",[n("reference")]),HYPERLINK:t("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[n("link_location"),n("friendly_name")]),ACOT:t("This function calculates the inverse arccotangent of a number.",[n("value")]),ACOTH:t("This function calculates the inverse hyperbolic arccotangent of a number.",[n("value")]),ARABIC:t("This function converts a Roman numeral text to an Arabic numeral equivalent.",[n("text")]),BASE:t("This function converts a number into a text representation with the given radix (base).",[n("number"),n("radix"),n("minLength")]),"CEILING.MATH":t("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[n("value"),n("signif"),n("mode")]),COMBINA:t("This function calculates the number of possible combinations with repetitions for a specified number of items.",[n("number"),n("number_choosen")]),COT:t("This function returns the cotangent of the specified angle.",[n("angle")]),COTH:t("This function returns the hyperbolic cotangent of the specified number.",[n("value")]),CSC:t("This function returns the cosecant of the specified angle.",[n("angle")]),CSCH:t("This function returns the hyperbolic cosecant of the specified number.",[n("value")]),DECIMAL:t("This function converts a text representation of a number in a given base into a decimal number.",[n("text"),n("radix")]),"FLOOR.MATH":t("This function round a number down to the nearest integer or to the nearest multiple of significance.",[n("value"),n("signif"),n("mode")]),SEC:t("This function returns the secant of the specified angle.",[n("angle")]),SECH:t("This function returns the hyperbolic secant of the specified value.",[n("value")]),"BINOM.DIST.RANGE":t("This function calculates the probability of a trial result using a binomial distribution.",[n("x"),n("n"),n("p"),n("cumulative")]),GAMMA:t("This function returns the gamma function value.",[n("number")]),MAXIFS:t("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[n("array"),n("conditionarray"),n("condition",!0)]),GAUSS:t("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[n("number")]),MINIFS:t("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[n("array"),n("conditionarray"),n("condition",!0)]),PERMUTATIONA:t("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[n("k"),n("n")]),PHI:t("This function returns the value of the density function for a standard normal distribution.",[n("value")]),"SKEW.P":t("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[n("number1"),n("number2",!0)]),BAHTTEXT:t('This function converts a number to Thai text and adds a suffix of "Baht"',[n("number")]),CONCAT:t('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[n("text1"),n("text2"),n("....")]),FINDB:t("This function finds one text value within another and returns the text value\ufffds position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[n("findtext"),n("intext"),n("start")]),LEFTB:t("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[n("mytext"),n("num_bytes")]),LENB:t("This function returns the length of the number of bytes in a text string.",[n("value")]),MIDB:t("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[n("text"),n("start_num"),n("num_bytes")]),REPLACEB:t("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[n("old_text"),n("start_byte"),n("num_bytes"),n("new_text")]),RIGHTB:t("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[n("text"),n("num_bytes")]),SEARCHB:t("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[n("string1"),n("string2")]),TEXTJOIN:t("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[n("delimiter"),n("ignore_empty"),n("text1"),n("text2"),n("....")]),UNICHAR:t("This function returns the Unicode character of a given numeric reference.",[n("number")]),UNICODE:t("This function returns the number corresponding to the first character of the text.",[n("text")]),ENCODEURL:t("This function returns a URL-encoded string.",[n("text")])}}}()}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.CalcEngine=GC.Spread.CalcEngine||{},GC.Spread.CalcEngine.BasicFunctions=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";e.exports=n(1)}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y=n(2),S=n(3),x=y._RegexHelper,b=y._StringHelper,T=y._DateTimeHelper,R=T._toOADate,A=T._parseLocale,I=y._ArrayHelper._getLength,M=y._Types,E=M._inArray,F=M._isNullOrUndefined,D=void 0,N=isNaN,V=parseFloat,O=parseInt,H=Math.abs,P=Math.sqrt,L=Math.max,k=Math.min,B=Math.floor,W=Math.exp,z=Math.log,U=Math.PI,Y=Math.random,G=Math.pow,X=S.Errors,j=X.Null,K=X.DivideByZero,Z=X.Value,J=X.Reference,q=X.Name,Q=X.NotAvailable,$=X.Number,ee=S.Convert,te=ee.CalcConvertedError,ne=ee._isError,re=ee._isReference,oe=ee._isArray,ie=ee._tryToBool,ae=ee._toInt,le=ee._toDouble,se=ee._toString,ue=ee._isNumber,ce=ee._toArray,_e=ee._toResult,fe=S._Helper,de=fe.tryExtractToSingleValue,he=S.CalcReference,ge=S.Functions,pe=ge._isBoolean,me=ge._isString,ve=ge._isLeapYear,Ce=ge._getDaysInMonth,we=ge._fact,ye=ge._st_includeSubstotals,Se=ge._st_devVarIncludeSubtotals,xe=ge._MathHelper,be=xe._approxCeiling,Te=xe._approxFloor,Re=ge._defineBuiltInFunction,Ae=ee._tryToDouble,Ie=ee._tryToBool,Me=ee._isNotAvailableError,Ee=function(){return y._getResource(S.SR)()};function Fe(e,t){for(;0!==t;){var n=e%t;e=t,t=n}return e}function De(e,t,n,r){return 0===t||0===e?0:0!==n&&e<0?!0===r?Te(e/Math.abs(t))*Math.abs(t):be(e/Math.abs(t))*Math.abs(t):!0===r?be(e/Math.abs(t))*Math.abs(t):Te(e/Math.abs(t))*Math.abs(t)}function Ne(e,t){var n,r,o,i,a,l,s=e[0],u=I(s),c=s.rowCount,_=s.colCount,f=[],d=[],h=[];for(i=1;i<I(e);i+=2){if(l=ce(e[i],0,!0,!1,!1),l.rowCount!==c||l.colCount!==_)return Z;a=xe._parseCriteria(e[i+1]),f.push(l),d.push(a)}for(o=0;o<u;o++){for(r=!0,i=0;i<I(f)&&(a=d[i],n=f[i][o],r=a&&a(n));i++);r&&(n=s[o])!==te&&h.push(n)}return t(h)}function Ve(e,t){return t=t<0?B(t):Math.ceil(t),(e&&t%2==0||!e&&t%2!=0)&&(t+=t<0?-1:1),t}function Oe(e,t,n){return t>0&&n<0?$:t<0&&n>0?(n=-n,e?Te(t/n)*n:be(t/n)*n):e?be(t/n)*n:Te(t/n)*n}function He(e,t,n){var r,o,i,a=xe._pow10(H(n));return t=n<0?t/a:t*a,r=be(t),o=Te(t),e&&(i=r,r=o,o=i),t=t<0?r:o,t=n<0?t*a:t/a,_e(t)}function Pe(e,t,n,r){var o=t?-1:1,i=0,a,l,s;if(I(n)!==I(r))return Q;for(s=0;s<I(n);s++)a=n[s],l=r[s],a!==te&&l!==te&&(i+=e?(a-l)*(a-l):a*a+o*l*l);return _e(i)}function Le(e){return _e(H(e))}function ke(e){return Te(e)}function Be(e,t){var n=1,r;if(e<t)return $;for(t=k(e-t,t),r=1;r<=t;r++)n*=e-r+1,n/=r;return _e(n)}function We(e,t){var n=1,r;for(r=1;r<=t;r++)n*=e+r-1;for(r=2;r<=t;r++)n/=r;return _e(n)}function ze(e,t){var n,r,o,i,a,l,s;if(!e||e.length>255)return 0;if(0===(n=e.length))return 0;if("-"===e[0])return $;for(r=0;r<n&&" "===e[r];)r++;if(o=0,r===n)return 0;for(i=1,a=n-1;a>=r;a--){if(l=e.charCodeAt(a)|" ".charCodeAt(0),(s=l-"a".charCodeAt(0)>=0?l-87:l-48)<0||s>=t)return $;o+=s*i,i*=t}return o}function Ue(e){return 180*e/U}function Ye(e){return Ve(!0,e)}function Ge(e){return Ve(!1,e)}function Xe(e){return we(e)}function je(e){var t=1,n;for(n=e;n>1;n-=2)t*=n;return t}function Ke(e){return _e(z(e))}function Ze(e,t){return e-t*B(e/t)}function Je(){return U}function qe(e,t){return G(e,t)}function Qe(){var e,t,n,r,o=arguments,i=0;for(e=0;e<I(o);e++){if(t=o[e],ne(t))return t;if(re(t)||oe(t)){if(n=ce(t,1,!0,!0,!1),n.isError)return n[0]}else n=ce(t,1,!0,!0,!0);for(r=0;r<I(n);r++)n[r]!==te&&(i+=n[r])}return i}function $e(e){return 0===e?0:-1}function et(){var e,t,n,r,o=arguments,i=0;for(e=0;e<I(o);e++)for(n=o[e],t=0;t<I(n);t++)if((r=n[t])!==te){if(r<0)return $;i=Fe(i,ae(r))}return i}function tt(){var e,t,n,r,o=arguments,i=1,a=[];for(e=0;e<I(o);e++){for(n=o[e],t=0;t<I(n);t++)if((r=n[t])!==te){if(r<0)return $;if(0===r)return 0;a.push(ae(r))}for(t=0;t<I(a);t++)r=a[t],i/=Fe(i,r),i*=r}return i}function nt(){return ye(arguments,!0,6)}function rt(e){return P(e)}function ot(e,t){return O(""+e/t)}function it(e){var t,n=arguments,r=[],o=Z;for(t=1;t<I(n);t++)r[t-1]=n[t];return E(e,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])>=0?o=ye(r,!1,e):E(e,[7,107,8,108,10,110,11,111])>=0&&(o=Se(r,!1,e)),o}function at(e,t){return Oe(!0,e,t)}function lt(e,t){return Oe(!1,e,t)}function st(e,t,n){return De(e,t,n,!0)}function ut(e,t,n){return De(e,t,n,!1)}function ct(e,t,n){var r=""+e.toString(t);return n&&r.length<n?Array.apply(null,{length:n-r.length+1}).join(0)+r:r}function _t(e,t){return e<0&&t>0||t<0&&e>0?$:Te(e/t+.5)*t}function ft(e,t){return xe._round(e,t)}function dt(e,t){return He(!1,e,t)}function ht(e,t){return He(!0,e,t)}function gt(e){return _e(W(e))}function pt(e,t){return be(e/H(t))*H(t)}function mt(e,t){return Te(e/H(t))*H(t)}function vt(e,t){return 1===t?K:_e(xe._log(e,t))}function Ct(e){return _e(xe._log(e,10))}function wt(e,t,n){var r,o,i,a,l,s,u;if(n=n!==D?n:e,F(t)&&(t=0),r=0,i=xe._parseCriteria(t),a=oe(e),l=oe(n),s=e.toArray(0,!0,!1),u=n.toArray(1,!0,!1),(a?1:e.getRangeCount())!==(l?1:n.getRangeCount())||(a?e.getRowCount():e.getRowCount(0))>(l?n.getRowCount():n.getRowCount(0))||(a?e.getColumnCount():e.getColumnCount(0))>(l?n.getColumnCount():n.getColumnCount(0)))return Z;if(s.isError)return s[0];if(u.isError)return u[0];for(o=0;o<I(s);o++)i&&i(s[o])&&u[o]!==te&&(r+=u[o]);return _e(r)}function yt(){return Ne(arguments,function(e){var t,n=0;for(t=0;t<e.length;t++)n+=e[t];return n})}function St(){return Ne(arguments,function(e){var t=null;return e.length>0&&(t=Math.max.apply(null,e)),t})}function xt(){return Ne(arguments,function(e){var t=null;return e.length>0&&(t=Math.min.apply(null,e)),t})}function bt(e){for(var t=[],n=0,r=[];n<e;n++)r[n]=0;for(n=0;n<e;n++)t[n]=r.slice(0),t[n][n]=1;return new S.CalcArray(t)}function Tt(){var e,t,n,r,o,i,a,l=arguments,s=0,u=[],c=0;for(e=0;e<I(l);e++){if(r=ce(l[e],1,!0,!0,!1,!0),r.isError)return r[0];if(r.isConvertError)return Z;if(0===e)t=r.rowCount,n=r.colCount,c=I(r);else if(r.rowCount!==t||r.colCount!==n)return Z;u.push(r)}for(e=0;e<c;e++){for(o=1,i=0;i<I(l);i++){if((a=u[i][e])===te){o=0;break}o*=a}s+=o}return _e(s)}function Rt(){var e,t,n,r,o=arguments,i=0;for(t=0;t<I(o);t++)for(r=o[t],n=0;n<I(r);n++)(e=r[n])!==te&&(i+=e*e);return _e(i)}function At(e,t){return Pe(!1,!0,e,t)}function It(e,t){return Pe(!1,!1,e,t)}function Mt(e,t){return Pe(!0,!1,e,t)}function Et(e,t,n,r){var o,i,a=0;for(o=0;o<I(r);o++){if(i=le(r[o]),N(i))return Z;a+=i*G(e,t+o*n)}return _e(a)}function Ft(e){return _e(P(e*U))}function Dt(e){return U*e/180}function Nt(e){return _e(Math.sin(e))}function Vt(e){var t=Nt(e);return 0===t?K:1/t}function Ot(e){return _e(Math.cos(e))}function Ht(e){var t=Ot(e);return 0===t?K:1/t}function Pt(e){return _e(Math.tan(e))}function Lt(e){return 0===e?K:_e(1/Math.tan(e))}function kt(e){return _e(Math.asin(e))}function Bt(e){return _e(Math.acos(e))}function Wt(e){return _e(xe._sinhCosh(e,!0))}function zt(e){if(e>709||e<-709)return 0;var t=Wt(e);return 0===t?K:1/t}function Ut(e){return _e(xe._sinhCosh(e,!1))}function Yt(e){if(e>709||e<-709)return 0;var t=Ut(e);return 0===t?K:1/t}function Gt(e){return _e(z(e+P(e*e+1)))}function Xt(e){return _e(z(e+P(e*e-1)))}function jt(e){return _e(Math.atan(e))}function Kt(e){return _e(e<0?Math.PI+Math.atan(1/e):Math.atan(1/e))}function Zt(e,t){return 0===e&&0===t?K:_e(Math.atan2(t,e))}function Jt(e){var t=W(e),n=W(-e);return _e(t-n)/(t+n)}function qt(e){return 0===e?K:e>10?1:e<-10?-1:1/Jt(e)}function Qt(e){return _e(z((1+e)/(1-e))/2)}function $t(e){return Qt(1/e)}function en(e){var t=e.rowCount,n=1,r,o,i,a,l,s,u,c;if(e.rangeCount>1||t!==e.colCount)return Z;for(r=0;r<t-1;r++){if(0===e[r][r]){for(s=!1,o=r+1;!s&&o<t;o++)if(0!==e[o][r]){for(a=r;a<t;a++)u=e[r][a],e[r][a]=e[o][a],e[o][a]=u;n*=-1,s=!0}if(!s)return 0}for(i=r+1;i<t;i++)if(0!==e[i][r])for(c=e[i][r]/e[r][r],l=r;l<t;l++)e[i][l]-=c*e[r][l]}for(r=0;r<t;r++)n*=e[r][r];return n}function tn(e){var t=e.rowCount,n=[],r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v;if(e.rangeCount>1||t!==e.colCount)return Z;for(r=0;r<t;r++)for(n[r]=[t],a=0;a<t;a++)n[r][a]=r===a?1:0;for(o=0;o<t;o++){if(0===e[o][o]){for(v=!1,l=o+1;!v&&l<t;l++)if(0!==e[l][o]){for(u=o;u<t;u++)p=e[o][u],e[o][u]=e[l][u],e[l][u]=p;for(c=1;c<t;c++)m=n[o][c],n[o][c]=n[l][c],n[l][c]=m;v=!0}if(!v)return $}for(s=0;s<t;s++)if(s!==o&&0!==e[s][o]){for(h=e[s][o]/e[o][o],_=o;_<t;_++)e[s][_]-=h*e[o][_];for(f=0;f<t;f++)n[s][f]-=h*n[o][f]}}for(i=0;i<t;i++)for(g=e[i][i],d=0;d<t;d++)n[i][d]/=g;return new S.CalcArray(n)}function nn(e,t){var n,r,o,i,a,l,s=e.rowCount,u=e.colCount,c=t.rowCount,_=t.colCount,f=[];if(u!==c)return Z;for(o=0;o<s;o++)for(f[o]=n=[],r=e[o],i=0;i<_;i++){for(l=0,a=0;a<c;a++)l+=r[a]*t[a][i];n[i]=l}return new S.CalcArray(f)}function rn(){var e,t,n,r,o=arguments,i=0,a=1;for(t=0;t<I(o);t++)for(e=o[t],n=0;n<I(e);n++){if((r=ae(e[n]))<0||170<r)return $;i+=r,a*=we(r)}return i<0||170<i?$:we(i)/a}function on(){return H(2*Y()-1)}function an(e,t){return t<e?$:ae(e+Y()*(t-e+1))}function ln(e,t){var n,r,o,i,a,l,s,u,c=["M","D","C","L","X","V","I"],_=[1e3,500,100,50,10,5,1],f=7,d=[];for(n=pe(t)?t?0:4:t,r=0;r<f;r+=2){if(2<=r&&_[r-2]-_[r]<=e){for(o=r,i=r-2,a=0;a<n&&o+1<f&&_[i]-_[o+1]<=e;a++)o++;d.push(c[o]),d.push(c[i]),e+=_[o],e-=_[i]}if(1<=r&&_[r-1]<=e&&(d.push(c[r-1]),e-=_[r-1]),1<=r&&_[r-1]-_[r]<=e){for(l=r,s=r-1,u=0;u<n&&l+1<f&&_[s]-_[l+1]<=e;u++)l++;d.push(c[l]),d.push(c[s]),e+=_[l],e-=_[s]}for(;_[r]<=e;)d.push(c[r]),e-=_[r]}return d.join("")}function sn(e){var t,n,r,o,i,a,l,s,u,c;if(!e.length)return 0;if(e.length>255)return Z;for(e=e.toLowerCase(),t=0,n=e.length-1,o=0,l=-1;n>=0&&" "===e[n];)n--;for(s=0;s<=n&&" "===e[s];)s++;u=!1,s<=n&&"-"===e[s]&&(u=!0,s++);do{for(r=n,c=e[r],--n;n>=s&&(e[n].charCodeAt(0)|" ".charCodeAt(0))===c.charCodeAt(0);)--n;switch(c){case"i":i=r-n,a=1;break;case"v":i=5*(r-n),a=5;break;case"x":i=10*(r-n),a=10;break;case"l":i=50*(r-n),a=50;break;case"c":i=100*(r-n),a=100;break;case"d":i=500*(r-n),a=500;break;case"m":i=1e3*(r-n),a=1e3;break;default:return Z}a>=l?(t+=i-o,l=a,o=0):o+=i}while(n>=s);return 0!==o&&(t-=o),u&&(t=-t),t}function un(e,t){var n,r,o;for(n=0;n<I(t);n++)for(o=t[n],r=0;r<I(o);r++)if(e){if(!o[r])return!1}else if(o[r]&&o[r]!==te)return!0;return!!e}function cn(){return un(!0,arguments)}function _n(){return un(!1,arguments)}function fn(e){var t={};return ee._tryToBool(e,t),!t.value}function dn(e,t,n){var r,o,i=e,a=t,l=de(i);return r=n!==D?n:2!==I(arguments)&&0,o={},ie(l.value,o),o.value?a:r}function hn(e,t){return ne(e)?F(t)?0:t:F(e)?0:e}function gn(e,t){if(!ne(e)&&re(e)){if(e.getRangeCount()>1)return Z;e=e.getValue(0,0,0)}return hn(e,t)}function pn(){return!0}function mn(){return!1}function vn(e,t){return Me(e)?t:e}function Cn(){var e,t,n;for(e=0,t=arguments.length;e<t;e++){if(n={value:!1},ne(arguments[e]))return arguments[e];if(!ie(arguments[e++],n))return Z;if(n.value)return arguments[e]}return Q}function wn(){var e,t,n;if(arguments.length<3)return Z;if(ne(arguments[0]))return arguments[0];for(e=1,t=arguments.length-1;e<t;e++){if(n=arguments[e++],ne(n))return n;if("string"==typeof arguments[0]&&"string"==typeof n){if(arguments[0].toUpperCase()===n.toUpperCase())return arguments[e]}else if(arguments[0]===n)return arguments[e]}return arguments.length%2==0?arguments[arguments.length-1]:Q}function yn(){var e,t,n,r=0;for(e=0;e<I(arguments);e++)for(n=arguments[e],t=0;t<I(n);t++)n[t]&&r++;return!!(r%2)}function Sn(e){var t,n=e.getFullYear(),r=e.getMonth(),o=e.getDate(),i=o;for(t=0;t<r;t++)i+=Ce(n,t);return i}function xn(e){if(me(e)){if(7!==I(e)||N(O(e)))return Z}else if(!N(e)){if(B(e)<1||B(e)>17)return $;e=""+e}var t=["1","2","3","4","5","6","7"],n=[0,0,0,0,0,0,0],r;switch(I(e)){case 1:if(E(e,t)>=0){r=O(e),n[(r+4)%7]=1,n[(r+5)%7]=1;break}return $;case 2:if("1"===e[0]&&E(e[1],t)>=0){r=O(e[1]),n[(r+5)%7]=1;break}return $;case 7:for(r=0;r<7;r++)n[r]=O(e[r]);break;default:return Z}return n}function bn(e,t,n,r,o){var i,a=Wn(t,3);if(ne(a))return a;for(i=ae(a);n<0;++n)t.setDate(t.getDate()-1),i=0===i?6:--i,(e&&(5===i||6===i)||!e&&o[i]||r.indexOf(R(t))>=0)&&n--;for(;n>0;--n)t.setDate(t.getDate()+1),i=6===i?0:++i,(e&&(5===i||6===i)||!e&&o[i]||r.indexOf(R(t))>=0)&&n++;return R(t)}function Tn(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,h;if(i&&(e=e!==D?e:"0000011",l=xn(e),ne(l)))return l;if(t!==D&&(a=ce(t,4,!0,!0,!1)),!a)return o;if(a.isError)return a[0];for(s=I(a),u=[],c=0;c<s;c++)_=a[c],f=T._fromOADate(_),d=f.getDay(),h=I(l)?l[Wn(f,3)]:6===d||0===d,-1===u.indexOf(_)&&!h&&_>=n&&_<=r&&u.push(_);return o-=I(u)}function Rn(e,t,n,r,o,i){var a,l,s,u=ae(R(t)),c=ae(R(n)),_=!1;return u>c&&(a=t,t=n,n=a,l=u,u=c,c=l,_=!0),s=c-u+1,s=i(t,n,s,r),e&&ne(s)?s:s<=0?0:(s=Tn(r,o,u,c,s,e),s=_?-s:s)}function An(e,t,n){var r,o;return t=ee._toDateTime(t),r=new Date(t.getFullYear(),t.getMonth(),1),r.setMonth(r.getMonth()+n),o=Ce(r.getFullYear(),r.getMonth()),r.setDate(e?o:k(t.getDate(),o)),r}function In(e,t,n){e<=1899&&(e+=1900)
;var r=new Date(e,t-1,n);return r<new Date(1899,11,30)?$:r}function Mn(e,t,n){var r=T._fromOADate(0);return r.setHours(e),r.setMinutes(t),r.setSeconds(n),r.setMilliseconds(0),r.getHours()<0&&r.getMinutes()<0&&r.getSeconds()<0?$:r}function En(e){var t,n,r,o;if(me(e)&&((t=A(e))||(t=new Date(e))&&!N(t.valueOf())||(t=null)),!t)return Z;if(r=t.getFullYear(),o=Sn(t),r<1900)return Z;for(n=1900;n<r;n++)o+=365,ve(n)&&o++;return o}function Fn(e){var t;return me(e)&&(t=A(e)),t?(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())/86400:Z}function Dn(){return new Date}function Nn(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e}function Vn(e){return e.getHours()}function On(e){return e.getMinutes()}function Hn(e){return e.getSeconds()}function Pn(e){return e.getDate()}function Ln(e){return e.getMonth()+1}function kn(e){return e.getFullYear()}function Bn(e,t){var n,r,o;return 1===t||2===t?(n=Sn(e),r=new Date(e.getFullYear(),0,1).getDay(),2===t&&(r-=1)<0&&(r=6),o=n-1-(6-r),o<0&&(o=0),1+ae(o/7)+(o%7!=0?1:0)):$}function Wn(e,t){var n=e.getDay();switch(t){case 1:return n+1;case 2:return 0===n?7:n;case 3:return 0===n?6:n-1;default:return $}}function zn(e,t){return An(!1,e,t)}function Un(e,t){return An(!0,e,t)}function Yn(e,t,n){return bn(!0,e,t,n)}function Gn(e,t,n,r){var o=xn(n);return ne(o)?o:"1111111"===o.join("")?Z:bn(!1,e,t,r,o)}function Xn(e,t,n){function r(e,t,n){var r=ae(R(t)-R(e))%7,o=ae(Wn(e,2)+r),i=0===e.getDay()?1:2;return r=o>5?o-5:0,r=r>i?i:r,n-=r,n-=2*B(n/7)}return Rn(!1,e,t,D,n,r)}function jn(e,t,n,r){var o,i,a,l,s,u,c;if(r=r!==D?r:"0000011",o=xn(r),i=0,a=0,ne(o))return o;for(l=0;l<I(o);l++)1===o[l]&&i++;if(n<30){for(l=0;l<n;l++)o[(ae(Wn(e,3))+l)%7]&&a++;return n-=a}for(s=n,u=0,c=0,l=0;l<s&&ae(Wn(e,3)+l)%7!=0;l++)u++;for(l=0;l<u;l++)o[(ae(Wn(e,3))+l)%7]&&a++;for(l=0;l<s&&(ae(Wn(t,3))+7-l)%7!=6;l++)c++;for(l=0;l<c;l++)o[(ae(Wn(t,3))+7-l)%7]&&a++;return s=s-u-c,n-=ae(s/7)*i,n-=a}function Kn(e,t,n,r){return Rn(!0,e,t,n,r,jn)}function Zn(e,t,n){var r,o,i;function a(){var e=[];return e[0]=function(e,t){return t.getFullYear()-e.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0)},e[1]=function(e,t){return 12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth())+(t.getDate()<e.getDate()?-1:0)},e[2]=function(e,t){return(t.getTime()-e.getTime())/864e5},e[3]=function(e,t){var n=new Date(t.getFullYear(),t.getMonth()+(t.getDate()<e.getDate()?-1:0),e.getDate());return(t.getTime()-n.getTime())/864e5},e[4]=function(e,t){return t.getMonth()-e.getMonth()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?12:0)+(t.getDate()<e.getDate()?-1:0)},e[5]=function(e,t){return(t-new Date(t.getFullYear()+(t.getMonth()<e.getMonth()||t.getMonth()===e.getMonth()&&t.getDate()<e.getDate()?-1:0),e.getMonth(),e.getDate()))/864e5},e}if(n=n.toLocaleUpperCase(),r=a(),o=E(n,["Y","M","D","MD","YM","YD"]),t<e)return $;if(o<0)throw Ee().Exp_NotSupported;return(i=r[o])(e,t)}function Jn(e,t){var n,r,o={value:0};if(!Ae(e,o))return Z;if(n={value:0},!Ae(t,n))return Z;r=2958465;function i(e){return e>=0&&e<r+1}return i(o.value)&&i(n.value)?o.value-n.value:$}function qn(e){var t,n,r;if(isNaN(e))return $;function o(e){var t=new Date(e,0,4),n=t.getDay();return 0===n&&(n=7),t.setDate(t.getDate()+1-n),t}return t=new Date(1900,1,28),e.getTime()<=t.getTime()&&e.setDate(e.getDate()-1),1900===(n=e.getFullYear())?n+=400:9999===n&&(n-=400),e.setYear(n),e.getTime()<new Date(n,11,29).getTime()&&n--,r=o(n+1),e.getTime()<r.getTime()&&(r=o(n)),parseInt((e.getTime()-r.getTime())/864e5/7)+1}function Qn(e){var t,n,r,o=""+e,i="",a=[];if(e<0&&(o=o.substr(1),i="-"),n=o.split("."),r=I(n),r<1||r>2)return Z;for(2===r&&(a.push(n[1]),a.push(".")),o=n[0],t=I(o)-3;t>=0;t-=3)a.push(o.substr(t,3)),t>0&&a.push(",");return a.push(o.substring(0,t+3)),a.reverse(),i+a.join("")}function $n(e,t){var n,r,o,i,a=[],l=I(e);for(n=0;n<l;n++){if(o=e[n],0===(i=I(o))&&"concat"===t)return j;for(r=0;r<i;r++)F(o[r])||a.push(se(o[r]))}return a.join("")}function er(e,t,n){return n>=I(t)?t:t.substr(e?0:I(t)-n,n)}function tr(e){var t=[],n,r;for(n=0;n<I(e);n++)0<=(r=e.charCodeAt(n))&&r<=31||127===r||128<=r&&r<=159||t.push(e[n]);return t.join("")}function nr(e){var t,n,r,o,i;for(e=e.trim(),t=[],n=!0,r=0;r<I(e);r++)o=e.charAt(r),i=" "===o||"\t"===o||"\n"===o,i&&!n||t.push(o),n=!i;return t.join("")}function rr(e,t){function n(e){var t=Qn(e),n=[];return e<0&&(t=t.substr(1)),n.push("$"),n.push(t),e<0&&(n.push(")"),n.unshift("(")),n.join("")}return e=le(ft(e,t)),n(e)}function or(e,t,n){var r=0;return t<0&&(r=ae(G(10,H(t))),e/=r),e=le(ft(e,L(0,t))),t<0&&(e*=r),n?""+e:Qn(e)}function ir(e){var t,n,r,o;if(b._startsWith(e,"[$-"))return e;if(-1!==(t=e.indexOf("["))&&-1!==e.indexOf("]"))for(n=e.indexOf("]",t);-1!==t&&-1!==n;)r=e.substring(0,t),o=e.substring(n+1),e=r.concat(o),t=e.indexOf("["),n=-1===t?-1:e.indexOf("]",t);return e}function ar(e,t){var r,o,i;if(""===t)return se(e);F(e)&&(e=0),t=ir(t);try{return r=n(4),o=r&&r.GeneralFormatter,o?(i=new o(t),i.format(e)):""+e}catch(e){return Z}}function lr(e){if(!e)return 0;var t=A(e),n;return F(t)?sr(e):(n=R(t),ne(n)?Fn(t):n)}function sr(e){var t,n,r,o,i,a,l=y.CultureManager._getCultureInfo().NumberFormat,s=S.isDigit;if("$"!==e[0]&&e[0]!==l.currencySymbol||(e=e.substring(1)),t=V(e),!e||N(t)||!s(e[0].charCodeAt(0))&&"."!==e[0])return Z;for("."===e[0]&&(e="0"+e),n=e.length,r=0,i=0,a=0;r<n;r++){for(o=e[r];r<n&&s(o.charCodeAt(0));)r++,o=e[r];if(r===n){if(i&&r-i<=3)return Z;break}if(o===l.numberGroupSeparator){if(a||i&&r-i<=3)return Z;i=r}else if(o===l.numberDecimalSeparator){if(a||i&&r-i<=3)return Z;a=r}}return e=b._replace(e,",",""),V(e)}function ur(e){return e.toLowerCase()}function cr(e){return e.toUpperCase()}function _r(e){var t,n,r,o=I(e),i=[];if(o>0)for(t=e.toUpperCase(),n=e.toLowerCase(),r=1,i[0]=t[0];r<o;)i[r]=S._isLetter(e[r-1])?n[r]:t[r],r++;return i.join("")}function fr(e){return String.fromCharCode(e)}function dr(e){return e[0].charCodeAt(0)}function hr(e,t,n,r){var o,i,a=I(e);return t=k(t,a+1),n=k(n||0,a-t+1),o=e.substring(0,t-1),i=e.substr(t-1+n),o.concat(r).concat(i)}function gr(e,t,n,r){var o,i,a,l,s,u;if(S.usedbcs){for(o=[],i=0,a=0;a<e.length;a++)o[a+i]=e[a],4===e[a].charCodeAt(0).toString(16).length&&i++;return 0===i?hr(e,t,n,r):(l=e.length+i,t=k(t,l+1),n=k(n||0,l-t+1),s=o.slice(0,t-1).join(""),u=o.slice(t-1+n).join(""),s.concat(r).concat(u))}return hr(e,t,n,r)}function pr(e,t,n,r){var o,i,a,l,s,u,c=I(t);if(I(arguments)>3){if(i=ae(r),a=0,i<1)return Z;for(l=0;l<i;l++){if(-1===(a=e.indexOf(t,a)))return e;a+=c}s=e.substring(0,a-c),u=e.substr(a),o=s.concat(n).concat(u)}else o=b._join(e,t,n);return o}function mr(){return $n(arguments,"concatenate")}function vr(){return $n(arguments,"concat")}function Cr(e,t){var n,r,o,i,a,l,s,u,c,_;if(e.isReference&&0===e.length)return j;if(n={value:!1},r=!!F(t[0])||t[0],!Ie(r,n))return Z;for(r=n.value,o=arguments,i=[],s=I(o),a=2;a<s;a++){if(u=o[a],0===(c=I(u)))return j;for(l=0;l<c;l++)F(u[l])?r||i.push(""):i.push(se(u[l]))}if(e.isArray){if(0===e.length)return j;for(_=i[0],l=0,a=1;a<i.length;a++)l===e.length&&(l=0),_+=e[l++]+i[a];return _}return i.join(e)}function wr(e,t){return er(!0,e,t)}function yr(e,t){return er(!1,e,t)}function Sr(e,t,n){var r,o,i,a;if(S.usedbcs){for(r=[],o=0,i=0;i<t.length;i++)e||(r[i+o]=t[i]),4===t[i].charCodeAt(0).toString(16).length&&o++,e&&(r[i+o]=t[i]);return a=t.length+o,n>=a?t:e?r.slice(0,n-1<0?0:n-1).join(""):r.slice(a-n).join("")}return er(e,t,n)}function xr(e,t){return Sr(!0,e,t)}function br(e,t){return Sr(!1,e,t)}function Tr(e,t,n){t--;var r=I(e);return t>=r?"":r<t+n?e.substr(t):e.substr(t,n)}function Rr(e,t,n){var r,o,i,a;if(S.usedbcs){for(r=[],o=0,i=0;i<e.length;i++)4===e[i].charCodeAt(0).toString(16).length&&o++,r[i+o]=e[i];return a=e.length+o,t--,t<0?Z:t>=a?"":a<t+n?r.slice(t).join(""):r.slice(t,t+n).join("")}return Tr(e,t,n)}function Ar(e,t){var n=[],r;if(t<0||t*I(e)>32767)return Z;for(r=0;r<t;r++)n.push(e);return n.join("")}function Ir(e){return e?e.length:0}function Mr(e){var t,n;if(S.usedbcs){for(t=0,n=0;n<e.length;n++)4===e[n].charCodeAt(0).toString(16).length&&t++;return e.length+t}return e?e.length:0}function Er(e,t,n){if(n<1||I(t)<n)return Z;var r=t.indexOf(e,n-1);return-1===r?Z:r+1}function Fr(e,t,n){var r,o,i,a,l;if(S.usedbcs){for(r=[],o=0,i=0;i<t.length;i++)4===t[i].charCodeAt(0).toString(16).length&&o++,r[i]=o;return a=t.length+o,n<1||a<n?Z:(l=t.indexOf(e,n-1),-1===l?Z:r[l]+l+1)}return Er(e,t,n)}function Dr(e,t,n){var r=-1,o,i;return o=x._getWildcardCriteria(e),o?(i=x._getRegIgnoreCase(o).exec(t),r=F(i)?-1:i.index):r=t.toLowerCase().indexOf(e.toLowerCase(),--n),-1===r?Z:r+1}function Nr(e,t,n){var r,o,i,a,l;if(S.usedbcs){for(r=[],o=0,i=0;i<t.length;i++)r[i]=o,4===t[i].charCodeAt(0).toString(16).length&&o++;return 0===o?Dr(e,t,n):(a=t.length+o,n<1||a<n?Z:(l=Dr(e,t,n),l===Z?Z:r[l-1]+l))}return Dr(e,t,n)}function Vr(e,t){return e===t}function Or(e){return me(e)?e:""}function Hr(e){if(e){var t=e;return t<=0||t>1114111?Z:t>=55296&&t<=57343?Q:t<1048576?String.fromCharCode(t):(t-=1048576,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}return Z}function Pr(e){var t,n,r=se(e);return""===r||null===r?Z:(t=r.charCodeAt(0))>=55296&&t<=56319?1===r.length?Z:(n=r.charCodeAt(1))>=56320&&n<=57343?t|n<<8:1:t>=56320&&t<=57343?t-53248+53248:t}function Lr(e){var t,n;function r(e){var t,n,r,o,i=["\u0e25\u0e49\u0e32\u0e19","\u0e2a\u0e34\u0e1a","\u0e23\u0e49\u0e2d\u0e22","\u0e1e\u0e31\u0e19","\u0e2b\u0e21\u0e37\u0e48\u0e19","\u0e41\u0e2a\u0e19",""],a=["\u0e28\u0e39\u0e19\u0e22\u0e4c","\u0e2b\u0e19\u0e36\u0e48\u0e07","\u0e2a\u0e2d\u0e07","\u0e2a\u0e32\u0e21","\u0e2a\u0e35\u0e48","\u0e2b\u0e49\u0e32","\u0e2b\u0e01","\u0e40\u0e08\u0e47\u0e14","\u0e41\u0e1b\u0e14","\u0e40\u0e01\u0e49\u0e32"],l=["\u0e25\u0e1a","\u0e1a\u0e32\u0e17","\u0e16\u0e49\u0e27\u0e19","\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c","\u0e22\u0e35\u0e48","\u0e40\u0e2d\u0e47\u0e14",","," ","\u0e3f"],s="",u=e+"",c=u.length;for(t=c;t>0;--t){if(n=parseInt(u[c-t]),r=a[n],o=1<t?(t-1)%6:6,1===o&&2===n&&(r=l[4]),1===n)switch(o){case 0:case 6:s+=t<c?l[5]:r;break;case 1:break;default:s+=r}else{if(0===n){0===o&&(s+=i[o]);continue}s+=r}s+=i[o]}return s}return e?(t=Math.abs(parseInt(e)),n=parseFloat((Math.abs(e)-t).toFixed(2)),0!==t?0===n?(e<0?"\u0e25\u0e1a":"")+r(t)+"\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19":(e<0?"\u0e25\u0e1a":"")+r(t)+"\u0e1a\u0e32\u0e17"+r(100*n)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":0!==n?(e<0?"\u0e25\u0e1a":"")+r(100*n)+"\u0e2a\u0e15\u0e32\u0e07\u0e04\u0e4c":"\u0e28\u0e39\u0e19\u0e22\u0e4c\u0e1a\u0e32\u0e17\u0e16\u0e49\u0e27\u0e19"):Z}function kr(e){return ne(e)}function Br(e){return!!ne(e)&&e._code!==Q._code}function Wr(e){return!!ne(e)&&e._code===Q._code}function zr(e){if(!F(e)&&ne(e)){var t=E(e._code,[j._code,K._code,Z._code,J._code,q._code,$._code,Q._code]);if(t>=0)return t+1}return Q}function Ur(e){return ue(e)}function Yr(e){return Te(H(e))%2==0}function Gr(e){return Te(H(e))%2!=0}function Xr(e){return ue(e)?le(e):pe(e)?e?1:0:ne(e)?e:0}function jr(e){return F(e)}function Kr(e){return pe(e)}function Zr(e){return me(e)}function Jr(e){return!me(e)}function qr(e){return re(e)}function Qr(e){return pe(e)?4:ue(e)?1:me(e)?2:ne(e)?16:oe(e)?64:Z}function $r(){return Q}function eo(e,t){var n,r=0,o=e.source._sheet;if(oe(t))return Q;if(n=t&&(t._source||t.references[0]._source)||e.source,t instanceof he||F(t))return o.parent.getSheetIndex(n._sheet.name())+1;if(ue(t)||me(t))for(r;r<o.parent.sheets.length;r++)if(t.toUpperCase()===o.parent.sheets[r].name().toUpperCase())return r+1;return Q}function to(e,t){var n,r=e.source._sheet;return oe(t)||ue(t)?Q:me(t)?Z:F(t)?r.parent.sheets.length:(n=t&&(t._source||t.references)||e.source,t instanceof he?n.length||r.parent.getSheetIndex(n._sheet.name())+1:Q)}function no(){var e=new S.Functions.AsyncFunction("REFRESH",1,3,D);e.evaluate=ro,S.Functions._builtInFunctions.REFRESH=e}function ro(e,t){return t}function oo(e){return e>=55296&&e<=57343}function io(e,t){return!(e<55296||e>56319)&&(t>=56320&&t<=57343)}function ao(e){var t,n,r,o,i,a="";if((t=e.length-1)<0)return"";for(n=0;n<=t;n++)if((r=e.charCodeAt(n))>="A".charCodeAt(0)&&r<="Z".charCodeAt(0)||r>="0".charCodeAt(0)&&r<="9".charCodeAt(0)||r>="a".charCodeAt(0)&&r<="z".charCodeAt(0)||r==="-".charCodeAt(0)||r==="_".charCodeAt(0)||r===".".charCodeAt(0))a+=e[n];else{if(oo(r)){if(t===n||!io(r,e.charCodeAt(n+1)))return null;o=[r,e.charCodeAt(n+1)],n++}else o=[r];for(i=0;i<o.length;i++)a+="%",a+=o[i].toString(16).toUpperCase()}return a}t={_argType:0},r={_argType:0,_argCondition:"= 0",_conditionErrorValue:K},o={_argType:0,_argCondition:"= 0",_conditionErrorValue:0},i={_defaultValue:1,_argType:0,_argCondition:"= 0",_conditionErrorValue:0},a={_argType:2,_argCondition:"< 0"},l={_argType:0,_argCondition:["> 134217728","< -134217728"]},s={_argType:1},u={_argType:1,_argCondition:"< 0"},c={_argType:2},_={_defaultValue:1,_argType:2},f={_defaultValue:1,_argType:2,_argCondition:"< 0",_conditionErrorValue:Z},d={_argType:5},h={_argType:6},g={_argType:2,_argCondition:"< 0",_conditionErrorValue:Z},p={_defaultValue:[],_argType:4,_valueType:4,_toOneDimension:!0,_breakOnError:!0,_breakOnConvertError:!0},m={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0},v={_argType:4,_valueType:1,_breakOnError:!0,_breakOnConvertError:!0},C={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},w={_argType:4,_valueType:3,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},Re("ABS",Le,1,1,t),Re("ACOS",Bt,1,1,{_argType:0,_argCondition:["> 1","< -1"]}),Re("ACOT",Kt,1,1,t),Re("ASIN",kt,1,1,{_argType:0,_argCondition:["> 1","< -1"]}),Re("ATAN",jt,1,1,t),Re("ATAN2",Zt,2,2,[t,t]),Re("COS",Ot,1,1,t),Re("SEC",Ht,1,1,l),Re("CEILING",at,2,2,[o,o]),Re("ODD",Ye,1,1,s),Re("EVEN",Ge,1,1,s),Re("FLOOR",lt,2,2,[o,o]),Re("LN",Ke,1,1,{_argType:1,_argCondition:"<= 0"}),Re("SQRT",rt,1,1,{_argType:1,_argCondition:"< 0"}),Re("SIN",Nt,1,1,t),Re("CSC",Vt,1,1,l),Re("TAN",Pt,1,1,t),Re("COT",Lt,1,1,l),Re("SIGN",$e,1,1,{_argType:1,_argCondition:"> 0",_conditionErrorValue:1}),Re("GCD",et,1,D,C,-1,-1),Re("LCM",tt,1,D,C,-1,-1),Re("PRODUCT",nt,1,D,D,-1,-1),Re("POWER",qe,2,2,[s,s]),Re("MOD",Ze,2,2,[s,{_argType:1,_argCondition:"= 0",_conditionErrorValue:K}]),Re("QUOTIENT",ot,2,2,[t,r],D,D),Re("SUBTOTAL",it,2,D,c,"!= 0","!= 0"),Re("INT",ke,1,1,s),Re("MROUND",_t,2,2,[o,o]),Re("ROUND",ft,2,2,[t,c]),Re("ROUNDDOWN",dt,2,2,[t,c]),Re("ROUNDUP",ht,2,2,[t,c]),Re("TRUNC",dt,1,2,[t,{_defaultValue:0,_argType:2}],D,D,{_acceptsMissingArgument:1}),Re("EXP",gt,1,1,t),Re("LOG",vt,1,2,[{_argType:0,_argCondition:"<= 0"},{_defaultValue:10,_argType:0,_argCondition:"<= 0"}],D,D,{_acceptsMissingArgument:1}),Re("LOG10",Ct,1,1,{_argType:0,_argCondition:"<= 0"}),Re("SUM",Qe,1,D,D,-1,-1),Re("SUMIF",wt,2,3,D,[0,2],[0,2],{_acceptsMissingArgument:2}),Re("SUMIFS",yt,3,D,m,[0,"%= 1"],[0,"%= 1"]),Re("SUMPRODUCT",Tt,1,D,D,-1,-1,{_arrayArgumentEvaluateMode:1}),Re("SUMSQ",Rt,1,D,C,-1,-1),Re("SUMX2MY2",At,2,2,C,-1,-1),Re("SUMX2PY2",It,2,2,C,-1,-1),Re("SUMXMY2",Mt,2,2,C,-1,-1),Re("SERIESSUM",Et,4,4,[t,c,c,{_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_breakOnConvertError:!0}],3,3),Re("PI",Je,0,0),Re("SQRTPI",Ft,1,1,{_argType:0,_argCondition:"< 0"}),Re("DEGREES",Ue,1,1,s),Re("RADIANS",Dt,1,1,t),Re("COSH",Ut,1,1,t),Re("SECH",Yt,1,1,t),Re("ACOSH",Xt,1,1,{_argType:0,_argCondition:"< 0"}),Re("SINH",Wt,1,1,t),Re("CSCH",zt,1,1,t),Re("ASINH",Gt,1,1,t),Re("TANH",Jt,1,1,t),Re("COTH",qt,1,1,{_argType:0}),Re("ATANH",Qt,1,1,{_argType:0,_argCondition:["<= -1",">= 1"]}),Re("ACOTH",$t,1,1,{_argType:0}),Re("MDETERM",en,1,1,v,-1,-1),Re("MINVERSE",tn,1,1,v,-1,-1),Re("MMULT",nn,2,2,[v,v],-1,-1),Re("FACT",Xe,1,1,{_argType:3,_argCondition:["< 0","> 170"]}),Re("FACTDOUBLE",je,1,1,{_argType:3,_argCondition:["< 0","> 300"]}),Re("MULTINOMIAL",rn,1,D,{_argType:4,_valueType:0,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},-1,-1),Re("RAND",on,0,0,D,D,D,{_isVolatile:!0}),Re("RANDBETWEEN",an,2,2,[c,c],D,D,{_isVolatile:!0}),Re("COMBIN",Be,2,2,[u,u]),Re("COMBINA",We,2,2,[a,a]),Re("DECIMAL",ze,2,2,[{_defaultValue:"0",_argType:5},{_argType:0,_argCondition:["> 36","< 2"]}]),Re("CEILING.MATH",st,1,3,[t,{_argType:0,_defaultValue:1},{_argType:0,_defaultValue:0}]),Re("FLOOR.MATH",ut,1,3,[t,{_argType:0,_defaultValue:1},{_argType:0,_defaultValue:0}]),Re("BASE",ct,2,3,[{_argType:0,_argCondition:["< 0",">= 9007199254740992"]},{_argType:3,_argCondition:["> 36","< 2"]},{_argType:3,_defaultValue:0,_argCondition:["< 0",">= 256"]}]),Re("ROMAN",ln,1,2,[{_argType:2,_argCondition:["< 0","> 3999"],_conditionErrorValue:Z},{_defaultValue:0,_argType:2,_argCondition:["< 0","> 4"],_conditionErrorValue:Z}],D,D,{_acceptsMissingArgument:1}),Re("ARABIC",sn,1,1,d),Re("CEILING.PRECISE",pt,1,2,[o,i]),Re("ISO.CEILING",pt,1,2,[o,i]),Re("FLOOR.PRECISE",mt,1,2,[o,i]),Re("MAXIFS",St,3,D,m,[0,"%= 1"],[0,"%= 1"]),Re("MINIFS",xt,3,D,m,[0,"%= 1"],[0,"%= 1"]),Re("MUNIT",bt,1,1,t),Re("AND",cn,1,D,w,-1,-1),Re("OR",_n,1,D,w,-1,-1),Re("NOT",fn,1,1),Re("IF",dn,2,3,D,[1,2],[1,2],{_acceptsError:[1,2],_acceptsMissingArgument:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(e){if(ee._isError(e))return-1;var t={value:!1};return ie(e,t),t.value?1:2}}),Re("IFERROR",gn,2,2,D,0,D,{_acceptsError:-1}),Re("TRUE",pn,0,0),Re("FALSE",mn,0,0),Re("IFNA",vn,2,2,D,0,D,{_acceptsError:-1}),Re("IFS",Cn,2,254,D,0,D,{_acceptsError:-1}),Re("SWITCH",wn,3,253,D,1,D,{_acceptsError:-1}),Re("XOR",yn,1,D,w,-1,-1),Re("DATE",In,3,3,[{_argType:2,_argCondition:["< 0","> 9999"]},c,c]),Re("TIME",Mn,3,3,[c,c,c]),Re("DATEVALUE",En,1,1,{_acceptsEmptyString:!0}),Re("TIMEVALUE",Fn,1,1,{_acceptsEmptyString:!0}),Re("NOW",Dn,0,0,D,D,D,{_isVolatile:!0}),Re("TODAY",Nn,0,0,D,D,D,{_isVolatile:!0}),Re("HOUR",Vn,1,1,h),Re("MINUTE",On,1,1,h),Re("SECOND",Hn,1,1,h),Re("DAY",Pn,1,1,h),Re("MONTH",Ln,1,1,h),Re("YEAR",kn,1,1,h),Re("WEEKNUM",Bn,1,2,[h,_],D,D,{_acceptsMissingArgument:1}),Re("WEEKDAY",Wn,1,2,[h,_],D,D,{_acceptsMissingArgument:1}),Re("EDATE",zn,2,2,[h,c]),Re("EOMONTH",Un,2,2,[h,c]),Re("WORKDAY",Yn,2,3,[h,c,p],2,2,{_acceptsMissingArgument:2}),Re("WORKDAY.INTL",Gn,2,4,[h,c,{_defaultValue:"0000011"},p],[2,3],[2,3],{_acceptsMissingArgument:[2,3]}),Re("DAYS360",ge._days360,2,3,[h,h,{_defaultValue:!1,_argType:7}],{_acceptsMissingArgument:2}),Re("NETWORKDAYS",Xn,2,3,[h,h],2,2,{_acceptsMissingArgument:2}),Re("NETWORKDAYS.INTL",Kn,2,4,[h,h],[2,3],[2,3],{_acceptsMissingArgument:[2,3]}),Re("YEARFRAC",ge._yearfrac,2,3,[h,h,{_defaultValue:0,_argType:2}],{_acceptsMissingArgument:2}),Re("DATEDIF",Zn,3,3,[h,h,d]),Re("DAYS",Jn,2,2),Re("ISOWEEKNUM",qn,1,1,h),Re("CLEAN",tr,1,1,d),Re("TRIM",nr,1,1,d),Re("DOLLAR",rr,1,2,[t,{_defaultValue:2,_argType:2,_argCondition:"> 99",_conditionErrorValue:Z}],D,D,{_acceptsMissingArgument:1}),Re("FIXED",or,1,3,[t,{_defaultValue:2,_argType:2},{_defaultValue:!1,_argType:7}],D,D,{_acceptsMissingArgument:[1,2]}),Re("TEXT",ar,2,2,[{},d]),Re("VALUE",lr,1,1,d),Re("LOWER",ur,1,1,d),Re("UPPER",cr,1,1,d),Re("PROPER",_r,1,1,d),Re("CHAR",fr,1,1,{_argType:2,_argCondition:["> 255","< 1"],_conditionErrorValue:Z}),Re("CODE",dr,1,1,{_argType:5,_acceptsEmptyString:!0}),Re("REPLACE",hr,4,4,[d,{_argType:2,_argCondition:"< 1",_conditionErrorValue:Z},g,d],D,D,{_acceptsMissingArgument:2}),Re("SUBSTITUTE",pr,3,4,[d,{_argType:5,_acceptsEmptyString:!0},d],D,D,{_acceptsMissingArgument:3}),Re("CONCATENATE",mr,2,D,{_argType:4,_valueType:0,_toOneDimension:!0,_isAllArgsSameLimit:!0},D,-1),Re("LEFT",wr,1,2,[d,f],D,D,{_acceptsMissingArgument:1}),Re("MID",Tr,3,3,[d,g,g]),Re("RIGHT",yr,1,2,[d,f],D,D,{_acceptsMissingArgument:1}),Re("REPT",Ar,2,2,[d,c]),Re("LEN",Ir,1,1,d),Re("FIND",Er,2,3,[d,d,_],D,D,{_acceptsMissingArgument:2}),Re("SEARCH",Dr,2,3,[d,d,f],D,D,{_acceptsMissingArgument:2}),Re("EXACT",Vr,2,2,[d,d]),Re("T",Or,1,1),Re("UNICHAR",Hr,1,1,[{_argType:2,_conditionErrorValue:Z}]),Re("UNICODE",Pr,1,1),Re("BAHTTEXT",Lr,1,1,[{_argType:0,_conditionErrorValue:Z}]),Re("CONCAT",vr,1,D,{_argType:4,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},-1,-1),Re("TEXTJOIN",Cr,3,D,{_argType:4,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},-1,-1),Re("FINDB",Fr,2,3,[d,d,_],D,D,{_acceptsMissingArgument:2}),Re("LEFTB",xr,1,2,[d,f],D,D,{_acceptsMissingArgument:1}),Re("RIGHTB",br,1,2,[d,f],D,D,{_acceptsMissingArgument:1}),Re("MIDB",Rr,3,3,[d,g,g]),Re("LENB",Mr,1,1,d),Re("REPLACEB",gr,4,4,[d,{_argType:2,_argCondition:"< 1",_conditionErrorValue:Z},g,d],D,D,{_acceptsMissingArgument:2}),Re("SEARCHB",Nr,2,3,[d,d,f],D,D,{_acceptsMissingArgument:2}),Re("ENCODEURL",ao,0,1,d),Re("ISERROR",kr,1,1,D,D,D,{_acceptsError:-1}),Re("ISERR",Br,1,1,D,D,D,{_acceptsError:-1}),Re("ISNA",Wr,1,1,D,D,D,{_acceptsError:-1}),Re("ERROR.TYPE",zr,1,1,D,D,D,{_acceptsError:-1}),Re("ISNUMBER",Ur,1,1,D,D,D,{_acceptsError:-1}),Re("ISEVEN",Yr,1,1,t,D,D),Re("ISODD",Gr,1,1,t,D,D),Re("N",Xr,1,1,D,D,D),Re("ISBLANK",jr,1,1,D,D,D,{_acceptsError:-1}),Re("ISLOGICAL",Kr,1,1,D,D,D,{_acceptsError:-1}),Re("ISTEXT",Zr,1,1,D,D,D,{_acceptsError:-1}),Re("ISNONTEXT",Jr,1,1,D,D,D,{_acceptsError:-1}),Re("ISREF",qr,1,1,D,-1,D,{_acceptsError:-1}),Re("TYPE",Qr,1,1,D,D,-1,{_acceptsError:-1}),Re("NA",$r,0,0),Re("SHEET",eo,0,0,D,-1,D,{_isContextSensitive:!0}),Re("SHEETS",to,0,0,D,-1,D,{_isContextSensitive:!0}),no(),e.exports=ge}()},function(e,t){e.exports=GC.Spread.Common},function(e,t){e.exports=GC.Spread.CalcEngine},function(e,t){if(void 0===GC.Spread.Formatter){var n=Error('Cannot find module "GC.Spread.Formatter"');throw n.code="MODULE_NOT_FOUND",n}e.exports=GC.Spread.Formatter}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.CalcEngine=GC.Spread.CalcEngine||{},GC.Spread.CalcEngine.AdvancedFunctions=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";var t=n(1).Functions;n(2),n(4),n(5),n(6),n(7),e.exports=t}()},function(e,t){e.exports=GC.Spread.CalcEngine},function(e,t,n){!function(){"use strict";var t,r,o,i,a=n(3),l=n(1),s=a._RegexHelper,u=null,c=l.Convert,_=c._toDouble,f=c._isNumber,d=c._isError,h=c._toResult,g=l.Errors,p=g.DivideByZero,m=g.Value,v=l.Functions,C=v._defineBuiltInFunction,w=v._isString,y=isNaN,S=function(){return a._getResource(l.SR)()},x=S().Exp_InvalidCast;function b(e,t){this._criteriaOperator=e,this._criteriaValue=t}b.prototype._evaluate=function(e){var t={"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14},n=l.evaluateOperator(t[this._criteriaOperator],e,this._criteriaValue);return!!v._isBoolean(n)&&c._toBool(n)};function T(e,t,n){var r=this;if(r._row=0,r._database=e,r._criteria=n,3===arguments.length){if(r._column=r._columnIndex(e,t),e.rowCount<2||e.colCount<1||n.rowCount<2||n.colCount<1||r._column<0||r._database.colCount<=r._column)throw x}else if(2===arguments.length&&(r._column=-1,e.rowCount<2||e.colCount<1||n.rowCount<2||n.colCount<1))throw x}T.prototype={_columnIndex:function(e,t){var n,r;if(w(t)){for(n=0;n<e.colCount;n++)if((r=c._toString(e[0][n]))&&this._ignoreCaseEqual(r,t))return n;return-1}return c._toInt(t)-1},_current:function(){var e=this;if(e._row<=0||e._database.rowCount<=e._row)throw S().Exp_InvalidOperation;return e._database[e._row][e._column]},_moveNext:function(){for(var e=this,t=!1,n=e._database.rowCount;!t&&e._row<n;)++e._row<n&&(t=e._rowMeetsCriteria());return t},_createEvaluator:function(e){var t,n,r,o;if(w(e)){for(t=["=","<>","<=",">=","<",">"],n=c._toString(e),r=0;r<t.length;r++)if(a._StringHelper._startsWith(n,t[r]))return n=n.substring(t[r].length),o=a._NumberHelper._parseInvariant(n),e=y(o)?!!this._ignoreCaseEqual("true",n)||!this._ignoreCaseEqual("false",n)&&n:o,new b(t[r],e);return new b("=",e)}return e?new b("=",e):u},_rowMeetsCriteria:function(){var e,t,n,r,o,i,a=this,l=!1,u=a._criteria;for(e=1;!l&&e<u.rowCount;e++)for(l=!0,t=0;l&&t<u.colCount;t++)if(n=a._createEvaluator(u[e][t])){if((r=a._columnIndex(a._database,u[0][t]))<0)return!1;o=a._database[a._row][r],i=s._getWildcardCriteriaFullMatch(n._criteriaValue,!0),l="="===n._criteriaOperator&&w(n._criteriaValue)&&w(o)&&i?s._getRegIgnoreCase(i).test(o):n._evaluate(o)}return l},_ignoreCaseEqual:function(e,t){return e.toLowerCase()===t.toLowerCase()}};function R(e,t,n,r){for(var o,i=0,a=new T(e,t,n);a._moveNext();)o=a._current(),(o=r?f(o):o)&&i++;return h(i)}function A(e,t,n,r,o,i,a){for(var l,s,u,c,g=a?1:0,v=0,C=0,w=new T(e,t,n);w._moveNext();)if(l=w._current(),f(l)){if(s=_(l),y(s))return m;g=a?g*s:g+s,v+=s*s,C++}else if(d(l))return l;return i||a?h(g):(u=Math.max(0,(C*v-g*g)/(C*(C-o))),c=r?Math.sqrt(u):u,C<=1?p:h(c))}function I(e,t,n){for(var r,o,i=0,a=0,l=new T(e,t,n);l._moveNext();){if(r=l._current(),d(r))return r;if(f(r)){if(o={value:0},!c._tryToDouble(r,o))return m;i+=o.value,a++}}return 0===a?p:h(i/a)}function M(e,t,n){return R(e,t,n,!0)}function E(e,t,n){return R(e,t,n,!1)}function F(e,t,n){var r,o=new T(e,t,n);return o._moveNext()?(r=o._current(),o._moveNext()?g.Number:r):m}function D(e,t,n){for(var r,o,i=!1,a=-v._MAX_DOUBLE_VALUE,l=new T(e,t,n);l._moveNext();){if(r=l._current(),d(r))return r;if(f(r)){if(o=_(r),y(o))return m;(!i||o>a)&&(a=o),i=!0}}return i?h(a):0}function N(e,t,n){for(var r,o,i=!1,a=v._MAX_DOUBLE_VALUE,l=new T(e,t,n);l._moveNext();){if(r=l._current(),d(r))return r;if(f(r)){if(o=_(r),y(o))return m;(!i||r<a)&&(a=r),i=!0}}return i?h(a):0}function V(e,t,n){return A(e,t,n,!1,0,!1,!0)}function O(e,t,n){return A(e,t,n,!0,1)}function H(e,t,n){return A(e,t,n,!0,0)}function P(e,t,n){return A(e,t,n,!1,0,!0)}function L(e,t,n){return A(e,t,n,!1,1)}function k(e,t,n){return A(e,t,n,!1,0)}t="!= 1",r={_acceptsRealValue:!0,_argType:4,_valueType:0},o={_acceptsRealValue:!0},i=[r,o,r],C("DAVERAGE",I,3,3,i,t,t),C("DCOUNT",M,3,3,i,t,t),C("DCOUNTA",E,3,3,i,t,t),C("DGET",F,3,3,i,t,t),C("DMAX",D,3,3,i,t,t),C("DMIN",N,3,3,i,t,t),C("DPRODUCT",V,3,3,i,t,t),C("DSTDEV",O,3,3,i,t,t),C("DSTDEVP",H,3,3,i,t,t),C("DSUM",P,3,3,i,t,t),C("DVAR",L,3,3,i,t,t),C("DVARP",k,3,3,i,t,t),e.exports=v}()},function(e,t){e.exports=GC.Spread.Common},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k=n(3),B=n(1),W=k._ArrayHelper._getLength,z=void 0,U=Math.abs,Y=Math.sin,G=Math.cos,X=Math.sqrt,j=Math.log,K=Math.pow,Z=Math.exp,J=Math.E,q=Math.atan2,Q=parseFloat,$=isNaN,ee=B.Errors,te=ee.NotAvailable,ne=ee.Number,re=ee.Value,oe=B.Functions,ie=oe._defineBuiltInFunction,ae=oe._st_normsdist,le=B.Convert,se=le._toResult,ue=oe._MathHelper,ce=ue._sinhCosh,_e=oe._Complex,fe=oe._convertToComplex,de=0xffffffffffff,he=new _e(1,0),ge=le._tryToDouble;function pe(e,t){return{_str:e,_c:t}}function me(e,t){var n=[],r;for(r=0;r<W(e);r++)n.push(new pe(e[r],t[r]));return n.push(new pe(null,0)),n}t=me(["g","sg","lbm","u","ozm"],[1,6852205001e-14,.002204622915,6.02217e23,.035273972]),r=1e4/254,o=r/12,i=o/3,a=i/1760,l=me(["m","mi","Nmi","in","ft","yd","ang","Pica","km"],[1,a,1/1852,r,o,i,1e10,2834.645669,.001]),s=365.25,u=24*s,c=60*u,_=60*c,f=me(["yr","day","hr","mn","sec"],[1,s,u,c,_]),d=.00750061708,h=me(["Pa","atm","mmHg","p","at"],[1,9869233e-12,d,1,d]),g=1e5,p=me(["N","dyn","lbf","dy"],[1,g,.224808924,g]),m=745.701,v=me(["HP","W","h","w"],[1,m,1,m]),C=62146e14,w=1/(3600*m),y=1/3600,S=947815e-9,x=me(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,9999995.193,.239006249,.238846191,C,w,y,23.73042222,S,C,w,y,S]),b=me(["T","gs"],[1,1e4]),T=.0049289216,R=me(["tsp","tbs","oz","cup","pt","qt","gal","l","uk_pt","us_pt","lt"],[1,1/3,1/6,1/48,1/96,1/192,1/768,T,.008675585,1/96,T]),A=me(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]);function ve(e,t,n){var r,o,i,a,l,s,u,c=100,_=.5*e,f=_*_;for(_=K(_,Q(t)),r=oe._fact(t),o=1,i=0,a=Q(t),l=_/r,s=.9*l,u=!1;l!==s&&0!==c;)_*=f,r*=++i,o*=++a,s=l,l=n||u?l+_/r/o:l-_/r/o,c--,u=!u;return l}function Ce(e,t){var n=K(t,10),r=parseInt(e,t);return $(r)?ne:n/2<=r?r-n:r}function we(e,t,n){e<0&&(e+=K(t,10));var r=e.toString(t),o=n-W(r),i;for(i=0;i<o;i++)r="0"+r;return r.toUpperCase()}function ye(e,t){var n=Ce(e,t);return W(n)<W(e)?ne:n}function Se(e,t,n){var r=we(e,n,t._value);return 0<=r&&t._value<W(r)&&t._isArgExists?ne:r}function xe(e,t,n,r,o){var i,a=Ce(e,n);return W(a)<W(e)?ne:o&&(a<-o||o-1<a)?ne:(i=we(a,r,t._value),0<=a&&t._value<W(i)&&t._isArgExists?ne:i)}function be(e,t){var n=Number.POSITIVE_INFINITY,r=e._getReal(),o=e._getImag();return $(r)||r===n||$(o)||o===n?ne:e._toString(t)}function Te(e,t,n,r){var o=e,i=t,a=n._getReal(),l=n._getImag();return e=r?o*a-i*l:o+a,t=r?o*l+i*a:i+l,{_real:e,_imag:t}}function Re(e,t){var n,r,o,i,a,l,s,u,c=t?1:0,_=0;for(r=0;r<W(e);r++)if(le._isArray(e[r]))for(s=e[r],o=0;o<s.rowCount;o++)for(i=0;i<s.columnCount;i++){if(!(n=fe(s.getValue(o,i))))return ne;l=Te(c,_,n,t),c=l._real,_=l._imag}else if(le._isReference(e[r]))for(u=e[r],a=0;a<u.getRangeCount();a++)for(o=0;o<u.getRowCount(a);o++)for(i=0;i<u.getColumnCount(a);i++){if(!(n=fe(u.getValue(a,o,i))))return ne;l=Te(c,_,n,t),c=l._real,_=l._imag}else{if(!(n=fe(e[r])))return ne;l=Te(c,_,n,t),c=l._real,_=l._imag}return be(new _e(c,_))}function Ae(e,t){return se(ve(e,t,!0))}function Ie(e,t){return se(ve(e,t,!1))}function Me(e,t){var n,r,o,i,a,l,s,u,c,_=1.7976931348623157e308,f=.5772156649015329,d=0,h=.25*e*e,g=1,p=0,m=1,v=2/e;if(t>0){for(p=-f,i=1;i<t;i++)p+=1/i,g*=i+1;if(m=v,1===t)d=1/e;else{for(a=g/t,l=1,s=1,n=a,i=1;i<t;i++){if(a/=t-i,l*=i,s*=-h,r=a*s/l,n+=r,_-U(r)<U(n)||v>1&&_/v<m)return _;m*=v}if(n*=.5,r=U(n),m>1&&_/m<r||r>1&&_/r<m)return _;d=n*m}}u=2*j(e/2),c=-f,0===t?(p=c,r=1):(p+=1/t,r=1/g),n=(c+p-u)*r,o=1;do{r*=h/(o*(o+t)),c+=1/o,p+=1/(o+t),n+=(c+p-u)*r,o++}while(U(r/n)>1.1102230246251565e-16);return n=.5*n/m,!0&t&&(n=-n),d+=n,se(d)}function Ee(e,t){var n=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],r=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],o=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],i=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],a=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],l=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],s=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],u=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],c=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],_=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],f=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],d=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],h=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],g=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],p=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],m=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],v=.7978845608028654,C=2.356194490192345,w=.7853981633974483;function y(e,t,n,r){
var o=0,i=Q(t[o++]),a=n;r&&(i+=e,a--);do{i=i*e+Q(t[o++])}while(0!=--a);return i}function S(e,t){var c,_,f,d,S,x=t?n:r,b=t?o:i,T=t?a:l,R=t?s:u,A=t?h:g,I=t?p:m,M=t?5.783185962946784:14.681970642123893,E=t?30.471262343662087:49.2184563216946;return e<=5?(_=e*e,t&&e<1e-5?1-_/4:(c=y(_,A,3)/y(_,I,8,!0),f=(_-M)*(_-E),f*=c,t?f:f*e)):(c=5/e,_=t?25/(e*e):c*c,f=y(_,x,6)/y(_,b,6),d=y(_,T,7)/y(_,R,7,!0),S=e-(t?w:C),(f=f*G(S)-c*d*Y(S))*v/X(e))}function x(e,t){var h,g,p,m,x,b=t?n:r,T=t?o:i,R=t?a:l,A=t?s:u,I=t?c:_,M=t?f:d,E=t?1:e,F=t?7:5,D=t?7:8;return e<=5?(g=e*e,h=E*y(g,I,F)/y(g,M,D,!0),h+=.6366197723675814*(t?j(e)*S(e,!0):S(e,!1)*j(e)-1/e)):(h=5/e,g=t?25/(e*e):h*h,p=y(g,b,6)/y(g,T,6),m=y(g,R,7)/y(g,A,7,!0),x=e-(t?w:C),(p=p*Y(x)+h*m*G(x))*v/X(e))}function b(e,t){var n=x(e,!0),r=x(e,!1),o=1,i=2*o,a;if(0===t)return n;if(1===t)return r;do{a=i*r/e-n,n=r,r=a,i+=2,++o}while(o<t);return a}return se(b(e,t))}function Fe(e){return ye(e,2)}function De(e){return ye(e,16)}function Ne(e){return ye(e,8)}function Ve(e,t){return xe(e,t,2,16)}function Oe(e,t){return xe(e,t,2,8)}function He(e,t){return Se(e,t,2)}function Pe(e,t){return Se(e,t,16)}function Le(e,t){return Se(e,t,8)}function ke(e,t){return xe(e,t,16,2,512)}function Be(e,t){return xe(e,t,8,2,512)}function We(e,t){return xe(e,t,16,8,536870912)}function ze(e,t){return xe(e,t,8,16,549755813888)}function Ue(e,t){var n,r=ae(e*X(2)),o=2*Q(r)-1;return t._isArgExists&&(r=ae(t._value*X(2)),n=2*Q(r)-1,o=n-o),o}function Ye(e){return Ue(e,{_isArgExists:!1})}function Ge(e){return 1-Ue(e,{_isArgExists:!1})}function Xe(e,t){return B._Helper._approxEqual(e,t)?1:0}function je(e,t){return e>=t?1:0}function Ke(e,t,n){return"i"!==n&&"j"!==n?ee.Value:be(new _e(e,t),n)}function Ze(e){return se(X(e._real*e._real+e._imag*e._imag))}function Je(e){return se(e._imag)}function qe(e){return 0===e._real&&0===e._imag?ee.DivideByZero:se(q(e._imag,e._real))}function Qe(e){return be(new _e(e._real,-e._imag))}function $e(e){return be(new _e(G(e._real)*ce(e._imag,!1),-Y(e._real)*ce(e._imag,!0)))}function et(e,t){var n=e._real,r=e._imag,o=t._real,i=t._imag;return be(new _e((n*o+r*i)/(o*o+i*i),(r*o-n*i)/(o*o+i*i)))}function tt(e){return be(new _e(Z(e._real)*G(e._imag),Z(e._real)*Y(e._imag)))}function nt(e){var t=e._real,n=e._imag;return be(new _e(j(X(t*t+n*n)),q(n,t)))}function rt(e){var t=e._real,n=e._imag,r=ue._log(J,10);return be(new _e(r*j(X(t*t+n*n)),r*q(n,t)))}function ot(e){var t=e._real,n=e._imag,r=ue._log(J,2);return be(new _e(r*j(X(t*t+n*n)),r*q(n,t)))}function it(e,t){var n,r,o=e._real,i=e._imag;return 0===o&&0===i?t>0?"0":ne:(n=X(o*o+i*i),r=q(i,o),be(new _e(K(n,t)*G(t*r),K(n,t)*Y(t*r))))}function at(e){return se(e._real)}function lt(e){return be(new _e(Y(e._real)*ce(e._imag,!1),G(e._real)*ce(e._imag,!0)))}function st(e){var t,n,r=e._real,o=e._imag;return 0===r&&0===o?"0":(t=X(r*r+o*o),n=q(o,r),be(new _e(X(t)*G(n/2),X(t)*Y(n/2))))}function ut(e,t){return be(new _e(e._real-t._real,e._imag-t._imag))}function ct(){return Re(arguments,!0)}function _t(){return Re(arguments,!1)}function ft(e){var t,n=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];for(t=0;n[t]._str;t++)if(0===e.localeCompare(n[t]._str))return!1;return!0}function dt(e,t,n){var r,o,i,a,l,s,u=0,c=1;for(r=0;e[r]._str;r++)if(0===n.localeCompare(e[r]._str))return u=e[r]._c,{_hasUnit:!0,_prefix:c,_constant:u};if(t)for(r=0;t[r]._str;r++)o=n.substr(0,1).toLowerCase(),i=t[r]._str.substr(0,1).toLowerCase(),o===i&&ft(n)&&(c=t[r]._c);for(r=0;e[r]._str;r++)if(a=W(e[r]._str),l=n.substr(1,a),s=e[r]._str.substr(0,a),l===s&&ft(n))return u=e[r]._c,{_hasUnit:!0,_prefix:c,_constant:u};return{_hasUnit:!1,_prefix:c,_constant:u}}function ht(e,n,r){var o,i,a,s,u,c,_,d,g,m,C,w,y,S,T,I,M;function E(e,t){return e===t}if(o=273.15,!n||!r)return te;if(i=E(n,"C")||E(n,"cel"),a=E(r,"C")||E(r,"cel"),s=E(n,"F")||E(n,"fah"),u=E(r,"F")||E(r,"fah"),c=E(n,"K")||E(n,"kel"),_=E(r,"K")||E(r,"kel"),i&&a||s&&u||c&&_)return e;if(i&&u)return 9*e/5+32;if(s&&a)return 5*(e-32)/9;if(s&&_)return 5*(e-32)/9+o;if(c&&u)return 9*(e-o)/5+32;if(i&&_)return e+o;if(c&&a)return e-o;for(d=[t,l,f,h,p,x,v,b,R,b],g=0;g<W(d);g++)if(m=d[g],C=dt(m,A,n),w=C._hasUnit,y=C._constant,S=C._prefix,C=dt(m,A,r),T=C._hasUnit,I=C._prefix,M=C._constant,w&&T&&0!==y&&0!==I)return e*S/y*M/I;return te}function gt(e,t,n,r){var o,i;if(""===e&&""===t)return re;if(o={value:0},i={value:0},!0===ge(e,o)&&!0===ge(t,i)){if(e=o.value,t=i.value,e<0||e>de||e%1!=0)return ne;if("bitOperator"===n){if(t<0||t>de||t%1!=0)return ne}else if("shiftOperator"===n&&0===e)return 0;return r(e,t)}return re}function pt(e,t){return gt(e,t,"bitOperator",function(e,t){return e&t})}function mt(e,t){return gt(e,t,"bitOperator",function(e,t){return e|t})}function vt(e,t){return gt(e,t,"bitOperator",function(e,t){return e^t})}function Ct(e,t){return gt(e,t,"shiftOperator",function(e,t){if(t>=48)return ne;if(t<0&&e<1<<-t)return 0;var n=e<<t;return n>de?ne:n})}function wt(e,t){return gt(e,t,"shiftOperator",function(n,r){return r>53?ne:t>=0?e>>t:e<<-t})}function yt(e,t){if(""===e)return ne;if(!0===e||!1===e)return re;var n=fe(e);return n?t(n):ne}function St(e){return yt(e,function(e){return be(Nt(e),e._getSuffix())})}function xt(e){return yt(e,function(e){return Bt(Et(e),new _e(0,0))?ne:be(kt(Ft(e),Et(e)),e._getSuffix())})}function bt(e){return yt(e,function(e){return Bt(e,new _e(0,0))?ne:be(Ot(e),e._getSuffix())})}function Tt(e){return yt(e,function(e){return Bt(Dt(e),new _e(0,0))?ne:be(Ht(e),e._getSuffix())})}function Rt(e){return yt(e,function(e){return Bt(Ft(e),new _e(0,0))?ne:be(Pt(e),e._getSuffix())})}function At(e){return yt(e,function(e){return Bt(Nt(e),new _e(0,0))?ne:be(Lt(e),e._getSuffix())})}function It(e){return yt(e,function(e){return be(Dt(e),e._getSuffix())})}function Mt(e){return yt(e,function(e){return be(Vt(e),e._getSuffix())})}function Et(e){var t=e._getReal(),n=e._getImag();return new _e(Y(t)*ce(n,!1),G(t)*ce(n,!0))}function Ft(e){var t=e._getReal(),n=e._getImag();return new _e(G(t)*ce(n,!1),-Y(t)*ce(n,!0))}function Dt(e){var t=e._getReal(),n=e._getImag();return new _e(ce(t,!0)*G(n),ce(t,!1)*Y(n))}function Nt(e){var t=e._getReal(),n=e._getImag();return new _e(ce(t,!1)*G(n),ce(t,!0)*Y(n))}function Vt(e){return kt(Et(e),Ft(e))}function Ot(e){return kt(he,Et(e))}function Ht(e){return kt(he,Dt(e))}function Pt(e){return kt(he,Ft(e))}function Lt(e){return kt(he,Nt(e))}function kt(e,t){var n,r,o=e._getReal(),i=e._getImag(),a=t._getReal(),l=t._getImag();return Math.abs(l)<Math.abs(a)?(n=l/a,new _e((o+i*n)/(a+l*n),(i-o*n)/(a+l*n))):(r=a/l,new _e((i+o*r)/(l+a*r),(i*r-o)/(l+a*r)))}function Bt(e,t){return e._getReal()===t._getReal()&&e._getImag()===t._getImag()}I={_argType:0},M={_argType:5},E={_argType:5,_argCondition:["checkLength 10"]},F={_needArgExistsValue:!0,_argType:2,_defaultValue:1,_argCondition:["< 1","> 10"]},D={_argType:2,_argCondition:"< 0"},N={_argType:8},V={_argType:8,_complexCondition:!0},O=[I,D],H=[{_argType:0,_argCondition:"<= 0"},D],P=[I,{_argType:0,_defaultValue:0}],L=[E,F],ie("BESSELI",Ae,2,2,O),ie("BESSELJ",Ie,2,2,O),ie("BESSELK",Me,2,2,H),ie("BESSELY",Ee,2,2,H),ie("BIN2DEC",Fe,1,1,E),ie("BIN2HEX",Ve,1,2,L,z,z,{_acceptsMissingArgument:1}),ie("BIN2OCT",Oe,1,2,L,z,z,{_acceptsMissingArgument:1}),ie("DEC2BIN",He,1,2,[{_argType:0,_argCondition:["< -512","> 511"]},F],z,z,{_acceptsMissingArgument:1}),ie("DEC2HEX",Pe,1,2,[{_argType:0,_argCondition:["< -549755813888","> 549755813887"]},F],z,z,{_acceptsMissingArgument:1}),ie("DEC2OCT",Le,1,2,[{_argType:0,_argCondition:["< -536870912","> 536870911"]},F],z,z,{_acceptsMissingArgument:1}),ie("HEX2BIN",ke,1,2,L,z,z,{_acceptsMissingArgument:1}),ie("HEX2DEC",De,1,1,E),ie("HEX2OCT",We,1,2,L,z,z,{_acceptsMissingArgument:1}),ie("OCT2BIN",Be,1,2,L,z,z,{_acceptsMissingArgument:1}),ie("OCT2DEC",Ne,1,1,E),ie("OCT2HEX",ze,1,2,L,z,z,{_acceptsMissingArgument:1}),ie("ERF",Ue,1,2,[I,{_needArgExistsValue:!0,_argType:0}],z,z,{_acceptsMissingArgument:1}),ie("ERF.PRECISE",Ye,1,1,I),ie("ERFC",Ge,1,1,I),ie("ERFC.PRECISE",Ge,1,1,I),ie("DELTA",Xe,1,2,P,z,z,{_acceptsMissingArgument:1}),ie("GESTEP",je,1,2,P,z,z,{_acceptsMissingArgument:1}),ie("COMPLEX",Ke,2,3,[I,I,{_argType:5,_defaultValue:"i"}],z,z,{_acceptsMissingArgument:2}),ie("IMABS",Ze,1,1,N),ie("IMAGINARY",Je,1,1,N),ie("IMARGUMENT",qe,1,1,N),ie("IMCONJUGATE",Qe,1,1,N),ie("IMCOS",$e,1,1,N),ie("IMDIV",et,2,2,[N,V]),ie("IMEXP",tt,1,1,N),ie("IMLN",nt,1,1,V),ie("IMLOG10",rt,1,1,V),ie("IMLOG2",ot,1,1,V),ie("IMREAL",at,1,1,N),ie("IMSIN",lt,1,1,N),ie("IMSQRT",st,1,1,N),ie("IMSUB",ut,2,2,[N,N]),ie("IMPOWER",it,2,2,[N,{_argType:2}]),ie("IMPRODUCT",ct,1,255,z,-1,-1),ie("IMSUM",_t,1,255,z,-1,-1),ie("CONVERT",ht,3,3,[{_argType:1},M,M]),ie("BITAND",pt,0,2),ie("BITLSHIFT",Ct,0,2),ie("BITOR",mt,0,2),ie("BITRSHIFT",wt,0,2),ie("BITXOR",vt,0,2),ie("IMCOSH",St,1,1),ie("IMCOT",xt,1,1),ie("IMCSC",bt,1,1),ie("IMCSCH",Tt,1,1),ie("IMSEC",Rt,1,1),ie("IMSECH",At,1,1),ie("IMSINH",It,1,1),ie("IMTAN",Mt,1,1),e.exports=oe}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N=n(3),V=n(1),O=isFinite,H=N._Types,P=H._inArray,L=H._isArray,k=H._isNullOrUndefined,B=N._ArrayHelper._getLength,W=V.Convert,z=W._toInt,U=W._isError,Y=W._toResult,G=W._toArray,X=W._toDouble,j=W.CalcConvertedError,K=null,Z=void 0,J=Math.pow,q=Math.abs,Q=Math.ceil,$=Math.log,ee=Math.sqrt,te=Math.floor,ne=Math.max,re=Math.min,oe=V.Errors,ie=oe.DivideByZero,ae=oe.Value,le=oe.Number,se=V.Functions,ue=se._defineBuiltInFunction,ce=se._MathHelper,_e=ce._round,fe=se._MAX_DOUBLE_VALUE,de=se._annualYearBasis,he=se._getDaysInMonth,ge=se._compareDateTime,pe=se._daysBetweenBasis,me=se._yearfrac,ve=W._tryToDouble;function Ce(e){return e.getMonth()}function we(e){return e.getDate()}function ye(e){return e.getFullYear()}function Se(e){return e instanceof Date?N._DateTimeHelper._toOADate(e):e}function xe(e,t,n){var r=ye(t)-ye(e),o=Ce(t)-Ce(e)+12*r,i=we(t)-we(e),a=-1;return 0===n?a=se._days360(e,t):P(n,[1,2,3])>=0?a=Se(t)-Se(e):4===n&&(a=30*o+i),a}function be(e,t,n,r,o){var i,a=J(1+e,t),l=O(a)?a:le;return 0===e?t:(a=(a-1)/e,i=O(a)?a:le,a=(-n*l-r)/((1+e*o)*i),O(a)?a:le)}function Te(e,t,n,r){var o=ye(t),i=Ce(t),a=we(t),l=new Date(1,0,1),s=0,u=a===he(o,i),c=12/n,_=o-ye(e);l.setFullYear(1),_>0&&(_=(_-1)*n);do{l=new Date(o,i,a),_++,l.setMonth(i-_*c),u&&(s=he(ye(l),Ce(l)),l=new Date(ye(l),Ce(l),s))}while(ge(e,l)<0);return r&&(l=new Date(o,i,a),_--,l.setMonth(i-_*c),u&&(s=he(ye(l),Ce(l)),l=new Date(ye(l),Ce(l),s))),l}function Re(e,t,n,r){return pe(Te(e,t,n,!1),e,r)}function Ae(e,t,n,r){var o;return o=P(r,[0,2,4,5])>=0?360/n:3===r?365/n:pe(Te(e,t,n,!1),Te(e,t,n,!0),1)}function Ie(e,t,n,r){return pe(e,Te(e,t,n,!0),r)}function Me(e,t,n){var r=ye(t),o=Ce(t),i=we(t),a=new Date(r,o,i),l=o-Ce(e)+12*(r-ye(e));if(a.setMonth(Ce(a)-l),i===he(r,o))for(;we(a)!==he(ye(a),Ce(a));)a.setDate(we(a)+1);return we(e)>=we(a)&&l--,parseInt(""+(1+l/(12/n)))}function Ee(e,t,n){return t>0?(n._havexpos?n._havexneg?q(e-n._xneg)<q(n._xpos-n._xneg)&&(n._xpos=e,n._ypos=t):t<n._ypos&&(n._xpos=e,n._ypos=t):(n._xpos=e,n._ypos=t,n._havexpos=!0),[!1,n]):t<0?(n._havexneg?n._havexpos?q(e-n._xpos)<q(n._xpos-n._xneg)&&(n._xneg=e,n._yneg=t):-t<-n._yneg&&(n._xneg=e,n._yneg=t):(n._xneg=e,n._yneg=t,n._havexneg=!0),[!1,n]):(n._root=e,[!0,n])}function Fe(e,t,n,r,o){var i,a=Te(e,n,r,!0),l=Te(e,n,r,!1);if(ge(a,t)>=0)return pe(e,t,o)/Ae(l,a,r,o);for(i=pe(e,a,o)/Ae(l,a,r,o);;){if(l=new Date(ye(a),Ce(a),we(a)),a.setMonth(Ce(a)+12/r),ge(a,t)>=0)return i+=pe(l,t,o)/Ae(l,a,r,o);i+=1}}function De(e,t,n,r,o,i,a){var l,s,u,c=Re(e,t,i,a),_=Ie(e,t,i,a),f=Ae(e,t,i,a),d=parseInt(""+Me(e,t,i)),h=0,g=100*n/i,p=1+r/i,m=_/f;for(l=0;l<d;l++)h+=g/J(p,m+l);return s=o/J(p,d-1+_/f),u=c/f*g,s+h-u}function Ne(e,t,n,r,o,i,a,l,s){var u,c,_,f,d,h,g=pe(l,e,a),p=pe(e,s,a),m=pe(l,s,a),v=Ae(e,t,i,a),C=parseInt(""+Me(e,t,i)),w=100*n/i,y=1+r/i;if(p>v)switch(a){case 0:case 4:u=pe(s,t,a),C=1+parseInt(""+Q(u/v));break;default:for(c=new Date(ye(s),Ce(s),we(s)),C=0;C<32767;C++)if(_=new Date(ye(c),Ce(c),we(c)),c.setMonth(Ce(c)+12/i),ge(c,t)>=0){C+=parseInt(""+Q(pe(_,t,a))/Ae(_,c,i,a))+1;break}g=v*Fe(l,e,s,i,a),p=v*Fe(e,s,s,i,a),m=v*Fe(l,s,s,i,a)}return f=o/J(y,C-1+p/v),d=m/v/J(y,p/v),h=J(y,-p/v)*(J(y,-C)-1/y)/(1/y-1),f+w*(d+h-g/v)}function Ve(e,t){var n=e.substr(0,3),r={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return r[n]?_e(r[n],t):-1}function Oe(e,t,n,r,o){var i,a=J(1+e,t);return 0===e?i=(n+r)/t:(i=r*e/(a-1)+n*e/(1-1/a),o>0&&(i/=1+e)),-i}function He(e,t,n,r,o){var i=J(1+e,t),a=o>0?1+e:1;return-(0===e?r+n*t:r*i+n*a*(i-1)/e)}function Pe(e,t,n,r,o,i,a){if(i<o||i>n||0!==a&&1!==a)return le;var l=Oe(t,n,r,0,a),s=0,u,c;for(1===o&&(e&&(s=l),a<=0&&(s+=e?r*t:-r),o++),u=o;u<=i;u++)c=a>0?He(t,u-2,l,r,1)-l:He(t,u-1,l,r,0),s+=e?l-c*t:c;return e?s:s*t}function Le(e,t,n,r){var o=J(1+n,r),i=-(e*o*n+t*(o-1));return O(i)?i:le}function ke(e,t,n,r,o){return P(r,[1,2,4])<0||ge(t,n)>=0?le:e(t,n,r,o)}function Be(e,t,n,r,o,i){function a(e,t,n,r){var o=0,i,a=0,l=100;for(e*=100/X(n),t/=n,t++,i=1;i<r;i++)o+=i*e/J(t,i);for(o+=r*(e+100)/J(t,r),i=1;i<r;i++)a+=e/J(t,i);return a+=(e+100)/J(t,r),o/=a,o/=X(n)}if(P(i,[1,2,4])<0||ge(t,n)>0)return le;var l=a(r,o,i,Me(t,n,i));return e?l/(1+o/i):l}function We(e,t,n,r,o,i,a,l,s){var u,c,_,f;if(P(a,[1,2,4])<0||ge(t,n)>0||ge(r,t)>0)return le;u=new Date(ye(r),Ce(r),we(r));do{u.setMonth(Ce(u)+12/a)}while(ge(u,n)<0);return c=Fe(r,t,u,a,l),_=Fe(r,n,u,a,l),f=Fe(t,n,u,a,l),e?(i*a+100*o*(_-c*(1+s*f/a)))/(s*f+a):(a*(i-s)+100*o*(_-c))/(f*s+100*o*c*f/a)}function ze(e,t,n){var r,o,i,a;return 0===n?ie:(r=t<0?Q(t):te(t),o=J(10,Q(ce._log(n,10))),i=t-r,a=e?i*o/n:i*n/o,Y(r+a))}function Ue(e,t,n){var r,o=B(t),i=0,a=1,l=1/(e+1);for(r=0;r<o;r++)i+=t[r]*a*(n?-r:1),a*=l;return i}function Ye(e,t,n,r){var o,i,a=0,l=B(t);for(o=0;o<l;o++){if((i=Se(r[o])-Se(r[0]))<0)return[!1,n];a+=t[o]/ce._pow1p(e,i/365)}return O(a)?n=isNaN(a)?5e-324:a:a===Number.POSITIVE_INFINITY?n=fe:a===Number.NEGATIVE_INFINITY&&(n=-fe),[!0,n]}function Ge(e,t,n,r){var o,i,a;return e>-1&&0!==e?(o=n,i=J(1+e,o._nper-(r?1:0)),a=(J(1+e,o._nper)-1)/e,t=r?-o._pmt*a/e+i*o._nper*(o._pv+o._pmt*(o._type+1/e)):o._pv*i+o._pmt*(1+e*o._type)*a+o._fv,[!0,t,n]):[!1,t,n]}function Xe(e,t,n,r,o,i,a,l,s,u,c,_,f,d,h){var g,p,m,v,C=0,w=0,y=n-o,S=n+o,x=2===e;if(y<i._xmin&&(y=n),S>i._xmax&&(S=n),y===S)return x?[!1,r,i,a]:[!1,r,i];if(0===e?(g=t(a,l,s,y,c,_,f,d,h)-u,p=t(a,l,s,S,c,_,f,d,h)-u):1===e?(g=t(y,a,C,l),p=t(S,a,w,l)):(g=Ge(y,C,a),p=Ge(S,w,a)),L(g)){if(v=g[2],C=g[1],!(m=g[0]))return x?[m,r,i,v]:[m,r,i]}else C=g;if(L(p)){if(v=p[2],w=p[1],!(m=p[0]))return x?[m,r,i,v]:[m,r,i]}else w=p;return r=(w-C)/(S-y),x?[!0,r,i,v]:[!0,r,i]}function je(e,t,n,r,o,i,a,l,s,u,c,_,f){var d,h;return r<n._xmin||r>n._xmax?[!1,n]:(d=e?Ue(r,o):t(o,i,a,r,s,u,c,_,f)-l,h=Ee(r,d,n),n=h[1],[!!h[0],n])}function Ke(e,t,n,r,o){if(t<e._xmin||t>e._xmax)return[!1,e,r];var i=Ye(t,n,r,o);return r=i[1],i[0]?(i=Ee(t,0,e),e=i[1],[!!i[0],e,r]):[i[0],e,r]}function Ze(e,t,n){var r,o,i=0;return t<e._xmin||t>e._xmax?[!1,e,n]:(r=Ge(t,i,n),n=r[2],i=r[1],r[0]?(o=Ee(t,i,e),e=o[1],[!!o[0],e,n]):[r[0],e,n])}function Je(e,t,n,r,o,i,a,l,s,u){var c,_,f,d,h,g,p=0,m=e?15:2;if(!n._havexpos||!n._havexneg)return e?[!1,n,r]:[!1,n];for(_=q(n._xpos-n._xneg)/(q(n._xpos)+q(n._xneg)),c=0;c<100+4*m;c++)if(f=0,d=0,h=c%4==0?1:c%4==2?2:3,g=e?tt(n,r,_,p,d,h):t?nt(!0,n,p,f,d,h,Ye,_,o,r,Xe):nt(!1,n,p,f,d,h,De,_,i,a,l,r,o,s,u),n=g[1],r=g[2],p=e?g[3]:g[2],g[0])return e?[!0,n,r]:[!0,n];return e?[!1,n,r]:[!1,n]}function qe(e,t,n,r,o,i,a,l,s,u,c){var _,f,d,h,g,p,m,v=0,C=e?15:2;if(!t._havexpos||!t._havexneg)return[!1,t];for(f=q(t._xpos-t._xneg)/(q(t._xpos)+q(t._xneg)),_=0;_<100+4*C;_++)if(d=0,h=0,g=_%4==0?1:_%4==2?2:3,p=e?nt(!0,t,v,d,h,g,Ue,f,Z,n,Xe):nt(!1,t,v,d,h,g,Ne,f,a,l,s,n,r,u,c,o,i),t=p[1],v=p[2],d=p[3],!(e&&p[0]===K||!e&&k(p[0]))){if(p[0])return[!0,t];if(h=e?Ue(d,n):Ne(n,r,a,d,s,u,c,o,i)-l,m=Ee(d,h,t),t=m[1],m[0])return[!0,t];if((f=q(t._xpos-t._xneg)/(q(t._xpos)+q(t._xneg)))<t._precision)return t._yneg<h&&(h=t._yneg,d=t._xneg),t._ypos<h&&(d=t._xpos),t._root=d,[!0,t]}return[!1,t]}function Qe(e,t,n,r,o,i,a,l,s,u,c,_,f){var d,h,g,p,m,v,C,w,y,S,x=n._precision/2;for(d=0;d<20;d++){if(r<n._xmin||r>n._xmax)return[!1,n];if(p=e?Ye(r,o,0,i):t(o,i,a,r,s,u,c,_,f)-l,L(p)){if(g=p[1],!(h=p[0]))return[h,n]}else g=p;if(m=Ee(r,g,n),n=m[1],m[0])return[!0,n];if(v=n._havexneg&&n._havexpos?q(n._xpos-n._xneg):n._xmax-n._xmin,C=(q(r)<1e-10?v:q(r))/1e6,w=0,m=e?Xe(1,Ye,r,w,C,n,o,i):Xe(0,t,r,w,C,n,o,i,a,l,s,u,c,_,f),n=m[2],w=m[1],!(h=m[0]))return[h,n];if(0===w)return[!1,n];if((y=r-1.000001*g/w)===r)return n._root=r,[!0,n];if(S=q(y-r)/(q(r)+q(y)),r=y,S<x)return n._root=r,[!0,n]}return[!1,n]}function $e(e,t,n){var r,o,i,a,l,s,u=e._precision/2;for(r=0;r<20;r++){if(n<e._xmin||n>e._xmax)return[!1,e];if(a=Ue(n,t),s=Ee(n,a,e),e=s[1],s[0])return[!0,e];if(0===(l=Ue(n,t,!0)))return[!1,e];if((o=n-1.000001*a/l)===n)return e._root=n,[!0,e];if(i=q(o-n)/(q(n)+q(o)),n=o,i<u)return e._root=n,[!0,e]}return[!1,e]}function et(e,t,n){var r,o,i,a,l,s,u,c,_=e._precision/2;for(r=0;r<100;r++){if(l=0,s=0,n<e._xmin||n>e._xmax)return[!1,e,t];if(u=Ge(n,l,t),t=u[2],l=u[1],!(a=u[0]))return[a,e,t];if(c=Ee(n,l,e),e=c[1],c[0])return[!0,e,t];if(u=Ge(n,s,t,!0),t=u[2],s=u[1],!(a=u[0]))return[a,e,t];if(0===s)return[!1,e,t];if((o=n-1.000001*l/s)===n)return e._root=n,[!0,e,t];if(i=q(o-n)/(q(n)+q(o)),n=o,i<_)return e._root=n,[!0,e,t]}return[!1,e,t]}function tt(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,h,g;if(1===i){if(a=(e._xpos+e._xneg)/2,u=Ge(a,o,t),t=u[2],o=u[1],!(l=u[0]))return[K,e,t,r];if(0===o)return e=Ee(a,o,e)[1],[!0,e,t,r];if(0===(s=ee(o*o-e._ypos*e._yneg)))return[K,e,t,r]}else if(2===i){if(f=0,d=0,n>.1)return i=3,tt(e,t,n,r,o,i);if(0===(h=r++%4))c=e._xpos,f=e._ypos;else if(2===h)c=e._xneg,f=e._yneg;else if(c=(e._xpos+e._xneg)/2,u=Ge(c,f,t),t=u[2],f=u[1],!(l=u[0]))return[K,e,t,r];if(_=q(e._xpos-e._xneg)/1e6,g=Xe(2,void 0,c,d,_,e,t),t=g[3],e=g[2],d=g[1],!(l=g[0])||0===d)return[K,e,t,r];if((a=c-1.01*f/d)<e._xpos&&a<e._xneg||a>e._xpos&&a>e._xneg)return[K,e,t,r]}return[!1,e,t,r]}function nt(e,t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p){var m,v,C,w,y,S,x,b;switch(i){case 0:r=t._xpos-t._ypos*((t._xneg-t._xpos)/(t._yneg-t._ypos));break;case 1:if(r=(t._xpos+t._xneg)/2,m=e?a(r,u,o,s):a(_,f,s,r,c,d,h,g,p)-u,L(m)){if(o=m[1],!m[0])return[K,t,n,r,o,i]}else o=m;if(0===o)return t=Ee(r,o,t)[1],[!0,t,n,r,o,i];if(0===(v=ee(o*o-t._ypos*t._yneg)))return[K,t,n,r,o,i];r+=(r-t._xpos)*o/v;break;case 3:r=(t._xpos+t._xneg)/2;break;case 2:if(w=0,S=0,l>.1)return i=3,nt(e,t,n,r,o,i,a,l,s,u,c,_,f,d,h);if(0===(x=n++%4))C=t._xpos,w=t._ypos;else if(2===x)C=t._xneg,w=t._yneg;else if(C=(t._xpos+t._xneg)/2,m=e?a(C,u,w,s):a(_,f,s,C,c,d,h,g,p)-u,L(m)){if(w=m[1],!m[0])return[K,t,n,r,o,i]}else w=m;if(y=q(t._xpos-t._xneg)/1e6,b=e?c(1,a,C,S,y,t,u,s):Xe(0,a,C,S,y,t,_,f,s,u,c,d,h,g,p),t=b[2],S=b[1],!b[0]||0===S)return[K,t,n,r,o,i];if((r=C-1.01*w/S)<t._xpos&&r<t._xneg||r>t._xpos&&r>t._xneg)return[K,t,n,r,o,i]}return[!1,t,n,r,o,i]}function rt(e,t,n,r,o){o=o?1:0;var i=J(1+e,t);return i=0===e?n*t+r:r*i+n*(1+e*o)*(i-1)/e,Y(-i)}function ot(e,t){for(var n=0;n<B(t);n++)t[n]!==j&&(e*=1+t[n]);return e}function it(e){var t,n,r,o=arguments,i=0,a=1;for(n=1;n<B(o);n++){if(r=G(o[n],1,!0,!0,!1),r.isError)return r[0];for(t=0;t<B(r);t++)r[t]!==j&&(i+=r[t]/J(1+e,a++))}return i}function at(e,t,n,r,o){if(o=o?1:0,0===e)return Y(-(n*t+r));var i=J(1+e,t);return-1===e?ie:Y(-(r+n*(1+e*o)*(i-1)/e)/i)}function lt(e,t,n,r,o){var i,a,l;return ge(e,t)>=0?le:(i=xe(e,t,o),a=de(e,o),i<=0||a<=0?le:(l=1-r*i/a,l<=0?le:n/l))}function st(e,t,n){var r=B(t),o=B(n),i=0,a;if(r!==o)return le;for(a=0;a<r;a++)i+=t[a]/J(1+e,(n[a]-n[0])/365);return i}function ut(e,t,n,r,o,i){return Pe(!1,e,t,n,r,o,i)}function ct(e,t,n,r,o,i){return Pe(!0,e,t,n,r,o,i)}function _t(e,t,n,r,o,i){return t>=n+1||0!==i&&1!==i?le:Le(r,be(e,n,r,o,i),e,t-1)}function ft(e,t,n,r){return Y(r*e*(t/n-1))}function dt(e,t,n,r,o){o=o?1:0;var i=J(1+e,t);return i=0===e?(n+r)/t:(n*i+r)/((1+e*o)*(i-1)/e),Y(-i)}function ht(e,t,n,r,o,i){if(i=i?1:0,t>=n+1)return le;var a=be(e,n,r,o,i);return a-Le(r,a,e,t-1)}function gt(e,t,n,r){return ke(Re,e,t,n,r)}function pt(e,t,n,r){return ke(Ae,e,t,n,r)}function mt(e,t,n,r){return ke(Ie,e,t,n,r)}function vt(e,t,n){return Se(Te(e,t,n,!0))}function Ct(e,t,n){return ke(vt,e,t,n)}function wt(e,t,n){return ke(Me,e,t,n)}function yt(e,t,n){return Se(Te(e,t,n,!1))}function St(e,t,n){return ke(yt,e,t,n)}function xt(e,t,n,r,o){return Be(!1,e,t,n,r,o)}function bt(e,t,n,r,o){return Be(!0,e,t,n,r,o)}function Tt(e,t,n,r,o){return o=o?1:0,0===e?0===t?ie:Y(-(n+r)/t):Y($((t*(1+e*o)-r*e)/(n*e+t*(1+e*o)))/$(1+e))}function Rt(e,t,n,r,o,i,a){var l,s,u,c,_,f,d,h,g,p,m;if(P(i,[1,2,4])<0||ge(e,t)>0)return le;if((l=Me(e,t,i))<=1)return s=Re(e,t,i,a),u=Ie(e,t,i,a),c=Ae(e,t,i,a),_=i*c/u,f=o/100+n/i-(r/100+s/c*n/i),d=r/100+s/c*n/i,f/d*_;if(g=.1,p={_xmin:0,_xmax:1e3,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},m=Qe(!1,De,p,g,e,t,n,r,o,i,a),p=m[1],!(h=m[0])){for(g=1e-10;g<p._xmax;g*=2)p=je(!1,De,p,g,e,t,n,r,o,i,a)[1];m=Je(!1,!1,p,e,t,n,r,o,i,a),p=m[1],h=m[0]}return h?p._root:le}function At(e,t,n,r,o){return ge(e,t)>=0?le:(r/n-1)/me(e,t,o)}function It(e,t,n,r,o,i){var a=me(n,t,i),l=me(n,e,i),s=me(e,t,i),u=1+a*r;return u/=o/100+l*r,u--,u/=s}function Mt(e,t,n,r,o,i,a){function l(e,t,n,r,o,i,a){var l,s,u,c,_,f,d=1/i;if(s=d<3?1:d<5?1.5:d<=6?2:2.5,i*=s,_=me(t,n,a),U(_))return 0;for(u=te(_*i*e+.5),e-=u,c=e-r,l=0;l<o;l++){if(u=te(i*e+.5),(c-=u)<0)return f=o-l,0===f||1===f?te(.5*e+.5):0;e-=u}return u}var s=1/i;return s>0&&s<1||s>1&&s<2||s>2&&s<3||s>4&&s<5||ge(t,n)>0?le:l(e,t,n,r,o,i,a)}function Et(e,t,n,r,o,i,a){function l(e,t,n,r,o,i,a){var l,s,u,c,_=e*i,f=e-r,d=me(t,n,a);return U(d)?0:(l=d*i*e,s=(e-r-l)/_,u=z((e-r-l)/_),c=0===o?l:o<=u?_*(s<1?s:1):o===u+1?f-_*u-l:0)}return ge(t,n)>0?le:l(e,t,n,r,o,i,a)}function Ft(e,t,n,r,o,i,a,l,s){var u,c,_,f=.1;if(P(l,[1,2,4])<0||ge(n,e)>0||ge(e,r)>0||ge(r,t)>0)return le;if(u={_xmin:0,_xmax:1e3,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},c=Qe(!1,Ne,u,f,e,t,o,i,a,l,s,n,r),u=c[1],_=c[0]){for(f=1e-10;f<u._xmax;f*=2)u=je(!1,Ne,u,f,e,t,o,i,a,l,s,n,r)[1];c=qe(!1,u,e,t,n,r,o,i,a,l,s),u=c[1],_=c[0]}return _?u._root:le}function Dt(e,t,n,r,o,i,a,l){return We(!1,e,t,n,r,i,a,l,o)}function Nt(e,t,n,r,o,i,a,l){return We(!0,e,t,n,r,i,a,l,o)}function Vt(e,t,n){var r,o,i=Se(t)-Se(e);return ge(e,t)>=0||i>365?le:(r=365*n,o=360-n*i,0===o?ie:o<0?le:Y(r/o))}function Ot(e,t,n){var r=Se(t)-Se(e);return ge(e,t)>=0||r>365?le:(100-n)/n*(360/r)}function Ht(e,t){var n,r,o,i,a,l=B(e),s=[],u=!1,c=!1,_={_xmin:-1,_xmax:1e10,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0};if(l<2)return le;for(q(t)>1&&(t=.1),_._xmax=re(_._xmax,J(fe/1e10,1/l)-1),n=0;n<l;n++)(r=e[n])!==j&&(s[n]=r,r>0&&(u=!0),r<0&&(c=!0));if(!u||!c)return le;if(o=$e(_,s,t),_=o[1],!(i=o[0])){for(a=2;(!_._havexneg||!_._havexpos)&&a<100;a*=2)_=je(!0,Z,_,t*a,s)[1],_=je(!0,Z,_,t/a,s)[1];o=qe(!0,_,s),_=o[1],i=o[0]}return i?_._root:le}function Pt(e,t,n){var r,o,i,a,l=0,s=0,u=0,c=0,_=0,f=[],d=B(e);if(d<2)return ie;for(r=0;r<d;r++)(o=e[r])!==j&&(f[r]=o,o>=0?l++:s++);for(u=s+l,i=0;i<u;i++)a=f[i],a>=0?c+=a/J(1+n,i):_+=a/J(1+t,i);return 0===_||0===c||n<=-1?ie:J(-c*J(1+n,u)/(_*(1+n)),1/(u-1))-1}function Lt(e,t,n){var r,o,i,a,l,s,u,c,_,f,d=B(e);if(d!==B(t))return le;for(i=0;i<d;i++)r=e[i]>0||r,o=e[i]<0||o;if(!r||!o)return le;if(a={_xmin:-1,_xmax:1e3,_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},l=Qe(!0,Xe,a,n,e,t),a=l[1],l[0])return a._root;for(i=1;i<=1024;i+=i)if(u=i,c=9/(u+9),_=Ke(a,n,c,e,t),a=_[1],c=u,_=Ke(a,n,c,e,t),a=_[1],f=Je(!1,!0,a,e,t),a=f[1],s=f[0])return a._root;return le}function kt(e,t,n,r,o,i){var a,l,s,u,c,_;if(o>1&&(o=1),a={_precision:1e-10,_havexpos:!1,_xpos:0,_ypos:0,_havexneg:!1,_xneg:0,_yneg:0,_root:0},l=J(1.7976931348623157e298,1/e),a._xmin=ne(-1e10,1-l),a._xmax=re(1e10,l-1),s={_nper:e,_pmt:t,_pv:n,_fv:r,_type:o},u=et(a,s,i),s=u[2],a=u[1],!(c=u[0])){for(_=2;(!a._havexneg||!a._havexpos)&&_<100;_*=2)u=Ze(a,i*_,s),s=u[2],a=u[1],u=Ze(a,i/_,s),s=u[2],a=u[1];u=Je(!0,!1,a,s),a=u[1],c=u[0]}return c?a._root:le}function Bt(e,t,n,r,o){var i,a,l,s=o/n;return s>=1?(s=1,a=1===r?e:0):a=e*J(1-s,r-1),l=e*J(1-s,r),i=a-(l<t?t:l),i<0?0:i}function Wt(e,t,n,r,o,i){var a,l,s,u=0,c=0,_=Q(o),f=_,d=e-t,h=!1;for(s=1;s<=f;s++)h?l=c:(a=Bt(e,t,n,s,i),c=d/(r-(s-1)),c>a?(l=c,h=!0):(l=a,d-=a)),s===f&&(l*=o+1-_),u+=l;return u}function zt(e,t,n,r,o,i,a){var l,s,u,c,_=te(r),f=_,d=Q(o),h=d,g=0;if(a)for(l=f+1;l<=h;l++)s=Bt(e,t,n,l,i),l===f+1?s*=re(o,_+1)-r:l===h&&(s*=o+1-d),g+=s;else u=n,r!==te(r)&&i>1&&r>=n/2&&(c=r-n/2,r=n/2,o-=c,u+=1),e-=Wt(e,t,n,u,r,i),g=Wt(e,t,n,n-r,o-r,i);return g}function Ut(e,t,n,r,o,i,a){return o<r?le:e<t&&0===r&&1===o?e-t:zt(e,t,n,r,o,i,a)}function Yt(e,t,n,r,o,i,a){var l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T;if(P(i,[1,2,4])<0||ge(e,n)>=0)return le;if(1===i||0===a||4===a)return Gt(e,t,n,r,o,i,a);for(l=e.getFullYear(),s=e.getMonth(),u=e.getDate(),c=n.getFullYear(),_=n.getMonth(),f=n.getDate(),d=t.getMonth(),h=t.getDate(),g=[],p=[],m=[],v=[31,28,31,30,31,30,31,31,30,31,30,31],C=0;C<i;C++)g[C]=(d+12*C/i)%12,p[C]=h<=v[g[C]]?h:v[g[C]],2===a?m[C]=360/i:3===a&&(m[C]=365/i);for(C=0;C<i;C++)w=C===i-1?0:C+1,y=g[w]>g[C]?2001:2002,m[C]=Se(new Date(y,g[w],p[w]))-Se(new Date(2001,g[C],p[C]));for(S=0,x=Se(n);l<c||l===c&&s<_||l===c&&s===_&&u<f;){for(C=0;C<i&&(s<g[C]||s===g[C]&&u<p[C])&&(0===C||g[C]>g[C-1]);)C++;for(;C<i&&(s>g[C]||s===g[C]&&u>=p[C])&&(C++,s!==g[C-1]||u!==p[C-1]););C--,w=C===i-1?0:C+1,y=s+12/i>=12?l+1:l,b=Se(new Date(l,s,u)),T=Math.min(Se(new Date(y,g[w],p[w])),x),S+=o*r/i*(T-b)/m[C],l=y,s=g[w],u=p[w]}return S}function Gt(e,t,n,r,o,i,a){var l=xe(e,n,a),s=de(e,a);return l<0||s<=0?le:o*r*(l/s)}function Xt(e,t,n,r,o){if(ge(e,t)>0)return le;var i=xe(e,t,o),a=de(e,o);return i<0||a<=0?le:r*n*i/a}function jt(e,t,n,r,o){if(ge(e,t)>=0)return le;var i=de(e,o),a=xe(e,t,o);return a<=0||i<=0?le:(r-n)/r*(i/a)}function Kt(e,t){return J(1+e/t,t)-1}function Zt(e,t,n,r,o){if(ge(e,t)>=0)return le;var i=xe(e,t,o),a=de(e,o);return i<=0||a<=0?le:(r-n)/n*(a/i)}function Jt(e,t){return t*(J(1+e,1/t)-1)}function qt(e,t,n,r,o){var i,a,l,s;if(n+(o<12?1:0)<r)return le;if(0===e)return 0;for(i=_e(1-J(t/e,1/n),3),a=0,l=0,s=1;s<=r;s++)l=1===s?e*i*o/12:s===n+1?(e-a)*i*(12-o)/12:(e-a)*i,a+=l;return l}function Qt(e,t,n,r,o){var i,a=0,l=0;if(n<r)return le;if(e<=t)return 0;for(i=1;i<=r;i++)l=o/n*(e-a),l=re(l,e-a-t),a+=l;return l}function $t(e,t,n){return(e-t)/n}function en(e,t,n,r){return r>n?le:(e-t)*(n-r+1)*2/(n*(n+1))}function tn(e,t){return ze(!0,e,t)}function nn(e,t){return ze(!1,e,t)}function rn(e,t,n,r,o,i,a){return P(i,[1,2,4])<0||ge(e,t)>0?le:De(e,t,n,r,o,i,a)}function on(e,t,n,r,o){if(ge(e,t)>=0)return le;var i=xe(e,t,o),a=de(e,o);return i<=0||a<=0?le:r-n*r*i/a}function an(e,t,n,r,o,i){var a,l,s,u,c;return ge(e,t)>=0?le:(a=xe(e,t,i),l=xe(n,t,i),s=xe(n,e,i),u=de(e,i),s<=0||u<=0||a<=0||l<=0?le:(c=1+a/u*o,0===c?le:(100+l/u*r*100)/c-s/u*r*100))}function ln(e,t,n,r,o,i,a,l,s){return P(l,[1,2,4])<0||ge(n,e)>0||ge(e,r)>0||ge(r,t)>0?le:Ne(e,t,o,i,a,l,s,n,r)}function sn(e,t,n){var r=Se(t)-Se(e);return ge(e,t)>=0||r>365?le:100*(1-n*r/360)}function un(e){var t=Ve(e,2);return t>=0?t:le}function cn(e,t,n,r,o){var i,a,l,s;function u(e){var t=e.substr(0,3);return P(t,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])>=0?0:2}function c(e){var t=e.substr(0,3);return P(t,["BEF","LUF","ESP","ITL","LUX"])>=0?0:2}return i=0,r||(i=c(n)),o._isArgExists||(o._value=u(t)),l=Ve(t,o._value),s=Ve(n,o._value),l>=0&&s>=0?(a=e*s/l,r||(a=_e(a,i)),a):ae}function _n(e,t,n,r){var o,i,a;return""===e&&""===t&&""===n?ae:(o={value:0},e=ve(e,o),i={value:0},t=ve(t,i),a={value:0},n=ve(n,a),!0===e&&!0===t&&!0===n?r(o,i,a):ae)}function fn(e,t,n){return _n(e,t,n,function(e,t,n){var r,o;return t.value>0&&e.value>0&&n.value>0?(r=(Math.log(n.value)-Math.log(t.value))/Math.log(1+e.value),o=Math.abs(r),o<=1.79769e308?o>=2.2250738585072014e-308?r:0:ie):le})}function dn(e,t,n){return _n(e,t,n,function(t,n,r){if(n.value>0&&t.value>0&&r.value>=0){e=Math.pow(r.value/n.value,1/t.value)-1;var o=Math.abs(e);if(o<=1.79769e308)return o>=2.2250738585072014e-308?e:0}return le})}t={_argType:0},r={_defaultValue:0,_argType:0},o={_argType:0,_argCondition:"<= 0"},i={_argType:0,_argCondition:"< 1"},a={_argType:0,_argCondition:"< 0"},l={_defaultValue:.1,_argType:0},s={_defaultValue:2,_argType:0},u={_argType:0,_argCondition:"= 0"},c={_defaultValue:1e3,_argType:0,_argCondition:"<= 0"},_={_argType:6},f={_argType:5},d={_defaultValue:!1,_argType:7},h={_argType:2},g={_argType:2,_argCondition:"<= 0"},p={_argType:2,_argCondition:"< 1"},m={_defaultValue:0,_argType:2},v={_defaultValue:0,_argType:2,_argCondition:["< 0","> 4"]},C={_defaultValue:0,_argType:2,_argCondition:["< 0","> 4","= 2"]},w={_argType:2,_argCondition:"= 0",_conditionErrorValue:ie},y={_argType:2,_argCondition:"< 0"},S={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0},x={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,breakOnConvertError:!0},b=[_,_,h,v],T=[_,_,t,t,h,v],R=[_,_,o],A=[t,_,_,t,h,o,C],I=[t,t,t,r,r],M=[_,_,o,o,v],E=[o,g,o,p,h,h],F=[o,p],D=[t,y],ue("FV",rt,3,5,I,Z,Z,{_acceptsMissingArgument:[3,4]}),ue("FVSCHEDULE",ot,2,2,[t,S],1,1),ue("NPV",it,2,Z,t,"> 0","> 0"),ue("PV",at,3,5,I,Z,Z,{_acceptsMissingArgument:[3,4]}),ue("RECEIVED",lt,4,5,M,Z,Z,{_acceptsMissingArgument:3}),ue("XNPV",st,3,3,[t,x,x],"!= 0","!= 0"),ue("CUMIPMT",ut,6,6,E),ue("CUMPRINC",ct,6,6,E),ue("IPMT",_t,4,6,[t,i,i,t,r,m],Z,Z,{_acceptsMissingArgument:[4,5]}),ue("ISPMT",ft,4,4,[t,h,w,t]),ue("PMT",dt,3,5,[t,{_argType:0,_argCondition:"= 0",_conditionErrorValue:ie},t,r,r],Z,Z,{_acceptsMissingArgument:[3,4]}),ue("PPMT",ht,4,6,[t,i,t,t,r,r],Z,Z,{_acceptsMissingArgument:[4,5]}),ue("COUPDAYBS",gt,3,4,b,Z,Z,{_acceptsMissingArgument:3}),ue("COUPDAYS",pt,3,4,b,Z,Z,{_acceptsMissingArgument:3}),ue("COUPDAYSNC",mt,3,4,b,Z,Z,{_acceptsMissingArgument:3}),ue("COUPNCD",Ct,3,4,b,Z,Z,{_acceptsMissingArgument:3}),ue("COUPNUM",wt,3,4,b,Z,Z,{_acceptsMissingArgument:3}),ue("COUPPCD",St,3,4,b,Z,Z,{_acceptsMissingArgument:3}),ue("DURATION",xt,5,6,T,Z,Z,{_acceptsMissingArgument:5}),ue("MDURATION",bt,5,6,T,Z,Z,{_acceptsMissingArgument:5}),ue("NPER",Tt,3,5,[{_argType:0,_argCondition:"<= -1"},t,t,r,r],Z,Z,{_acceptsMissingArgument:[3,4]}),ue("YIELD",Rt,6,7,[_,_,a,a,o,h,v],Z,Z,{_acceptsMissingArgument:6}),ue("YIELDDISC",At,4,5,[_,_,o,o,v],Z,Z,{_acceptsMissingArgument:3}),ue("YIELDMAT",It,5,6,[_,_,_,a,t,v],Z,Z,{_acceptsMissingArgument:5}),ue("AMORDEGRC",Mt,6,7,A,Z,Z,{_acceptsMissingArgument:6}),ue("AMORLINC",Et,6,7,A,Z,Z,{_acceptsMissingArgument:6}),ue("ODDFYIELD",Ft,8,9,[_,_,_,_,a,o,o,h,v],Z,Z,{_acceptsMissingArgument:8}),ue("ODDLYIELD",Dt,7,8,[_,_,_,a,a,o,t,v],Z,Z,{_acceptsMissingArgument:7}),ue("ODDLPRICE",Nt,7,8,[_,_,_,a,a,o,h,v],Z,Z,{_acceptsMissingArgument:7}),ue("TBILLEQ",Vt,3,3,R),ue("TBILLYIELD",Ot,3,3,R),ue("IRR",Ht,1,2,[S,l],0,0,{_acceptsMissingArgument:1}),ue("MIRR",Pt,3,3,[S,t,t],0,0),ue("XIRR",Lt,2,3,[x,{_argType:4,_valueType:4,_toOneDimension:!0,_breakOnError:!0,breakOnConvertError:!0},l],"!= 2","!= 2",{_acceptsMissingArgument:2}),ue("RATE",kt,3,6,[o,t,t,r,{_defaultValue:0,_argType:2,_argCondition:"< 0",_conditionErrorValue:ae},l],Z,Z,{_acceptsMissingArgument:[3,4,5]}),ue("VDB",Ut,5,7,[a,a,y,a,a,s,d],Z,Z,{_acceptsMissingArgument:[5,6]}),ue("ACCRINT",Yt,6,8,[_,_,_,o,c,h,v],Z,Z,{_acceptsMissingArgument:[4,6,7]}),ue("ACCRINTM",Xt,3,5,[_,_,o,c,v],Z,Z,{_acceptsMissingArgument:[3,4]}),ue("DISC",jt,4,5,[_,_,o,o,v],Z,Z,{_acceptsMissingArgument:3}),ue("EFFECT",Kt,2,2,F),ue("INTRATE",Zt,4,5,M,Z,Z,{_acceptsMissingArgument:3}),ue("NOMINAL",Jt,2,2,F),ue("DB",qt,4,5,[a,t,p,p,{_defaultValue:12,_argType:2,_argCondition:["< 1","> 12"]}],Z,Z,{_acceptsMissingArgument:3}),ue("DDB",Qt,4,5,[a,t,g,g,{_defaultValue:2,_argType:0,_argCondition:"<= 0"}],Z,Z,{_acceptsMissingArgument:3}),ue("SLN",$t,3,3,[t,t,w]),
ue("SYD",en,4,4,[t,a,p,g]),ue("DOLLARDE",tn,2,2,D),ue("DOLLARFR",nn,2,2,D),ue("PRICE",rn,6,7,[_,_,a,a,u,h,v],Z,Z,{_acceptsMissingArgument:6}),ue("PRICEDISC",on,4,5,M,Z,Z,{_acceptsMissingArgument:3}),ue("PRICEMAT",an,5,6,[_,_,_,a,a,v],Z,Z,{_acceptsMissingArgument:5}),ue("ODDFPRICE",ln,8,9,[_,_,_,_,a,a,o,h,v],Z,Z,{_acceptsMissingArgument:8}),ue("TBILLPRICE",sn,3,3,[_,_,o]),ue("EURO",un,1,1,f),ue("EUROCONVERT",cn,3,5,[t,f,f,d,{_needArgExistsValue:!0,_argType:2,_defaultValue:3,_argCondition:"< 3",_conditionErrorValue:ae}],Z,Z,{_acceptsMissingArgument:[3,4]}),ue("PDURATION",fn,3,3),ue("RRI",dn,3,3),e.exports=se}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g=n(3),p=n(1),m=null,v=void 0,C=g._RegexHelper,w=g._Types,y=g._DateTimeHelper._parseInvariant,S=w._extend,x=w._isNullOrUndefined,b=w._inherit,T=g._ArrayHelper._getLength,R=p.Convert,A=R._isError,I=R._toInt,M=R._tryToInt,E=R._isNumber,F=R._toDouble,D=R._toString,N=p.Errors,V=N.Value,O=N.Reference,H=N.NotAvailable,P=N.Null,L=p.Parser,k=p.CalcReference,B=p.CalcArrayHelper,W=p.Functions,z=W._defineBuiltInFunction,U=W._isBoolean,Y=W._isString,G=function(e,t,n,r){return{row:e,col:t,rowCount:n,colCount:r}};function X(e,t,n){var r,o;return x(e)?m:e.isArray||e.isReference?(r=e.colCount,t>r&&(o=t,t=n,n=o),e[n*r+t]):e[0]}function j(e,t){return!x(t)&&(!!((x(e)||E(e,!0))&&E(t,!0)||U(e)&&U(t))||!(!Y(e)||!Y(t)))}function K(e,n,s,u,c){if(e<0||n<0||n<e||s<e||s>n)return-1;if(c)return t=e,r=n,o=s,i=s,a=u,l=u,o;if(a){if(++o>r){if(a!==l)return-1;o=i-1,a=!1}}else if(--o<t){if(a!==l)return-1;o=i+1,a=!0}return o}function Z(e,t,n){var r=y(e),o=n;return r===t?o=0:r>t?o=1:r<t&&(o=2),o}function J(e,t,n){var r,o,i;return e===t?0:Y(e)?t||0!==T(""+e)?E(t)?1:U(t)?2:Y(t)?(r=n?(""+e).localeCompare(""+t):e.toLowerCase().localeCompare(t.toLowerCase()),0===r?0:r>0?1:2):t instanceof Date?Z(e,t,1):-1:0:Y(t)?e||0!==T(""+t)?E(e)?2:U(e)?1:e instanceof Date?Z(e,t,2):-1:0:U(e)&&E(t)?1:U(t)&&E(e)?2:(o=F(e),i=F(t),o===i?0:o<i?2:1)}function q(e,t,n){var r=X(e,t,n);return x(r)?0:r}function Q(e,t,n,r){var o,i,a,l,s=-1,u=0,c=-1,_=-1,f=r?t.rowCount:t.colCount;if(--f<u)return-1;for(;u<=f;){for(o=m,a=e[0],n>=1!=(2===s)&&(c=_),_=I((u+f)/2),_=K(u,f,_,n>=0,!0),i=_;!j(a,o)&&-1!==_&&(o=r?X(t,0,_):X(t,_,0),!j(a,o));)_=K(0,0,0,!1,!1),n>=0&&_<i?f=_:n<0&&_>i&&(u=_);if(-1===_&&n>=1!=(2===s))return c;if(-1===_)return-1;if(s=J(a,o,!1),n>=1&&1===s)u=_+1;else if(n>=1&&2===s)f=_-1;else if(n<=-1&&1===s)f=_-1;else if(n<=-1&&2===s)u=_+1;else if(0===s){for(;n<=-1&&_>u||n>=0&&_<f;){if(l=0,l=n>=0?_+1:_-1,null===(o=r?q(t,0,l):q(t,l,0)))return-1;if(!j(a,o))break;if(0!==(s=J(a,o,!1)))break;_=l}return _}}return n>=1!=(2===s)?_:c}function $(e,t,n,r){var o,i,a,l,s,u=m,c=-1,_=e[0],f=Y(_),d=C._getWildcardCriteriaFullMatch(_),h=r?t.rowCount:t.colCount;for(f&&d&&(a=C._getRegIgnoreCase(d)),i=0;i<h;i++)if(l=r?X(t,0,i):X(t,i,0),j(_,l))if(s=Y(l),f&&s&&d?(a.lastIndex=0,o=a.test(l)?0:1):o=J(_,l,!1),n>=1&&1===o)o=-1,c>=0&&(o=J(l,u,!1)),(c<0||c>=0&&1===o)&&(c=i,u=l);else if(n<=-1&&2===o)o=-1,c>=0&&(o=J(l,u,!1)),(c<0||c>=0&&2===o)&&(c=i,u=l);else if(0===o)return i;return c}s=function(e){b(t,e);function t(t,n,r,o,i,a){var l=this;e.call(l,t,[G(n,r,o,i)]),l._row=n,l._column=r,l._rowCount=o,l._columnCount=i,l._type=a}var n={type:function(){return this._type},getValue:function(t,n,r){var o=this,i=o._type,a;return a=0===i?o.getRow(0)+1+n:1===i?o.getColumn(0)+1+r:e.prototype.getValue.call(o,t,n,r)},toArray:function(t,n){var r=this,o=[],i=r._row,a=r._column,l=r._type,s=r.getRangeCount(),u=r._rowCount,c=r._columnCount,_,f,d,h,g,p;for(_=0;_<s;_++)for(n||(d=[],o.push(d)),g=0;g<u;g++)for(n||(h=[],d.push(h)),p=0;p<c;p++)f=0===l?i+1+g:1===l?a+1+p:e.prototype.getValue.call(r,_,i+g,a+p),n?o.push(f):h.push(f);return n||1!==s||(o=o[0]),o.rowCount=u,o.colCount=c,o.rangeCount=s,o}};return S(t.prototype,n),t}(p.CalcReference),u=function(e){b(t,e);function t(t){e.call(this),this._array=t}var n={getRowCount:function(){return B.getColumnCount(this._array)},getColumnCount:function(){return B.getRowCount(this._array)},getValue:function(e,t){return B.getValue(this._array,t,e)}};return S(t.prototype,n),t}(p.CalcArray);function ee(e,t,n){if(!e)return V;var r=e.arrayFormulaMode,o=t!==v,i=n?0:1;return t=o?t:e.getReference(e.source,p._createRangeIdentity(e.row,e.column,e.rowCount,e.columnCount)),t&&1===t.getRangeCount()?r&&o?new s(t.getSource(),t.getRow(0),t.getColumn(0),t.getRowCount(0),1,i):(n?t.getRow(0):t.getColumn(0))+1:V}function te(e,t,n,r,o){if(o&&n>t.colCount||!o&&n>t.rowCount)return O;var i=r?Q(e,t,1,o):$(e,t,0,o);return i>=0?o?q(t,n-1,i):q(t,i,n-1):H}function ne(e,t){return ee(e,t,!0)}function re(e,t){return ee(e,t,!1)}function oe(e){return B.getRowCount(e)}function ie(e){return B.getColumnCount(e)}function ae(e){return new u(e)}function le(e,t,n,r){return te(e,t,n,r,!1)}function se(e,t,n,r){return te(e,t,n,r,!0)}function ue(e,t,n){var r,o,i=e,a=t,l=-1,s=a.colCount,u=a.rowCount;if(n===v)return o=s>u?le(i,a,u):se(i,a,s),A(o)?H:o;if(r=R._toArray(n,0,!0,!1,!1)){if(r.colCount>1&&r.rowCount>1)return H}else r=a;return l=Q(i,a,1,!(s>u)),l>=0?(s=r.colCount,u=r.rowCount,s>u?q(r,l,u-1):q(r,s-1,l)):H}function ce(e){var t=arguments;return e<1||T(t)<=e?V:x(t[e])?0:t[e]}function _e(e,t,n){var r,o,i,a,l;function s(e,t){var n,r,o,i,a=T(e);for(n=1;n<a;n++)if(r=e[n-1],o=e[n],i=J(r,o,!1),2===i&&!t)return!1;return!0}return r=e,o=t,o.isArray||o.isReference?(i=o.colCount,a=o.rowCount,l=-1,i>1&&a>1?H:1===n&&!s(o,!0)||-1===n&&!s(o,!1)?H:(1===n?l=Q(r,o,1,a>1):0===n?l=$(r,o,0,a>1):-1===n&&(l=Q(r,o,-1,a>1)),-1===l?H:l+1)):H}function fe(e,t,n,r){return e+=t,r?0!==n&&(e+="[",e+=""+n,e+="]"):e+=n,e}function de(e,t,n){return n||(e+="$"),e+=t}function he(e,t,n){n||(e+="$");for(var r=e.length;t>.1;t=parseInt((t-1)/26),10)e=g._StringHelper._insert(e,r,String.fromCharCode("A".charCodeAt(0)+(t-1)%26));return e}function ge(e,t){if(t&&0<T(t)){var n,r=!p._isLetter(t[0])&&"_"!==t[0];for(n=1;!r&&n<T(t);n++)r=!p._isLetterOrDigit(t[n])&&"_"!==t[n];r?(e+="'",e+=t.replace("'","''"),e+="'"):e+=t,e+="!"}return e}function pe(e,t,n,r,o){var i=3===n||4===n||7===n||8===n,a=2===n||4===n||6===n||8===n,l="";return e<1&&(r||!i)||e>p.maxRowCount||t<1&&(r||!a)||t>p.maxColumnCount||n<1||8<n?V:(l=ge(l,o),r?(l=he(l,t,a),l=de(l,e,i)):(l=fe(l,"R",e,i),l=fe(l,"C",t,a)),l)}function me(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,C,w,y;function S(e){return!x(e)&&!e._error}return i=e instanceof p.EvaluateContext?e:v,a=i!==m&&i.acceptsReference,t instanceof k?(l={value:-1},s=t,u=s.getRowCount(0),c=s.getColumnCount(0),_=s.getRow(0),f=s.getColumn(0),3===T(arguments)?1!==s.getRangeCount()||1!==u&&1!==c?O:(g=S(n)&&M(n,l)?l.value:0,0!==g||a||i===m||(g=u>0?i.rowOffset:i.columnOffset),g<0?V:u*c<g?O:0===g?s.create([G(_,f,u,c)]):(d=Math.floor((g-1)/c)+_,h=(g-1)%c+f,s.create([G(d,h,1,1)]))):(n=S(n)&&M(n,l)?l.value-1:-1,r=S(r)&&M(r,l)?l.value-1:-1,(o=S(o)&&M(o,l)?l.value-1:0)>=s.getRangeCount()?O:(u=s.getRowCount(o),c=s.getColumnCount(o),C=s.getRow(o),w=s.getColumn(o),-1===n&&!a&&u>1&&i!==m&&(n=i.rowOffset),-1===r&&!a&&c>1&&i!==m&&(r=i.columnOffset),d=n+C,h=r+w,n<-1||r<-1||o<0?V:u<=n||c<=r||s.getRangeCount()<=o?O:-1===n&&-1===r?s.create([G(C,w,u,c)]):-1===n?s.create([G(C,h,u,1)]):-1===r?s.create([G(d,w,1,c)]):s.create([G(d,h,1,1)])))):R._isArray(t)?(y=t,u=y.getRowCount(),n=n!==v?I(n):-1,r=r!==v?I(r):-1,1!==(o=o!==v?I(o)-1:1)?O:(-1===n&&-1===r?n=r=0:-1===r&&1===u&&(r=n,n=1),n=-1===n?0:n,r=-1===r?0:r,u=y.getRowCount(),c=y.getColumnCount(),n<0||r<0||o<0?V:(n>u&&1===u&&r===v&&(r=n,n=0),u<n||c<r?O:0===n&&0===r?y.slice(0,0,u,c):0===n?y.slice(0,r-1,u,1):0===r?y.slice(n-1,0,1,c):y.getValue(n-1,r-1)))):void 0}function ve(e,t,n,r,o){var i,a;return e&&e instanceof k&&1===e.getRangeCount()?(r=r!==v?I(r):e.getRowCount(0),o=o!==v?I(o):e.getColumnCount(0),i=e.getRow(0)+t,a=e.getColumn(0)+n,r<=0||o<=0||i<0||a<0?O:e.create([{row:i,col:a,rowCount:r,colCount:o}])):V}function Ce(e,t,n){var r,o,i,a,l,s,u,c;return e?t?(r=e.row,o=e.column,i=new L,a=p._createCellIdentity(r,o),l=e.source?e.source.getParserContext(!n,a):new p.ParserContext(e.source,!n,a),l.onlyValidateSourceNameWithSpecial=!0,s=i.parse(l,t),s?(8===s.type&&(s.source?(u=s.source,s=u.getCustomName(s.value)):s=e.getName(s.value)),!s||w._inArray(s.type,[1,13])<0?O:(u=s.source||e.source,25===s.type||26===s.type?u.getValueByName(s.nameIdentity):(c=s.getRange(r,o),13===s.type&&(u=s.source()),1!==c.rowCount||1!==c.colCount||e.acceptsReference||e.arrayFormulaMode?u.getReference(c):u.getValue(c.row,c.col)))):O):O:H}function we(e,t){return D(2===arguments.length?t:e)}function ye(){var e,t=0;for(e=0;e<T(arguments);e++){if(0===arguments[e].length)return P;arguments[e].isReference&&(t+=arguments[e].rangeCount)}return t}function Se(e,t){var n=t.getRow(0),r=t.getColumn(0),o=e.source.getCalcSourceModel().getFormula(n,r);return o?"="+o:H}function xe(e,t){var n=t.getRow(0),r=t.getColumn(0);return!!e.source.getCalcSourceModel().getFormula(n,r)}c={_defaultValue:!0,_argType:7},_={_argType:2},f={_defaultValue:1,_argType:2},d={_argType:2,_argCondition:"<= 0",_conditionErrorValue:V},h={_argType:4,_valueType:0,_toOneDimension:!0},z("ADDRESS",pe,2,5,[_,_,f,c,{_defaultValue:"",_argType:5}],v,v,{_acceptsMissingArgument:[2,3,4]}),z("INDEX",me,2,4,v,0,0,{_acceptsMissingArgument:[1,2,3],_isContextSensitive:!0,_arrayArgumentEvaluateMode:3}),z("OFFSET",ve,3,5,[{},_,_],0,0,{_acceptsMissingArgument:[3,4],_isVolatile:!0,_arrayArgumentEvaluateMode:2,returnReference:!0}),z("ROW",ne,0,1,v,-1,v,{_isContextSensitive:!0,_precedentReference:-1,expandColumns:-1}),z("COLUMN",re,0,1,v,-1,v,{_acceptsMissingArgument:0,_isContextSensitive:!0,_precedentReference:-1,expandRows:-1}),z("ROWS",oe,1,1,v,-1,-1,{_precedentReference:-1,expandColumns:-1,_isVolatile:!0}),z("COLUMNS",ie,1,1,v,-1,-1,{_precedentReference:-1,expandRows:-1,_isVolatile:!0}),z("TRANSPOSE",ae,1,1,v,-1,-1),z("LOOKUP",ue,2,3,[h,h],"!= 0","!= 0",{_arrayArgumentEvaluateMode:1}),z("HLOOKUP",le,3,4,[h,h,d,c],1,1,{_acceptsMissingArgument:3}),z("VLOOKUP",se,3,4,[h,h,d,c],1,1,{_acceptsMissingArgument:3}),z("CHOOSE",ce,2,255,_,">= 1",">= 1",{_acceptsError:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(e){var t={value:-1};return A(e)?-1:(M(e,t),t.value)}}),z("MATCH",_e,2,3,[h,h,f],1,1,{_acceptsMissingArgument:2}),z("INDIRECT",Ce,1,2,[{_argType:5},c],v,v,{_acceptsMissingArgument:2,_isVolatile:!0,_isContextSensitive:!0}),z("HYPERLINK",we,1,2),z("AREAS",ye,1,v,{_argType:4,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},-1,-1),z("FORMULATEXT",Se,1,1,v,-1,v,{_isContextSensitive:!0}),z("ISFORMULA",xe,1,1,v,-1,v,{_isContextSensitive:!0}),e.exports=W}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U,Y,G,X,j,K,Z,J,q,Q,$,ee,te,ne=n(3),re=n(1),oe=re.Functions,ie=ne._ArrayHelper._getLength,ae=null,le=void 0,se=isNaN,ue=isFinite,ce=parseInt,_e=Math.pow,fe=Math.max,de=Math.min,he=Math.floor,ge=Math.sin,pe=Math.tan,me=Math.PI,ve=Math.atan,Ce=Math.exp,we=Math.abs,ye=Math.sqrt,Se=Math.log,xe=Math.round,be=re.Errors,Te=be.DivideByZero,Re=be.Value,Ae=be.NotAvailable,Ie=be.Number,Me=be.Null,Ee=re.CalcArray,Fe=re.Convert,De=Fe._toResult,Ne=Fe._toArray,Ve=Fe._toInt,Oe=Fe._toDouble,He=oe._MathHelper,Pe=He._combin,Le=He._parseCriteria,ke=Fe._isNumber,Be=Fe._isError,We=oe._st_includeSubstotals,ze=oe._st_devVarIncludeSubtotals,Ue=oe._st_includeAggregateMulti,Ye=oe._st_normsdist,Ge=oe._isBoolean,Xe=oe._isString,je=oe._isNumber,Ke=oe._MAX_DOUBLE_VALUE,Ze=Fe.CalcConvertedError,Je=oe._defineBuiltInFunction,qe=Fe._tryToDouble,Qe=Fe._tryToInt;function $e(e){var t,n=0;for(t=0;t<e.length;t++)e[t]!==Ze&&n++;return n}function et(e){var t,n,r;return 0===e?n=0:(t=.5*Math.abs(e),t>=3?n=1:t<1?(r=t*t,n=((((((((.000124818987*r-.001075204047)*r+.005198775019)*r-.019198292004)*r+.059054035642)*r-.151968751364)*r+.319152932694)*r-.5319230073)*r+.797884560593)*t*2):(t-=2,n=(((((((((((((-45255659e-12*t+.00015252929)*t-19538132e-12)*t-.000676904986)*t+.001390604284)*t-.00079462082)*t-.002034254874)*t+.006549791214)*t-.010557625006)*t+.011630447319)*t-.009279453341)*t+.005353579108)*t-.002141268741)*t+.000535310849)*t+.999936657524)),e>0?.5*(n+1):.5*(1-n)}function tt(e,t,n){var r,o,i,a,l,s=ie(e);if(t!==e[0]){for(i=0,a=e[0],o=1;o<s&&e[o]<t;o++)e[o]!==a&&(i=o,a=e[o]);e[o]!==a&&(i=o),t===e[o]?r=n?i/(s-1):(o+1)/(s+1):0===i?r=0:(l=(t-e[i-1])/(e[i]-e[i-1]),r=n?(i-1+l)/(s-1):(i+l)/(s+1))}else r=n?0:1/(s+1);return r}function nt(e,t,n,r){var o,i,a=[];return wt(e,a),0===(o=ie(a))||t<a[0]||t>a[o-1]?Ae:(i=1===o?1:tt(a,t,r),0!==i?xe(i*_e(10,n))/_e(10,n):i)}function rt(e,t,n){var r,o,i,a,l,s=300,u=1e-50,c=1e-20,_=e+t,f=e+1,d=e-1,h=1,g=1-_*n/f;for(we(g)<u&&(g=u),g=1/g,i=g,r=1;r<=s&&(o=r+r,a=(t-r)*r*n/((d+o)*(e+o)),g=1+a*g,we(g)<u&&(g=u),h=1+a/h,we(h)<u&&(h=u),g=1/g,i*=g*h,a=0-(e+r)*(_+r)*n/((e+o)*(f+o)),g=1+a*g,we(g)<u&&(g=u),h=1+a/h,we(h)<u&&(h=u),g=1/g,l=g*h,i*=l,!(we(l-1)<c));r++);return i}function ot(e){return[2.2250738585072014e-308,1.7976931348623157e308,_e(2,-53),_e(2,-52),He._log(2,10)][e-1]||0}function it(e,t,n){var r=0,o=0,i;if(t<1)return 0;for(i=1;i<=t;i++)if(r=t-i,(o+=we(Oe(e[r])))>n)return r;return r}function at(e,t,n){var r,o,i,a,l;if(n<1||n>1e3||e<-1.1||e>1.1)return NaN;for(a=2*e,i=o=0,r=0,l=1;l<=n;l++)i=o,o=r,r=a*o-i+Oe(t[n-l]);return.5*(r-i)}function lt(e){var t,n=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1.809129475572494e-11,6.221098041892606e-14,-3.399615005417722e-16,2.683181998482699e-18,-2.868042435334643e-20,3.9628370610464347e-22,-6.831888753985767e-24,1.4292273559424982e-25,-3.5475981581010704e-27,1.025680058010471e-28,-3.401102254316749e-30,1.276642195630063e-31],r=it(n,15,ot(3)),o=1/ye(ot(3)),i=Ce(de(Se(ot(2)/12),-Se(12*ot(1))));return e<10?NaN:e>=i?4.930380657631324e-32:e<o?(t=10/e,at(t*t*2-1,n,r)/e):1/(12*e)}function st(e){var t=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-7.71908941348408e-11,1.407574648135907e-11,-2.5769072058024682e-12,4.734240666629442e-13,-8.724901267474264e-14,1.612461490274055e-14,-2.9875652015665774e-15,5.548070120908289e-16,-1.0324619158271569e-16,1.9250239203049852e-17,-3.595507346526515e-18,6.726454253787686e-19,-1.260262416873522e-19,2.364488440860621e-20,-4.4419377050807936e-21,8.354659446403425e-22,-1.5731559416479563e-22,2.9653128740247425e-23,-5.594958348181595e-24,1.056635426883568e-24,-1.9972483680670205e-25,3.778297781883936e-26,-7.153158688908174e-27,1.3552488463674214e-27,-2.5694673048487566e-28,4.8747756066216946e-29,-9.254211253084972e-30,1.757859784176024e-30,-3.341002667773101e-31,6.353393618023618e-32],n=it(t,43,.1*ot(3));return e<=-1?NaN:we(e)<=.375?e*(1-e*at(e/.375,t,n)):Se(e+1)}function ut(e){var t,n,r,o,i,a,l=1,s=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,7.7823e-12,-3.6968e-12,5.1e-13,-2.06e-14,-5.4e-15,1.4e-15];if(e>171)return 1e308;if(e===Ve(e))if(e>0)for(o=1,t=2;t<e;t++)o*=t;else o=1e308;else{if(we(e)>1){for(a=we(e),r=Ve(a),l=1,n=1;n<=r;n++)l*=a-n;a-=r}else a=e;for(i=s[24],n=23;n>=0;n--)i=i*a+s[n];o=1/(i*a),we(e)>1&&(o*=l,e<0&&(o=-me/(e*o*ge(me*e))))}return o}function ct(e){var t,n,r,o,i,a=0,l=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],s=e;if(e<=0)return 1e308;if(1===e||2===e)return 0;for(e<=7&&(a=Ve(7-e),s=e+a),t=1/(s*s),n=2*me,o=l[9],i=8;i>=0;i--)o=o*t+l[i];if(r=o/s+.5*Se(n)+(s-.5)*Se(s)-s,e<=7)for(i=1;i<=a;i++)r-=Se(s-1),s-=1;return r}function _t(e,t){var n,r,o,i=r=e;return t<i&&(i=t),t>r&&(r=t),i<0?NaN:0===i?Ke:i>=10?(n=lt(i)+lt(r)-lt(i+r),-.5*Se(r)+.9189385332046728+n+(i-.5)*Se(i/(i+r))+r*st(-i/(i+r))):r>=10?(n=lt(r)-lt(i+r),o=pr(i),Be(o)?NaN:Oe(o)+n+i-i*Se(i+r)+(r-.5)*st(-i/(i+r))):Se(ut(i)*(ut(r)/ut(i+r)))}function ft(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h=ot(3),g=Se(h),p=ot(1),m=Se(p),v=e,C=t,w=n;if(C/(C+w)<e&&(v=1-v,C=n,w=t),(C+w)*v/(C+1)<h)r=0,u=C*Se(fe(v,p))-Se(C)-_t(C,w),u>m&&0!==v&&(r=Ce(u)),v===e&&C===t||(r=1-r);else{if(a=w-he(w),0===a&&(a=1),u=C*Se(v)-_t(a,C)-Se(C),r=0,u>=m&&(r=Ce(u),s=r*C,1!==a))for(_=Ve(fe(g/Se(v),4)),f=1;f<=_;f++)c=f,s=s*(c-a)*v/c,r+=s/(C+c);if(w>1){for(u=C*Se(v)+w*Se(1-v)-_t(C,w)-Se(w),d=Ve(fe(u/m,0)),s=Ce(u-d*m),o=1/(1-v),l=w*o/(C+w-1),i=0,_=Ve(w),w===_&&(_-=1),f=1;f<=_&&!(l<=1&&s/h<=i);f++)c=f,s=(w-c+1)*o*s/(C+w-c),s>1&&(d-=1,s*=p),0===d&&(i+=s);r+=i}v===e&&C===t||(r=1-r),r=fe(de(r,1),0)}return r}function dt(e){var t,n;return e=.7071067811865475*-e,t=Oe(e),se(t)?Re:(n=Ye(t*ye(2)),Be(n)?NaN:.5*(2-2*parseFloat(n)))}function ht(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m;function v(e,t){return e<0&&t>0||e>0&&t<0}for(o=1e-307,i=2.22045e-16,a=e._getValue(t),l=e._getValue(n),u=0;u<1e3&&!v(a,l);u++)we(a)<=we(l)?(s=t,t+=2*(t-n),t<0&&(t=0),n=s,l=a,a=e._getValue(t)):(s=n,n+=2*(n-t),t=s,a=l,l=e._getValue(n));if(0===a)return t;if(0===l)return n;if(!v(a,l))return r._bConvError=!0,0;for(c=t,_=a,f=n,d=l,h=t,g=a,p=.5*(t+n),m=!0,u=0;u<500&&we(g)>o&&n-t>fe(we(t),we(n))*i;)m&&(_!==d&&d!==g&&g!==_?(p=c*g*d/(g-_)/(d-_)+h*d*_/(d-g)/(_-g)+f*_*g/(_-d)/(g-d),m=t<p&&p<n):m=!1),m||(p=.5*(t+n),f=n,d=l,m=!0),c=f,f=h,h=p,_=d,d=g,g=e._getValue(p),v(a,g)?(n=h,l=g):(t=h,a=g),m=m&&2*we(g)<=we(d),++u;return h}function gt(e,t){var n,r,o,i,a=ie(t);for(n=0;n<a;n++)r=Oe(t[n]),o=r-e.M,i=o/(e.N+1),e.M+=i,e.Q+=e.N*o*i,e.N++,e._sum+=r}function pt(e){var t,n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],r=1.000000000190015,o=e,i=e+5.5;for(i-=(e+.5)*Se(i),t=0;t<=5;t++)r+=n[t]/++o;return-i+Se(2.5066282746310007*r/e)}function mt(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,p,m=0===n||1===n?0:Ce(pt(e+t)-pt(e)-pt(t)+e*Se(n)+t*Se(1-n)),v=n>=(e+1)/(e+t+2);for(v&&(r=e,e=t,t=r,n=1-n),o=4.450147717014403e-308,i=100,a=e+t,l=e+1,s=e-1,u=1,c=1-a*n/l,we(c)<o&&(c=o),c=1/c,_=c,f=1,d=2;f<=i;f++,d+=2)if(h=f*(t-f)*n/((s+d)*(e+d)),c=1+h*c,we(c)<o&&(c=o),u=1+h/u,we(u)<o&&(u=o),c=1/c,_*=c*u,h=-(e+f)*(a+f)*n/((e+d)*(l+d)),c=1+h*c,we(c)<o&&(c=o),u=1+h/u,we(u)<o&&(u=o),c=1/c,g=c*u,_*=g,we(Oe(g-1))<5e-324)return p=m*_/e,v?1-p:p;return Ie}function vt(e,t){var n,r,o,i,a=ie(t);for(i=0;i<a;i++)(n=t[i])!==Ze&&(r=n-e.M,o=r/(e.N+1),e.M+=o,e.Q+=e.N*r*o,e.N++,e._sum+=n)}function Ct(e){e.sort(function(e,t){return e-t})}function wt(e,t){var n,r;for(n=0;n<ie(e);n++)(r=e[n])!==Ze&&t.push(r);Ct(t)}function yt(e){var t=[],n;for(n=0;n<ie(e);n++){if(!e[n].length)return e;wt(e[n],t)}return t}function St(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h=Math.expm1||function(e){return Ce(e)-1},g=Math.log1p||function(e){return Se(1+e)};return e<=0?0:e>=1?1:1===n?_e(e,t):1===t?-h(n*g(-e)):(o=.5-e+.5,i=g(-e),a=e,l=Se(e),s=t,u=n,c=e>t/(t+n),c&&(s=n,u=t,a=o,o=e,l=i,i=Se(e)),r=xt(a,s,u),r/=s,_=s/(s+u),f=u/(s+u),d=s>1&&u>1&&_<.97&&f<.97?bt(a,s,u)*a*o:Ce(s*l+u*i-Tt(!1,s,u)),r*=d,c&&(r=.5-r+.5),r>1&&(r=1),r<0&&(r=0),r)}function xt(e,t,n){var r,o,i,a,l,s,u,c,_,f,d=2.22045e-16,h=1,g=1,p=1-(t+n)/(t+1)*e;0===p?(r=0,o=1,u=1):(r=1,o=1/p,u=r*o),s=1,c=1,_=5e4,f=!1;do{i=t+2*c,a=c*(n-c)*e/((i-1)*i),l=-(t+c)*(t+n+c)*e/(i*(i+1)),h=(r+a*h)*o,g=(p+a*g)*o,r=h+l*r*o,p=g+l*p*o,0!==p&&(o=1/p,s=r*o,f=we(u-s)<we(u)*d),u=s,c+=1}while(c<_&&!f);return u}function bt(e,t,n){var r,o,i,a,l,s,u;return 1===t?1===n?1:2===n?-2*e+2:e<=.01?n+n*Ce((n-1)*Se(1-e))-1:n*_e(.5-e+.5,n-1):1===n?2===t?t*e:t*_e(e,t-1):e<=0&&!(t<1&&0===e)||e>=1&&!(n<1&&1===e)?0:(r=Se(ot(2)),o=Se(ot(1)),i=Se(e<.1?1+e:1-e),a=Se(e),l=(t-1)*a,s=(n-1)*i,u=Tt(!1,t,n),l<r&&l>o&&s<r&&s>o&&u<r&&u>o&&l+s<r&&l+s>o?_e(e,t-1)*_e(.5-e+.5,n-1)/Tt(!0,t,n):Ce(l+s-u))}function Tt(e,t,n){var r,o,i,a,l,s,u,c,_,f=n,d=t;return t>n&&(r=f,f=d,d=r),e&&f+d<171.624376956302?At(f)/At(f+d)*At(d):(o=6.02468004077673,i=o-.5,a=Mt(f),a/=Mt(f+d),a*=Mt(d),l=f+d+i,s=e?a*ye(l/(f+i)/(d+i)):Se(a)+.5*(Se(l)-Se(f+i)-Se(d+i)),u=d/(f+i),c=f/(d+i),_=-f*Se(1+u)-d*Se(1+c)-i,e?Ce(_)*s:_+s)}function Rt(e){var t=Mt(e),n=6.02468004077673,r=e+n-.5,o=_e(r,e/2-.25);return t*=o,t/=Ce(r),t*=o,e<=20&&e===He._approxFloor(e)&&(t=xe(t)),t}function At(e){var t,n,r=Se(me),o=Se(ot(2));return e>171.624376956302?Ie:e>=1?Rt(e):e>=.5?Rt(e+1)/e:e>=-.5?(t=Rt(e+2)-Se(e+1)-Se(we(e)),t>=o?Ie:Rt(e+2)/(e+1)/e):(n=Rt(1-e)+Se(we(ge(me*e))),n-r>=o?0:n<0&&r-n>o?Ie:Ce(r-n)*(ge(me*e)<0?-1:1))}function It(e){var t=171.624376956302;return e>=171.624376956302?Rt(e):e>=1?Se(Rt(e)):e>=.5?Se(Rt(e+1)/e):Rt(e+2)-Se(e+1)-Se(e)}function Mt(e){var t,n,r,o,i=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],a=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(e<=1)for(t=i[12],n=a[12],r=11;r>=0;--r)t*=e,t+=i[r],n*=e,n+=a[r];else for(o=1/e,t=i[0],n=a[0],r=1;r<=12;++r)t*=o,t+=i[r],n*=o,n+=a[r];return t/n}function Et(e,t){return e<=0?0:Ft(t/2,e/2)}function Ft(e,t){var n=e*Se(t)-t-It(e),r=Ce(n);return t>e+1?1-r*Nt(e,t):r*Dt(e,t)}function Dt(e,t){var n=.5*ot(3),r=e,o=1/e,i=o,a=1;do{r+=1,o=o*t/r,i+=o,a+=1}while(o/i>n&&a<=1e4);return a>1e4?Re:i}function Nt(e,t){var n=ot(3),r=.5*n,o=1/n,i=0,a=0,l=1-e,s=t+2-e,u=0,c=t+1,_=1,f=1,d=s*t,h=t,g=c/d,p=!1,m=0;do{i+=1,l+=1,a=l*i,s+=2,u=c*s-_*a,f=d*s-h*a,0!==f&&(m=u/f,p=we((g-m)/m)<=r,g=m),_=c,c=u,h=d,d=f,we(u)>o&&(_*=n,c*=n,h*=n,d*=n)}while(!p&&i<1e4);return p?g:Re}function Vt(e,t){var n,r;if(e<=0)return 0;if(t*e>1391e3)n=Ce((.5*t-1)*Se(.5*e)-.5*e-Se(2)-It(.5*t));else{for(t%2<.5?(n=.5,r=2):(n=1/ye(2*e*me),r=1);r<t;)n*=e/r,r+=2;n=e>=1425?Ce(Se(n)-e/2):n*Ce(-e/2)}return n}function Ot(e,t,n,r){var o,i,a,l=Pe(n,e);return Be(l)?l:(o=Oe(l),l=Pe(r-n,t-e),Be(l)?l:(i=Oe(l),l=Pe(r,t),Be(l)?l:(a=Oe(l),De(o*i/a))))}function Ht(e,t,n){var r,o,i=St(t/(t+e*e),t/2,.5);switch(n){case 1:return.5*i;case 2:return i;case 3:return _e(1+e*e/t,-(t+1)/2)/(ye(t)*Tt(!0,.5,t/2));case 4:return r=t/(e*e+t),o=.5*St(r,.5*t,.5),e<0?o:1-o}return Re}function Pt(e,t,n){return{_getValue:function(r){return e-Ht(r,t,n)}}}function Lt(e,t,n){var r={_bConvError:!1},o=Pt(e,t,n),i=ht(o,.5*t,t,r);return r._bConvError?Ae:i}function kt(e,t){var n=!1,r=0,o,i,a,l,s;for(i=0;i<ie(t);i++)for(s=t[i],a=0;a<ie(s);a++)if(l=s[a],ke(l)||Ge(l)||Xe(l))o=Xe(l)?0:Oe(l),(!n||e&&o>r||!e&&o<r)&&(r=o),n=!0;else if(Be(l))return l;return r}function Bt(e,t,n,r){var o,i,a,l=0,s=0,u=0;for(o=0;o<ie(t);o++)(i=t[o])!==Ze&&(i<n?l++:n<i?u++:s++);return 0===s?Ae:(a=(0===r?u:l)+1,e?a:a+(s-1)/2)}function Wt(e,t){var n,r,o,i,a,l;for(i=0;i<ie(e);i++)for(n=e[i],a=0;a<ie(n);a++)if((o=n[a])===ae)t.n++;else if(Xe(o)){if(l={value:0},Fe._tryToDouble(o,l))r=l.value,t._sumx+=r,t._sumx2+=r*r;else if(!n.isArray&&!n.isReference)return Re;t.n++}else{if(Be(o))return o;ke(o)&&(r=Oe(o),t._sumx+=r,t._sumx2+=r*r,t.n++)}}function zt(e,t,n){var r,o={_sumx:0,_sumx2:0,n:0},i=Wt(e,o);return Be(i)?i:o.n<=t?Te:(r=fe(0,(o.n*o._sumx2-o._sumx*o._sumx)/(o.n*(o.n-t))),r=n?ye(r):r,De(r))}function Ut(e,t,n){var r,o,i,a,l,s=0,u=0,c=0,_=0,f=ie(t);if(f!==ie(n))return Ae;for(i=0;i<f;i++)r=t[i],o=n[i],r!==Ze&&o!==Ze&&(s+=r,u+=o,_++);if(_<=1)return Te;for(a=s/_,l=u/_,i=0;i<f;i++)r=t[i],o=n[i],r!==Ze&&o!==Ze&&(c+=(r-a)*(o-l));return De(e?c/_:c/(_-1))}function Yt(e,t){var n,r,o,i,a=e?1:0,l=0;for(o=0;o<ie(t);o++)for(n=t[o],i=0;i<ie(n);i++)if((r=n[i])!==Ze){if(r<=0)return Ie;a=e?a*r:a+1/r,l++}return e?l<=0?Te:De(_e(a,1/l)):0===a?Te:De(l/a)}function Gt(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B=t.rowCount,W=t.colCount;if(e?n=n!==le?Ne(n,1,!1,!0,!0):t:(i=n!==le?n:function(e,t){var n=[];for(a=0;a<e;a++)for(n[a]=[],l=0;l<t;l++)n[a][l]=a*t+l+1;return new Ee(n)}(B,W),n=Ne(i,1,!1,!0,!0)),s=n.rowCount,u=n.colCount,B===s&&W===u&&(r||!o)){for(f=e?s*u:Oe(s*u),S=0,x=0,b=0,T=0,R=0,a=0;a<s;a++)for(l=0;l<u;l++)d=n[a][l],h=t[a][l],e&&(h=Se(h)),S+=d,x+=d*d,b+=h,T+=h*h,R+=d*h;return C=f*x-S*S,_=r?(f*R-S*b)/C:R/x,A=r?(b*x-S*R)/C:0,e&&(_=Ce(_),A=Ce(A)),m=[[_,A]],o&&(m[1]=[],m[2]=[],m[3]=[],m[4]=[],I=f*x-S*S,M=f*T-b*b,E=f*R-S*b,F=T-A*b-_*R,D=E*E/(I*M),f<3?(m[1][0]=Ie,m[1][1]=Ie,m[2][1]=Ie,m[3][0]=Ie):(m[1][0]=ye(F*f/(I*(f-2))),m[1][1]=ye(F*x/(I*(f-2))),m[2][1]=ye((M-E*E/I)/(f*(f-2))),m[3][0]=1===D?Ie:D*(f-2)/(1-D)),m[2][0]=D,m[3][1]=f-2,m[4][0]=M/f-F,m[4][1]=F),new Ee(m)}if(1===W&&B===s||1===B&&W===u){for(h=[],d=[],C=1===W,f=s,_=u,a=0;a<f;a++)h[a]=r?t[a][0]:t[0][a],e&&(h[a]=Se(h[a]));for(a=0;a<f;a++)for(d[a]=[],l=0;l<_;l++)d[a][l]=C?n[a][l]:n[l][a];for(N=[],c=0;c<_+1;c++)N[c]=[];for(g=0;g<_+1;g++)for(p=0;p<_+2;p++)N[g][p]=0;for(V=[],g=0;g<_+2;g++)V[g]=0;for(O=o?[]:ae,c=0;c<f;c++)for(V[_+1]+=h[c]*h[c],N[0][_+1]+=h[c],V[0]=N[0][_+1],a=0;a<_;a++)for(N[0][a+1]+=d[c][a],N[a+1][0]=N[0][a+1],N[a+1][_+1]+=d[c][a]*h[c],V[a+1]=N[a+1][_+1],l=a;l<_;l++)N[l+1][a+1]+=d[c][a]*d[c][l],N[a+1][l+1]=N[l+1][a+1];if(N[0][0]=f,o){for(g=0;g<_+1;g++)for(O[g]=[],p=0;p<_+1;p++)O[g][p]=0;for(a=0;a<_+1;a++)O[a][a]=1}for(H=r?0:1,a=0;a<_+1;a++){if(0===N[a][a]){for(v=!1,l=a+1;!v&&l<_+1;l++)if(0!==N[l][a]){for(c=0;c<_+2;c++)C=N[a][c],N[a][c]=N[l][c],N[l][c]=C;if(o)for(c=0;c<_+1;c++)C=O[a][c],O[a][c]=O[l][c],O[l][c]=C;v=!0}if(!v)return Ie}for(w=1/N[a][a],c=H;c<_+2;c++)N[a][c]*=w;if(o)for(c=H;c<_+1;c++)O[a][c]*=w;for(l=H;l<_+1;l++)if(l!==a){for(w=-N[l][a],c=H;c<_+2;c++)N[l][c]+=w*N[a][c];if(o)for(c=H;c<_+1;c++)O[l][c]+=w*O[a][c]}r||(N[0][_+1]=0)}for(m=e?[[],_+1]:[[]],a=0;a<_+1;a++)m[0][a]=e?Ce(N[_-a][_+1]):N[_-a][_+1];if(o){if(e)m[1]=[],m[2]=[],m[3]=[],m[4]=[];else for(g=1;g<5;g++)for(m[g]=[],p=0;p<_+1;p++)m[g][p]=0;for(L=V[_+1]-V[0]*V[0]/f,P=V[_+1],a=0;a<_+1;a++)P-=N[a][_+1]*V[a];if(k=L-P,m[2][0]=0===L?Ie:k/L,m[4][0]=k,m[4][1]=P,0===(C=r?f-_-1:f-_)){for(a=0;a<_+1;a++)m[1][a]=Ie;m[2][1]=Ie}else{for(y=P/Oe(C),r||(m[1][_]=Ae),a=H;a<_+1;a++)m[1][_-a]=ye(y*O[a][a]);m[2][1]=ye(y)}for(m[3][0]=0===P?Ie:Oe(C)*k/(P*Oe(_)),m[3][1]=Oe(C),a=2;a<5;a++)for(l=2;l<_+1;l++)m[a][l]=Ae}return e||(m=[m[0]]),new Ee(m)}return Ie}function Xt(e,t){var n,r,o,i,a,l=0,s=0,u=0,c=[];for(o=0;o<ie(t);o++)for(a=t[o],c.push(a),i=0;i<ie(a);i++)(n=a[i])!==Ze&&(l+=n,u++);for(r=l/u,o=0;o<ie(t);o++)for(a=c[o],i=0;i<ie(a);i++)(n=a[i])!==Ze&&(s+=e?(n-r)*(n-r):we(n-r));return e?De(s):0===u?Te:De(s/u)}function jt(e,t,n,r){t=t!==le?Ne(t,0,!1,!0,!1):e,n=n!==le?Ne(n,0,!1,!0,!1):t;var o,i;for(o=0;o<e.rowCount;o++)for(i=0;i<e.colCount;i++)if(!ke(e[o][i]))return Re;for(o=0;o<t.rowCount;o++)for(i=0;i<t.colCount;i++)if(!ke(t[o][i]))return Re;for(o=0;o<n.rowCount;o++)for(i=0;i<n.colCount;i++)if(!ke(n[o][i]))return Re;return ne._trend(e,t,n,r,Oe,Ee,Re,Ae)}function Kt(e,t,n,r){return t=t!==le?Ne(t,1,!1,!0,!0):e,n=n!==le?Ne(n,1,!1,!0,!0):t,ne._growth(e,t,n,r,Ee,Ie,Ae)}function Zt(e,t,n){var r,o,i,a,l,s=0,u=0,c=0,_=0,f=ie(t),d=0;if(f!==ie(n))return Ae;for(r=0;r<f;r++)o=t[r],i=n[r],o!==Ze&&i!==Ze&&(s+=o,u+=i,c+=i*i,_+=i*o,d++);return 0===d?Te:d*c-u*u==0?Te:(a=(d*_-u*s)/(d*c-u*u),l=s/d-a*(u/d),De(l+a*e))}function Jt(){return We(arguments,!0,1)}function qt(){return ze(arguments,!0,7)}function Qt(e,t){return Ue([e,t],16)}function $t(){return We(arguments,!0,4)}function en(){return kt(!0,arguments)}function tn(){return We(arguments,!0,5)}function nn(){return kt(!1,arguments)}function rn(e,t){return Ue([e,t],14)}function on(e,t){return Ue([e,t],15)}function an(){var e,t,n,r,o=arguments,i=0,a=0;for(e=0;e<ie(o);e++)for(r=o[e],t=0;t<ie(r);t++)n=r[t],ke(n)||Ge(n)?(i+=Oe(n),a++):(n===ae||Xe(n))&&a++;return 0===a?Te:De(i/a)}function ln(e,t,n){var r,o,i,a=0,l=0,s=Le(t);if(e.rowCount!==n.rowCount||e.colCount!==n.colCount)return Re;for(r=0;r<ie(e);r++)o=e[r],s&&s(o)&&(i=n[r])!==Ze&&(a+=i,l++);return 0===l?Te:De(a/l)}function sn(e,t,n,r){var o,i,a,l=e?t.rowCount:t.getRowCount(0),s=e?t.colCount:t.getColumnCount(0),u=[];for(o=0;o<l;o++)for(u[o]=[],i=0;i<s;i++)a=e?t.getValue(o,i):t.getValue(0,o,i),u[o][i]=ln(n,a,r);return new Ee(u)}function un(e,t,n){if(n!==le){if(e=Ne(e,0,!0,!1,!1),n=Ne(n,1,!0,!0,!1),n.isError)return n[0]}else{if(e=Ne(e,1,!0,!0,!1),e.isError)return e[0];n=e}return Fe._isReference(t)?sn(!1,t,e,n):Fe._isArray(t)?sn(!0,t,e,n):ln(e,t,n)}function cn(e){var t,n,r,o,i,a,l,s=arguments,u=0,c=0,_=e.length,f=s.length,d=[];for(d.push(e),r=1;r<f;r+=2){if(o=Ne(s[r],0,!0,!1,!1),o.isError)return o[0];d.push(o),i=s[r+1],a=Le(i),d.push(a)}for(n=0;n<_;n++)if((t=e[n])!==Ze){for(l=!0,r=1;r<f&&(a=d[r+1],l=a(d[r][n]));r+=2);l&&(u+=t,c++)}return 0===c?Te:De(u/c)}function _n(){return Ue(arguments,12)}function fn(){return Ue(arguments,13)}function dn(){return Yt(!0,arguments)}function hn(){return Yt(!1,arguments)}function gn(e,t){var n,r,o,i=0,a=[];for(wt(e,a),n=$e(a),r=ce(""+n*t/2),o=r;o<n-r;o++)i+=Oe(a[o]);return i/(n-2*r)}function pn(e,t){var n,r,o,i,a,l,s,u,c,_,f,d,h=0,g=t.rowCount,p=t.colCount;for(n=0;n<g;n++)for(r=0;r<p;r++)t[n][r]!==Ze&&h++;for(i=e.rowCount,a=e.colCount,l=[],s=[],u=h+1,h=0,n=0;n<g;n++)for(r=0;r<p;r++)(o=t[n][r])!==Ze&&(l[h++]=Oe(o));for(c=l.slice(0),Ct(l),n=0;n<u;n++)s[n]=[0];for(n=0;n<i;n++)for(r=0;r<a;r++)if(o=e[n][r],ke(o)){for(_=Oe(o),f=!1,d=0;!f&&d<h;d++)_<=l[d]&&(s[c.indexOf(l[d])][0]++,f=!0);f||s[h][0]++}return new Ee(s)}function mn(e,t,n){var r=re.CalcArrayHelper;if(Fe._isReference(e)){if(1!==r.getLength(e))return Re;e=r.getValueByIndex(e,0)}return e=Oe(e),se(e)?Re:Bt(!0,t,e,n)}function vn(){var e,t,n,r,o,i,a=arguments,l=0,s=0,u=0,c=0,_=ie(a),f=[];if(_>0){for(i=a[0],f.push(i),r=0;r<ie(i);r++)(e=i[r])!==Ze&&(l+=e,s+=e*e,c++);if(c<=3)return Te;if(t=l/c,0===(n=ye((c*s-l*l)/(c*(c-1)))))return Te;for(o=0;o<_;o++)for(i=f[o],r=0;r<ie(i);r++)(e=i[r])!==Ze&&(u+=_e((e-t)/n,4));return De(c*(c+1)*u/((c-1)*(c-2)*(c-3))-3*(c-1)*(c-1)/((c-2)*(c-3)))}}function Cn(e,t,n){return nt(e,t,n,!0)}function wn(e,t,n){return nt(e,t,n,!1)}function yn(e,t){return Ue([e,t],17)}function Sn(){return We(arguments,!0,2)}function xn(){return We(arguments,!0,3)}function bn(e){var t,n=0;for(t=0;t<ie(e);t++)e[t]===ae&&n++;return n}function Tn(e,t){var n,r,o=0,i=0===t||"*"===t,a=Le(t);for(n=0;n<ie(e);n++)r=e[n],i&&r===ae||!a||!a(r)||o++;return De(o)}function Rn(e,t){var n=0,r,o,i;if(t.isArray||t.isReference){for(i=0;i<ie(t);i++){if(o=Tn(e,t[i]),Be(o))return o;if(r=Oe(o),se(r))return Re;n+=r}return n}return Tn(e,t[0])}function An(e){var t,n,r,o,i,a=arguments,l=0,s=ie(e),u=ie(a),c=[];for(r=0;r<u;r+=2){if(t=0===r?e:Ne(a[r],0,!0,!1,!1),t.isError)return t[0];s=t.length,c.push(t),o=Le(a[r+1]),c.push(o)}for(n=0;n<s;n++){for(i=!0,r=0;r<u&&(o=c[r+1],i=o&&o(c[r][n]));r+=2);i&&l++}return De(l)}function In(){return Xt(!1,arguments)}function Mn(){return zt(arguments,1,!0)}function En(){return ze(arguments,!0,8)}function Fn(){return zt(arguments,0,!0)}function Dn(){return ze(arguments,!0,10)}function Nn(){return zt(arguments,1,!1)}function Vn(){return ze(arguments,!0,11)}function On(){return zt(arguments,0,!1)}function Hn(e,t){return Ut(!0,e,t)}function Pn(){return Xt(!0,arguments)}function Ln(e,t,n){var r=br(e/2);return Be(r)?r:-Oe(r)*(t/ye(n))}function kn(e,t,n){return 1===n?Te:t*Lt(e,n-1,2)/ye(n)}function Bn(e,t){var n,r,o,i,a=0,l=0,s=0,u=0,c=0,_=ie(e);if(_!==ie(t))return Ae;for(i=0;i<_;i++)n=e[i],(r=t[i])!==Ze&&n!==Ze&&(a+=n,l+=r,s+=r*r,u+=r*n,c++);return 0===c?Te:c*s-l*l==0?Te:(o=(c*u-l*a)/(c*s-l*l),De(a/c-o*(l/c)))}function Wn(e,t,n,r){return Gt(!1,e,t,n,r)}function zn(e,t){var n,r,o,i,a,l=0,s=0,u=0,c=0,_=0,f=ie(t);if(f!==ie(e))return Ae;for(n=0;n<f;n++)r=e[n],(o=t[n])===Ze||r===Ze||Be(o)||Be(r)||(i=Oe(r),a=Oe(o),l+=i,s+=a,u+=a*a,c+=a*i,_++);return _*u-s*s==0?Te:De((_*c-s*l)/(_*u-s*s))}function Un(e,t,n,r){return Gt(!0,e,t,n,r)}function Yn(e,t){var n,r,o,i,a,l=0,s=0,u=0,c=0,_=0,f=0,d=ie(e);if(d!==ie(t))return Ae;for(o=0;o<d;o++)i=e[o],a=t[o],i!==Ze&&a!==Ze&&(r=i,n=a,l+=r,s+=r*r,u+=n,c+=n*n,
_+=n*r,f++);return f*(f-2)==0||f*c-u*u==0?Te:ye((f*s-l*l-(f*_-u*l)*(f*_-u*l)/(f*c-u*u))/(f*(f-2)))}function Gn(e){var t,n=e,r=n+5.5;return r-=(n+.5)*Se(r),t=1.000000000190015+76.18009172947146/(e+1),t-=86.50532032941678/(e+2),t+=24.01409824083091/(e+3),t-=1.231739572450155/(e+4),t+=.001208650973866179/(e+5),t-=5395239384953e-18/(e+6),Se(2.506628274631001*t/n)-r}function Xn(e,t,n,r,o){var i,a,l,s,u,c,_,f,d;return e<r||o<e||r===o?Ie:(i=(e-r)/(o-r),a=Gn(t+n),l=Gn(t),s=Gn(n),u=Se(i),c=Se(1-i),_=Ce(a-l-s+t*u+n*c),f=_*rt(n,t,1-i)/n,d=i<(t+1)/(t+n+2)?f:1-f,De(d))}function jn(e,t,n,r,o,i){if(e<o||i<e||o===i)return Ie;var a=(e-o)/(i-o);return r?St(a,t,n):bt(a,t,n)/(i-o)}function Kn(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b=2.30753,T=.27061,R=.99229,A=.04481,I=3e-308,M=1e-300,E=I,F=1-2.22e-16,D=5,N=6,V=2,O=_t(t,n);for(e<=.5?(s=e,f=t,h=n,i=0):(s=1-e,f=n,h=t,i=1),g=ye(-Se(s*s)),w=g-(b+T*g)/(1+(R+A*g)*g),f>1&&h>1?(g=(w*w-3)/6,p=1/(f+f-1),m=1/(h+h-1),_=2/(p+m),C=w*ye(_+g)/_-(m-p)*(g+D/N-V/(3*_)),x=f/(f+h*Ce(C+C))):(g=h+h,m=1/(9*h),m=g*_e(1-m+w*ye(m),3),m<=0?x=1-Ce((Se((1-s)*h)+O)/h):(m=(4*f+g-V)/m,x=m<=1?Ce((Se(s*f)+O)/f):1-V/(m+1))),g=1-f,m=1-h,y=0,u=1,x<E?x=E:x>F&&(x=F),S=fe(M,_e(10,-13-2.5/(f*f)-.5/(s*s))),v=d=0,a=0;a<1e3;a++){for(w=ft(x,f,h),w=(w-s)*Ce(O+g*Se(x)+m*Se(1-x)),w*y<=0&&(d=fe(we(u),I)),c=1,l=0;l<1e3;l++){if(u=c*w,we(u)<d&&(v=x-u)>=0&&v<=1){if(d<=S)return 0!==i&&(x=1-x),De((o-r)*x+r);if(we(w)<=S)return 0!==i&&(x=1-x),De((o-r)*x+r);if(0!==v&&1!==v)break}c/=3}if(v===x)return 0!==i&&(x=1-x),De((o-r)*x+r);x=v,y=w}return 0!==i&&(x=1-x),De((o-r)*x+r)}function Zn(e,t,n,r){var o,i,a,l;if(t<e)return Ie;if(!r){if(o=1-n,0===(i=_e(o,t))){if(0===(i=_e(n,t)))return Ie;for(a=0;a<t-e&&i>0;a++)i*=Oe(t-a)/Oe((a+1)*o/n);return i}for(a=0;a<e&&i>0;a++)i*=Oe(t-a)/Oe((a+1)*n/o);return i}if(t===e)return 1;if(o=1-n,0===(i=_e(o,t))){if(0===(i=_e(n,t)))return Ie;for(l=1-i,a=0;a<t-e&&i>0;a++)i*=Oe(t-a)/Oe((a+1)*o/n),l-=i;return l<0?0:l}for(l=i,a=0;a<e&&i>0;a++)i*=Oe(t-a)/Oe((a+1)*n/o),l+=i;return l}function Jn(e,t,n){if(e+t-1<=0)return Ie;var r=Pe(e+t-1,t-1);return Be(r)?r:De(Oe(r)*_e(n,t)*_e(1-n,e))}function qn(e,t,n,r){if(e+t-1<=0)return Ie;if(r)return 1-St(1-n,e+1,t);var o=_e(n,t),i;for(i=0;i<e;i++)o*=(i+t)/(i+1)*(1-n);return o}function Qn(e,t,n){var r,o,i=1-t,a=_e(i,e);if(0===a){if(0===(a=_e(t,e)))return Ie;for(r=1-a,o=0;o<e&&r>=n;o++)a*=Oe(e-o)/Oe((o+1)*i/t),r-=a;return Oe(e-o)}for(r=a,o=0;o<e&&r<n;o++)a*=Oe(e-o)/Oe((o+1)*t/i),r+=a;return Oe(o)}function $n(e,t){var n,r,o,i,a,l,s=Se(ye(me)),u=1/ye(me),c=0,_=e,f=.5*_,d=t%2==0;if(t>1&&(c=Ce(-f)),a=Ye(-ye(_)),Be(a))return a;if(l=Oe(a),r=d?c:2*l,t>2){if(_=.5*(t-1),o=d?1:.5,f>20){for(n=d?0:s,i=Se(f);o<=_;)n=Se(o)+n,r+=Ce(i*o-f-n),o+=1;return r}for(n=d?1:u/ye(f),i=0;o<=_;)n*=f/o,i+=n,o+=1;return i*c+r}return r}function er(e,t,n){return n?Et(e,t):Vt(e,t)}function tr(e,t){var n=gr(1-e,.5*t,2);return Oe(n)}function nr(e,t){return{_getValue:function(n){return e-Et(n,t)}}}function rr(e,t){var n=nr(e,t),r={bConvError:!1},o=ht(n,.5*t,t,r);return r._bConvError?Ae:o}function or(e,t){var n,r,o,i,a=0,l=e.rowCount,s=e.colCount;if(l!==t.rowCount||s!==t.colCount)return Ae;if(l>1&&s>1)n=(l-1)*(s-1);else if(l>1&&1===s)n=l-1;else{if(!(1===l&&s>1))return Ae;n=s-1}for(r=0;r<ie(e);r++)if(o=e[r],i=t[r],o!==Ze&&i!==Ze){if(0===i)return Te;a+=(o-i)*(o-i)/i}return $n(a,n)}function ir(e,t){var n,r,o,i,a,l,s,u,c=0,_=0,f=0,d=0,h=0,g=ie(t);if(g!==ie(e))return Ae;for(a=0,l=0;l<g;l++)s=e[l],u=t[l],s!==Ze&&u!==Ze&&(c+=s,_+=u,f+=s*s,d+=u*u,a++);if(a<=1)return Te;if(n=c/a,r=_/a,o=ye((a*f-c*c)/(a*(a-1))),i=ye((a*d-_*_)/(a*(a-1))),0===o||0===i)return Te;for(l=0;l<g;l++)s=e[l],u=t[l],s!==Ze&&u!==Ze&&(h+=(s-n)*(u-r));return De(h/Oe((a-1)*o*i))}function ar(e,t,n){var r=Ce(-t*e);return De(n?1-r:t*r)}function lr(e,t,n){var r=t*e/(t*e+n),o=.5*t,i=.5*n,a=Xn(r,o,i,0,1);return Be(a)?a:1-Oe(a)}function sr(e,t,n,r){if(r){return 1-St(n/(n+t*e),n/2,t/2)}return _e(t/n,t/2)*_e(e,t/2-1)/(_e(1+e*t/n,(t+n)/2)*Tt(!0,t/2,n/2))}function ur(e,t,n){var r=1-e,o=Kn(1-r,n/2,t/2,0,1);return Be(o)?o:(1/Oe(o)-1)*(n/t)}function cr(e,t,n){var r=1-e,o=Kn(r,n/2,t/2,0,1);return Be(o)?o:(1/Oe(o)-1)*(n/t)}function _r(e){return Se((1+e)/(1-e))/2}function fr(e){var t=Ce(2*e)-1,n=Ce(2*e)+1;return!ue(t)&&t>0&&!ue(n)&&n>0?1:t/n}function dr(e,t){var n,r,o,i,a,l,s={N:0,M:0,Q:0,_sum:0};return vt(s,e),i=s.N-1,1===s.N?Te:0===(n=s.Q/(s.N-1))?Te:(s.N=0,s.M=0,s.Q=0,s._sum=0,vt(s,t),a=s.N-1,1===s.N?Te:0===(r=s.Q/(s.N-1))?Te:(l=lr(n/r,i,a),Be(l)?l:(o=2*(1-Oe(l)),o>1&&(o=2-o),o)))}function hr(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A;if(!1===r)return o=_e(n,t),se(o)||!ue(o)?Te:(i=1/(o*ut(t)),a=_e(e,t-1),l=Ce(-e/n),s=a*l,i*s);if(x=1/3,b=1e8,T=1e37,R=1e3,A=-88,(e/=n)<=0)return Ie;if(t>R)return u=3*ye(t)*(_e(e/t,x)+1/(9*t)-1),S=Sr(u,0,1,!0),Be(S)?S:Oe(S);if(e>b)return 1;if(e<=1||e<t){if(S=pr(t+1),Be(S))return S;g=t*Se(e)-e-Oe(S),p=1,y=1,v=t;do{v+=1,p=p*e/v,y+=p}while(p>2.220446049250313e-16);g+=Se(y),y=0,g>=A&&(y=Ce(g))}else{if(S=pr(t),Be(S))return S;for(g=t*Se(e)-e-Oe(S),v=1-t,C=v+e+1,p=0,u=1,c=e,_=e+1,f=e*C,y=_/f;;){if(v+=1,C+=2,p+=1,w=v*p,d=C*_-w*u,h=C*f-w*c,we(h)>0){if(m=d/h,we(y-m)<=de(2.220446049250313e-16,2.220446049250313e-16*m))break;y=m}u=_,c=f,_=d,f=h,we(d)>=T&&(u/=T,c/=T,_/=T,f/=T)}g+=Se(y),y=1,g>=A&&(y=1-Ce(g))}return y}function gr(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S=4.67,x=6.66,b=6.73,T=13.32,R=60,A=70,I=84,M=105,E=120,F=127,D=140,N=1175,V=210,O=252,H=2264,P=294,L=346,k=420,B=462,W=606,z=672,U=707,Y=735,G=889,X=932,j=966,K=1141,Z=1182,J=1278,q=1740,Q=2520,$=5040,ee=5e-7,te=.01,ne=5e-7,re=20,oe=.999998;if(e<2e-6)return 0;if(e>oe)return Ke;if(u=2*t,i=t-1,y=pr(t),Be(y))return y;if(l=Oe(y),u<-1.24*Se(e)){if((a=_e(e*t*Ce(l+.6931471805599453*t),1/t))<ee)return NaN}else if(u>.32){if(y=xr(e,0,1),Be(y))return y;C=Oe(y),s=.222222/u,a=u*_e(C*ye(s)+1-s,3),a>2.2*u+6&&(a=-2*(Se(1-e)-i*Se(.5*a)+l))}else{a=.4,r=Se(1-e)+l+.6931471805599453*i;do{_=a,s=1+a*(S+a),c=a*(b+a*(x+a)),v=(S+2*a)/s-.5-(b+a*(T+3*a))/c,a-=(1-Ce(r+.5*a)*c/s)/v}while(we(_/a-1)>te)}for(w=1;w<=re;w++){if(_=a,s=.5*a,y=hr(s,t,1,!0),Be(y))return y;if(c=e-Oe(y),v=c*Ce(.6931471805599453*t+l+s-i*Se(a)),o=v/a,r=.5*v-o*i,f=(V+r*(D+r*(M+r*(I+r*(A+R*r)))))/k,d=(k+r*(Y+r*(j+r*(K+J*r))))/Q,h=(V+r*(B+r*(U+X*r)))/Q,g=(O+r*(z+Z*r)+i*(P+r*(G+q*r)))/$,p=(I+H*r+i*(N+W*r))/Q,m=(E+i*(L+F*i))/$,a+=v*(1+.5*v*f-o*i*(f-o*(d-o*(h-o*(g-o*(p-o*m)))))),we(_/a-1)>ne)return.5*n*a}return.5*n*a}function pr(e){return ct(e)}function mr(e,t,n,r){return e>de(t,n)||e<fe(0,t-r+n)||t>r||n>r?Ie:Ot(e,t,n,r)}function vr(e,t,n,r,o){var i,a;if(e>de(t,n)||e<fe(0,t-r+n)||t>r||n>r)return Ie;if(o){for(i=0,a=0;a<=e;a++)i+=Ot(a,t,n,r);return i}return Ot(e,t,n,r)}function Cr(e,t,n){return Ye((Se(e)-t)/n)}function wr(e,t,n,r){if(r)return Ye((Se(e)-t)/n);var o=(Se(e)-t)/n;return.3989422804014327*Ce(-o*o/2)/n/e}function yr(e,t,n){var r,o=br(e);return Be(o)?o:(r=Oe(o),De(Ce(t+n*r)))}function Sr(e,t,n,r){return r?Ye((e-t)/n):De(Ce(-(e-t)*(e-t)/(2*n*n))/(ye(2*me)*n))}function xr(e,t,n){var r,o,i,a,l,s=e-.5;if(we(s)<=.42)r=s*s,o=s*(((-25.44106049637*r+41.39119773534)*r-18.61500062529)*r+2.50662823884)/((((3.13082909833*r-21.06224101826)*r+23.08336743743)*r-8.4735109309)*r+1);else{if(r=e,s>0&&(r=1-e),!(r>2.220446049250313e-16))return r>1e-300?(o=-2*Se(e),r=Se(6.283185307179586*o),r=r/o+(2-r)/(o*o)+(6*r-14-r*r)/(2*o*o*o),o=ye(o*(1-r)),s<0?-o:o):s<0?-Ke:Ke;r=ye(-Se(r)),o=(((2.32121276858*r+4.85014127135)*r-2.29796479134)*r-2.78718931138)/((1.63706781897*r+3.54388924762)*r+1),s<0&&(o=-o)}return i=(o-0)/1,a=.3989422804014327*Ce(-.5*i*i)/1,l=Sr(o,0,1,!0),Be(l)?l:(o-=(l-e)/a,t+n*o)}function br(e){return xr(e,0,1)}function Tr(e,t){return t?dt(e):Ce(-_e(e,2)/2)/ye(2*me)}function Rr(e,t){var n,r,o,i,a=0,l=0,s=0,u=0,c=0,_=ie(e);if(_!==ie(t))return Ae;for(n=0,r=0;r<_;r++)o=e[r],i=t[r],je(o)&&je(i)&&(a+=o,l+=i,s+=o*o,u+=i*i,c+=o*i,n++);return n*s-a*a==0||n*u-l*l==0?Te:(n*c-a*l)/ye((n*s-a*a)*(n*u-l*l))}function Ar(e,t){var n,r,o,i,a,l=0,s=0,u=0,c=0,_=0,f=0,d=ie(t);if(d!==ie(e))return Ae;for(n=0;n<d;n++)r=t[n],o=e[n],je(r)&&je(o)&&(l+=r,s+=o,u+=r*r,c+=o*o,_+=r*o,f++);return 0===(i=ye((f*u-l*l)*(f*c-s*s)))?Te:(a=(f*_-l*s)/i,De(a*a))}function Ir(e,t,n){var r,o=0;if(n)for(r=0;r<=e;r++)o+=Ce(-t)*_e(t,r)/oe._fact(r);else o=Ce(-t)*_e(t,e)/oe._fact(e);return De(o)}function Mr(e,t,n,r){var o,i,a,l,s,u,c=n;if(r!==le&&(c=Oe(r),se(c)))return Re;if(o=0,i=0,(a=ie(e))!==ie(t))return Ae;for(l=0;l<a;l++)if(s=e[l],u=t[l],s!==Ze&&u!==Ze){if(u<=0||1<u)return Ie;n<=s&&s<=c&&(o+=u),i+=u}return 1!==i?Ie:o}function Er(){var e,t,n,r,o,i,a=arguments,l=0,s=0,u=0,c=0,_=[];for(n=0;n<ie(a);n++)for(i=a[n],_.push(i),r=0;r<ie(i);r++)(o=i[r])!==Ze&&(l+=o,s+=o*o,c++);if(c<=2)return Te;if(e=l/c,0===(t=ye((c*s-l*l)/(c*(c-1)))))return Te;for(n=0;n<ie(_);n++)for(i=_[n],r=0;r<ie(i);r++)(o=i[r])!==Ze&&(u+=_e((o-e)/t,3));return De(c*u/((c-1)*(c-2)))}function Fr(){var e,t,n,r,o,i,a,l,s,u,c=arguments,_=0,f=0,d=[];for(n=0;n<ie(c);n++){if(i=c[n],1===ie(c)&&0===ie(i))return Me;for(r=0;r<ie(i);r++)o=i[r],a={value:0},o!==Ze&&"boolean"!=typeof o&&qe(o,a)&&(_+=a.value,f++,d.push(a.value))}if(f<=2)return Te;for(e=_/f,l=0,s=0,u=0,n=0;n<d.length;n++)u=d[n]-e,s+=_e(u,2),l+=_e(u,3);return t=ye(s/f),0===t?Te:De(l/f/t/t/t)}function Dr(e,t,n){return(e-t)/n}function Nr(e,t,n){var r,o,i,a,l,s,u,c,_,f;if(1!==n&&2!==n)return Ie;if(r=t,o=e/ye(r),i=r/(r+e*e),a=r-2,l=r%2,s=1,u=1,r=1,c=2+l,_=c,a>=2)for(f=Ve(c);f<=a&&(u=u*i*(_-1)/_,(s+=u)!==r);f+=2)r=s,_+=2;return 1!==l?n*(1-(.5+.5*o*ye(i)*s)):(1===t&&(s=0),n*(1-(.5+.3183098862*(o*i*s+ve(o)))))}function Vr(e,t,n){return Ht(e,t,n?4:3)}function Or(e,t){return Nr(e,t,1)}function Hr(e,t){return Nr(e,t,2)}function Pr(e,t){var n,r,o,i,a,l,s,u,c,_,f,d=1e-12,h=e/2,g=h;if(t>1e20)return br(h);if(g<.5?(_=0,l=2*g):(_=1,l=2*(1-g)),we(t-2)<d)s=l>0?ye(2/(l*(2-l))-2):Ke;else if(Oe(t)<1+d)l>0?(a=1.5707963267948966*(l+1),s=-pe(a)):s=Ke;else{if(n=1/(t-.5),r=48/(n*n),o=((20700*n/r-98)*n-16)*n+96.36,i=((94.5/(r+o)-3)/r+1)*ye(1.5707963267948966*n)*t,(c=_e(i*l,2/t))>.05+n){if(f=br(.5*l),Be(f))return f;u=Oe(f),c=u*u,t<5&&(o+=.3*(t-4.5)*(u+.6)),o=(((.05*i*u-5)*u-7)*u-2)*u+r+o,c=(((((.4*c+6.3)*c+36)*c+94.5)/o-c-3)/r+1)*u,c*=n*c,c=c>.002?Ce(c)-1:.5*c*c+c}else c=((1/(((t+6)/(t*c)-.089*i-.822)*(t+2)*3)+.5/(t+4))*c-1)*(t+1)/(t+2)+1/c;s=ye(t*c)}return 0!==_&&(s=-s),De(s)}function Lr(e,t){return e<.5?-Lt(1-e,t,4):Lt(e,t,4)}function kr(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b={N:0,M:0,Q:0,_sum:0};if(1!==n&&2!==n)return Ie;if(1===r){if(ie(e)!==ie(t))return Ae;for(w=ie(e),C=0;C<w;C++)e[C]=e[C]-t[C];for(p=m=v=d=0,C=0;C<w;C++)y=e[C],h=y-p,g=h/(v+1),p+=g,m+=v*h*g,v++,d+=y;if(v-1==0||0===v)return Te;if(l=ye(m/(v-1)),se(l)||!ue(l))return Ie;o=d/v,a=o/(l/ye(v)),c=v-1}else b.N=0,b.M=0,b.Q=0,b._sum=0,gt(b,e),s=b.Q/(b.N-1),o=b._sum/b.N,_=b.N,b.N=0,b.M=0,b.Q=0,b._sum=0,gt(b,t),u=b.Q/(b.N-1),i=b._sum/b.N,f=b.N,2!==r?(S=s/_/(s/_+u/f),c=1/(S*S/Oe(_-1)+(1-S)*(1-S)/Oe(f-1))):c=Oe(_+f-2),a=(o-i)/ye(s/Oe(_)+u/Oe(f));return a=we(a),x=mt(.5*c,.5,c/(c+a*a)),Be(x)?x:.5*n*Oe(x)}function Br(e,t,n,r){var o=Ce(-_e(e/n,t));return De(r?1-o:t/_e(n,t)*_e(e,t-1)*o)}function Wr(e,t,n){var r,o,i,a,l,s,u=0,c=0,_=0,f=0;if(n!==le&&(u=Oe(n),se(u)))return Re;for(a=0;a<ie(e);a++)(l=e[a])!==Ze&&(i=Oe(l),c+=i,_+=i*i,f++);return 0===f?Ae:1===f?Te:(r=c/f,0===(o=n!==le?u:ye((f*_-c*c)/(f*(f-1))))?Te:(s=Ye((r-t)/(o/ye(f))),Be(s)?s:De(1-Oe(s))))}function zr(e,t){e=Oe(Ve(e)),t=Oe(Ve(t));var n=1,r;if(e<0||t<0||e<t)return Ie;for(r=e-t+1;r<=e;r++)n*=r;return De(n)}function Ur(e,t){return Ut(!1,e,t)}function Yr(){var e,t,n,r=0,o=[],i=yt(arguments),a=ie(i);for(e=0;e<a;e++){for(n=0,t=e+1;t<a;t++)i[e]===i[t]&&n++;n>r?(r=n,o=[],o.push([i[e]])):n===r&&o.push([i[e]])}return 0===r?Ae:new Ee(o)}function Gr(e,t){return Ue([e,t],18)}function Xr(e,t){return Ue([e,t],19)}function jr(e,t,n){return e.rowCount>1||e.colCount>1?Re:Bt(!1,t,e[0],n)}function Kr(e,t){var n,r=t;return e>=0&&e<2147483647&&r>=0&&r<2147483647&&(e=Math.pow(parseInt(e),parseInt(r)),(n=Math.abs(e))<=1.79769e308)?n>=2.2250738585072014e-308?e:0:Ie}function Zr(e){var t,n;return""===e?Re:(t={value:0},!0===qe(e,t)?(e=.3989422804014327*Math.exp(-t.value*t.value*.5),n=Math.abs(e),n<=1.79769e308?n>=2.2250738585072014e-308?e:0:Ie):Re)}function Jr(e,t,n,r){var o,i,a,l,s,u,c,_,f;if(""===e)return Re;o=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,0x3ceea4c2b3e0d80000,2.585201673888498e22,6.204484017332394e23,1.5511210043330986e25,4.0329146112660565e26,1.0888869450418352e28,3.0488834461171387e29,8.841761993739702e30,2.6525285981219107e32,8.222838654177922e33,2.631308369336935e35,8.683317618811886e36,2.9523279903960416e38,1.0333147966386145e40,3.7199332678990125e41,1.3763753091226346e43,5.230226174666011e44,2.0397882081197444e46,8.159152832478977e47,3.345252661316381e49,1.40500611775288e51,6.041526306337383e52,2.658271574788449e54,1.1962222086548019e56,5.502622159812089e57,2.5862324151116818e59,1.2413915592536073e61,6.082818640342675e62,3.0414093201713376e64,1.5511187532873822e66,8.065817517094388e67,4.2748832840600255e69,2.308436973392414e71,1.2696403353658276e73,7.109985878048635e74,4.0526919504877214e76,2.3505613312828785e78,1.3868311854568984e80,8.32098711274139e81,5.075802138772248e83,3.146997326038794e85,1.98260831540444e87,1.2688693218588417e89,8.247650592082472e90,5.443449390774431e92,3.647111091818868e94,2.4800355424368305e96,1.711224524281413e98,1.1978571669969892e100,8.504785885678623e101,6.1234458376886085e103,4.4701154615126844e105,3.307885441519386e107,2.48091408113954e109,1.8854947016660504e111,1.4518309202828587e113,1.1324281178206297e115,8.946182130782976e116,7.156945704626381e118,5.797126020747368e120,4.753643337012842e122,3.945523969720659e124,3.314240134565353e126,2.81710411438055e128,2.4227095383672734e130,2.107757298379528e132,1.8548264225739844e134,1.650795516090846e136,1.4857159644817615e138,1.352001527678403e140,1.2438414054641308e142,1.1567725070816416e144,1.087366156656743e146,1.032997848823906e148,9.916779348709496e149,9.619275968248212e151,9.426890448883248e153,9.332621544394415e155,9.332621544394415e157,9.42594775983836e159,9.614466715035127e161,9.90290071648618e163,1.0299016745145628e166,1.081396758240291e168,1.1462805637347084e170,1.226520203196138e172,1.324641819451829e174,1.4438595832024937e176,1.588245541522743e178,1.7629525510902446e180,1.974506857221074e182,2.2311927486598138e184,2.5435597334721877e186,2.925093693493016e188,3.393108684451898e190,3.969937160808721e192,4.684525849754291e194,5.574585761207606e196,6.689502913449127e198,8.094298525273444e200,9.875044200833601e202,1.214630436702533e205,1.506141741511141e207,1.882677176888926e209,2.372173242880047e211,3.0126600184576594e213,3.856204823625804e215,4.974504222477287e217,6.466855489220474e219,8.47158069087882e221,1.1182486511960043e224,1.4872707060906857e226,1.9929427461615188e228,2.6904727073180504e230,3.659042881952549e232,5.012888748274992e234,6.917786472619489e236,9.615723196941089e238,1.3462012475717526e241,1.898143759076171e243,2.695364137888163e245,3.854370717180073e247,5.5502938327393044e249,8.047926057471992e251,1.1749972043909107e254,1.727245890454639e256,2.5563239178728654e258,3.80892263763057e260,5.713383956445855e262,8.62720977423324e264,1.3113358856834524e267,2.0063439050956823e269,3.0897696138473508e271,4.789142901463394e273,7.471062926282894e275,1.1729568794264145e278,1.853271869493735e280,2.9467022724950384e282,4.7147236359920616e284,7.590705053947219e286,1.2296942187394494e289,2.0044015765453026e291,3.287218585534296e293,5.423910666131589e295,9.003691705778438e297,1.503616514864999e300,2.5260757449731984e302,4.269068009004705e304,7.257415615307999e306];function d(e){return e<171?e<0?NaN:o[e]:1/0}function h(e,t){var n,r,o,i;if(e<=t)return e===t&&t>=0?1:Re;if(e<2*t&&(t=e-t),t<2)return t>=0?0!==t?e:1:Re;if(e<171)return d(e)/(d(t)*d(e-t));if(t>514)return Re;if(e>8192){for(n=e,r=2;r<=t;r++)n*=--e/r;return n}for(o=e,e--,i=2;;)switch(t-i){case-1:return o;case 0:return e/i*o;case 1:return e*(e-1)/(i*(i+1))*o;case 2:return e*(e-1)*(e-2)/(i*(i+1)*(i+2))*o;default:o*=e*(e-1)*(e-2)*(e-3)/(i*(i+1)*(i+2)*(i+3)),i+=4,e-=4}}if(i={value:0},e=Qe(e,i),a={value:0},t=qe(t,a),l={value:0},n=Qe(n,l),4===arguments.length&&r?(s={value:0},r=Qe(r,s)):(r=n,s=l),!0===e&&!0===t&&!0===n&&!0===r){if(e=i.value,t=a.value,n=l.value,r=s.value,e>=0&&e<=2147483646&&t>=0&&t<=1&&n>=0&&n<=e&&r>=n&&r<=e){if((u=e*t*(1-t))>100)return u=Math.sqrt(u),t*=e,et((r-t+.5)/u)-et((n-1-t+.5)/u);if(0===(c=h(e,n)*Math.pow(t,n)*Math.pow(1-t,e-n)))return 0;for(_=c,u=c,t/=1-t,f=n;f<r;f++)u*=(e-f)/(f+1)*t,_+=u;return _<=1?_:1}return Ie}return Re}function qr(e){var t,n,r;if(e>0)e=Math.exp(ct(e));else{if(t=Math.abs(parseInt(e)),0===(n=e+t))return Ie;e=Math.pow(-1,t-1)*Math.exp(ct(-n))*Math.exp(ct(1+n))/Math.exp(ct(t+1-n))}return r=Math.abs(e),r<=1.79769e308?r>=2.2250738585072014e-308?e:0:Ie}function Qr(e){e=et(e)-.5;var t=Math.abs(e);return t<=1.79769e308?t>=2.2250738585072014e-308?e:0:Ie}t={_argType:7},r={_defaultValue:!0,_argType:7},o={_argType:2},i={_argType:2,_argCondition:"< 1"},a={_argType:2,_argCondition:"< 0"},l={_argType:2,_argCondition:["< 1","> 10000000000"]},s={_argType:0},u={_argType:0,_argCondition:["< 0",">= 1"]},c={_argType:0,_argCondition:["<= 0",">= 1"]},_={_argType:0,_argCondition:"<= 0"},f={_defaultValue:0,_argType:0},d={_defaultValue:1,_argType:0},h={_argType:0,_argCondition:["< 0","> 1"]},g={_argType:0,_argCondition:"< 0"},p={_argType:0,_argCondition:["< 1","> 10000000000"]},m={_argType:0,_argCondition:["< 1",">= 10000000000"]},v={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_ignoreBlank:!0},C={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0},w={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_ignoreBlank:!0,_isAllArgsSameLimit:!0},y={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},S={_argType:4,_valueType:1,_breakOnError:!0,_ignoreBlank:!0},x={_argType:4,_valueType:0,_toOneDimension:!0},b={_argType:4,_valueType:1,_toOneDimension:!0},T={_argType:4,_valueType:1,_toOneDimension:!0,_breakOnError:!0,_breakOnConvertError:!0},R={_argType:4,_valueType:0,_toOneDimension:!0,_breakOnError:!0,_isAllArgsSameLimit:!0},A={_argType:4,_valueType:0,_toOneDimension:!0,_breakOnError:!0,_ignoreBlank:!0,_isAllArgsSameLimit:!0},I={_argType:4,_valueType:0,_toOneDimension:!0,_breakOnError:!0},M={_argType:4,_valueType:1,_breakOnError:!0,_breakOnConvertError:!0},E=[v,{_argType:2}],F=[C,o],D=[v,s,{_defaultValue:3,_argType:2,_argCondition:"< 1"}],N=[c,_,i],V=[c,_,_,f,d],O=[a,a,h,t],H=[a,h,c],P=[g,p],L=[h,l],k=[C,C],B=[g,_,t],W=[g,m,m],z=[h,m,m],U=[v,v],Y=[g,_,_,t],G=[h,_,_],X=[h,s,_],j=[s,s,_,t],K=[b,b],Z=[{_argType:2,_argCondition:"<= 0"},_,t],J=[g,i],q=[T,T,o,{_argType:2,_argCondition:["< 1","> 3"]}],Q=[g,_,_,t],$=[v,s],ee=[M,{},r,{_defaultValue:!1,_argType:7}],te=[{},C,f],Je("TREND",jt,1,4,[{_argType:4,_valueType:0,_breakOnError:!0},{},{},r],[0,1,2],[0,1,2],{_acceptsMissingArgument:[1,2,3]}),Je("GROWTH",Kt,1,4,[M,{},{},r],"!= 3","!= 3",{_acceptsMissingArgument:[1,2,3]}),Je("FORECAST",Zt,3,3,[s,C,C],"> 0","> 0"),Je("AVERAGE",Jt,1,le,le,-1,-1),Je("STDEV",qt,1,le,le,-1,-1),Je("STDEV.S",qt,1,le,le,-1,-1),Je("PERCENTILE",Qt,2,2,le,0,0),Je("PERCENTILE.INC",Qt,2,2,le,0,0),Je("MAX",$t,1,le,le,-1,-1),Je("MAXA",en,1,le,R,-1,-1),Je("MIN",tn,1,le,le,-1,-1),Je("MINA",nn,1,le,R,-1,-1),Je("LARGE",rn,2,2,F,0,0),Je("SMALL",on,2,2,F,0,0),Je("AVERAGEA",an,1,le,A,-1,-1),Je("AVERAGEIF",un,2,3,le,[0,2],[0,2],{_acceptsMissingArgument:2}),Je("AVERAGEIFS",cn,3,le,C,[0,"%= 1"],[0,"%= 1"]),Je("MEDIAN",_n,1,le,w,-1,-1),Je("MODE",fn,1,le,w,-1,-1),Je("MODE.SNGL",fn,1,le,w,-1,-1),Je("GEOMEAN",dn,1,le,y,-1,-1),Je("HARMEAN",hn,1,le,w,-1,-1),Je("TRIMMEAN",gn,2,2,[v,u],0,0),Je("FREQUENCY",pn,2,2,[S,S],-1,-1),Je("RANK",mn,2,3,te,[0,1],[0,1],{_acceptsMissingArgument:2}),Je("RANK.EQ",mn,2,3,te,[0,1],1,{_acceptsMissingArgument:2}),Je("KURT",vn,1,le,w,-1,-1),Je("PERCENTRANK",Cn,2,3,D,0,0,{_acceptsMissingArgument:2}),Je("PERCENTRANK.INC",Cn,2,3,D,0,0,{_acceptsMissingArgument:2}),Je("PERCENTRANK.EXC",wn,2,3,D,0,0,{_acceptsMissingArgument:2}),Je("QUARTILE",yn,2,2,E,0,0),Je("QUARTILE.INC",yn,2,2,E,0,0),Je("COUNT",Sn,1,le,le,-1,-1,{_acceptsError:-1}),Je("COUNTA",xn,1,le,le,-1,-1,{_acceptsError:-1}),Je("COUNTBLANK",bn,1,1,x,-1,-1),Je("COUNTIF",Rn,2,2,[x,x],0,0),Je("COUNTIFS",An,2,le,I,"%= 0","%= 0"),Je("AVEDEV",In,1,le,w,-1,-1),Je("STDEVA",Mn,1,le,A,-1,-1),Je("STDEVP",En,1,le,le,-1,-1),Je("STDEV.P",En,1,le,le,-1,-1),Je("STDEVPA",Fn,1,le,A,-1,-1),Je("VAR",Dn,1,le,le,-1,-1),Je("VAR.S",Dn,1,le,le,-1,-1),Je("VARA",Nn,1,le,A,-1,-1),Je("VARP",Vn,1,le,le,-1,-1),Je("VAR.P",Vn,1,le,le,-1,-1),Je("VARPA",On,1,le,A,-1,-1),Je("COVAR",Hn,2,2,k,-1,-1),Je("COVARIANCE.P",Hn,2,2,k,-1,-1),Je("DEVSQ",Pn,1,le,w,-1,-1),Je("CONFIDENCE",Ln,3,3,N),Je("CONFIDENCE.NORM",Ln,3,3,N),Je("CONFIDENCE.T",kn,3,3,N),Je("INTERCEPT",Bn,2,2,[w,w],-1,-1),Je("LINEST",Wn,1,4,ee,[0,1],[0,1],{_acceptsMissingArgument:[1,2,3],_arrayArgumentEvaluateMode:1}),Je("SLOPE",zn,2,2,[w,w],-1,-1,{_arrayArgumentEvaluateMode:1}),Je("LOGEST",Un,1,4,ee,[0,1],[0,1],{_acceptsMissingArgument:[1,2,3]}),Je("STEYX",Yn,2,2,k,-1,-1),Je("BETADIST",Xn,3,5,[s,_,_,f,d],le,le,{_acceptsMissingArgument:[3,4]}),Je("BETA.DIST",jn,4,6,[s,_,_,t,f,d],le,le,{_acceptsMissingArgument:[5,6]}),Je("BETAINV",Kn,3,5,V,le,le,{_acceptsMissingArgument:[3,4]}),Je("BETA.INV",Kn,3,5,V,le,le,{_acceptsMissingArgument:[3,4]}),Je("BINOMDIST",Zn,4,4,O),Je("BINOM.DIST",Zn,4,4,O),Je("NEGBINOMDIST",Jn,3,3,[o,o,u]),Je("NEGBINOM.DIST",qn,4,4,[a,i,u,t]),Je("CRITBINOM",Qn,3,3,H),Je("BINOM.INV",Qn,3,3,H),Je("CHIDIST",$n,2,2,P),Je("CHISQ.DIST.RT",$n,2,2,P),Je("CHISQ.DIST",er,3,3,[g,l,t]),Je("CHIINV",tr,2,2,L),Je("CHISQ.INV.RT",tr,2,2,L),Je("CHISQ.INV",rr,2,2,L),Je("CHITEST",or,2,2,k,-1,-1),Je("CHISQ.TEST",or,2,2,k,-1,-1),Je("CORREL",ir,2,2,[w,w],-1,-1),Je("EXPONDIST",ar,3,3,B),Je("EXPON.DIST",ar,3,3,B),Je("FDIST",lr,3,3,W),Je("F.DIST",sr,4,4,[g,p,p,t]),Je("F.DIST.RT",lr,3,3,W),Je("FINV",ur,3,3,z),Je("F.INV.RT",ur,3,3,z),Je("F.INV",cr,3,3,[h,l,l]),Je("FISHER",_r,1,1,{_argType:0,_argCondition:["<= -1",">= 1"]}),Je("FISHERINV",fr,1,1,s),Je("FTEST",dr,2,2,U,-1,-1),Je("F.TEST",dr,2,2,U,-1,-1),Je("GAMMADIST",hr,4,4,Y),Je("GAMMA.DIST",hr,4,4,Y),Je("GAMMAINV",gr,3,3,G),Je("GAMMA.INV",gr,3,3,G),Je("GAMMALN",pr,1,1,_),Je("GAMMALN.PRECISE",pr,1,1,_),Je("HYPGEOMDIST",mr,4,4,[a,a,a,a]),Je("HYPGEOM.DIST",vr,5,5,[a,a,a,a,t]),Je("LOGNORMDIST",Cr,3,3,[_,s,_]),Je("LOGNORM.DIST",wr,4,4,[_,s,_,t]),Je("LOGINV",yr,3,3,X),Je("LOGNORM.INV",yr,3,3,X),Je("NORMDIST",Sr,4,4,j),Je("NORM.DIST",Sr,4,4,j),Je("NORMINV",xr,3,3,X),Je("NORM.INV",xr,3,3,X),Je("NORMSDIST",Ye,1,1,s,le,le),Je("NORMSINV",br,1,1,h),Je("NORM.S.INV",br,1,1,h),Je("NORM.S.DIST",Tr,2,2,[s,t]),Je("PEARSON",Rr,2,2,K,-1,-1),Je("RSQ",Ar,2,2,K,[0,1],[0,1]),Je("POISSON",Ir,3,3,Z),Je("POISSON.DIST",Ir,3,3,Z),Je("PROB",Mr,3,4,[T,C,s],[0,1],[0,1],{_acceptsMissingArgument:3}),Je("SKEW",Er,1,le,w,-1,-1),Je("STANDARDIZE",Dr,3,3,[s,s,_]),Je("TDIST",Nr,3,3,[g,i,o]),Je("T.DIST",Vr,3,3,[g,i,t]),Je("T.DIST.RT",Or,2,2,J),Je("T.DIST.2T",Hr,2,2,J),Je("TINV",Pr,2,2,L),Je("T.INV.2T",Pr,2,2,L),Je("T.INV",Lr,2,2,[{_argType:0,_argCondition:["<= 0","> 1"]},l]),Je("TTEST",kr,4,4,q,[0,1],[0,1]),Je("T.TEST",kr,4,4,q,[0,1],[0,1]),Je("WEIBULL",Br,4,4,Q),Je("WEIBULL.DIST",Br,4,4,Q),Je("ZTEST",Wr,2,3,$,0,0,{_acceptsMissingArgument:2}),Je("Z.TEST",Wr,2,3,$,0,0,{_acceptsMissingArgument:2}),Je("PERMUT",zr,2,2),Je("COVARIANCE.S",Ur,2,2,k,-1,-1),Je("MODE.MULT",Yr,1,le,y,-1,-1),Je("PERCENTILE.EXC",Gr,2,2,[v,c],0,0),Je("QUARTILE.EXC",Xr,2,2,[v,o],0,0),Je("RANK.AVG",jr,2,3,[T,b,f],[0,1],1,{_acceptsMissingArgument:2}),Je("PERMUTATIONA",Kr,2,2,[s,s]),Je("PHI",Zr,1,1),Je("BINOM.DIST.RANGE",Jr,3,4,[{_defaultValue:0},{_defaultValue:0},{_defaultValue:0}]),Je("GAMMA",qr,1,1,_),Je("GAUSS",Qr,1,1,s),Je("SKEW.P",Fr,1,le,A,-1,-1),e.exports=oe}()}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.Sheets=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";var t,r,o,i=n(1),a=n(2);n(3),n(4),t=n(7),r=t._pt,o=-1,1===r?(n(8),n(9),n(10),o=Math.floor(5*Math.random()),i["G".concat("C","$")]["s".concat("d")]=o):(n(10),n(8),n(9)),0===o&&n(7),n(11),1===o&&n(7),n(12),2===o&&n(7),n(15),3===o&&n(7),n(16),4===o&&n(7),n(17),a&&(n(18),n(19),n(20),n(21)),n(30),n(24),n(31),n(32),n(33),n(34),n(35),n(36),n(37),n(38),n(25),n(22),a&&n(39),n(40),n(28),n(27),n(29),n(26),n(13),n(41),n(42),1!==r&&2!==r||t._replace(),i.SR={},i.SR.en=n(43),e.exports=i}()},function(e,t){!function(){"use strict";e.exports={}}()},function(e,t){e.exports=GC.Spread.CalcEngine},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f=n(4).GC$,d=n(5),h=n(2),g=n(6),p=n(1),m=f.each,v=f.extend,C=d._NumberHelper,w=d._ArrayHelper._clone,y=g&&g.GeneralFormatter,S=window,x=document,b="boolean",T="date",R="function",A=void 0,I=null,M=Math.floor,E=Math.ceil,F=Math.min,D=Math.max,N=Math.round,V=parseInt,O=parseFloat,H=isNaN,P="px",L=" ",k=".",B="string",W="number";function z(e){return void 0!==e}function U(e){return x.createElement(e)}function Y(e){x.body&&x.body.insertBefore(e,I)}function G(e,t,n){Object.defineProperty(e,t,{get:function(){return this._ps[t]},set:function(e){var r=this._ps[t];r!==e&&(this._ps[t]=e,n&&n(t,e,r))},enumerable:!0})}p.productInfo={productVersion:"11.0.0"},p.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},p.getTypeFromString=function(e){var t,n,r,o=!1,i=S;if(typeof e===B){for(t=e.split(k),n=0,r=t.length;n<r&&i;n++)i=i[t[n]];i&&n===r&&r>0&&(o=!0)}return o?i:A},p.findControl=function(e){return typeof e===B&&(e=x.getElementById(e)),f(e).data("workbook")};function X(e){return e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1),!1}t={},t._cancelDefault=X,t._getHAlignByValueType=function(e,t,n){if(3===e){var r=f.getType(t);e=n&&"@"===n?0:r===b?1:r===W||r===T?2:0}return e},t._toString=function(e){var t,n=f.getType(e);return e===I||e===A?e="":n===b?e=(""+e).toUpperCase():n===T?(t=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds(),e=d._DateTimeHelper._localeFormat(e,t?"M/d/yyyy":"M/d/yyyy h:mm:ss")):e=""+e,e},t._applyBackgroundImageLayout=function(e,t,n,r,o,i){var a,l,s,u,c,_,d=f(e),h=t,g=n,p="background-position",m="background-size",v="auto",C="0%",w="50%",y="100%";switch(i){case 0:d.css(p,C+L+C).css(m,y+L+y);break;case 1:a=w,l=w,r>h&&(a=C),o>g&&(l=C),d.css(p,a+L+l).css(m,v+L+v);break;case 2:s=0,u=0,c=h,_=g,g>0&&o>0&&h/g>r/o?(c=r/o*g,s=s+h/2-c/2):h>0&&r>0&&g/h>o/r&&(_=o/r*h,u=u+g/2-_/2),d.css(p,s+P+L+u+P).css(m,c+P+L+_+P);break;case 3:d.css(p,C+L+C).css(m,v+L+v)}},t._device=t.device=function(){var e,t,n,r,o=navigator.userAgent,i=o.match(/iPad/i);return i&&(e=i[0])&&(t="ipad"===e.toLowerCase()),i=o.match(/iPhone/i),i&&(e=i[0])&&(n="iphone"===e.toLowerCase()),i=o.match(/android/i),i&&(e=i[0])&&(r="android"===e.toLowerCase()),{ipad:t,iphone:n,android:r}},t._isMacOS=function(){var e=navigator.platform;return e&&e.indexOf("Mac")>-1},t._isStringNumber=function(e){if(e===A||e===I)return!1;var t=""+e;return t=C._replaceCultureSymbolToNormal(t),!H(+(""===t.trim()?NaN:t))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(t)},t._parseText2Value=function(e,n,r,o,i){var a,l,s,u,c=I;if(e&&(e.formatter?typeof(c=i||e.formatter)===B&&y&&(c=new y(c)):c=e._autoFormatter),c&&!c.isAuto){a=I;try{if(typeof(a=c.parse(n))===W)return a}catch(e){}return a===A||a===I?n:a}if(r){if(l={},u=I,y)try{u=(new y).getPreferredDisplayFormatter(n,l)}catch(e){}return s=l.value,typeof s===W?n=s:t._isStringNumber(n)&&(s=l.value=n),o&&(o.value=u),s!==A&&s!==I?s:n}return n},t._getPreferredZIndex=function(e){for(var t,n,r=x.body,o=e;o&&o.parentElement&&o.parentElement!==r;)o=o.parentElement;return t=1e3,o&&o.parentElement===r&&(n=V(f(o).css("z-index")),H(n)||(t+=n)),t},t._getLinearGradientColors=function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g;if(!e)return[];if(t=e.indexOf("("),n=e.lastIndexOf(")"),!(r=e.substring(t+1,n)))return[];for(o=[],i=0,a="",l=0,s=0;s<r.length;)l=r.indexOf("rgb",i),s=r.indexOf("rgb",i+1),-1===s&&(s=r.length),a=r.substring(l,s),o.push(a),i=s;for(u=[],c=0,_=o.length;c<_;c++)f=o[c],d=f.indexOf(")"),h=f.substring(0,d+1),g=O(f.substring(d+1,f.length)),H(g)&&(c===_-1?g=100:c<=1&&(g=0)),(h||0!==c)&&(g/=100,u.push({color:h,point:g}));return u},t._getColumnAutoFitValue=function(e,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b=n._render,T=0,R=[r];for(1===o&&(3===r?R.push(1):2===r&&R.push(0)),i=0;i<R.length;i++)for(a=0,l=R[i],s=n.getRowCount(l);a>=0&&a<s;)u=n._getSpanModel(l).find(a,e),u&&(u.col<e||u.colCount>1||u.row<a)?a=u.row+u.rowCount:(n.getRowHeight(a,l)>0&&(c=n.getActualStyle(a,e,l),_=0,f=c.cellType||n._getDefaultCellType(l),f&&(d=c.font||b._getDefaultFont(),c.font=b._getZoomFont(d),h=n.rowFilter&&n.rowFilter(),g=!(!h||!h._isFilterHeader(a,e,l)),g||3!==l||(p=n.tables?n.tables.find(a,e):I)&&p.showHeader()&&p.headerIndex()===a&&p.rowFilter()&&p.filterButtonVisible(e-p.range().col)&&(g=!0),m=c.formatter?c.formatter:c._autoFormatter,v={sheet:n,row:a,col:e,sheetArea:l,quotePrefix:c.quotePrefix},C={},w=n.getValue(a,e,l),y=f.format(w,m,C,v),_=f._getAutoFitContainerWidth(w,y,c,n._zoomFactor,v),g&&(S=F(n._zoomFactor,1),x=V(""+n.defaults.rowHeight*S,10),_+=x)),_>T&&(T=_)),3===l?a=t._nextAutoFitRow(a,e,n,l):a++);return 0===T?T=n.defaults.colWidth:T+=E(3/n._zoomFactor),E(T)},t._nextAutoFitRow=function(e,t,n,r){var o,i,a,l=-1,s=n.getRowCount(r);for(o=e+1;o<s;o++){if(i=n.getText(o,t,r)){l=o;break}if((a=n.getActualStyle(o,t,r))&&a.cellType){l=o;break}}return l},t._getRowAutoFitValue=function(e,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p=n._render,m=0,v=[r];for(1===o&&(3===r?v.push(2):1===r&&v.push(0)),i=0;i<v.length;i++)for(r=v[i],a=0,l=n.getColumnCount(r);a>=0&&a<l;)s=n._getSpanModel(r).find(e,a),s&&(s.row<e||s.rowCount>1||s.col<a)?a=s.col+s.colCount:(n.getColumnWidth(a,r)>0&&(u=n.getActualStyle(e,a,r),c=u.font||p._getDefaultFont(),u.font=p._getZoomFont(c),_=0,f=n.getCellType(e,a,r),f&&(d=n.getText(e,a,r),h=n.getValue(e,a,r),g={sheet:n,row:e,col:a,sheetArea:r},_=f._getAutoFitContainerHeight(h,d,u,n._zoomFactor,g)),_>m&&(m=_)),3===r?a=t._nextAutoFitColumn(e,a,n,r):a++);return 0===m?m=n.defaults.rowHeight:m+=E(3/n._zoomFactor),E(m)},t._nextAutoFitColumn=function(e,t,n,r){var o,i,a,l=-1,s=n.getColumnCount(r);for(o=t+1;o<s;o++){if(i=n.getText(e,o,r)){l=o;break}if((a=n.getActualStyle(e,o,r))&&a.cellType){l=o;break}}return l},t._formatValue2Text=function(e,n,r,o){var i,a,l,s,u,c,_,f;if(r&&(i=r._activeRowIndex,a=r._activeColIndex,l=e.formatter?e.formatter:e._autoFormatter,s=o||{},y&&n!==I&&n!==A))if(l&&l.isAuto)u=typeof n===W,c=t._isStringNumber(n),!u&&c&&(n=C._replaceCultureSymbolToNormal(n)),n=l.getPreferredEditingFormatter?l.getPreferredEditingFormatter(n).format(n):n;else if(typeof l===B&&(l=new y(l)),l)try{n instanceof Date?(_=h&&h.Convert._toDateTime(n),_&&(n=_),f=d.CultureManager._getCultureInfo().DateTimeFormat,l=new y(0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?f.shortDatePattern:f.shortDatePattern+L+f.longTimePattern),r._editingTimeValue=!0,n=l.format(n),s.formatter=l):typeof n===W&&(n=C._replaceNormalToCultureSymbol(""+n))}catch(e){n=r.getText(i,a)}else n=r.getText(i,a);return n!==I&&n!==A&&(n=t._toString(n)),n},t._browser=t.browser=function(){var e,t,n,r,o,i,a;function l(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}e=navigator.userAgent,t=l(e),n={},t.browser&&(n[t.browser]=!0,n.version=t.version),
n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),r=e.indexOf("PhantomJS")>=0,r&&(n.safari=!1,n.chrome=!0),o=e.toLowerCase(),i=o.indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(o)!==I,i&&(n.mozilla=A,n.msie=!0),(a=/Edge\/\d+/.exec(e))!==I&&a.length>0&&(n.webkit=A,n.chrome=A,n.msie=!0,n.edge=!0,n.version=a[0].substr(a[0].indexOf("/")+1));function s(){var e=I,t=!1;try{new ActiveXObject("")}catch(t){e=t.name}try{t=!!new ActiveXObject("htmlfile")}catch(e){t=!1}return!(t="ReferenceError"===e||!1!==t)}return n.msie&&s()&&(n.metroMode=!0),n}(),t._createElement=U,t._isDefined=z,t._defProperty=function(e,t,n,r){var o=e,i=t,a=function(e,t){var a,l,s=this;return s.hasOwnProperty("_ps")||(s._ps={}),a=s._ps,0===arguments.length?a[o]!==A?a[o]:i:(!1!==t&&r&&!r.call(s,e)||(l=a[o]!==A?a[o]:i)!==e&&(a[o]=e,!1!==t&&n&&n.call(s,e,l)),s)};return a.isDefault=function(e){return e===i},a},t._createOptions=function(e,t){var n={};return n._ps={},d._Types._each(e,function(e){G(n,e,t)}),n},t._getDistance=function(e,t,n,r,o){var i,a=F(t,n),l=D(t,n),s=0;for(i=a;i<l&&(s+=r?e._getZoomRowHeight(i,3):e._getZoomColumnWidth(i,3),!(o&&s>o));i++);return s},t._getRelativeOffset=function(e,t){var n,r,o=0,i=0;return e!==t&&(n=f(e).offset(),r=f(t).offset(),o=n.left-r.left,i=n.top-r.top),{_top:i,_left:o}},t._isValidSheetName=function(e,t,n){var r,o,i,a;if(!e||"string"!=typeof e)return!1;for(o=0;o<e.length;o++)if("*"===(r=e.charAt(o))||":"===r||"["===r||"]"===r||"?"===r||"\\"===r||"/"===r)return!1;if(!t)return!0;for(i=t.length,o=0;o<i;o++)if(a=t[o],n!==a&&e.toUpperCase()===a._name.toUpperCase())return!1;return!0},t._replaceSpaceChar=function(e,t,n){var r,o,i;if(!e)return e;for(r=0,o=e.length,i=[];r<o;)e[r]===t?i[r]=n:i[r]=e[r],r++;return i.join("")},t._getEditingSpan=function(){var e,n,r,o=t;return o._editingSpan||(e=U("span"),n=e.style,r="-10000px",n.visibility="hidden",n.top=r,n.left=r,n.position="absolute",e.setAttribute("gcUIElement","gcStringWidthSpan"),x.body.insertBefore(e,I),o._editingSpan=e),o._editingSpan},t._getFontHeight=function(e,n){var r,o,i,a=t,l=a._fontHeightCache;if(!n)if(l){if(r=l[e])return r}else l=a._fontHeightCache={};return o=a._getEditingSpan(),o.style.font=e,o.innerHTML="H",i=o.offsetHeight,n||(l[e]=i),i},t._getTextHeight=function(e,n){var r=t._getEditingSpan();return r.style.font=n,r.innerHTML=e||"H",r.offsetHeight},t._dispose=function(){var e=t,n=e._editingSpan;n&&(f(n).remove(),e._editingSpan=A),e._fontHeightCache=A,t._helpDiv&&(t._helpDiv=A)},t._getEditableDivValue=function(e){var n,r=t._helpDiv;return r||(r=t._helpDiv=U("div")),n=e.innerHTML,r.innerHTML=n,r.innerText},p._util=p.util=t,r=p._FocusHelper={},r._isActiveElement=function(e){return r._getActiveElement()===e&&e._eventHandler&&e._eventHandler._focusElem},r._getActiveElement=function(){return S._gcGlobal.activeElement};function j(e){var t,n,o,i,a,l,s;function u(r){var i,a;for(i=0;i<=2;i++)(a=r.call(t,i))&&0!==a.width&&0!==a.height&&(e._dirty=!0,n._paintBody(o,a))}if(e&&!r._isActiveElement(e)&&e.parent&&e.parent.options.hideSelection){for(t=e._getSheetLayout(),n=e._render,o=n._getCtx(),i=e.getSelections(),a=0;a<i.length;a++)l=i[a],s=e._getRangeWholeRect(l),s.width>=0&&s.height>=0&&(s.x-=9,s.y-=9,s.width+=18,s.height+=30,n._copyDoubleBufferRect(s));s=t._headerCornerRect(),e._dirty=!0,n._paintBody(o,s),u(t._rowHeaderRect),u(t._colHeaderRect)}}r._setActiveElement=function(e,t){var n=r._getActiveElement();S._gcGlobal.activeElement=e,e===n||t||(n&&(n.endEdit(),j(n),n._disposeValidationUI&&n._disposeValidationUI()),e&&e._render._repaintSelection())};function K(){this._eventSuspended=0,this._init(),this._clickOutsideSheetCallBack=[]}function Z(e,t){var n=U("span");return n.className=e,t&&(n.id=t),n.style.display="none",Y(n),n}function J(e,t,n,r){e.addEventListener(t,n,r)}function q(e){var t=e.currentStyle,n=x.defaultView;return n&&n.getComputedStyle&&(t=n.getComputedStyle(e,"")),t}function Q(e){var t,n,o,i,a,l,s;S._gcGlobal._eventSuspended>0||(t=r._getActiveElement(),n=t&&t._validationSelect,n&&(o=f(n),o.isVisible())||t&&t._eventHandler&&t._eventHandler._doKeyDown&&(t._eventHandler._doKeyDown(e),t.isEditing()||(i=e.keyCode,a=e.ctrlKey,l=e.altKey,s=e.shiftKey,90!==i&&89!==i||!a||l?86!==i||!a||l||s||e.stopPropagation&&e.stopPropagation():X(e))))}function $(e){var t;S._gcGlobal._eventSuspended>0||(t=r._getActiveElement())&&t._eventHandler&&t._eventHandler._doKeyUp&&t._eventHandler._doKeyUp(e)}function ee(e){var t;S._gcGlobal._eventSuspended>0||(t=r._getActiveElement())&&t._eventHandler&&t._eventHandler._doCompositionStart&&t._eventHandler._doCompositionStart(e)}function te(e){return x.all===A&&r._getActiveElement()&&X(e),!1}o=K.prototype={_createDummyObjects:function(){o._getDummyHeader(),o._getDummyContent(),o._getDummyHover(),o._getDummyHighlight()},_getDummyHeader:function(){var e="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",t="span."+e.split(L).join(k);return o._dummyHeader?f(x).find(t).length<=0&&Y(o._dummyHeader):o._dummyHeader=Z(e),o._dummyHeader},_getDummyContent:function(){var e="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",t="span."+e.split(L).join(k);return o._dummyContent?f(x).find(t).length<=0&&Y(o._dummyContent):o._dummyContent=Z(e),o._dummyContent},_getDummyHover:function(){var e="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",t="span."+e.split(L).join(k);return o._dummyHover?f(x).find(t).length<=0&&Y(o._dummyHover):o._dummyHover=Z(e),o._dummyHover},_getDummyHighlight:function(){var e="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",t="span."+e.split(L).join(k);return o._dummyHighlight?f(x).find(t).length<=0&&Y(o._dummyHighlight):o._dummyHighlight=Z(e),o._dummyHighlight},_getDummyElement:function(){var e="gcDummyElement";return o._dummyElement?f(x).find("#"+e).length<=0&&Y(o._dummyElement):o._dummyElement=Z("gc-theme-version",e),o._dummyElement},_init:function(){var e,n,i=this;i._eventSuspended=0,J(S,"keydown",Q,!0),J(S,"keyup",$,!0),J(S,"compositionstart",ee,!0),J(S,"selectstart",te,!0),e=t._device(),n=e.ipad||e.iphone;function a(e){var t,a,l=r._getActiveElement();if(l&&(t=o._getUIElement(e.target),i._clickOutsideSheetCallBack.forEach(function(e){e&&e(l,t)}),!t))if(l.endEdit())n&&(a=l._eventHandler)&&a._setFocusToReadonlyFocusElem&&a._setFocusToReadonlyFocusElem(),r._setActiveElement(I);else if(e.cancelable)return!1}navigator.msPointerEnabled?f(x).bind("MSPointerDown",a):n?f(x).bind("touchstart",a):(f(x).bind("pointerdown",a),f(x).bind("mousedown",a)),f(x).bind("DOMContentLoaded",function(){o._createDummyObjects()})},_getUIElement:function(e){for(var t,n=e;n&&"BODY"!==n.tagName&&typeof n.getAttribute===R;){if(t=n.getAttribute("gcUIElement"),t||(t=n.gcUIElement),t)return n;n=n.parentNode}return I},_getExternalThemeStyle:function(e,t){var n,r,i,a,l=o._getDummyHeader();return 1===e||2===e?l=o._getDummyHighlight():4===e&&(l=o._getDummyHover()),n=l.className,f(l).removeClass(n).addClass(t),r=q(l),i={backgroundColor:r.backgroundColor,backgroundImage:r.backgroundImage},f(l).addClass(n),r=q(l),a={backgroundColor:r.backgroundColor,backgroundImage:r.backgroundImage,color:r.color,zIndex:r.zIndex},a.borderLeftColor=r.borderLeftColor,a.borderRightColor=r.borderRightColor,a.borderBottomColor=r.borderBottomColor,a.borderBottomWidth=r.borderBottomWidth,a.borderTopColor=r.borderTopColor,a.borderRightWidth=r.borderRightWidth,a.backgroundImage===i.backgroundImage&&a.backgroundColor!==i.backgroundColor&&(a.backgroundImage=A),f(l).removeClass(t),a},_getStyleByCssClass:function(e){var t,n=o._getDummyElement();return f(n).removeClass(n.className).addClass("gc-theme-version "+e),t=q(n),v({},t)},_getThemeContentStyle:function(e){var t,n=o._getDummyContent();return f(n).removeClass(n.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+e),t=q(n),v({},t)},_suspendEvent:function(){S._gcGlobal._eventSuspended++},_resumeEvent:function(){var e=S._gcGlobal;--e._eventSuspended<0&&(e._eventSuspended=0)}},S._gcGlobal||(S._gcGlobal=new K),p.VisualState={normal:0,highlight:1,selected:2,active:3,hover:4},p.SortState={none:0,ascending:1,descending:2},i=p._ThemeStyleHelper={styleCache:{}},i._getString=function(e){return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover"}[e]||""},i._getVisualStateThemeStyle=function(e,t){var n=i._getString(e)+t,r=i.styleCache;return r[n]||(r[n]=o._getExternalThemeStyle(e,t)),r[n]},i._getCssClassThemeStyle=function(e){var t=e,n=i.styleCache;return n[t]||(n[t]=o._getStyleByCssClass(e)),n[t]},i._getContentThemeStyle=function(e){var t="content"+e,n=i.styleCache;return n[t]||(n[t]=o._getThemeContentStyle(e)),n[t]},i._clearCache=function(){i.styleCache={}};function ne(e,t){this.x=e,this.y=t}ne.prototype.clone=function(){return new ne(this.x,this.y)},p.Point=ne;function re(e,t,n,r){var o=this;o.x=e,o.y=t,o.width=n,o.height=r}re.prototype={intersect:function(e,t,n,r){var o=this;return e<o.x+o.width&&o.x<e+n&&t<o.y+o.height&&o.y<t+r},intersectRect:function(e){return this.intersect(e.x,e.y,e.width,e.height)},contains:function(e,t){var n=this;return n.x<e&&e<n.x+n.width&&n.y<t&&t<n.y+n.height},containsRect:function(e){return this.contains(e.x,e.y)&&this.contains(e.x+e.width,e.y+e.height)},getIntersectRect:function(e){return this.getIntersect(e.x,e.y,e.width,e.height)},getIntersect:function(e,t,n,r){var o=this,i=o.x,a=o.y,l=o.x+o.width,s=o.y+o.height,u=e,c=t,_=e+n,f=t+r,d=D(i,u),h=D(a,c),g=F(l,_),p=F(s,f),m=d,v=h,C=g-d,w=p-h;return C>0&&w>0?new re(m,v,C,w):I},round:function(){var e=this;e.x=M(e.x),e.y=M(e.y),e.width=E(e.width),e.height=E(e.height)},clone:function(){var e=this;return new re(e.x,e.y,e.width,e.height)}},p.Rect=re;function oe(e,t,n,r){var o=this;o.row=e,o.rowCount=n,o.col=t,o.colCount=r}oe.prototype={intersect:function(e,t,n,r){var o=this;return(-1===e||-1===o.row||o.row<e+n&&e<o.row+o.rowCount)&&(-1===t||-1===o.col||o.col<t+r&&t<o.col+o.colCount)},getIntersect:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d=this;return e&&d.intersect(e.row,e.col,e.rowCount,e.colCount)?(r=-1===d.col?n-1:d.col+d.colCount-1,o=-1===e.col?n-1:e.col+e.colCount-1,i=-1===d.row?t-1:d.row+d.rowCount-1,a=-1===e.row?t-1:e.row+e.rowCount-1,l=D(d.col,e.col),s=F(r,o),u=D(d.row,e.row),c=F(i,a),_=-1===u?-1:c-u+1,f=-1===l?-1:s-l+1,new oe(u,l,_,f)):I},contains:function(e,t,n,r){var o=this,i=arguments.length,a=!1;return 2!==i&&4!==i||(2===i&&(n=1,r=1),a=(-1===o.row||o.row<=e&&e+n<=o.row+o.rowCount)&&(-1===o.col||o.col<=t&&t+r<=o.col+o.colCount)),a},containsRange:function(e){return this.contains(e.row,e.col,e.rowCount,e.colCount)},offset:function(e,t){var n=this,r=n.col,o=n.row;return-1!==r&&(r+=e),-1!==o&&(o+=t),new oe(o,r,n.rowCount,n.colCount)},union:function(e){var t=this,n=F(t.row,e.row),r=F(t.col,e.col),o=D(t.row+t.rowCount-1,e.row+e.rowCount-1),i=D(t.col+t.colCount-1,e.col+e.colCount-1);return n>=0&&r>=0?new oe(n,r,o-n+1,i-r+1):n>=0?new oe(n,-1,o-n+1,-1):r>=0?new oe(-1,r,-1,i-r+1):new oe(-1,-1,-1,-1)},equals:function(e){var t=this;return e instanceof oe&&t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount}},p.Range=oe,p._createRange=function(e,t,n,r){return new oe(e,t,n,r)};function ie(){}ie._getColor=function(e,t){if(e&&t){var n=e._currentTheme;if(n)return n.getColor(t)}return t},ie._getFont=function(e,t){if(e&&t){var n=e._currentTheme;return n?n.getFont(t):t}return I},p._ThemeContext=ie,a={},l=["ValidationError","CellClick","CellDoubleClick","EnterCell","LeaveCell","ValueChanged","TopRowChanged","LeftColumnChanged","InvalidOperation","RangeFiltering","RangeFiltered","TableFiltering","TableFiltered","RangeSorting","RangeSorted","ClipboardChanging","ClipboardChanged","ClipboardPasting","ClipboardPasted","ColumnWidthChanging","ColumnWidthChanged","RowHeightChanging","RowHeightChanged","DragDropBlock","DragDropBlockCompleted","DragFillBlock","DragFillBlockCompleted","EditStarting","EditStarted","EditChange","EditEnding","EditEnd","EditEnded","RangeGroupStateChanging","RangeGroupStateChanged","SelectionChanging","SelectionChanged","SheetTabClick","SheetTabDoubleClick","SheetNameChanging","SheetNameChanged","UserZooming","UserFormulaEntered","CellChanged","ColumnChanged","RowChanged","ActiveSheetChanging","ActiveSheetChanged","SparklineChanged","RangeChanged","ButtonClicked","EditorStatusChanged","FloatingObjectChanged","FloatingObjectSelectionChanged","PictureChanged","FloatingObjectRemoving","FloatingObjectRemoved","PictureSelectionChanged","FloatingObjectLoaded","TouchToolStripOpening","CommentChanged","CommentRemoving","CommentRemoved","SlicerChanged","ResetBinding","InitBinding","BeforeDragDrop","FormulatextboxActiveSheetChanging","FormulatextboxActiveSheetChanged","FormulatextboxEditStarted","FormulatextboxEnterCell","FormulatextboxEditEnded","FormulatextboxRangeChanged","SheetMoving","SheetMoved","DragMerging","DragMerged","ChartClicked"],m(l,function(e,t){a[t]=t}),p.Events=a;function ae(e){this._sheet=e}ae.prototype={_getCellOverflowBuilder:function(e,t,n){var r,o=this._cellOverflowBuilderCache,i=e<<4+t;return o?(r=o[i],r||(r=n(),o[i]=r),r):n()},_getConditionalFormat:function(e,t){var n,r=this._conditionalFormatCache;return r&&(n=r[e])?n[t]:I},_setConditionalFormat:function(e,t,n,r){var o,i=this._conditionalFormatCache;i&&(i[e]||(i[e]={}),o=i[e],o[t]={d:n,i:r})},_getValue:function(e,t,n){var r,o,i,a=this,l=a._sheet,s=a._valueCache;return n===A&&(n=3),s?(r=s[n],r||(r={},s[n]=r),o=r[e],o||(o={},r[e]=o),i=o[t],i===A&&(i=l.getValue(e,t,n),o[t]=i),i):l.getValue(e,t,n)},_getActualStyle:function(e,t,n){var r,o,i,a=this,l=a._sheet,s=a._styleCache;return n===A&&(n=3),s?(r=s[n],r||(r={},s[n]=r),o=r[e],o||(o={},r[e]=o),i=o[t],i||(i=l.getActualStyle(e,t,n,!1,!0),o[t]=i),i.clone(!0)):l.getActualStyle(e,t,n,!1,!1)},_getZoomRowHeight:function(e){var t,n=this,r=n._sheet,o=n._rowHeightCache;return o?(t=o[e],t===A&&(t=o[e]=r._getZoomRowHeight(e)),t):r._getZoomRowHeight(e)},_getZoomColWidth:function(e){var t,n=this,r=n._sheet,o=n._colWidthCache;return o?(t=o[e],t===A&&(t=o[e]=r._getZoomColumnWidth(e)),t):r._getZoomColumnWidth(e)},_getRowGroups:function(e){var t=this;return t._valueCache?(t._rowGroups||(t._rowGroups=e()),t._rowGroups):e()},_getColGroups:function(e){var t=this;return t._valueCache?(t._colGroups||(t._colGroups=e()),t._colGroups):e()},_startCacheBeforPan:function(){var e=this;e._isCaching=!0,e._cellOverflowBuilderCache={},e._conditionalFormatCache={},e._valueCache={},e._styleCache={},e._rowHeightCache={},e._colWidthCache={}},_endCache:function(){this._isCaching=!1},_clearCacheEndPan:function(){var e=this;e._isCaching=!1,e._cellOverflowBuilderCache=I,e._conditionalFormatCache=I,e._valueCache=I,e._styleCache=I,e._colWidthCache=I,e._rowHeightCache=I,e._rowGroups=I,e._colGroups=I}},p._CachePool=ae,s=p._CacheMgr={_cached:!1,_formatterCache:{},_formattedTextCache:{}},s._startCache=function(e,t,n,r,o){var i,a,l,u;if(s._cached=!0,(i=e.tables)&&i._has(t,n,r-t+1,o-n+1))for(a=-1,l=s._visibleRowIndexCache=[],u=0;u<=r;u++)e.getRowVisible(u)?(a++,l[u]=a):l[u]=-1},s._clearCache=function(){s._visibleRowIndexCache=I,s._cached=!1},s._getFormatter=function(e){var t=s._formatterCache;return t[e]||(t[e]=y?new y(e):I),t[e]},s._getFormattedText=function(e,t,n){var r,o,i,a,l,u,c,_=s._formattedTextCache,f=e+"_"+typeof e;return y?(_[t]||(_[t]={}),r=_[t],(o=r[f])?(n&&(n.conditionalForeColor=n.value=o.color,n.content=w(o.content)),o.text):(i=s._formatterCache,i[t]||(i[t]=new y(t)),a=i[t],l={},u=a.format(e,l),c=r[f]={},c.text=u,c.color=l.conditionalForeColor,c.content=l.content,n&&(n.conditionalForeColor=n.value=l.conditionalForeColor,n.content=w(l.content)),u)):""+e},s._getFormattedTextByStyle=function(e,t,n,r){var o=t.cellType||e._getDefaultCellType(),i=t.formatter||t._autoFormatter;return o.format(n,i,r,I)},s._clearFormatCache=function(){s._formatterCache={},s._formattedTextCache={}};function le(e){var t=e._matrix||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return e._matrix=t,t}u=p._CanvasHelper={_scaleTo:function(e,t,n){var r=le(e);r.scaleX=t,r.scaleY=n,r.translateX=r.orgTranslateX*t,r.translateY=r.orgTranslateY*n,e.setTransform(r.scaleX,r.skewX,r.skewY,r.scaleY,r.translateX,r.translateY)},_translate:function(e,t,n){var r=le(e);r.orgTranslateX+=t,r.orgTranslateY+=n,r.translateX=r.orgTranslateX*r.scaleX,r.translateY=r.orgTranslateY*r.scaleY,e.setTransform(r.scaleX,r.skewX,r.skewY,r.scaleY,r.translateX,r.translateY)}},c=p._DPIHelper={dpr:1,_spreadCanvasCaches:[]};function se(){var e,t,n=S.screen,r=n.deviceXDPI,o=S.devicePixelRatio||(r?r/n.logicalXDPI:1);return o<=1?1:(e=20*o,t=N(e),t-e>.82?t/20:N(100*o)/100)}function ue(e,t){e&&(e._gcDPIScaleX=t)}function ce(e,t){e&&(e._gcDPIScaleY=t)}function _e(e,t){e._gcLogicWidth=t}function fe(e,t){e._gcLogicHeight=t}c._adjustDevicePixel=function(e,t,n){var r,o,i,a,l,s,u,_,f=c;if(ue(e,1),ce(e,1),(1!==(r=se())||1!==f.dpr)&&(f.dpr=r,o=t||n&&n.parent)){for(i=f._spreadCanvasCaches,l=0;l<i.length;l++)if(o===i[l].workbook){a=i[l];break}if(a||(a={workbook:o,sheets:[],canvases:[]},i.push(a)),t)a.canvases.push(e);else{for(u=a.sheets,_=0;_<u.length;_++)if(u[_].sheet===n){s=u[_];break}s||(s={sheet:n,canvases:[]},u.push(s)),s.canvases.push(e)}}},c._getScaleX=function(e){return e&&e._gcDPIScaleX||1},c._getScaleY=function(e){return e&&e._gcDPIScaleY||1},c._getLogicWidth=function(e){return e._gcLogicWidth},c._getLogicHeight=function(e){return e._gcLogicHeight},c._setSize=function(e,n,r){var o,i,a,l=c,s=l.dpr,_=l._getScaleX(e),f=l._getScaleY(e);_e(e,n),fe(e,r),1===s&&1===_&&1===f?(e.width=n,e.height=r):(o=e.getContext("2d"),u._scaleTo(o,1,1),t._browser.mozilla?(e.width=E(n*s),e.height=E(r*s)):(e.width=N(n*s),e.height=N(r*s)),e.style.width=n+P,e.style.height=r+P,i=e.width/n,a=e.height/r,i===_&&a===f||(ue(e,i),ce(e,a)),u._scaleTo(o,i,a))},c._disposeCanvasForSheet=function(e,t){var n,r,o,i,a,l=c._spreadCanvasCaches,s=e.parent;for(o=0;o<l.length;o++)if(!s||l[o].workbook===s)for(n=l[o].sheets,i=0;i<n.length;i++)if(n[i].sheet===e){for(r=n[i].canvases,a=0;a<r.length;a++)if(r[a]===t){r.splice(a,1);break}break}},c._disposeCanvasForSpread=function(e,t){var n,r,o,i=c._spreadCanvasCaches;for(r=0;r<i.length;r++)if(i[r].workbook===e)for(n=i[r].canvases,o=0;o<n.length;o++)if(n[o]===t){n.splice(o,1);break}},c._disposeSheet=function(e){var t,n,r,o=c._spreadCanvasCaches,i=e.parent;for(n=0;n<o.length;n++)if(!i||o[n].workbook===i){for(t=o[n].sheets,r=0;r<t.length;r++)t[r].sheet===e&&t.splice(r,1);return}},c._disposeSpread=function(e){var t,n=c._spreadCanvasCaches;for(t=0;t<n.length;t++)if(n[t].workbook===e)return void n.splice(t,1)},c._updateDPI=function(){var e,t,n,r,o,i,a,l,s=c,u=se();if(s.dpr!==u)for(e=s._spreadCanvasCaches,s.dpr=u,i=0;i<e.length;i++){for(n=e[i],r=n.canvases,t=n.sheets,a=0;a<t.length;a++)r=r.concat(t[a].canvases);for(l=0;l<r.length;l++)o=r[l],s._setSize(o,s._getLogicWidth(o),s._getLogicHeight(o))}},_=p._WordWrapHelper={},_._getWrapInfo=function(e,t,n){var r,o,i,a,l,s,u,c,_,f=[];if(0===e.length)return f;if(!(r=de()))return f;if(r.font=n,t<=0){for(o=-1,i=!0,a=0;a<e.length;a++)l=e.charAt(a),l===L||i?l!==L&&i&&(o=r.measureText(l).width,i=!1):o=F(o,r.measureText(l).width);if((t=o)<=0)return[e]}for(s=e.split(/\r\n|\r|\n/),u=0;u<s.length;u++)if(c=me(s[u],t))if(0===c.length)f.push("");else for(_=0;_<c.length;_++)f.push(c[_]);return f},_._measureText=function(e,t,n){var r,o=de();return o?(t&&(o.font=t),r=n?ge(e):e,o.measureText(r).width):0};function de(){return _._ctx||(_._ctx=U("canvas").getContext("2d")),_._ctx}function he(e){var t,n,r,o=[],i=0,a=L;for(t=0;t<e.length;t++)o[i]===A&&(o[i]=""),n=e.charAt(t),r="",t+1<e.length&&(r=e.charAt(t+1)),n===a&&r!==a?(o[i]+=n,i++):o[i]+=n;return o}function ge(e){for(var t=e.length-1;" "===e.charAt(t);)t--;return t!==e.length-1&&(e=e.substring(0,t+1)),e}function pe(e,t){var n,r,o,i,a,l,s,u,c,_=[],f=de();if(!f)return _;for(n=f.measureText(e).width,r=n/e.length,o=E(t/r);n>t&&e;)for(i=!1,a=o;;){if(e.length<a){_.push(e),e="";break}if(l=e.substring(0,a),(s=f.measureText(l).width)===t||i&&s<t){_.push(l),e=e.substring(a),n-=s;break}if(s>t){if(1===l.length){u=e.substring(l.length),u.trim()?(_.push(l),e=e.substring(a),n-=s):(_.push(e),e="");break}a-=1,i=!0}else c=(t-s)/r,c=c>=1?c:1,a+=c}return e&&_.push(e),_}function me(e,t){var n,r,o,i,a,l,s,u,c,f,d,h,g,p,m=[],v=he(e),C=de();if(!C)return m;for(n=C.measureText(e).width,r=n/e.length,o=V(t/r+"",10),i=0,a=0,l=0,s=0,u=[],c=!1;s<v.length;){if(!1===c){if(f=v[s],u.push(f),(a+=f.length)<o&&s<v.length-1){s++;continue}l=a,a=0}if((d=_._measureText(u.join(""),A,!0))>t)if(h=u.pop(),0===u.length){for(g=pe(h,t),p=0;p<g.length-1;p++)m[i++]=g[p];g.length>=2?v[s]=g[g.length-1]:s++,c=!1}else c=!0,s--;else d<t&&!0===c||d===t?(c=!1,m[i++]=ge(u.join("")),u=[],s++):d<t&&(s++,a=l)}return 0!==u.length&&(m[i]=ge(u.join(""))),m}p._defineFeature=function(e){e._registerFeature=function(t,n){var r,o;for(e._features||(e._features=[]),r=e._features,n.name=t,n.priority=n.priority||5e3,o=0;;o++)if(o>=r.length||n.priority>r[o].priority){r.splice(o,0,n);break}},e._callFeatureHandler=function(t,n,r){var o,i,a=e._features;if(a)for(o=0;o<a.length;o++)(i=a[o][n])&&i.call(t,r)}},e.exports=p}()},function(e,t,n){!function(){"use strict";var t,r,o,i=n(5),a=i._Types,l=i._hasOwnProperty,s=void 0,u=null,c=parseFloat,_=document,f="_nonamespace",d="events",h="get",g="set",p="width",m="height",v="left",C="right",w="top",y="bottom",S="hidden",x="block",b="none",T="position",R="visibility",A="display",I={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},M={tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex"),n=/^(?:input|select|textarea|button|object)$/i,r=/^(?:a|area)$/i,o=e.nodeName;return t&&t.specified?parseInt(t.value,10):n.test(o)||r.test(o)&&e.href?0:s}}},E={option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,o=e.selectedIndex,i="select-one"===e.type||o<0,a=i?u:[],l=i?o+1:r.length,s=i?o:0;for(o<0&&(s=l);s<l;s++)if(n=r[s],(n.selected||s===o)&&!n.disabled&&(!n.parentNode.disabled||!L(n.parentNode,"optgroup"))){if(t=H(n).val(),i)return t;a.push(t)}return a},set:function(e,t){var n=H.makeArray(t);return H(e).find("option").getAll().forEach(function(e){e.selected=H.inArray(H(e).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},F={},D="GC$"+(""+Math.random()).replace(/\D/g,""),N=1,V={};[m,p].forEach(function(e){V[e]={get:function(t){var n,r,o,i=getComputedStyle(t),a=t.style,l=a[T],s=a[R],u=a[A],c=0===t.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(i[A]);if(c&&(a[T]="absolute",a[R]=S,a[A]=x),n=i&&i[e],c&&(a[T]=l,a[R]=s,a[A]=u),""===n){for(r=t.parentElement,o=_.body;r&&r!==o;)r=r.parentElement;r!==o&&(n=a[e])}return n}}});function O(e,t){var n,r;for(Array.call(this),"string"==typeof e?n=(t||_).querySelectorAll(e):e&&(n=a._isArray(e)||e instanceof HTMLCollection?e:[e]),r=0;n&&r<n.length;r++)this.push(n[r])}function H(e,t){return e instanceof O?e:new O(e,t)}t={get:function(e){return this[e]},getAll:function(){return this},bind:function(e,t,n){var r=this;return Z(n)&&(n=t,t=s),r.forEach(function(r){var o,i,a,l,u,c,_=U(r,d,s,!0);_||(_={},U(r,d,_,!0)),o=e.split("."),i=o[0],a=o[1]||f,l=_[a],l||(l=_[a]={}),u=function(e){Z(t)||(e.data=t);var o=n.apply(r,arguments);e.result=o,!1===o&&(e.preventDefault?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!1,e.returnValue=!1))},u.original=n,c=l[i],c||(c=l[i]=[]),c.push(u),r.addEventListener(i,u)}),r},unbind:function(e,t){var n=this;return n.forEach(function(n){var r,o,i,a,u=e.split("."),c=u[0],_=u[1]||f,h=U(n,d,s,!0),g=h&&h[_];if(t){if(g&&c&&(r=g[c]))for(o=0,i=r.length;o<i;o++)if(r[o].original===t){te(n,c,r[o]),r.splice(o,1);break}}else if(g)if(c){if(r=g[c])for(o=0,i=r.length;o<i;o++)te(n,c,r[o]);g[c]=s}else{for(a in g)if(l(g,a)&&(r=g[a]))for(o=0,i=r.length;o<i;o++)te(n,a,r[o]);h[_]=s}}),n},trigger:function(e,t){var n,r,o,i,a,u,c,_,f,h,g,p=this;for(n=0,r=p.length;n<r;n++)if(o=p[n],i=U(o,d,s,!0)){a=e.split("."),u=a[0];for(c in i)if(l(i,c)&&(_=i[c],f=_&&_[u]))for(h=0,g=f.length;h<g;h++)f[h].apply(o,[{type:u},t])}return p},css:function(e,t){var n,r,o,i=this,a=i,s=arguments.length;function u(e,t){a.forEach(function(n){n.style[e]=k(e,t)})}if(1===s){if(!K(e))return n=i[0],(r=V[e])&&h in r?r.get(n):(o=getComputedStyle(n))&&o[e];a.forEach(function(t){for(var n in e)l(e,n)&&(t.style[n]=k(n,e[n]))})}else 2===s&&(Array.isArray(e)&&Array.isArray(t)&&e.length===t.length?e.forEach(function(e,n){u(e,t[n])}):u(e,t));return i},width:J(!0),height:J(),innerWidth:q(!0),innerHeight:q(),outerWidth:Q(!0),outerHeight:Q(),append:function(e){var t,n,r=[e];return e instanceof H&&(r=e.getAll()),t=this,n=t[0],r.forEach(function(e){e&&n.appendChild(e)}),t},appendTo:function(e){var t,n=e;return e instanceof H&&(n=e[0]),t=this,t.forEach(function(e){n.appendChild(e)}),t},prepend:function(e){var t=this,n=t[0];return n.insertBefore(e,n.firstChild),t},insertBefore:function(e){var t=this,n=e.parentElement;return t.forEach(function(t){n.insertBefore(t,e)}),t},addClass:function(e){var t,n,r,o,i,a=0,l=this,s=l.length,u=/\S+/g,c=/[\t\r\n]/g;for(t=(e||"").match(u)||[];a<s;a++)if(n=l[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(c," "):" ")){for(i=0;o=t[i++];)r.indexOf(" "+o+" ")<0&&(r+=o+" ");n.className=H.trim(r)}return this},removeClass:function(e){var t,n,r,o,i,a=0,l=this,s=l.length,u=/\S+/g,c=/[\t\r\n]/g;for(t=(e||"").match(u)||[];a<s;a++)if(n=l[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(c," "):"")){for(i=0;o=t[i++];)for(;r.indexOf(" "+o+" ")>=0;)r=r.replace(" "+o+" "," ");n.className=e?H.trim(r):""}return this},hasClass:function(e){var t,n=0,r=this,o=r.length,i=/[\t\r\n]/g;for(e=" "+e+" ";n<o;n++)if(t=r[n],1===t.nodeType&&(" "+t.className+" ").replace(i," ").indexOf(e)>=0)return!0;return!1},toggle:function(){var e=this;return e[0].style[A]===b?e.show():e.hide(),e},show:$(!0),hide:$(),attr:function(e,t){var n=this,r=n,o=arguments.length;if(1===o){if(!K(e))return n[0].getAttribute(e);r.forEach(function(t){for(var n in e)l(e,n)&&t.setAttribute(n,e[n])})}else 2===o&&r.forEach(function(n){n.setAttribute(e,t)});return n},removeAttr:function(e){return this.forEach(function(t){t.removeAttribute(e)}),this},prop:function(e,t){var n=this,r=n,o=arguments.length;if(1===o){if(!K(e))return B(n[0],e);r.forEach(function(t){for(var n in e)l(e,n)&&B(t,n,e[n])})}else 2===o&&r.forEach(function(n){B(n,e,t)});return n},removeProp:function(e){e=I[e]||e;var t=this;return t.forEach(function(t){try{t[e]=s,delete t[e]}catch(e){}}),t},text:function(e){var t=this,n=t;return 0===arguments.length?t[0].textContent:(n.forEach(function(t){t.textContent=e}),t)},val:function(e){var t,n,r,o,i=this;{if(arguments.length)return o=H.isFunction(e),i.forEach(function(n,r){var i;1===n.nodeType&&(i=o?e.call(n,r,H(n).val()):e,i===u||i===s?i="":"number"==typeof i?i+="":H.isArray(i)&&(i=H.map(i,function(e){return e===u||e===s?"":e+""})),(t=E[n.type]||E[n.nodeName.toLowerCase()])&&g in t&&!Z(t.set(n,i,"value"))||(n.value=i))}),i;if(n=i[0])return(t=E[n.type]||E[n.nodeName.toLowerCase()])&&h in t&&(r=t.get(n,"value"),!Z(r))?r:(r=n.value,j(r)?r.replace(/\r/g,""):r===u||r===s?"":r)}},position:function(){var e,t,n,r,o=this[0];if(o)return t={top:0,left:0},"fixed"===H(o).css(T)?e=o.getBoundingClientRect():(n=this.offsetParent(),e=this.offset(),r=n[0],L(r,"html")||(t=n.offset(),t.left-=r.scrollLeft,t.top-=r.scrollTop),t.top+=c(H(r).css("borderTopWidth")),t.left+=c(H(r).css("borderLeftWidth"))),{top:e.top-t.top-c(H(o).css("marginTop")),left:e.left-t.left-c(H(o).css("marginLeft"))}},offsetParent:function(){return H(H.map(this,function(e){for(var t=_.documentElement,n=e.offsetParent||t;n&&!L(n,"html")&&"static"===H(n).css(T);)n=n.offsetParent;return n||t}))},offset:function(){var e,t,n={top:0,left:0},r=this[0],o=r&&r.ownerDocument;if(o)return e=o.documentElement,Z(r.getBoundingClientRect)||(n=r.getBoundingClientRect()),t=P(o),{top:n.top+(t.pageYOffset||e.scrollTop)-(e.clientTop||0),left:n.left+(t.pageXOffset||e.scrollLeft)-(e.clientLeft||0)}},scrollLeft:ee(!0),scrollTop:ee(),html:function(e){var t=this,n=t;return 0===arguments.length?t[0].innerHTML:(n.forEach(function(t){t.innerHTML=e}),t)},remove:function(){this.forEach(function(e){var t=e.parentElement;t&&(t.removeChild(e),X([e]))})},empty:function(){return this.forEach(function(e){H(e.children).remove()}),this},find:function(e){var t=[];return j(e)&&this.forEach(function(n){var r=n.querySelectorAll(e);H.merge(t,r)}),H(t)},parent:function(){var e=[];return this.forEach(function(t){var n=t.parentElement;n&&e.push(n)}),H(e)},index:function(e){var t=this[0];return e?j(e)?H.inArray(t,H(e).getAll()):H.inArray(e,this):t&&t.parentElement?H.inArray(t,t.parentElement.children):-1},focus:function(){var e=this,t=e[0];return t!==_.activeElement&&t.focus&&t.focus(),e},isVisible:function(){var e=0;return this.forEach(function(t){var n=getComputedStyle(t);n[R]!==S&&n[A]!==b&&e++}),e>0},data:function(e,t){var n=this,r=Z(t);return r&&(n=void 0),H.each(this,function(o,i){var a=U(i,e,t);if(r)return n=a,!1}),n},removeData:function(e){return H.each(this,function(t,n){G(n,e)}),this}},r=O.prototype=[],a._extend(r,t),H.prototype=r,H.each=a._each,H.isEmptyObject=a._isEmptyObject,H.isFunction=a._isFunction,H.isArray=a._isArray,H.isNumeric=a._isNumeric,H.getType=a._getType,H.inArray=a._inArray,H.merge=a._merge,H.map=a._map,H.extend=a._extend,H.inherit=a._inherit,H.isPlainObject=a._isPlainObject,H.isArraylike=a._isArraylike,H.isWindow=a._isWindow,H.makeArray=a._makeArray,H.trim=function(e){if(e.trim)return e.trim();var t=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;return e===u||e===s?"":(e+"").replace(t,"")},H._createElement=function(e,t,n,r,o){var i=H(_.createElement(e));return t&&n&&i.css(t,n),r&&i.addClass(r),o&&(o instanceof H?o.append(i):H(o).append(i)),i};function P(e){return H.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}function L(e,t){var n=e.nodeName;return n&&n.toLowerCase()===t.toLowerCase()}function k(e,t){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(e)>=0&&isFinite(t)?("width height".split(" ").indexOf(e)>=0&&t<0&&(t=0),t+"px"):t}function B(e,t,n){var r,o,i,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return i=1!==a,i&&(t=I[t]||t,o=M[t]),Z(n)?o&&h in o&&(r=o.get(e,t))!==u?r:e[t]:o&&g in o&&(r=o.set(e,n,t),!Z(r))?r:(e[t]=n,n)}function W(e){var t,n,r,o=e.nodeType;return(!o||1===o||9===o)&&(t={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},n=e.nodeName,!(r=n&&t[n.toLowerCase()])||!0!==r&&e.getAttribute("classid")===r)}function z(e){return e.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,function(e,t){return t.toUpperCase()})}function U(e,t,n,r){if(W(e)){var o,i,a=D,l=j(t),c=e.nodeType,_=c?F:e,f=c?e[a]:e[a]&&a;if(f&&_[f]&&(r||_[f].data)||!l||!Z(n))return f||(c?e[a]=f=N++:f=a),_[f]||(_[f]={},c||(_[f].toJSON=function(){})),(K(t)||"function"==typeof t)&&(r?_[f]=H.extend(_[f],t):_[f].data=H.extend(_[f].data,t)),o=_[f],r||(o.data||(o.data={}),o=o.data),Z(n)||(o[z(t)]=n),l?(i=o[t])!==u&&i!==s||(i=o[z(t)]):i=o,i}}function Y(e){var t;for(t in e)if(("data"!==t||!H.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function G(e,t,n){if(W(e)){var r,o,i,a=e.nodeType,l=a?F:e,s=a?e[D]:D;if(l[s]){if(t&&(i=n?l[s]:l[s].data)){H.isArray(t)?t=t.concat(H.map(t,z)):t in i?t=[t]:(t=z(t),t=t in i?[t]:t.split(" "));for(r=0,o=t.length;r<o;r++)delete i[t[r]];if(!(n?Y:H.isEmptyObject)(i))return}(n||(delete l[s].data,Y(l[s])))&&(a?X([e],!0):l!==l.window?delete l[s]:l[s]=u)}}}function X(e,t){for(var n,r,o,i,a,s,c,_,f,d,h=0,g=D,p=F;(n=e[h])!==u&&void 0!==n;h++)if((t||W(n))&&(r=n[g],
o=r&&p[r])){if(i=o.events)for(a in i)if(l(i,a)&&(s=i[a]))for(c in s)if(l(s,c)&&(_=s[c]))for(f=0,d=_.length;f<d;f++)te(n,a,_[f]);p[r]&&(delete p[r],delete n[g])}}function j(e){return"string"==typeof e}function K(e){return"object"==typeof e}function Z(e){return typeof e==typeof s}function J(e){var t=e;return function(e){var n,r=this,o="border-box"===r.css("box-sizing"),i=t?p:m,a=t?v:w,l=t?C:y;return 0===arguments.length?(n=Math.round(c(r.css(i)))||0,o&&(n-=c(r.css("padding-"+a))+c(r.css("padding-"+l))+c(r.css("border-"+a+"-"+p))+c(r.css("border-"+l+"-"+p))),n):(r.css(i,e),r)}}function q(e){var t=e;return function(){var e=this,n=t?v:w,r=t?C:y;return t?e.width():e.height()+c(e.css("padding-"+n))+c(e.css("padding-"+r))}}function Q(e){var t=e;return function(e){var n=t?v:w,r=t?C:y,o=this,i=t?o.innerWidth():o.innerHeight();return i+=c(o.css("border-"+n+"-"+p))+c(o.css("border-"+r+"-"+p)),e&&(i+=c(o.css("margin-"+n))+c(o.css("margin-"+r))),i}}function $(e){var t=e;return function(e){return this.forEach(function(n){n.style[A]=t?x:b,e&&e.apply(n)}),this}}function ee(e){var t=e;return function(e){var n="scrollLeft",r="scrollTop",o=t?n:r,i=t?"pageXOffset":"pageYOffset",a=this,l=a[0],s=P(l);return Z(e)?s?i in s?s[i]:_.documentElement[o]:l[o]:(s?s.scrollTo(t?e:H(s)[n](),t?H(s)[r]():e):l[o]=e,a)}}function te(e,t,n){e.removeEventListener(t,n)}o=n(1),o.GC$=H,e.exports=o}()},function(e,t){e.exports=GC.Spread.Common},function(e,t){e.exports=GC.Spread.Formatter},function(e,t){!function(){"use strict";e.exports={_pri:function(){},_pt:0}}()},function(e,t,n){!function(){"use strict";var t=n(1),r=n(4).GC$,o=n(3),i=o._util._createElement,a=o._util,l=a._browser,s=a._cancelDefault,u=window._gcGlobal,c=document,_=function(){function e(e,t){var n=this;n._host=e,n._gcPopupClass="gc-popup",n._overlayClass="gc-overlay",t=t||0,n._defaultOverlayCSS={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:t,backgroundColor:"rgba(0,0,0,0)"},n._defaultContainerCSS={position:"absolute",padding:0,margin:0,height:"auto",zIndex:t+1,outline:"none"},n._init()}return e.prototype={constructor:e,_init:function(){var e=this;e._hasTargetContainer(e._name)?e._container=r("#"+e._name):(e._name=e._generateName(),e._container=r(i("div")).addClass(e._gcPopupClass+" ui-widget").attr({id:e._name,tabIndex:-1}).css(e._defaultContainerCSS))},_generateName:function(){for(var e=0,t="gc-dialog";this._hasTargetContainer(t+""+e);)e++;return t+""+e},_getContainer:function(){if(this._container)return this._container},_getHost:function(){return this._host?this._host:c.body},_show:function(e){var t=this,n=t._container;t._hasOverlay()||t._createOverlay(),u._suspendEvent(),t._hasTargetContainer(t._name)||(r(t._getHost()).append(n),t._resetDialogPosition(),n.css("display","none")),n.show(e)},close:function(){var e=this;e._hasTargetContainer(e._name)&&e._container.remove(),r("."+e._gcPopupClass).isVisible()||e._closeOverlay(),u._resumeEvent()},_closeOverlay:function(){r("."+this._overlayClass).remove()},_resetDialogPosition:function(){var e,t,n,o,i,a,l,s,u,_,f,d=this._container,h=this._getHost();0!==d.length&&(e=r(h).offset(),t=parseInt(d.css("left"))+e.left,n=parseInt(d.css("top"))+e.top,o=d.width(),i=d.height(),isNaN(t)||isNaN(n)||isNaN(o)||isNaN(i)||(a=0,l=0,s=c.documentElement,u=s.clientWidth,_=s.clientHeight,f=d[0].getBoundingClientRect(),f.left+o>u&&(l=f.left+o-u),f.top+i>_&&(a=f.top+i-_),(t<0||n<0||a>0||l>0)&&(t-=l,n-=a,t<0&&(t=0),n<0&&(n=0),d.css({left:t-e.left+"px",top:n-e.top+"px"}))))},_hasTargetContainer:function(e){return r("#"+e).length>0},_createOverlay:function(){var e,t,n=this,o=r(i("div")).addClass(n._overlayClass);o.css(n._defaultOverlayCSS),r(n._host).append(o),e=l&&l.mozilla,e&&(t=(new Date).valueOf()),o.bind("mousedown",function(r){if(e){if((new Date).valueOf()-t<100)return}n.close(),e&&n._delayCloseTimeout&&clearTimeout(n._delayCloseTimeout),s(r)}),"touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){o.bind(t,function(t){e?n._delayCloseTimeout=setTimeout(function(){n.close()},100):n.close(),s(t)})})},_hasOverlay:function(){return r("."+this._overlayClass).length>0}},e}();t._BaseDialog=_,e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r=n(4).GC$,o=".gcSheet";function i(e){var t=this;t._imageCount=0,t._loadedCount=0,t._onLoadedComplete=e,t._imgs={}}i.prototype={_addImage:function(e){var t,n,i,a=this;function l(){a._imageLoaded(e)}t=a._imgs,(n=t[e])||(i=r(document.createElement("img")),i.bind("load"+o,l),i.bind("error"+o,l),i.bind("abort"+o,l),a._imageCount++,t[e]={_state:!1,_img:i[0]},i[0].src=e)},_getState:function(e){var t=this._imgs[e];return!!t&&t._state},_getImage:function(e){var t=this._imgs[e];return t?t._img:null},_imageLoaded:function(e){var t=this;t._loadedCount++,t._imgs[e]._state=!0,t._isAllImagesLoaded()&&t._onLoadedComplete&&t._onLoadedComplete()},_isAllImagesLoaded:function(){return this._loadedCount>=this._imageCount},_dispose:function(){var e,t,n=this._imgs;if(n)for(e in n)n[e]&&(t=r(n[e]._img),t.unbind(o));this._onLoadedComplete=null}},t=n(1),t._ImageLoader=i,e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v=n(5),C=v._Types._isNullOrUndefined,w=v._ColorHelper,y=w._fromString,S=parseInt,x=n(3),b=x._util._defProperty;function T(e){var t=e;return function(n){return 0===arguments.length?this._colorList[t]:(this._colorList[e]=y(n),this)}}t=0,r=1,o=2,i=3,a=4,l=5,s=6,u=7,c=8,_=9,f=10,d=11,h=function(){function e(e,t,n,r,o,i,a,l,s,u,c,_,f){this._name=e,this._colorList=[];for(var d=1;d<13;d++)this._colorList.push(y(arguments[d]))}return e.prototype={constructor:e,name:function(e){return 0===arguments.length?this._name:(this._name=e,this)},background1:T(t),background2:T(r),textColor1:T(o),textColor2:T(i),accent1:T(a),accent2:T(l),accent3:T(s),accent4:T(u),accent5:T(c),accent6:T(_),hyperlink:T(f),followedHyperlink:T(d),getColor:function(e){var t,n,r,o,i;if(e&&(t=e.split(" "))){if(r=-1,(o=t.length)>1){if(!t[0])return e;n=t[0].toLowerCase(),"background"===n?r=S(t[1],10)-1:"text"===n?r=S(t[1],10)+1:"accent"===n&&(r=S(t[1],10)+3)}else 1===o&&(n=t[0].toLowerCase(),"hyperlink"===n?r=f:"followedhyperlink"===n&&(r=d));if(r>=0&&r<=11)return o>2?(i=S(t[2],10)/100,w._toString(w._applyTint(this._colorList[r],i))):w._toString(this._colorList[r])}return e},toJSON:function(){var e=this,n=e._colorList;return{name:e._name,background1:n[t],background2:n[r],text1:n[o],text2:n[i],accent1:n[a],accent2:n[l],accent3:n[s],accent4:n[u],accent5:n[c],accent6:n[_],hyperlink:n[f],followedHyperlink:n[d]}},fromJSON:function(e,n){var h,g,p,m,v,w,y,S,x,b,T,R,A,I,M,E,F;function D(e,t){C(t)||(h._colorList[e]={a:t.a,r:t.r,g:t.g,b:t.b})}e&&(h=this,g="_colorList",p="_name",n?(m=e.name?e.name:e[p],C(m)||(h._name=m),v=e.colorList?e.colorList:e[g],w=v[t],y=v[r],S=v[o],x=v[i],b=v[a],T=v[l],R=v[s],A=v[u],I=v[c],M=v[_],E=v[f],F=v[d]):(C(e.name)||(h._name=e.name),w=e.background1,y=e.background2,S=e.text1,x=e.text2,b=e.accent1,T=e.accent2,R=e.accent3,A=e.accent4,I=e.accent5,M=e.accent6,E=e.hyperlink,F=e.followedHyperlink),D(t,w),D(r,y),D(o,S),D(i,x),D(a,b),D(l,T),D(s,R),D(u,A),D(c,I),D(_,M),D(f,E),D(d,F))},_compare:function(e){var t,n,r,o;if(this.name()!==e.name())return!1;for(t=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"],n=0,r=t.length;n<r;n++)if(o=t[n],!w._equal(this[o](),e[o]()))return!1;return!0}},e}(),g=function(){function e(e,t,n,r){var o=this;o.name(e),o.colors(t||new h(e)),o.headerFont(n),o.bodyFont(r)}return e.prototype={name:b("name"),colors:b("colors"),headerFont:b("headerFont"),bodyFont:b("bodyFont"),getColor:function(e){return this.colors().getColor(e)},getFont:function(e){return"Body"===e?this.bodyFont():"Headings"===e?this.headerFont():e},toJSON:function(){var t=this,n=t.name();return e._isBuiltInTheme(t)?n:{name:n,themeColor:t.colors()?t.colors().toJSON():void 0,headingFont:t.headerFont(),bodyFont:t.bodyFont()}}},e._isBuiltInTheme=function(e){var t,n=e.name();return!!m[n]&&(t=m[n],e.bodyFont()===t.bodyFont()&&e.headerFont()===t.headerFont()&&e.colors()._compare(t.colors()))},e}(),p=function(){var e,t;function n(){}return e="#000000",t="#FFFFFF",n.Default=new h("Default",t,"#EEECE1",e,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),n.Office2007=new h("Office2007",t,"#EEECE1",e,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),n.Office=new h("Office",t,"#E7E6E6",e,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),n.Apex=new h("Apex",t,"#C9C2D1",e,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),n.Aspect=new h("Aspect",t,"#E3DED1",e,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),n.Concourse=new h("Concourse",t,"#DEF5FA",e,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),n.Civic=new h("Civic",t,"#C5D1D7",e,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),n.Oriel=new h("Oriel",t,"#FFF39D",e,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),n.Origin=new h("Origin",t,"#DDE9EC",e,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),n.Paper=new h("Paper",t,"#FEFAC9",e,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),n.Solstice=new h("Solstice",t,"#E7DEC9",e,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),n.Technic=new h("Technic",t,"#D4D2D0",e,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),n.Trek=new h("Trek",t,"#FBEEC9",e,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),n.Urban=new h("Urban",t,"#DEDEDE",e,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),n.Verve=new h("Verve",t,"#D2D2D2",e,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),n.Equity=new h("Equity",t,"#E9E5DC",e,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),n.Flow=new h("Flow",t,"#DBF5F9",e,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),n.Foundry=new h("Foundry",t,"#EAEBDE",e,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),n.Median=new h("Median",t,"#EBDDC3",e,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),n.Metro=new h("Metro",t,"#D6ECFF",e,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),n.Module=new h("Module",t,"#D4D4D6",e,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),n.Opulent=new h("Opulent",t,"#F4E7ED",e,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),n}(),m={Default:new g("Default",p.Default,"Cambria","Calibri"),Office:new g("Office",p.Office,"Calibri Light","Calibri"),Office2007:new g("Office2007",p.Office2007,"Cambria","Calibri"),Apex:new g("Apex",p.Apex,"Lucida Sans","Book Antiqua"),Aspect:new g("Aspect",p.Aspect,"Verdana","Verdana"),Concourse:new g("Concourse",p.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),Civic:new g("Civic",p.Civic,"Georgia","Georgia"),Oriel:new g("Oriel",p.Oriel,"Century Schoolbook","Century Schoolbook"),Origin:new g("Origin",p.Origin,"Bookman Old Style","Gill Sans MT"),Paper:new g("Paper",p.Paper,"Constantia","Constantia"),Solstice:new g("Solstice",p.Solstice,"Gill Sans MT","Gill Sans MT"),Technic:new g("Technic",p.Technic,"Franklin Gothic Book","Arial"),Trek:new g("Trek",p.Trek,"Franklin Gothic Medium","Franklin Gothic Book"),Urban:new g("Urban",p.Urban,"Trebuchet MS","Georgia"),Verve:new g("Verve",p.Verve,"Century Gothic","Century Gothic"),Equity:new g("Equity",p.Equity,"Franklin Gothic Book","Perpetua"),Flow:new g("Flow",p.Flow,"Calibri","Constantia"),Foundry:new g("Foundry",p.Foundry,"Rockwell","Rockwell"),Median:new g("Median",p.Median,"Tw Cen MT","Tw Cen MT"),Metro:new g("Metro",p.Metro,"Consolas","Corbel"),Module:new g("Module",p.Module,"Corbel","Corbel"),Opulent:new g("Opulent",p.Opulent,"Trebuchet MS","Trebuchet MS")},x.ColorScheme=h,x.ThemeColors=p,x.Theme=g,x.Themes=m,e.exports=x}()},function(e,t,n){!function(){"use strict";var t,r=n(1),o=n(4).GC$,i=n(3)._util,a=document,l=Math.floor,s=Math.max,u=void 0,c=r._DefaultFontSize="11pt";function _(){}_._composeFont=function(e,t){return t?_._normalizeFont(e,t):e},_._splitFont=function(e){var t,n;return e?(t=_._getMeasureSpan(),t.style.font=e,n=t.style,{fontFamily:n.fontFamily,fontSize:n.fontSize,fontStyle:n.fontStyle,fontWeight:n.fontWeight}):{}},_._buildFontString=function(e){var t,n,r,o,a,l,s;return i._browser.safari?e.font:(t="",n="normal",r="400",o=e.fontStyle,a=e.fontVariant,l=e.fontWeight,s=e.lineHeight,o!==n&&(t=o),a!==n&&(t+=(t?" ":"")+a),l!==n&&l!==r&&(t+=(t?" ":"")+l),t+=(t?" ":"")+e.fontSize,s!==n&&(t+="/"+s),t+=" "+e.fontFamily)},_._normalizeFont=function(e,t){var n,r,i,l,s;if(!e&&!t)return e;if(e){if(r=t?e+"+"+t:e,i=_._fontStringCache[r])return i;n=_._getMeasureSpan(),o(n).css("font",e)}else{if(r=t,i=_._fontStringCache[r])return i;n=_._getMeasureSpan(),o(n).css("fontSize",c),o(n).css("fontFamily",t)}return l=n.currentStyle,s=a.defaultView,s&&s.getComputedStyle&&(l=s.getComputedStyle(n,"")),i=_._buildFontString(l),_._fontStringCache[r]=i,_._fontStringCache[i]=i,i},_._scaleFont=function(e,t,n,r){var o,i,u,c,f,d,h,g,p,m=_._scaleFontInfoCache[t];if(!r)if(m){if(o=m[e])return o}else m=_._scaleFontInfoCache[t]={};return i=_._getMeasureSpan(),i.style.font=e,u=i.currentStyle,c=a.defaultView,c&&c.getComputedStyle&&(u=c.getComputedStyle(i,"")),f=u.fontSize,d="px",-1!==f.indexOf(d)&&(h=s(1,l(parseFloat(f.replace(d,""))*t)),n&&1===h&&(n.value=!0),f=h+d),g=u.lineHeight,-1!==g.indexOf(d)&&(p=s(1,l(parseFloat(g.replace(d,""))*t)),g=p+d),1===t?o={font:e,fontSize:h}:(i.style.fontSize=f,i.style.lineHeight=g,o={font:i.style.font,fontSize:h}),r||(m[e]=o),o},_._getMeasureSpan=function(){var e,t,n;return _._measureSpan?_._measureSpan.style.cssText=_._measureSpanOriginalStyleText:(e="-10000px",t=i._createElement("span"),n=t.style,n.visibility="hidden",n.top=e,n.left=e,n.lineHeight="normal",n.position="absolute",n.fontWeight="normal",n.fontStretch="normal",n.fontVariant="normal",n.fontStyle="normal",a.body.insertBefore(t,null),_._measureSpan=t,_._measureSpanOriginalStyleText=n.cssText),_._measureSpan},_._dispose=function(){var e=_._measureSpan;e&&(o(e).remove(),_._measureSpan=u,_._measureSpanOriginalStyleText=u)},t={},_._setStringFont=function(e,n){var r,o=e+","+n,i=t,a=i[o];return a||(r=_._getMeasureSpan(),r.style.font=e,n&&(r.style.fontWeight=n),a=i[o]=r.style.font),a},_._fontStringCache={},_._scaleFontInfoCache={},_._composeTextDecoration=function(e){if(e<=0)return"none";var t="";return(1|e)===e&&(t+="underline "),(2|e)===e&&(t+="line-through "),(4|e)===e&&(t+="overline "),t.trim()},r._StyleHelper=_,e.exports=r}()},function(e,t,n){!function(){"use strict";var t,r=n(1),o=n(4).GC$,i=n(3),a=n(11)._StyleHelper,l=o.each,s=i._util,u=s._isDefined,c=void 0,_=null,f="autoFormatter",d="formatter",h="cellType",g="hAlign",p="vAlign",m="imeMode",v="labelOptions",C={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0};r.HorizontalAlign={left:0,center:1,right:2,general:3},r.VerticalAlign={top:0,center:1,bottom:2},r.ImageLayout={stretch:0,center:1,zoom:2,none:3},r.LineStyle={empty:0,thin:1,medium:2,dashed:3,dotted:4,thick:5,double:6,hair:7,mediumDashed:8,dashDot:9,mediumDashDot:10,dashDotDot:11,mediumDashDotDot:12,slantedDashDot:13},r.TextDecorationType={underline:1,lineThrough:2,overline:4,none:0},r.LineBorderComposeLevel={conditionalFormat:1,cell:10,table:20,row:30,column:40,sheet:50},r.LabelAlignment={topLeft:0,topCenter:1,topRight:2,bottomLeft:3,bottomCenter:4,bottomRight:5},r.LabelVisibility={visible:0,hidden:1,auto:2};function w(e,t,n){this.color=e||"black",this.style=t||0,this.level=n}w.prototype={constructor:w,_clone:function(){return new w(this.color,this.style,this.level)},toJSON:function(){var e={},t=this,n=t.color,r=t.style;return"black"!==n&&(e.color=n),0!==r&&(e.style=r),e},fromJSON:function(e){if(e){var t=this,n=e.color,r=e.style;u(n)&&(t.color=n),u(r)&&(t.style=r)}}},w._width=function(e){return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[e&&e.style]||0},r.LineBorder=w,t=["backColor","foreColor",g,p,"font","themeFont",d,"borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","shrinkToFit","backgroundImage",h,"backgroundImageLayout","tabStop","textDecoration",m,"name","parentName","watermark","cellPadding",v,"quotePrefix"];function y(){var e,n,r=this;if(r._id=y._styleId++,e=arguments,0!==e.length)for(n=0;n<t.length;n++)r[t[n]]=e[n]}function S(e,t,r,o){var a,l,s,u,_=t;if(r&&t){if(a=t._cloneCellType&&t._cloneCellType())return void(e.cellType=_);t.toJSON&&(t=t.toJSON()),l=n(13).CellTypes._typeDict,s=t.typeName,u=l[t.type]||l[s]||i.getTypeFromString(s),u?(_=new u,_.fromJSON(t,o)):_=c}e.cellType=_}function x(e,t,r){var o,a,l,s,u=t;r&&t&&"object"==typeof t&&(t.toJSON&&(t=t.toJSON()),o=n(6),(a=o&&o.GeneralFormatter)&&(l=t.typeName,l?(s=i.getTypeFromString(l))&&(u=new s,u.fromJSON(t)):u=new a(t.formatCached,t.customerCultureName))),e.formatter=u}function b(e,t,r){var o,i,a=t;r&&t&&(t.toJSON&&(t=t.toJSON()),o=n(6),(i=o&&o.GeneralFormatter)&&(a=new i(t.formatCached,t.customerCultureName),a.isAuto=!0)),e._autoFormatter=a}function T(e,t,n){t&&(t=e.getColor(t))&&n(t)}function R(e,t,n){return e===g?2===n?1===t:1===n?1===t:3===t:e===p?2===n?1===t:1===n?1===t:0===t:e===m?1===t:e===f?t===c:void 0}y.prototype={constructor:y,_compose:function(e,t,n){var r,o,i,a,l,s=this,u=e.labelOptions;t?(s._autoFormatter=e._autoFormatter,s.backgroundImage=e.backgroundImage,s.backgroundImageLayout=e.backgroundImageLayout,s.backColor=e.backColor,s.foreColor=e.foreColor,s.hAlign=e.hAlign,s.vAlign=e.vAlign,s.font=e.font,s.themeFont=e.themeFont,s.formatter=e.formatter,r=e.borderLeft,s.borderLeft=r&&r._clone()||r,s.borderLeft&&n&&(s.borderLeft.level=n),o=e.borderTop,s.borderTop=o&&o._clone()||o,s.borderTop&&n&&(s.borderTop.level=n),i=e.borderRight,s.borderRight=i&&i._clone()||i,s.borderRight&&n&&(s.borderRight.level=n),a=e.borderBottom,s.borderBottom=a&&a._clone()||a,s.borderBottom&&n&&(s.borderBottom.level=n),s.locked=e.locked,s.textIndent=e.textIndent,s.wordWrap=e.wordWrap,s.shrinkToFit=e.shrinkToFit,s.overflow=e.overflow,s.cellType=e.cellType,s.name=e.name,s.parentName=e.parentName,s.tabStop=e.tabStop,s.textDecoration=e.textDecoration,s.imeMode=e.imeMode,s.watermark=e.watermark,s.cellPadding=e.cellPadding,u&&(s.labelOptions={alignment:u.alignment,font:u.font,foreColor:u.foreColor,visibility:u.visibility,margin:u.margin}),s.quotePrefix=e.quotePrefix):(s.backgroundImage===c&&(s.backgroundImage=e.backgroundImage),s.backgroundImageLayout===c&&(s.backgroundImageLayout=e.backgroundImageLayout),s.backColor===c&&(s.backColor=e.backColor),s.foreColor===c&&(s.foreColor=e.foreColor),s.hAlign===c&&(s.hAlign=e.hAlign),s.vAlign===c&&(s.vAlign=e.vAlign),s.themeFont===c&&s.font===c?(s.themeFont=e.themeFont,s.font=e.font):s.themeFont!==c&&s.font===c&&(s.font=e.font),s.formatter===c&&(s.formatter=e.formatter),s._autoFormatter===c&&(s._autoFormatter=e._autoFormatter),s.borderLeft===c&&(r=e.borderLeft,s.borderLeft=r&&r._clone()||r,s.borderLeft&&n&&(s.borderLeft.level=n)),s.borderTop===c&&(o=e.borderTop,s.borderTop=o&&o._clone()||o,s.borderTop&&n&&(s.borderTop.level=n)),s.borderRight===c&&(i=e.borderRight,s.borderRight=i&&i._clone()||i,s.borderRight&&n&&(s.borderRight.level=n)),s.borderBottom===c&&(a=e.borderBottom,s.borderBottom=a&&a._clone()||a,s.borderBottom&&n&&(s.borderBottom.level=n)),s.locked===c&&(s.locked=e.locked),s.textIndent===c&&(s.textIndent=e.textIndent),s.wordWrap===c&&(s.wordWrap=e.wordWrap),s.shrinkToFit===c&&(s.shrinkToFit=e.shrinkToFit),s.overflow===c&&(s.overflow=e.overflow),s.cellType===c&&(s.cellType=e.cellType),s.tabStop===c&&(s.tabStop=e.tabStop),s.textDecoration===c&&(s.textDecoration=e.textDecoration),s.imeMode===c&&(s.imeMode=e.imeMode),s.name===c&&(s.name=e.name),s.parentName===c&&(s.parentName=e.parentName),s.watermark===c&&(s.watermark=e.watermark),s.cellPadding===c&&(s.cellPadding=e.cellPadding),!s.labelOptions&&u&&(s.labelOptions={}),l=s.labelOptions,l&&u&&(l.alignment===c&&(l.alignment=u.alignment),l.font===c&&(l.font=u.font),l.foreColor===c&&(l.foreColor=u.foreColor),l.visibility===c&&(l.visibility=u.visibility),l.margin===c&&(l.margin=u.margin)),s.quotePrefix===c&&(s.quotePrefix=e.quotePrefix))},_clear:function(e){var n=this;0===arguments.length?l(t,function(e,t){n[t]=c}):n[e]=c},clone:function(e){var t=this,n=t.borderLeft,r=t.borderTop,o=t.borderRight,i=t.borderBottom,a=new y(t.backColor,t.foreColor,t.hAlign,t.vAlign,t.font,t.themeFont,c,n&&!e&&n._clone()||n,r&&!e&&r._clone()||r,o&&!e&&o._clone()||o,i&&!e&&i._clone()||i,t.locked,t.textIndent,t.wordWrap,t.shrinkToFit,t.backgroundImage,c,t.backgroundImageLayout,t.tabStop,t.textDecoration,t.imeMode,t.name,t.parentName,t.watermark,t.cellPadding,t.labelOptions,t.quotePrefix);return x(a,t.formatter,!e),b(a,t._autoFormatter,!e),S(a,t.cellType,!e,!0),a.overflow=t.overflow,a},_normalize:function(e){var t,n,r,o,i,l,s=this;if(e&&e.getColor)for(T(e,s.foreColor,function(e){s.foreColor=e}),T(e,s.backColor,function(e){s.backColor=e}),t=[s.borderLeft,s.borderTop,s.borderRight,s.borderBottom],n=0,r=t.length;n<r;n++)(o=t[n])&&o.color&&T(e,o.color,function(e){o.color=e});return i=s.themeFont,l=s.font,e&&e.getFont&&(i?s.font=a._composeFont(l,e.getFont(i)):l||(s.font=a._composeFont(l,e.bodyFont()))),s},_setActualAutoFormatter:function(e){var t,n=this,r=n._autoFormatter;r&&e!==_&&(t=r.getPreferredEditingFormatter(e),t.isAuto=!0,n._autoFormatter=t)},toJSON:function(e,n){var r,i,a=this,l={},s=a._autoFormatter;for(!u(s)||n&&R(f,s,e)||(s.toJSON&&(s=s.toJSON()),o.isEmptyObject(s)||(l[f]=s)),r=0;r<t.length;r++)i=t[r],s=a[i],i!==v||o.isEmptyObject(s)?!u(s)||n&&R(i,s,e)||(l[i]=s&&s.toJSON?s.toJSON():s):l[v]=s;return void 0!==a.overflow&&(l.overflow=a.overflow),o.isEmptyObject(l)?c:l},fromJSON:function(e,t){var n,r,o,i,a;if(e){n=this,void 0!==e.overflow&&(n.overflow=e.overflow);for(r in e)o=e[r],u(o)&&(i={p:r,v:o,r:!1},y._callFeatureHandler(n,"fromJson",i),i.r||("formatter"===r?x(n,o,!0):"autoFormatter"===r?b(n,o,!0):r===h?S(n,o,!0,t):C[r]?o===_?n[r]=null:(a=new w,a.fromJSON(o,t),n[r]=a):n[r]=o))}}},i._defineFeature(y),y._styleId=0,r.Style=y,e.exports=r}()},function(e,t,n){!function(){"use strict";var t=n(5),r=n(4).GC$,o=n(3),i=n(11)._StyleHelper,a=n(1),l=a.CellTypes={},s=t.CultureManager,u=t._NumberHelper,c=t._DateTimeHelper,_=t._ColorHelper,f=o._CacheMgr,d=t._Types._isNullOrUndefined,h=t._Types._isType,g=o._WordWrapHelper,p=o.Rect,m=o._ThemeStyleHelper,v=o._util,C=v._getFontHeight,w=v._getHAlignByValueType,y="right",S="center",x=16,b="string",T="number",R=null,A=void 0,I=Math.floor,M=Math.ceil,E="none",F=l.Context={};F._paintBackgroundImage=function(e,t,n,r,o,i,a,l){var s,u,c,_,f,d,h,g,p,m,v;if(i&&"none"!==i&&l)try{l._getState(i)?(s=l._getImage(i),u=s.width,c=s.height,_=0,f=0,d=u,h=c,g=r,p=o,m=t,v=n,1===a?(d=r>=u?u:r,h=o>=c?c:o,m=r>u&&u>0?M(t+r/2-u/2):t,v=o>c&&c>0?M(n+o/2-c/2):n,g=d,p=h):2===a?o>0&&c>0&&r/o>u/c?(g=u/c*o,m=t+r/2-g/2):r>0&&u>0&&o/r>c/u&&(p=c/u*r,v=n+o/2-p/2):3===a&&(d=r>=u?u:r,h=o>=c?c:o,g=d,p=h),e.drawImage(s,_,f,d,h,m,v,g,p)):l._addImage(i)}catch(e){}};function D(e,t,n,r){var o=e.conditionalFormats;if(o)return o._hasIconSet(t,n,r)}F._getAutoFitWidth=function(e,t,n,r,o){var i,a,l=0,s=o&&o.sheet,u=n.textIndent,c=n.font,_=n.hAlign;if(s&&typeof t===b&&t){if(n.wordWrap)for(i=t.split(/\r\n|\r|\n/),a=0;a<i.length;a++)l=Math.max(l,g._measureText(i[a],c,!0)/r);else l=s._getStringWidthByCanvas(t,c)/r;1!==_&&u>0&&(l+=8*u/r),0===_&&D(s,o.row,o.col,o.sheetArea)&&(l+=x)}return l},F._getAutoFitHeight=function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,p=0,m=o&&o.sheet,v=n.font;if(m&&typeof t===b&&t)if(i=C(v)/r,n.wordWrap){if(a=o.row,l=o.col,s=o.sheetArea,u=m._getZoomColumnWidth(l),(c=m._getSpanModel(s).find(a,l))&&c.row>=a&&c.col>=l&&c.colCount>1)for(_=l+1;_<l+c.colCount;_++)u+=m._getZoomColumnWidth(_);f=0,d=n.textIndent,d>0&&(f=8*d),h=g._getWrapInfo(t,u-3-f,v),p=h.length*i}else p=i;return p};function N(e,t,n,r,o,i,a,l,s){(i||a)&&(e.save(),e.beginPath(),i&&(e.fillStyle!==i&&(e.fillStyle=i),e.fillRect(t,n,r,o)),F._paintBackgroundImage(e,t,n,r,o,a,l,s),e.restore())}function V(e,t,r,o,i,a,l){var s,u,c=n(14),_=c&&c.SparklineExValue;return!!(_&&t instanceof _&&(s=l&&l.parent)&&(u=s.getSparklineEx(t.name)))&&(u.paint(e,t.value,r,o,i,a,{zoomFactor:l._zoomFactor,sheet:l}),!0)}function O(e,t,n,r,o,i){0===e&&D(t,n,r,o)&&(i.x+=x,i.width-=x)}F._paintHeaderCellGridline=function(e,t,n,r,o,i,a,l,s,u,c){var _;1===s?(e.beginPath(),_=e.createLinearGradient(t,n+1,t,n+o-2),_.addColorStop(0,l.borderLeftColor),_.addColorStop(1,l.borderRightColor),e.strokeStyle=_,i.borderLeft||(e.moveTo(t+.5,n),e.lineTo(t+.5,n+o)),i.borderRight||(e.moveTo(t+r-.5,n),e.lineTo(t+r-.5,n+o)),u&&!i.borderTop&&(e.moveTo(t,n+.5),e.lineTo(t+r,n+.5)),e.stroke(),l.borderBottomWidth&&!i.borderBottom&&(e.beginPath(),e.strokeStyle=l.borderBottomColor,e.moveTo(t+1,n+o-.5),e.lineTo(t+r,n+o-.5),e.stroke())):(e.beginPath(),_=e.createLinearGradient(t,n,t+r-2,n),_.addColorStop(0,l.borderTopColor),_.addColorStop(1,l.borderBottomColor),e.strokeStyle=_,i.borderTop||(e.moveTo(t,n+.5),e.lineTo(t+r,n+.5)),i.borderBottom||(e.moveTo(t,n+o-.5),e.lineTo(t+r,n+o-.5)),c&&!i.borderLeft&&(e.moveTo(t+.5,n),e.lineTo(t+.5,n+o)),e.stroke(),l.borderRightWidth&&!i.borderRight&&(e.beginPath(),e.strokeStyle=l.borderRightColor,e.moveTo(t+r-.5,n+1),e.lineTo(t+r-.5,n+o),e.stroke()))},F._setImeMode=function(e,t){var n;n=2===t?"active":4===t?"inactive":0===t?"disabled":"auto",r(e).css("ime-mode",n)};function H(e,t,n,r){var o=e.cellPadding,i=0,a=e.labelOptions;return n&&(o=a?a.margin:"0"),o&&(i=parseInt(k(o)[t]),i=typeof i===T&&i>0?i:0),r===A?i:i*r}function P(e){var t={context:e,value:0};return J._callFeatureHandler(e.sheet,"getOutlineColumnOffset",t),t.value}F._getPositionOffset=H;function L(e,t,n,o){var i,a,l=o&&o.sheet;l&&n&&(i=o.canvasOffset||l._eventHandler._getCanvasPosition(),a=l._getBounds(),r(e).css("top",i.top+a.y+n.y-2).css("left",i.left+a.x+n.x-2).css("background-color",t.backColor||"white").width(n.width).height(n.height))}function k(e){var t,n,r,o,i=[0,0,0,0];return typeof e===b&&(t=e.split(" ",4),n=t.length,1===n?(r=t[0],i=[r,r,r,r]):2===n?(r=t[0],o=t[1],i=[r,o,r,o]):3===n?(o=t[1],i=[t[0],o,t[2],o]):4===n&&(i=[t[0],t[1],t[2],t[3]])),i}function B(e,t){var n,r=H(e,0),o=H(e,2),i=H(e,0,!0),a=H(e,2,!0);if(H(e,3,!0)+H(e,1,!0)>=t.width)return!1;if(n=e.labelOptions.alignment,n===A&&(n=e.labelOptions.alignment=0),0===n||1===n||2===n){if(r>0&&i+a<r)return!0}else if((3===n||4===n||5===n)&&r<t.height&&o>0&&i+a<o)return!0;return!1}function W(e,t){var n=H(t,0),r=H(t,3,!0),o=H(t,2,!0),i=e.clone(),a=t.labelOptions.alignment;return 0===a||1===a||2===a?n<e.height&&(i.height=n-o+1):3!==a&&4!==a&&5!==a||(i.height=e.height-o),i.x+=r,i.width-=r+H(t,1,!0),i}function z(e){var t="left";return 1===e||4===e?t="center":2!==e&&5!==e||(t="right"),t}function U(e,t,n,r){var i=new o.Point(e.x,e.y),a=n.fontSize,l=H(t,0),s=H(t,2),u=H(t,3,!0),c=H(t,1,!0),_=e.width,f=e.height,d=a>8?Math.floor((a-8)/5+2):1,h=r/2-a/2+d-1,g=a>8?1:2,p=r-h+H(t,0,!0),m=p+1,v=l+s>f?l+p:f-s+p-1;switch(t.labelOptions.alignment){case 0:i.x+=u+g+1,i.y+=m;break;case 1:i.x+=u+(_-u-c)/2,i.y+=m;break;case 2:i.x+=_-c-2,i.y+=m;break;case 3:i.x+=u+g+1,i.y+=v;break;case 4:i.x+=u+(_-u-c)/2,i.y+=v;break;case 5:i.x+=_-c-2,i.y+=v}return i}function Y(e,t){var n=H(t,3,!0),r=H(t,1,!0),o=H(t,0,!0),i=H(t,2,!0),a=e.clone(),l=t.labelOptions.alignment;return a.x=n+1,a.width-=n+r,0===l||1===l||2===l?(a.y=o,a.height=H(t,0)-o-i):3!==l&&4!==l&&5!==l||(a.y=e.height-H(t,2)+o,a.height=H(t,2)-o-i),2!==l&&5!==l||(a.width-=2),a}function G(e,t){if(e.cellPadding){var n=k(e.cellPadding),r;for(r=0;r<4;r++)n[r]=parseInt(n[r]),"number"==typeof n[r]&&n[r]>0&&(n[r]*=t);e.cellPadding=n.join(" ")}}function X(e,t){var n,r;if(h(t,"string"))return e.measureText(t).width;for(n=0,r=0;r<t.length;r++)"fillingChar"!==t[r].type&&(n+=e.measureText(t[r].value).width);return n}function j(e){for(var t=0;t<e.length;t++)if("fillingChar"===e[t].type)return!0;return!1}function K(e,t,n){var r=Math.floor(t/e.measureText(n).width);return Array(r+1).join(n)}function Z(e){var t=e.clone();return t.width--,t.height--,t}function J(){this.allowOverflow=!1,this.typeName="0"}o._defineFeature(J),J.prototype={constructor:J,_paintPadding:function(e,t,n,r,o){var i,a=this;return a._paintLabel&&(a._paintLabel(e,t,n,r),t=a._getContentRect(t,n)),i={ctx:e,options:{rect:t,context:r,value:o}},J._callFeatureHandler(r.sheet,"paintCellPadding",i),i.options.rect},_paintLabel:function(e,t,n,r){var o,a,l,s,u,c,_,f,d,h=n.labelOptions;if(h&&(o=r.sheet,a=n.watermark)){if(l=h.visibility,s=o.getText(r.row,r.col,r.sheetArea),1===l||(2===l||l===A)&&""===s)return;1!==o._zoomFactor&&G(n,o._zoomFactor),u=h.font,c=u?i._scaleFont(u,o._zoomFactor):i._scaleFont(n.font,1),_=C(c.font),f=W(t,n),B(n,t)&&(d=U(t,n,c,_)),d&&(e.save(),e.textAlign=z(h.alignment),e.textBaseline="alphabetic",e.font=c.font,e.fillStyle=h.foreColor||n.foreColor||"grey",e.rect(f.x,f.y,f.width,f.height),e.clip(),e.beginPath(),e.fillText(a,d.x,d.y),e.restore())}},_getContentRect:function(e,t){var n=e.clone(),r=H(t,0),o=H(t,1),i=H(t,2),a=H(t,3);return r>0&&(n.y+=r,n.height-=r),i>0&&(n.height-=i),a>0&&(n.x+=a,n.width-=a),o>0&&(n.width-=o),o+a>=e.width&&(n.width=0),r+i>=e.height&&(n.height=0),n},_getContentRectImp:function(e,t,n,r){var o;return t=this._getContentRect(t,n),o={ctx:e,options:{rect:t,context:r}},J._callFeatureHandler(r.sheet,"getCellPaddingRect",o),o.options.rect},_createLabelElement:function(e,t,n,o){var i,a,l,s,u,c,_,f,d,h,g,p,m=n.labelOptions;m&&(i=o.sheet,a=i.getText(o.row,o.col,o.sheetArea),l=n.watermark,1!==(s=m.visibility)&&l&&(u=m.font||n.font||i._render._getDefaultFont(),1!==i._zoomFactor&&(u=i._render._getZoomFont(u),G(n,i._zoomFactor)),c=C(u),B(n,t)&&(_=Y(t,n)),_&&(f=r(v._createElement("span")),f.text(l),d=(2===s||s===A)&&""===a,h=_.height-c,g=_.y+(d&&h>0?h:0),f.css({display:"block",position:"absolute",left:_.x,top:g,width:_.width,height:_.height,font:u,color:m.foreColor||n.foreColor||"grey",textAlign:z(m.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),r(e).append(f),d&&(p=setInterval(function(){g--,f.css("top",g),g<=_.y&&clearInterval(p)},20)))))},_createCellTypeElement:function(e){var t,n,o=this,i=v._createElement("div");return r(i).css({position:"absolute",margin:0,padding:0,overflow:"hidden","box-sizing":"content-box",resize:E,outline:E,border:"2px #5292f7 solid","box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","background-color":"white"}),t=r(v._createElement("div")),t.css({position:"absolute",outline:E,border:E}),r(i).append(t),n=o.createEditorElement(e,i),n&&t.append(r(n)),i},_activateEditorWrapper:function(e,t,n,r){var o,i,a;e&&e.firstChild&&(o=this,i=Z(n),L(e,t,i,r),o._createLabelElement&&o._createLabelElement(e,i,t,r),a=o._getContentRect?o._getContentRect(i,t):i,o.activateEditor(e.firstChild.firstChild,t,a,r))},updateEditorContainer:function(e,t,n){var o,i,a,l,s,u;e&&t&&(o=e.parentNode)&&(i=o.parentNode,a=r(i),l=t.width,s=t.height,l>0&&(a.width(l),u=i.lastChild,n&&"gcEditorLabel"===u.getAttribute("gcUIElement")&&r(u).width(l-H(n,3,!0)-H(n,1,!0)-2)),s>0&&a.height(s),d(t.x)||a.css("left",t.x+"px"),d(t.y)||a.css("top",t.y+"px"))},_updateEditorWrapper:function(e,t,n,o,i){var a,l,s,u=this,c=e.firstChild,_=o.sheet,f=Z(n);L(e,t,f,o),i&&_&&G(t,_._zoomFactor),r(c).css({left:H(t,3),top:H(t,0)}),a=c.firstChild,
l=u._getContentRect?u._getContentRect(f,t):f,s=u.updateEditor(a,t,l,o),u.updateEditorContainer(a,s,t)},_getHitInfoWrapper:function(e,t,n,r,o){var i=this,a=i._getContentRect?i._getContentRect(r,n):r;return i.getCellAndPaddingHitInfo(e,t,n,a,o)},_getAutoFitContainerWidth:function(e,t,n,r,o){return P(o)+H(n,3,!1,r)+H(n,1,!1,r)+this.getAutoFitWidth(e,t,n,r,o)},_getAutoFitContainerHeight:function(e,t,n,r,o){return H(n,0,!1,r)+H(n,2,!1,r)+this.getAutoFitHeight(e,t,n,r,o)},paintValue:function(e,t,n,r,o,i,a,l){var s={},u;l.quotePrefix=a.quotePrefix,(u=this.format(t,a.formatter||a._autoFormatter,s,l))&&this.paintText(e,t,n,r,o,i,a,l,u,s)},paintText:function(e,t,n,r,o,i,a,l,s,u,c){var f,h,p,m,v,C,x,b,T,R,A,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U,Y,G,X,j,K,Z,J,q,Q,$;if(e.save(),e.beginPath(),f=a.foreColor,h=a.font,p=u.conditionalForeColor,p&&(f=p),d(c)||(m=_._fromString(f),m.a=c,f=_._toString(m)),f&&e.fillStyle!==f&&(e.fillStyle=f),h&&e.font!==h&&(e.font=h),v=0,C=a.textIndent,x=a.wordWrap,b=a.hAlign,T=a.vAlign,R=a.textDecoration,A="left",M="alphabetic",E=2,F=2,D=0,N=l.lineHeight,V=[],O=0,H=l.fontInfo.fontSize,C>0&&(v=8*C),l.sheet.outlineColumn&&l.sheet.outlineColumn._isOutlineColumn(l.col)&&(v=0),3===b&&(b=w(b,t,a.formatter)),E+=v,1===b?(E=o/2,A=S):2===b&&(E=o-1-2,E-=v,A=y),e.textAlign!==A&&(e.textAlign=A),x&&(P=o-3-v,P-=1,V=g._getWrapInfo(s,P,h),(O=V.length)>1&&0!==T&&(D=(O-1)*N)),L=H>8?I((H-8)/5+2):1,k=N/2-H/2+L-1,F+=N-k,1===T?F=(i-D)/2+N/2-k:2===T&&(F=i-D-2-k),e.textBaseline!==M&&(e.textBaseline=M),B=l.cellOverflowLayout,W=B&&B.layout,z={x:W?W.x:n+1,y:W?W.y:r+1,width:W?W.width:o-2,height:W?W.height:i-2},U=W&&W.width>o,Y=z.x,G=z.y,X=z.width,j=z.height,x)if(e.rect(Y,G,X,j),e.clip(),e.beginPath(),K=r+F,O>1)for(Z=0;Z<O;Z++)e.fillText(V[Z],n+E,K),R&&(J=e.measureText(V[Z]).width,this._renderTextDecoration(e,R,n+E,K,J,H,L)),K+=N;else this._renderCellTextNormal(e,s,u,n+E,r+F,b,X,v,R,L,H,U);else q=e.measureText(s).width,Q=q>X-(n+1-Y)||N>j,Q||(1===b?B&&(($=q/2)>B.backgroundLeftWidth||$>B.backgroundRightWidth)&&(Q=!0):q+v>X&&(Q=!0)),Q&&(e.rect(Y,G,X,j),e.clip(),e.beginPath()),this._renderCellTextNormal(e,s,u,n+E,r+F,b,X,v,R,L,H,U);e.restore()},paint:function(e,t,n,r,o,i,a,l){var s,u,c;e&&(s=a.backColor,l.parentBackColor!==s&&N(e,n,r,o,i,s,a.backgroundImage,a.backgroundImageLayout,l.imageLoader),u=this,c=new p(n,r,o,i),u._paintPadding&&(c=u._paintPadding(e,c,a,l,t)),c.width>0&&c.height>0&&u.paintContent(e,t,c.x,c.y,c.width,c.height,a,l))},paintContent:function(e,t,n,r,o,i,a,l){var s,u,c,_,f,d,h,g,v=l.sheetArea;2!==v&&1!==v||(s=l.visualState||0,u="columnHeader",2===v&&(u="rowHeader"),c=this.getThemeStyle(l.visualState,"gc-"+u+"-"+m._getString(s)),F._paintHeaderCellGridline(e,n,r,o,i,a,u,c,v)),f=l.conditionalFormats,f&&(_=f._paint(e,t,n,r,o,i,a,l)),l.showBarIconOnly=_,d=l.sparkline,d&&d.paintSparkline(e,n,r,o,i),h=V(e,t,n,r,o,i,l.sheet),l.cellOverflowLayout||_||h||(g=new p(n,r,o,i),O(a.hAlign,l.sheet,l.row,l.col,l.sheetArea,g),this.paintValue(e,t,g.x,g.y,g.width,g.height,a,l))},createEditorElement:function(e){return R},getEditorValue:function(e,t){return R},_formatEditorValue:function(e,t,n,r){return n},setEditorValue:function(e,t,n){},getEditingElement:function(){return R},parse:function(e,t,r){var o,i,a,l=d(t),s=d(e);try{if(o=n(6),i=o&&o.GeneralFormatter,!l&&!s&&i)return a=typeof t===b?new i(t):t,a.parse(e)}catch(e){}return s?"":""+e},format:function(e,t,r,o){var i,a,l,_;if(d(e)||""===e)return"";if(typeof t===b&&"object"!=typeof e)return f._getFormattedText(e,t,r);if(!t)return"boolean"==typeof e||e instanceof Boolean?(""+e).toUpperCase():e instanceof Date?(i=s._getCultureInfo(s.culture()).DateTimeFormat,c._localeFormat(e,i.shortDatePattern+" H:mm:ss")):(typeof e===T&&(e=u._replaceNormalToCultureSymbol(""+e)),""+e);try{return a=n(6),l=a&&a.GeneralFormatter,l?(_=R,_=typeof t===b?f._getFormatter(t):t,_.format(e,r)):""+e}catch(t){return""+e}},focus:function(e,t){e&&e.focus&&e.focus()},getThemeStyle:function(e,t){return m._getVisualStateThemeStyle(e,t)},activateEditor:function(e,t,n,r){},deactivateEditor:function(e,t){},selectAll:function(e,t){e&&e.select&&e.select()},updateEditor:function(e,t,n,r){},setImeMode:function(e,t,n){this.isImeAware(n)?this.updateImeMode(e,t,n):e&&F._setImeMode(e,0)},updateImeMode:function(e,t,n){e&&F._setImeMode(e,t)},getHitInfo:function(e,t,n,r,o){return R},getCellAndPaddingHitInfo:function(e,t,n,r,o){var i,a;return o&&3===o.sheetArea?(i=null,a={x:e,y:t,context:o,cellStyle:n,cellRect:r,paddingHitInfo:i},J._callFeatureHandler(o.sheet,"getCellPaddingHitInfo",a),a.paddingHitInfo?a.paddingHitInfo:this.getHitInfo(e,t,n,r,o)):this.getHitInfo(e,t,n,r,o)},processCellAndPaddingMouseDown:function(e){return J._callFeatureHandler(e.sheet,"processMouseDownOnCellPadding",e),this.processMouseDown(e)},processMouseDown:function(e){return!1},processMouseMove:function(e){return!1},processMouseUp:function(e){return!1},processMouseEnter:function(e){},processMouseLeave:function(e){},isReservedKey:function(e,t){return!1},isEditingValueChanged:function(e,t,n){return e!==t},processKeyDown:function(e,t){return!1},processKeyUp:function(e,t){return!1},getAutoFitWidth:function(e,t,n,r,o){return F._getAutoFitWidth(e,t,n,r,o)},getAutoFitHeight:function(e,t,n,r,o){return F._getAutoFitHeight(e,t,n,r,o)},_renderCellTextNormal:function(e,t,n,r,o,i,a,l,s,u,c,_){if(n&&n.content&&n.content.length>0&&!_)this._paintTextObject(e,n.content,r,o,i,a,l,s,u,c);else if(e.fillText(t,r,o),s){var f=e.measureText(t).width;this._renderTextDecoration(e,s,r,o,f,c,u)}},_paintTextObject:function(e,t,n,r,o,i,a,l,s,u){var c,_;e.save(),e.textAlign="left",c=X(e,t),_=i-a-c-2,_=_>0?_:0,j(t)?(1===o?(n-=i/2,n+=a):2===o&&(n=n-i+2,n+=a),this._paintTextItem(e,t,n,r,_,l,s,u)):(1===o?n-=c/2:2===o&&(n-=c),this._paintTextItem(e,t,n,r,_,l,s,u)),e.restore()},_paintTextItem:function(e,t,n,r,o,i,a,l){var s,u;for(u=0;u<t.length;u++)"fillingChar"===t[u].type?(e.fillText(K(e,o,t[u].value),n,r),i&&this._renderTextDecoration(e,i,n,r,o,l,a),n+=o):"placeholder"===t[u].type?n+=e.measureText(t[u].value).width:"numberPlaceholder"===t[u].type?n+=e.measureText("0").width:(e.fillText(t[u].value,n,r),s=e.measureText(t[u].value).width,i&&this._renderTextDecoration(e,i,n,r,s,l,a),n+=s)},_renderTextDecoration:function(e,t,n,r,o,i,a){var l,s,u,c,_;e.strokeStyle=e.fillStyle,l=e.textAlign,s=0,u=0,c=.5,_=i<=12?12:i,u=I((_-12)/21+1),e.lineWidth=u,0==(1&u)&&(c=0),l===S?n-=o/2:l===y&&(n-=o),e.beginPath(),4==(4&t)&&(s=M(r+a-i-1)-c,e.moveTo(n,s),e.lineTo(n+o,s)),2==(2&t)&&(s=M(r+a-i/2)-c,e.moveTo(n,s),e.lineTo(n+o,s)),1==(1&t)&&(s=M(r+a-1)-c,e.moveTo(n,s),e.lineTo(n+o,s)),e.stroke()},_setTextDecoration:function(e,t){var n="";4==(4&t)&&(n="overline"),2==(2&t)&&(n+=" line-through"),1==(1&t)&&(n+=" underline"),e.css("text-decoration",n)},_cloneCellType:function(){return R},isImeAware:function(e){return!1},isEditting:function(){return!1},toJSON:function(){var e,t={},n=this;for(e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t},fromJSON:function(e){if(e)for(var t in e)d(e[t])||(this[t]=e[t])}},l.Base=J,l._typeDict={0:J},e.exports=a}()},function(e,t){e.exports=GC.Spread.Sheets.Sparklines},function(e,t,n){!function(){"use strict";var t=n(1),r=n(3),o=n(5),i=n(12),a=n(11)._StyleHelper,l=o._StringHelper,s=r._util._browser,u=o._Types._isNullOrUndefined,c=o._ArrayHelper._contains,_=i.LineBorder,f=i.Style,d=null;function h(e){return e&&e.options.allowCopyPasteExcelStyle}function g(e){var t=this;t._fromSheet=d,t._ranges=d,t._isCutting=!1,t._owner=e,t._createElement()}g.prototype={_createElement:function(){var e,t,n,r=this,o=document.createElement("div");o.style.position="fixed",o.style.top="0px",o.style.left="0px",o.style.width="0px",o.style.height="0px",o.style.overflow="hidden",e=document.createElement("div"),e.setAttribute("contenteditable","true"),e.setAttribute("gcUIElement","gcSheetClipboard"),e.setAttribute("tabindex",-1),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",o.appendChild(e),r._element=e,t=document.createElement("textarea"),t.setAttribute("gcUIElement","gcSheetClipboard"),t.setAttribute("tabindex",-1),t.style.position="absolute",t.style.overflow="hidden",t.style.background="white",t.style.webkitUserSelect="text",o.appendChild(t),r._textAreaElement=t,n=r._owner.getHost(),n&&n.appendChild(o),s.msie||s.edge||(r._pasteHandler=function(e){var t,n,o,i,a=r._owner.getActiveSheet(),l=e.clipboardData;l&&(t=l.getData("text/html"),n=r._getMeasureContainer(),n.innerHTML=t,t?(o=C(n),i=v(n)):o=w(l.getData("text/plain")),n.innerHTML="",a._doClipboardPaste(o,t,i))},e.addEventListener("paste",r._pasteHandler),r._textAreaPasteHandler=function(e){var t,n,o,i=r._owner.getActiveSheet(),a=e.clipboardData;a&&(t=w(a.getData("text/plain")),n=a.getData("text/html"),n&&(o=r._getMeasureContainer(),o.innerHTML=n,t=C(o)),i._doClipboardPaste(t,""))},t.addEventListener("paste",r._textAreaPasteHandler))},_dispose:function(){var e,t,n,r,o=this,i=o._element;i&&(s.msie||s.edge||(i.removeEventListener("paste",o._pasteHandler),o._textAreaElement.removeEventListener("paste",o._textAreaPasteHandler)),e=i.parent,e&&(t=e.parent)&&t.removeChild(e),o._element=d,o._textAreaElement=d),(n=o._measureContainer)&&(r=n.parent,r&&r.removeChild(n),o._measureContainer=d)},_setClipboardData:function(e){h(this._owner)?this._element.innerHTML=e:this._textAreaElement.value=e},_focus:function(){h(this._owner)?this._element.focus():this._textAreaElement.focus()},_select:function(){h(this._owner)?document.execCommand("selectAll"):this._textAreaElement.select()},_getClipboardData:function(){var e,t,n="",r="",o="";return h(this._owner)?(e=this._element,e&&(t=e.getElementsByTagName("table"),t.length>0&&(n=t[0].outerHTML)),r=C(this._element),o=v(this._element)):r=w(this._textAreaElement.value),{html:n,text:r,json:o}},_getRangeJSON:function(e,n,r,o,i){var a,l,s=t,u=e.parent,c=u.getSheetCount(),_=u.sheets[c-1];1===c&&(u.setSheetCount(2),_=u.sheets[1]),_.setRowCount(r>0?r:e.getRowCount()),_.setColumnCount(i>0?i:e.getColumnCount),s.staticMembers.copyTo(e,n,o,_,0,0,r,i,s.CopyToOptions.all,!1,3),a=e.getSelections()[0];const f=a.row<0?a.row:0,d=a.col<0?a.col:0;_.setSelection(f,d,a.rowCount,a.colCount);try{return l=_.toJSON(),JSON.stringify(l).replace(/"/g,"&quot;").replace(/'/g,"&#39;")}catch(e){return""}},_getRangeHtml:function(e,t,n,o,i,a,l,s){var u,c,_,f,d,h,g,p=this,m=e._getActualRange(r._createRange(t,o,n,i)),v=RegExp(String.fromCharCode(32),"g"),C="&nbsp;",w=!1,y=!1,S=e.parent.options.copyPasteHeaderOptions;t<0&&2==(2&S)&&(w=!0),o<0&&1==(1&S)&&(y=!0),u=t,c=o,t=m.row,o=m.col,n=m.rowCount,i=m.colCount,_=null,f=null,d=p._getRangeHtmlImp(e,t,n,o,i,3,l,s,a,m,v,C),y&&(h=e.getColumnCount(2),_=p._getRangeHtmlImp(e,t,n,0,h,2,l,s,a,m,v,C)),w&&(g=e.getRowCount(1),f=p._getRangeHtmlImp(e,0,g,o,i,1,l,s,a,m,v,C));const x=p._getRangeJSON(e,u,n,c,i);return p._join(d,_,f,x)},_join:function(e,t,n,r){var o,i,a=this,l=e,s=0,u=function(e,t){var n,r=[],o=e.length;for(n=0;n<o;n++)r.push(e[n].concat(t[n]));return r};return t&&(s=t[0].length,l=u(t,e)),n&&(o=n.length,i=null,s&&(i=a._getRangeHtmlImp(null,0,o,0,s,null,[],[],!1,null,null,null),n=u(i,n)),l=n.concat(l)),a._buildStr(l,r)},_buildStr:function(e,t){var n,r,o="",i=e.length;for(o+="<table innerdata='"+t+"'>",n=0;n<i;n++){for(o+="<tr>",r=0;r<e[n].length;r++)o+=e[n][r];o+="</tr>"}return o+="</table>"},_getRangeHtmlImp:function(e,t,n,r,o,i,a,_,f,h,g,m){var v,C,w,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U=[];for(v=0;v<n;v++)if(C=t+v,!c(a,C)){for(w=[],b=0;b<o;b++)T=r+b,c(_,T)||(R="",f&&e&&(A=e.getSpan(C,T,i),A&&p(A,h,a,_)&&(A=d),A&&(A.row!==C||A.col!==T))||(R+="<td",f&&e&&(A&&(A.rowCount>1&&(R+=" rowSpan="+A.rowCount),A.colCount>1&&(R+=" colSpan="+A.colCount)),I=e.getActualStyle(C,T,i),R+=' style="',M=I.backColor,M&&(R+="background-color: "+M+";"),E=I.foreColor,E&&(R+="color: "+E+";"),F=I.font,F&&(R+="font: "+F.replace(/"/g,"'")+";"),D=I.vAlign,u(D)||(R+="vertical-align: "+S(D)+";"),N=I.hAlign,u(N)||(V=y(N))&&(R+="text-align: "+V+";"),O=I.borderLeft,O&&(R+="border-left: "+x(O)+";"),H=I.borderRight,H&&(R+="border-right: "+x(H)+";"),P=I.borderTop,P&&(R+="border-top: "+x(P)+";"),L=I.borderBottom,L&&(R+="border-bottom: "+x(L)+";"),R+='"'),R+=">",f&&e&&(k=I.textDecoration,B=2==(2&k),W=1==(1&k),B&&(R+="<s>"),W&&(R+="<u>")),z=e?e.getText(C,T,i):"",z?z=l._escapeHtml(z).replace(g,m):s.chrome?z=" ":s.safari&&(z="&nbsp;"),R+=z,f&&(W&&(R+="</u>"),B&&(R+="</s>")),R+="</td>",w.push(R)));U.push(w)}return U},_getMeasureContainer:function(){var e,t,n=this;return n._measureContainer||(e=document.createElement("div"),e.style.display="none",t=n._owner.getHost(),t&&t.appendChild(e),n._measureContainer=e),n._measureContainer},_setRangeHtml:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p=this._getMeasureContainer();if(p.innerHTML=e,i=p.getElementsByTagName("table"),i.length>0)for(a=m(i[0],!0,t),l=0;l<a.length;l++)for(s=a[l],u=n+l,c=0;c<s.length;c++)(_=s[c])&&(f=r+c,t._setStyleWithoutLocked(u,f,_.style),32&o&&(d=_.rowSpan,h=_.colSpan,(d>1||h>1)&&(g=t.getSpan(u,f),g?(g.row=u,g.col=f,g.rowCount=d,g.colCount=h):t.addSpan(u,f,d,h))));p.innerHTML=""}};function p(e,t,n,r){if(!t.containsRange(e))return!0;for(var o=0;o<n.length;o++)if(e.row<=n[o]&&n[o]<e.row+e.rowCount)return!0;for(o=0;o<r.length;o++)if(e.col<=r[o]&&r[o]<e.col+e.colCount)return!0;return!1}function m(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h=[],g=/\s+/g;for(r=0;r<e.rows.length;r++)for(o=e.rows[r],h[r]||(h[r]=[]),i=h[r],a=0,l=0;a<o.cells.length;a++){for(s=o.cells[a];i[l];)l++;for(u=i[l]={},t&&(c=E(s,n),u.style=c),u.text=s.innerText,u.rowSpan=s.rowSpan,u.colSpan=s.colSpan,_=0;_<s.rowSpan;_++)for(f=0;f<s.colSpan;f++)0===_&&0===f||(h[r+_]||(h[r+_]=[]),d=h[r+_],d[l+f]={style:c,text:"",rowSpan:1,colSpan:1});l+=s.colSpan}return h}function v(e){var t,n,r;if(e&&(t=e.getElementsByTagName("table"),t.length>0))for(n=0;n<t.length;n++){r=t[n];const o=r.attributes.innerdata;if(o&&o.value)return JSON.parse(o.value)}}function C(e){var t,n,r,o,i,a,l,s,u,c,_=[];if(e)if(t=e.getElementsByTagName("table"),t.length>0)for(n=m(t[0],!1),r=RegExp(String.fromCharCode(160),"g"),o=String.fromCharCode(32),i=0,a=n.length;i<a;i++){for(l=n[i],s=0,u=l.length;s<u;s++)c=l[s]?l[s].text:"",c.indexOf("\n")>=0&&(c=c.split("\n").join("")),_.push(c.replace(r,o)),s<u-1&&_.push("\t");i<a-1&&_.push("\r\n")}else _.push(e.innerText.trim());return _.join("")}function w(e){var t,n,r,o,i,a=[];if(e){for(t='"',n=!1,r=0;r<e.length;r++)o=r>0?e[r-1]:"",i=e[r],i===t?(n=!n,a.push(t)):n||"\n"!==i||"\r"===o?a.push(i):a.push("\r\n");return a.join("")}return""}function y(e){return{0:"left",1:"center",2:"right"}[e]}function S(e){return{0:"top",1:"middle",2:"bottom"}[e]}function x(e){var t={0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"};return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[e.style]+"px "+t[e.style]+" "+e.color}function b(e){return{left:0,center:1,right:2}[e]}function T(e){return{top:0,middle:1,bottom:2}[e]}function R(e,t,n){var r={none:0,solid:1,dashed:3,dotted:4,double:6};return"3px"===n?r.solid=5:"2px"===n&&(r.solid=2,r.dashed=8),new _(e,r[t])}function A(e){return{underline:1,"line-through":2,none:0}[e]}function I(e){return"rgba(0, 0, 0, 0)"===e||0===o._ColorHelper._fromString(e).a}function M(e){if("rgb(0, 0, 0)"===e)return!0;var t=o._ColorHelper._fromString(e);return 0!==t.a&&0===t.r&&0===t.g&&0===t.b}function E(e,t){var n,r,o,i,l,s,u,c,_,d=e.getElementsByTagName("font")[0],h=getComputedStyle(e),g=new f,p=h.backgroundColor;return p&&!I(p)&&(g.backColor=p),n=h.color,d&&(n=d.color),n&&!M(n)&&(g.foreColor=n),t&&t.options.pasteIgnoreFont||(d?g.font=a._buildFontString(getComputedStyle(d)):(r=a._buildFontString(h))&&(g.font=r)),o=h.verticalAlign,o&&(g.vAlign=T(o)),i=h.textAlign,i&&(g.hAlign=b(i)),t&&t.options.pasteIgnoreBorder||(l=h.borderLeftStyle,"none"!==l&&(g.borderLeft=R(h.borderLeftColor,l,h.borderLeftWidth)),s=h.borderRightStyle,"none"!==s&&(g.borderRight=R(h.borderRightColor,s,h.borderRightWidth)),u=h.borderTopStyle,"none"!==u&&(g.borderTop=R(h.borderTopColor,u,h.borderTopWidth)),"none"!==(c=h.borderBottomStyle)&&(g.borderBottom=R(h.borderBottomColor,c,h.borderBottomWidth))),_=A(h.textDecoration),e.getElementsByTagName("u").length>0&&(_|=A("underline")),e.getElementsByTagName("s").length>0&&(_|=A("line-through")),0!==_&&(g.textDecoration=_),g}t._ClipboardHelper=g,e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l=null,s=void 0,u="string",c=Math.min,_=Math.floor,f=Math.max,d=n(1),h=n(12).Style,g=n(5),p=n(3),m=n(11)._StyleHelper,v=n(4).GC$,C=v.each,w=v.isEmptyObject,y=v.inherit,S=v.extend,x=g._addElements,b=g._deleteElements,T=g._Types._isNullOrUndefined,R=p._createRange,A=function(){return g._getResource(d.SR)()};function I(e,t){return e.hasOwnProperty(t)}function M(e){return e.rowCount}function E(e){return e.colCount}d.StorageType={data:1,style:2,comment:4,tag:8,sparkline:16,axis:32,bindingPath:64},t=function(e){y(t,e);function t(){e.call(this),this._lastNonNullColumn=-1,this._lastNonNullRow=-1,this.cache={}}function n(e,t){var n,r;for(e._lastNonNullRow=f(e._lastNonNullRow,t.row+M(t)-1),e._lastNonNullColumn=f(e._lastNonNullColumn,t.col+E(t)-1),n=0;n<t.rowCount;n++)for(r=0;r<t.colCount;r++)e.cache[t.row+n+"_"+(t.col+r)]=t}function r(e,t){var n,r;for(n=0;n<t.rowCount;n++)for(r=0;r<t.colCount;r++)e.cache[t.row+n+"_"+(t.col+r)]=s}var o={find:function(e,t){return this.cache[e+"_"+t]||l},get:function(e,t){return this.find(e,t)||R(e,t,1,1)},remove:function(e){var t=this.indexOf(e);t>=0&&this.removeSpan(t,1)},update:function(e,t){var o=this;r(o,o[e]),o[e]=t,n(o,t)},addSpan:function(e){n(this,e),this.push(e)},removeSpan:function(e,t){for(var n=0;n<t;n++)r(this,this[e+n]);this.splice(e,t)},copy:function(e,t,n,r,o,i){var a,l,s,u,c=this,_=c.length,f=[];for(u=0;u<_;u++)a=c[u],s=a.col,l=a.row,(-1===e||e<=l&&l<e+o)&&(-1===t||t<=s&&s<t+i)?f.push(R(-1===e?l:n+l-e,-1===t?s:r+s-t,M(a),E(a))):(-1===e||n<=l&&l<n+o)&&(-1===t||r<=s&&s<r+i)&&(c.removeSpan(u,1),u--,_--);for(u=0;u<f.length;u++){if(a=f[u],!c.isValid(c,0,c.length,a))throw Error(A().Exp_OverlappingSpans);c.addSpan(a)}},isValid:function(e,t,n,r){for(var o=t;o<n&&o<e.length;o++)if(e[o].intersect(r.row,r.col,M(r),E(r)))return!1;return!0},each:function(e,t,n,r,o){var i,a,l,s=this;for(i=0,a=s.length;i<a;i++){if(e>=0||t>=0)for(;i<a&&!s[i].intersect(e,t,n,r);)i++;if(i<a&&o&&!1===(l=o(s[i])))break}},getSpans:function(e){var t,n,r;if(!e)return this.slice(0);for(t=[],n=0;n<this.length;n++)r=this[n],r.intersect(e.row,e.col,M(e),E(e))&&t.push(r);return t},hasPartSpans:function(e,t,n,r){var o,i;for(o=0;o<this.length;o++)if(i=this[o],i.intersect(e,t,n,r)&&(-1!==e&&(i.row<e||i.row+M(i)>e+n)||-1!==t&&(i.col<t||i.col+E(i)>t+r)))return!0;return!1},hasSpans:function(e,t,n,r){var o=!1;return this.each(e,t,n,r,function(){return o=!0,!1}),o},clear:function(e,t,n,r){var o,i,a,l;for(o=0;o<this.length;o++)i=this[o],a=i.row,l=i.col,(-1===e||e<=a&&a<e+n)&&(-1===t||t<=l&&l<t+r)&&this.removeSpan(o--,1)},move:function(e,n,r,o,i,a){var l,s,u,c,_,f=this,d=!1,h=new t,g=[],p=f.length;for(c=0;c<p;c++)l=f[c],s=l.row,u=l.col,(-1===e||e<=s&&s<e+i)&&(-1===n||n<=u&&u<n+a)?(_=R(-1===e?s:r+s-e,-1===n?u:o+u-n,M(l),E(l)),g.push(_),d=!0):(-1===e||r<=s&&s<r+i)&&(-1===n||o<=u&&u<o+a)?d=!0:h.push(l);if(d){if(g.length>0)for(c=0;c<g.length;c++){if(_=g[c],!f.isValid(h,0,h.length,_))throw Error(A().Exp_OverlappingSpans);h.push(_)}for(f.length=0,f.cache={},c=0;c<h.length;c++)f.addSpan(h[c])}},isEmpty:function(){return this.length<=0},addRows:function(e,t){var n,r,o,i,a,l,s=this,u=s.length;for(n=0;n<u;n++)r=s[n],o=r.row,i=r.col,a=M(r),l=E(r),o>=e?s.update(n,R(o+t,i,a,l)):e<o+a&&s.update(n,R(o,i,a+t,l))},addColumns:function(e,t){var n,r,o,i,a,l,s=this,u=s.length;for(n=0;n<u;n++)r=s[n],o=r.row,i=r.col,a=M(r),l=E(r),i>=e?s.update(n,R(o,i+t,a,l)):e<i+l&&s.update(n,R(o,i,a,l+t))},removeRows:function(e,t){var n,r,o,i,a,l,s,u=this,_=[],f=u.length;for(n=0;n<f;n++)r=u[n],o=r.row,i=r.col,a=M(r),l=E(r),o>=e?o<e+t?_.push(n):u.update(n,R(o-t,i,a,l)):e<o+a&&(u.update(n,R(o,i,a-c(o+a-e,t),l)),1===u[n].rowCount&&1===u[n].colCount&&_.push(n));for(n=_.length-1;n>=0;n--)s=_[n],u.removeSpan(s,1)},removeColumns:function(e,t){var n,r,o,i,a,l,s,u=this,_=[],f=u.length;for(n=0;n<f;n++)r=u[n],o=r.row,i=r.col,a=M(r),l=E(r),i>=e?i<e+t?_.push(n):u.update(n,R(o,i-t,a,l)):e<i+l&&(u.update(n,R(o,i,a,l-c(i+l-e,t))),1===u[n].rowCount&&1===u[n].colCount&&_.push(n));for(n=_.length-1;n>=0;n--)s=_[n],u.removeSpan(s,1)},toJSON:function(){var e=this.slice(0);return 0===e.length?s:e},fromJSON:function(e){var t,n,r;if(e)for(t=e,n=0;n<t.length;n++)r=t[n],this.addSpan(R(r.row,r.col,M(r),E(r)))}};return S(t.prototype,o),t}(Array),d._SpanModel=t,r=function(e){y(t,e);function t(){e.call(this),this.headingOverflowlayout=l,this.trailingOverflowLayout=l}return t.prototype.find=function(e){var t,n,r=this,o=r.length;for(n=0;n<o;n++)if(t=r[n],t.contains(e))return t;return l},t}(Array),d._CellOverflowLayoutModel=r;function F(e,t,n,r,o,i,a,l){var s=this;s.column=e,s.startColumn=t,s.endColumn=n,s.valueWidth=r,s.columnWidth=o,s.backgroundWidth=i,s.backgroundLeftWidth=a,s.backgroundRightWidth=l}F.prototype.contains=function(e){return e>=this.startColumn&&e<=this.endColumn},d._CellOverflowLayout=F,o=function(e){y(t,e);function t(){e.call(this),this._selectionPolicy=2,this._selectionUnit=0}function n(e,t,n){var r,o,i,a,l=R(-1,-1,-1,-1);return e&&(r=e.col,o=e.row,i=-1===o,a=-1===r,l.row=i?0:o,l.rowCount=i?t:M(e),l.col=a?0:r,l.colCount=a?n:E(e)),l}var r={find:function(e,t){var n,r,o=this,i=o.length;for(r=0;r<i;r++)if(n=o[r],n.contains(e,t))return n;return l},clear:function(){this.splice(0,this.length),this._activeSelectedRangeIndex=-1},add:function(e,t,n,r){var o=this,i=o._selectionPolicy,a=o._selectionUnit;0===i?(n=c(n,1),r=c(r,1),o.clear()):1===i&&o.clear(),1===a?(t=-1,r=-1):2===a&&(e=-1,n=-1),o.push(R(e,t,n,r)),o._activeSelectedRangeIndex=o.length-1},toArray:function(){return this.slice(0)},fromArray:function(e){this.splice(0,this.length);for(var t=0;t<e.length;t++)this.push(e[t])},toJSON:function(){var e,t=this,n={},r=t._selectionPolicy,o=t._selectionUnit,i=t._activeSelectedRangeIndex,a=t.length;for(2!==r&&(n.selectionPolicy=r),0!==o&&(n.selectionUnit=o),0!==i&&(n.activeSelectedRangeIndex=i),n.length=a,e=0;e<a;e++)n[e]=t[e];return w(n)?s:n},fromJSON:function(e){var t,n,r,o,i,a;if(e){for(t=this,t.clear(),n=e.selectionPolicy,r=e.selectionUnit,o=e.length,T(o)&&(o=1),i=0;i<o;i++)a=e[i],t.push(R(a?a.row:0,a?a.col:0,a?M(a):1,a?E(a):1));t._activeSelectedRangeIndex=e.activeSelectedRangeIndex||0,T(n)||(t._selectionPolicy=n),T(r)||(t._selectionUnit=r)}},_isColumnSelected:function(e){var t,n,r,o=this;for(t=0;t<o.length;t++)if(n=o[t],r=-1===n.col?0:n.col,-1===n.row&&e>=r&&e<r+E(n))return!0;return!1},_isRowSelected:function(e){var t,n,r,o=this;for(t=0;t<o.length;t++)if(n=o[t],r=-1===n.row?0:n.row,-1===n.col&&e>=r&&e<r+M(n))return!0;return!1},_isSelected:function(e,t,r,o,i,a){var l,s,u,c,_,f,d,h,g=!1,p=this,m=a?1:0;for(l=0,s=p.length;l<s&&(u=p[l],c=n(u,o,i),_=c.row,f=c.col,d=_-m<=e&&e<_+M(c)+m,h=f-m<=t&&t<f+E(c)+m,3===r||T(r)?g=d&&h:2===r?g=d:1===r?g=h:0===r&&(g=-1===u.row&&-1===u.col),!g);l++);return g},_isAllSelected:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g=this,p=!1;for(i=0;i<g.length&&(a=g[i],l=a.row,s=a.col,u=M(a),c=E(a),_=-1===s,f=-1===l,T(n)||3===n||(2===n?(d=f?0:l,p=_&&e>=d&&e<d+u):1===n?(h=_?0:s,p=f&&t>=h&&t<h+c):0===n&&(p=f&&_&&u===r&&c===o),!p));i++);return p}};return S(t.prototype,r),t}(Array),d._SelectionModel=o,i=function(e){y(t,e);function t(){e.call(this)}function n(e,t,n,r,o){var i,a,s=e.length,u=!1;for(a=0;a<s;a++)if(i=e[a],u=T(t)||T(n)?T(t)?T(n)?T(r)?i.containsY(o):i.containsX(r):i.col===n:i.row===t:i.contains(t,n))return i;return l}function r(e,t,n){var r=l,o=e.length,i=!T(t);return o>0&&((r=i?e.findX(t):e.findY(n))||(r=i&&t<e[0].x||!i&&n<e[0].y?e[0]:e[o-1])),r}var o={findCell:function(e,t){var n,r,o=this.length;for(r=0;r<o;r++)if(n=this[r],n.contains(e,t))return n;return l},findRow:function(e){var t,n,r=this.length;for(n=0;n<r;n++)if(t=this[n],t.row===e)return t;return l},findCol:function(e){var t,n,r=this.length;for(n=0;n<r;n++)if(t=this[n],t.col===e)return t;return l},findX:function(e){return n(this,s,s,e)},findY:function(e){return n(this,s,s,s,e)},findNearX:function(e){return r(this,e)},findNearY:function(e){return r(this,s,e)}};return S(t.prototype,o),t}(Array),d._LayoutModel=i;function D(e,t,n,r,o,i,a,l){var s=this;s.rowCount=a,s.colCount=l,s.row=e,s.col=t,s.x=n,s.y=r,s.width=o,s.height=i}D.prototype={contains:function(e,t){var n=this;return e<n.row+M(n)&&n.row<=e&&t<n.col+E(n)&&n.col<=t},intersect:function(e){var t=this;return(t.x<0||e.x<t.x+t.width&&t.x<e.x+e.width)&&(t.y<0||e.y<t.y+t.height&&t.y<e.y+e.height)},containsX:function(e){return this.x<=e&&e<this.x+this.width},containsY:function(e){return this.y<=e&&e<this.y+this.height}},d._Layout=D;function N(e,t,n){var r=this;r.rowCount=e,r.colCount=t,r.name=n,r.dataTable={},r._rowDataArray=[],r._columnDataArray=[],r._defaultDataNode=l,r._dirtyNodes={},r._dirtySuspended=0,r._lastNonNullColumn=-1,r._lastNonNullRow=-1}function V(e,t,n,r,o,i,a,l){if(n>=0&&r>=0){i[n]||(i[n]={});i[n][r]=o}else n>=0&&-1===r&&e>=0&&-1===t?a[n]=o:r>=0&&-1===n&&t>=0&&-1===e&&(l[r]=o)}N.prototype={constructor:N,getRowCount:function(){return this.rowCount},getColumnCount:function(){return this.colCount},setRowCount:function(e){this.rowCount=e},setColumnCount:function(e){this.colCount=e},_updateDirty:function(e,t,n){var r,o,i,a,l=this,s=l._dirtyNodes;l._dirtySuspended>0||e>=0&&t>=0&&(s[e]||(s[e]={}),r=s[e],r[t]||(r[t]={}),o=r[t],"n"!==r.rs&&(r.rs="e"),i=n._originalItem,a=n._oldValue,T(i)||(r.originalItem=i),T(a)||(o.oldValue=a))},getValue:function(e,t){var n=this.getNode(e,t);return n&&!T(n.value)?n.value:l},setValue:function(e,t,n){var r=this.getNode(e,t,!0),o=r.value;o!==n&&(r.value=n,this._updateDirty(e,t,{_oldValue:o}))},getStyle:function(e,t){var n=this.getNode(e,t);return n&&n.style},setStyle:function(e,t,n){var r=this.getNode(e,t,!0);r&&r.style!==n&&(r.style=n)},getValueForKey:function(e,t,n){var r=this.getNode(e,t);return r&&r[n]},setValueForKey:function(e,t,n,r){var o=this.getNode(e,t,!0);o[n]!==r&&(o[n]=r)},addRows:function(e,t){var n,r=this,o=M(r),i=r.dataTable,a=r._dirtyNodes;if(0<=e&&e<=o&&t>=0)for(x(i,o,e,t),x(r._rowDataArray,o,e,t),x(a,o,e,t),r.rowCount+=t,n=0;n<t;n++)i[e+n]={rs:"n"},a[e+n]=i[e+n]},deleteRows:function(e,t){var n=this,r=M(n);0<=e&&e<r&&t>0&&(e+t>r&&(t=r-e),b(n.dataTable,r,e,t),b(n._rowDataArray,r,e,t),b(n._dirtyNodes,r,e,t),n.rowCount-=t)},addColumns:function(e,t){var n,r,o=this,i=E(o);if(0<=e&&e<=i&&t>=0){for(n=0;n<M(o);n++)(r=o.dataTable[n])&&e<i&&x(r,i,e,t);x(o._columnDataArray,i,e,t),o.colCount+=t}},deleteColumns:function(e,t){var n,r,o=this,i=E(o);if(0<=e&&e<i&&t>0){for(n=0;n<M(o);n++)(r=o.dataTable[n])&&b(r,i,e,t);b(o._columnDataArray,i,e,t),e+t>i&&(t=i-e),o.colCount-=t}},getNode:function(e,t,n){var r,o=this,i=o.dataTable,a=o._columnDataArray,s=o._rowDataArray,u=l;return e<o.rowCount&&t<o.colCount&&(e>=0&&t>=0?(r=i[e],n&&!r&&(r=i[e]={},e>o._lastNonNullRow&&(o._lastNonNullRow=e)),r&&(u=r[t],n&&!u&&(u=r[t]={},o._lastNonNullColumn<t&&(o._lastNonNullColumn=t)))):-1===e&&t>=0?(u=a[t],n&&!u&&(u=a[t]={},o._lastNonNullColumn<t&&(o._lastNonNullColumn=t))):e>=0&&-1===t?(u=s[e],n&&!u&&(u=s[e]={},o._lastNonNullRow<e&&(o._lastNonNullRow=e))):-1===e&&-1===t&&(u=o._defaultDataNode,n&&!u&&(u=o._defaultDataNode={}))),u},setNode:function(e,t,n){var r,o=this,i=o.dataTable,a=o._columnDataArray,l=o._rowDataArray;e<o.rowCount&&t<o.colCount&&(e>=0&&t>=0?(r=i[e],r||(r=i[e]={}),r[t]=n):-1===e&&t>=0?a[t]=n:-1===t&&e>=0&&(l[e]=n))},swapNode:function(e,t,n,r){var o=this,i=o.dataTable,a=o._rowDataArray,s=o._columnDataArray,u=o.getNode(e,t),c=o.getNode(n,r);u?V(e,t,n,r,u,i,a,s):c&&V(e,t,n,r,l,i,a,s),c?V(n,r,e,t,c,i,a,s):u&&V(n,r,e,t,l,i,a,s)},nextNonNullRow:function(e){e++;for(var t=M(this),n=this.dataTable;e>=0&&e<t&&!n[e];)e++;return e<t?e:-1},nextNonNullColumn:function(e,t){var n=this,r=l,o=E(n);if(e>=0&&e<M(n)&&(r=n.dataTable[e]),r){for(t++;t>=0&&t<o&&!r[t];)t++;if(t<o)return t}return-1},clear:function(e,t,n,r,o,i){var a,s,u,_,f=this,d=M(f),h=E(f),p=[];if(e>=0&&t>=0){if(n=c(n,d-e),r=c(r,h-t),n>0&&r>0)for(u=e;u<e+n;u++)if(!i||g._ArrayHelper._indexOf(i,u)<0)for(s=t;s<t+r;s++)(a=f.getNode(u,s))&&(p.push(a),(1&o)>0&&!T(a.value)&&f._updateDirty(u,s,{_oldValue:a.value}))}else if(e>=0&&-1===t){if((n=c(n,d-e))>0)for(u=e;u<e+n;u++)(a=f.getNode(u,-1))&&p.push(a)}else if(-1===e&&t>=0){if((r=c(r,h-t))>0)for(s=t;s<t+r;s++)(a=f.getNode(-1,s))&&p.push(a)}else-1===e&&-1===t&&(a=f._defaultDataNode)&&p.push(a);for(_=0;_<p.length;_++)p[_]&&((8&o)>0&&(p[_].tag=l),(2&o)>0&&(p[_].style=l),(1&o)>0&&(p[_].value=l),(16&o)>0&&(p[_].sparkline=l),(64&o)>0&&(p[_].bindingPath=l),(4&o)>0&&(p[_].comment=l))},toJSON:function(e,t){var n,r,o,i,a,u,c,_,f,d,h,g,p,v,C,y;function S(e,n,r){var o,i,a,u,c,_,f,d;return e?(o={},i=e.value,T(i)||(o.value=i),a=t&&t.ignoreStyle,a||(u=e.style,"string"==typeof u?o.style=u:u&&(c=u.toJSON(n,r),_=u.font,c&&(_&&(c.font=m._normalizeFont(_)),c.name=s,o.style=c))),f=e.bindingPath,T(f)||(o.bindingPath=f),d=e.tag,T(d)||(o.tag=d),o):l}for(n=this,r={},o={},i=n.nextNonNullRow(-1);i>=0;){for(u={},c=!1,a=n.nextNonNullColumn(i,-1);a>=0;)_=n.getNode(i,a),_&&(f=S(_),w(f)||(u[a]=f,c=!0)),a=n.nextNonNullColumn(i,a);c&&(o[i]=u),i=n.nextNonNullRow(i)}for(w(o)||(r.dataTable=o),d=[],h=n._rowDataArray,i=0;i<M(n);i++)I(h,i)&&h[i]&&(g=S(h[i]),w(g)||(d[i]=g));for(d.length>0&&(r.rowDataArray=d),p=[],v=n._columnDataArray,a=0;a<E(n);a++)I(v,a)&&v[a]&&(C=S(v[a]),w(C)||(p[a]=C));return p.length>0&&(r.columnDataArray=p),y=S(n._defaultDataNode,e,!0),w(y)||(r.defaultDataNode=y),r},fromJSON:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d;if(e){if(r=this,r._dirtySuspended++,T(e.name)||(r.name=e.name),o=e.dataTable,l=M(r),s=E(r),o)for(i=0;i<l;i++)if(u=o[i])for(a=0;a<s;a++)(c=u[a])&&P(c,r.getNode(i,a,!0),t,i,a,n);if(_=e.rowDataArray||e._rowDataArray)for(i=0;i<l;i++)I(_,i)&&_[i]&&P(_[i],r.getNode(i,-1,!0),t,i,-1,n);if(f=e.columnDataArray||e._columnDataArray)for(a=0;a<s;a++)I(f,a)&&f[a]&&P(f[a],r.getNode(-1,a,!0),t,-1,a,n);d=e.defaultDataNode||e._defaultDataNode,d&&P(d,r.getNode(-1,-1,!0),t,-1,-1,n),r._dirtySuspended--}}},d._SheetModel=N;function O(e,t){var n=e._infos,r=n[t];return r||(n[t]=r={},e.length=n.length),r}function H(){this._infos=[]}a=H.prototype={addItems:function(e,t){var n=this,r=n.length;0<=e&&e<=r&&t>0&&x(n._infos,r,e,t),n.length+=t},deleteItems:function(e,t){var n=this,r=n.length;0<=e&&e<r&&t>0&&(t=c(t,r-e),b(n._infos,r,e,t)),n.length-=t},reset:function(e){var t=this._infos;t.length>e&&(t[e]=l)},_getItems:function(){return this._infos},_setItems:function(e,t){this._infos=e,this.length=t},_getItem:function(e){return this._infos[e]},_setItem:function(e,t){this._infos[e]=t,this.length=this._infos.length},getSize:function(e){var t=this._infos[e],n=l;return t&&(n=!1===t.visible?0:_(t.size)),n},getActualSize:function(e){var t=this._infos[e];return t?_(t.size):l},setSize:function(e,t){var n=O(this,e);n.size!==t&&(n.size=t)}},C({visible:!0,resizable:!0,pageBreak:!1},function(e,t){var n=e[0].toUpperCase()+e.substr(1);a["get"+n]=function(n){var r=t,o=this._infos[n];return o&&!T(o[e])&&(r=o[e]),r},a["set"+n]=function(t,n){var r=O(this,t);r[e]!==n&&(r[e]=n)}});function P(e,t,r,o,i,a){var c,_,f,d,g,m,v,C,w,y,S;e&&(c=e.value,c!==s&&(c!==l&&(c._calcError||c._error&&c._code)&&(_=n(2),(f=_&&_.CalcError.parse(c._calcError||c._error))!==s&&(c=f)),t.value=c),d=e.style,g=a&&a.sheet,d===s||a.ignoreStyle||(m=l,typeof d===u?(t.style=d,m=g&&(g._getNamedStyleImp(d,!1)||g.parent&&g.parent._getNamedStyleImp(d,!1))):d&&(m=new h,m.fromJSON(d,r),m.name=s,t.style=m),m&&m.validator&&a&&a.setValidator&&a.setValidator(o,i,m.validator)),v=e.visualState,v!==s&&(t.visualState=v),C=e.bindingPath,C!==s&&(t.bindingPath=C),(w=e.tag)!==s&&(y=w.typeName,typeof y===u&&(S=p.getTypeFromString(y))&&(w=new S,
w.fromJSON&&w.fromJSON(e.tag)),t.tag=w))}d._AxisModel=H,e.exports=d}()},function(e,t,n){!function(){"use strict";var t,r=n(1),o=n(3),i=n(9)._ImageLoader,a=n(12).Style,l=n(16),s=n(4).GC$,u=n(5),c=o._util,_=o._DPIHelper,f=o._util._createElement,d=o._createRange,h=u._Types._isNullOrUndefined,g=o._CachePool,p=o.Rect,m=o.Events,v=c._defProperty,C=c._createOptions,w=c._isValidSheetName,y=o._FocusHelper,S=o._ThemeStyleHelper,x=o.Themes,b=o.Theme,T=l._Layout,R=l._LayoutModel,A=s.each,I=s.isEmptyObject,M=u._DateTimeHelper,E=u._hasOwnProperty,F=window,D=document,N=parseInt,V=parseFloat,O=isNaN,H=null,P=void 0,L=Math.min,k=Math.max,B=Math.floor,W="undefined",z="string",U="width",Y="height",G="black",X="tag",j="onLayoutChanged",K="onPaintSuspend",Z="isVisible",J="resizable",q=".gcSheet",Q=".gcSheetInternal",$=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),ee=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),te={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0};r.RangeChangedAction={dragDrop:0,dragFill:1,clear:2,paste:3,sort:4,setArrayFormula:5,evaluateFormula:6},r.SheetArea={corner:0,colHeader:1,rowHeader:2,viewport:3},r.HeaderAutoText={blank:0,numbers:1,letters:2};function ne(){return u._getResource(r.SR)()}function re(e){if(typeof e===z&&"/"===e.charAt(0)){var t;ee.test(e)?(t=e.match(ee),e=M._fromOADate(V(t[1]))):$.test(e)&&(t=e.match($),e=new Date(V(t[1])))}return e}function oe(e){return!h(e)&&M._isDate(e)&&(e=M._toOADateString(e)),e}function ie(e,t){var n,r,o,i=[],a=e._getModel()._dirtyNodes;if(a)for(n in a)E(a,n)&&(r=a[n])&&r.rs===(t?"e":"n")&&(o={row:+n,item:e.getDataItem&&e.getDataItem(n)},t&&(o.originalItem=r.originalItem),i.push(o));return i}function ae(e,t,n){var r,o=0;for(r=t;r<=n;r++)o+=e._getZoomColWidth(r);return o}function le(e,t,n){var r,o=0;for(r=t;r<=n;r++)o+=e._getZoomRowHeight(r);return o}function se(e){return e.getColumnCount()}function ue(e){return e.getRowCount()}function ce(e){return e.frozenTrailingColumnCount()}function _e(e){return e.frozenTrailingRowCount()}function fe(e){return e.frozenColumnCount()}function de(e){return e.frozenRowCount()}function he(e,t,n){Object.defineProperty(e,t,{get:function(){return this["_"+t]},set:function(e){var r=this["_"+t];r!==e&&(this["_"+t]=e,n&&n(t,e,r))}})}t={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:G,rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:H,selectionBackColor:H,selectionBorderColor:H,allowCellOverflow:!0,isProtected:!1,protectionOptions:{},gridline:{},borderColor:G,borderWidth:0};function ge(e){var n=this;n._id=ge._ID++,n.options=C(t,function(e,t,r){n._onOptionChanged(e,t,r)}),n._init(e)}o._defineFeature(ge),ge._ID=1,ge._defaultOptions=t,ge._defaultRowCount=200,ge._defaultColCount=20,ge._defaultRowHeaderColumnCount=1,ge._defaultColHeaderRowCount=1,ge._defaultRowHeight=20,ge._defaultColWidth=62,ge._defaultRowHeaderColWidth=40,ge._defaultColHeaderRowHeight=20;function pe(e,t,n,r){return{row:t,col:n,newValue:e.getValue(t,n),oldValue:r}}ge.prototype={constructor:ge,_onOptionChanged:function(e,t,n){var r,o,i=this,a=i.parent;switch(e){case"allowCellOverflow":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":i._invalidate();break;case"gridline":r=function(){i._invalidate()},o=i.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach(function(e){var n=t[e];he(o,e,r),o[e]=n});break;case"isProtected":a&&a.undoManager().clear(),i._adjustActiveCellToSelectable(),ge._callFeatureHandler(i,"onProtectChanged"),i._invalidate();break;case"protectionOptions":i._adjustActiveCellToSelectable(),ge._callFeatureHandler(i,"onProtectChanged");break;case"sheetTabColor":a&&a._doTabHSResize()}},name:function(e){var t=this,n=t.parent;if(0===arguments.length)return t._name;if(!w(e,n?n.sheets:null,t))throw ne().Exp_NotSupported;return t._setNameCore(e),n&&n._doTabHSResize(),t},_setNameCore:function(e){var t=this,n=t._name;ge._callFeatureHandler(t,"beforeSetName",{oldName:n,newName:e}),t._name=e,ge._callFeatureHandler(t,"setName",{oldName:n,newName:e})},visible:v("visible",!0,function(e){var t,n=this,r=n.parent,o=r.sheets,i=o.length,a=s.inArray(n,o),l=r.getActiveSheetIndex();if(e)l<0?r._setActiveSheetIndexImp(a,1):r._doTabHSResize();else if(a===l){for(t=a+1;t<i&&!o[t].visible();)t++;if(t>=i)for(t=a-1;t>=0&&!o[t].visible();)t--;t<r._tab._firstTab&&(r._tab._firstTab=t),t<0?(n._dispose(!1),r._activeSheetIndex=t,r._doResize()):r._setActiveSheetIndexImp(t,1)}else r._doTabHSResize()}),addRows:function(e,t){var n,r,o,i,a,l,s,u;if(!(t<=0)){n=this,r=ue(n),(e<0||e>r)&&(e=r),n.suspendPaint();try{if(o={changeType:"addingRows",row:e,rowCount:t,canAdd:!0},ge._callFeatureHandler(n,j,o),!o.canAdd)return;h(o.newRow)||(e=o.newRow),i=this._getRowInfos(),i.addItems(e,t),a=this._getModel(),a.addRows(e,t),l=n._getModel(2),l.addRows(e,t),s=n._getSpanModel(2),s.addRows(e,t),s=n._getSpanModel(),s.addRows(e,t),n._needSyncVScrollbarSize=!0,u="addRows",ge._callFeatureHandler(n,j,{changeType:u,row:e,oldValue:r,rowCount:t}),ge._callFeatureHandler(n,j,{changeType:"addRows2",row:e,oldValue:r,rowCount:t}),n._raiseRowChanged(e,3,u,t,r)}finally{n.resumePaint()}}},deleteRows:function(e,t){var n,r,o,i,a,l,s,u,c,_,f,d=this,h=ue(d);if(!(0>e||e>=h||t<=0)){d.suspendPaint();try{if(n={changeType:"deletingRows",row:e,rowCount:t,canDelete:!0},ge._callFeatureHandler(d,j,n),!n.canDelete)return;if(r=this._getRowInfos(),r.deleteItems(e,t),o=d._getModel(),o.deleteRows(e,t),i=d._getModel(2),i.deleteRows(e,t),a=d._getSpanModel(2),a.removeRows(e,t),a=d._getSpanModel(),a.removeRows(e,t),(l=d._scrollTopRow)>=0){for(s=-1,u=de(d),c=l;c>=u;c--)if(d.getRowVisible(c)&&d._getZoomRowHeight(c)>0){s=c;break}-1===s&&(s=0),l!==s&&d._setTopRow(s)}_=h,d.getActiveRowIndex()>=_&&d.setActiveCell(_-1,d.getActiveColumnIndex()),d._needSyncVScrollbarSize=!0,f="deleteRows",ge._callFeatureHandler(d,j,{changeType:f,row:e,oldValue:h,rowCount:t}),d._raiseRowChanged(e,3,f,t,h)}finally{d.resumePaint()}}},addColumns:function(e,t){var n,r,o,i,a,l,s,u;t<=0||(n=this,r=se(n),(e<0||e>r)&&(e=r),o={changeType:"addingColumns",col:e,colCount:t,canAdd:!0},ge._callFeatureHandler(n,j,o),o.canAdd&&(i=n._getColInfos(),i.addItems(e,t),a=n._getModel(),a.addColumns(e,t),l=n._getModel(1),l.addColumns(e,t),l=n._getModel(4),l&&l.addColumns(e,t),s=n._getSpanModel(1),s.addColumns(e,t),s=n._getSpanModel(),s.addColumns(e,t),n._needSyncHScrollbarSize=!0,u="addColumns",ge._callFeatureHandler(n,j,{changeType:u,col:e,oldValue:r,colCount:t}),n._raiseColumnChanged(e,3,u,t,r),n._invalidate()))},deleteColumns:function(e,t){var n,r,o,i,a,l,s,u,c,_,f,d=this,h=se(d);if(!(0>e||e>=h||t<=0)&&(n={changeType:"deletingColumns",col:e,colCount:t,canDelete:!0},ge._callFeatureHandler(d,j,n),n.canDelete)){if(r=d._getColInfos(),r.deleteItems(e,t),o=d._getModel(),o.deleteColumns(e,t),i=d._getModel(1),i.deleteColumns(e,t),i=d._getModel(4),i&&i.deleteColumns(e,t),a=d._getSpanModel(1),a.removeColumns(e,t),a=d._getSpanModel(),a.removeColumns(e,t),(l=d._scrollLeftCol)>=0){for(s=-1,u=fe(d),c=l;c>=u;c--)if(d.getColumnVisible(c)&&d._getZoomColumnWidth(c)>0){s=c;break}-1===s&&(s=0),l!==s&&d._setLeftColumn(s)}_=h,d.getActiveColumnIndex()>=_&&d.setActiveCell(d.getActiveRowIndex(),_-1),d._needSyncHScrollbarSize=!0,f="deleteColumns",ge._callFeatureHandler(d,j,{changeType:f,col:e,oldValue:h,colCount:t}),d._raiseColumnChanged(e,3,f,t,h),d._invalidate()}},frozenColumnCount:v("frozenColumnCount",0,function(e){var t=this;t._scrollLeftCol<e&&(t._scrollLeftCol=e),t._needSyncHScrollbarSize=!0,t._invalidate()},function(e){return e>=0}),frozenRowCount:v("frozenRowCount",0,function(e){var t=this;t._scrollTopRow<e&&(t._scrollTopRow=e),t._needSyncVScrollbarSize=!0,t._invalidate()},function(e){return e>=0}),frozenTrailingRowCount:v("frozenTrailingRowCount",0,function(){var e=this;e._needSyncVScrollbarSize=!0,e._invalidate()},function(e){return e>=0}),frozenTrailingColumnCount:v("frozenTrailingColumnCount",0,function(){var e=this;e._needSyncHScrollbarSize=!0,e._invalidate()},function(e){return e>=0}),getRowCount:function(e){return 0===e?0:ue(this._getModel(e))},getColumnCount:function(e){return 0===e?0:se(this._getModel(e))},setRowCount:function(e,t){var n,r;h(t)&&(t=3),n=this,r={changeType:"settingRowCount",rowCount:e,sheetArea:t,canSet:!0},ge._callFeatureHandler(n,j,r),r.canSet&&n.setRowCountCore(e,t)},setRowCountCore:function(e,t){var n,r,o,i,a;e=N(e,10),O(e)||(h(t)&&(t=3),n=this,r=n._getModel(),e<0||e===n.getRowCount(t)||(3===t||2===t?(o=ue(r),o>e&&n.deleteRows(e,o-e),r.setRowCount(e),n._getModel(2).setRowCount(e),de(n)>e&&n.frozenRowCount(e)):1===t&&(i=n._getModel(1),ue(i)>e&&(a=n._getRowInfos(t),a.deleteItems(e,ue(i)-e)),i.setRowCount(e)),ge._callFeatureHandler(n,j,{changeType:"setRowCount",rowCount:e,sheetArea:t}),n._needSyncVScrollbarSize=!0,n._activeRowIndex>=e&&(3===t||2===t)&&n.setActiveCell(e-1,n.getActiveColumnIndex()),n._invalidate(),n.clearPendingChanges()))},setColumnCount:function(e,t){var n,r,o,i,a;e=N(e,10),O(e)||(n=this,r=n._getModel(),e<0||e===n.getColumnCount(t)||(h(t)&&(t=3),3===t||1===t?(o=se(r),o>e&&n.deleteColumns(e,o-e),n._getModel().setColumnCount(e),n._getModel(1).setColumnCount(e),n._getModel(4)&&n._getModel(4).setColumnCount(e),fe(n)>e&&n.frozenColumnCount(e)):2===t&&(i=n._getModel(2),se(i)>e&&(a=n._getColInfos(t),a.deleteItems(e,se(i)-e)),i.setColumnCount(e)),ge._callFeatureHandler(n,j,{changeType:"setColumnCount",colCount:e,sheetArea:t}),n._needSyncHScrollbarSize=!0,n._activeColIndex>=e&&(3===t||1===t)&&n.setActiveCell(n.getActiveRowIndex(),e-1),n._invalidate(),n.clearPendingChanges()))},getText:function(e,t,n){var r,o,i,a,l,s;return h(n)&&(n=3),r=this,o=r.getValue(e,t,n),i=r.getCellType(e,t,n),a=r._getStyleProperty(e,t,"formatter",n),a||(a=r._getStyleProperty(e,t,"_autoFormatter",n)),l={},s=r._getStyleProperty(e,t,"quotePrefix",n),o=i.format(o,a,l,{sheet:r,row:e,col:t,sheetArea:n,quotePrefix:s}),o&&"string"==typeof o&&(o=o.replace(/\r\n?/g,"\n")),o},setText:function(e,t,n,r){var o,i,a,l,s,u,c=this;h(r)&&(r=3),o=n,i={value:n},ge._callFeatureHandler(c,"settingText",i),n=i.value,a=n,l=c.getCellType(e,t,r),s=c.getFormatter&&c.getFormatter(e,t,r),l&&s&&(u={sheet:c,row:e,col:t,sheetArea:r},a=l.parse(o,s,u),a=h(a)?n:a),c._setValueInternal(e,t,a,r),c._invalidate()},getValue:function(e,t,n){var r,o,i,a,l,s,u,c,_,f;return 0===n?H:(h(n)&&(n=3),r=this,o=r.options,i=r._getModel(n),a=r._getValueImp(i,e,t,n),1===n?h(a)&&(s=r._bindingManager,s&&s._dataSource&&(u=r._getColInfos()._getItem(t),c=o.colHeaderAutoTextIndex,u&&(c>=0&&e===c||-1===c&&e===ue(i)-1)&&(a=u.displayName||u.name)),h(a)&&(l=o.colHeaderAutoTextIndex,(l<0||l>=ue(i))&&(l=ue(i)-1),e===l&&(_=o.colHeaderAutoText,2===_?a=r._indexToLetters(t+1):1===_&&(a=t+1)))):2===n&&h(a)&&(l=o.rowHeaderAutoTextIndex,(l<0||l>=se(i))&&(l=se(i)-1),t===l&&(f=o.rowHeaderAutoText,2===f?a=r._indexToLetters(e+1):1===f&&(a=e+1))),a)},setValue:function(e,t,n,r,o){this._setValueInternal(e,t,n,r,o),this._invalidate()},_setValueInternal:function(e,t,n,o,i){var a,l,u,c,_,f,d,g,p,m,v,C,w,y;if(0!==o&&(h(o)&&(o=3),a=this,l=a._getModel(o),u=ue(l),c=se(l),!(e<0||e>=u||t<0||t>=c))){if(_=3===o,n=oe(n),a.isEventSuspended()&&a.isDirtySuspended()||(f=a._getValueImp(l,e,t,o)),d=!1,g=a.tables,_&&g&&(m=g.find(e,t))){if(p=g._setValue(e,t,n),!p.isValid)return;d=p.isValueSet}_?(v=a._bindingManager,!d&&v&&v._dataSource&&(C=v.getValue(e,t),C.hasBinding&&n!==C.value&&(a.isDirtySuspended()||(w=s.extend({},a.getDataItem(e)),l._updateDirty(e,t,{_originalItem:w,_oldValue:f})),v.setValue(e,t,n)),d=C.hasBinding),d||l.setValue(e,t,n)):l.setValue(e,t,n),_&&!i&&r._supportsCalc&&a._recalcCell(l,e,t),a._updateTableSlicer&&a._updateTableSlicer(e,t,1,1,o),y=a.conditionalFormats,y&&y._clearCache(),a.isEventSuspended()||f===n||a._raiseCellChanged("value",e,t,o,f,n)}},getActualStyle:function(e,t,n,r,o){var i,l,s,u,c,_,f,d,g,p,m,v,C,w,y,S,x,b,T,R,A,I;if(h(n)&&(n=3),0===n)return new a;if(-1===e&&-1===t)return this.getDefaultStyle(n);if(i=this,f=i._styleComposeCache,y="__spreadJSDefault",S="__undefined",x=this._getModel(n),u=x.getStyle(e,t),c=x.getStyle(e,-1),_=x.getStyle(-1,t),u=u||H,c=c||H,_=_||H,v=S,u&&(v=u.charAt?u:y+u._id),C=S,c&&(C=c.charAt?c:y+c._id),w=S,_&&(w=_.charAt?_:y+_._id),m=f[n],d=m[v],b=i.tables,T=3===n&&b?b.find(e,t):H,T||(d||(d=m[v]={}),g=d[C],g?p=g[w]:g=d[C]={}),p||(s=i._getCompositeStyle(e,t,n,u,c,_,T)),3!==n||r||(p||(R=s.formatter)&&R.hasFormatedColor&&R.hasFormatedColor()&&(A={value:H},R.format(i.getValue(e,t),A),A.value&&(l=new a,l.foreColor=A.value)),(I=i.conditionalFormats)&&(l=I._applyFormats(l,e,t,n))),l)l._compose(p||s),s=l;else if(p)return o?p:p.clone(!0);return h(s.locked)&&(s.locked=!0),s=s._normalize(i._currentTheme),l||T||(g[w]=s.clone(!0)),s},_getStyleProperty:function(e,t,n,r){var o,i,l,s,u,c,_,f,d,g,p,m,v,C,w;if(0===r)return P;for(h(r)&&(r=3),o=this,u=o._getModel(r),_=!1,3===r&&("foreColor"===n&&(d=o._getStyleProperty(e,t,"formatter",r))&&d.hasFormatedColor&&d.hasFormatedColor()&&(g={value:H},d.format(o.getValue(e,t),g),g.value&&(c=g.value,_=!0)),(p=o.conditionalFormats)&&p.count()>0&&(m=p._getConditionalStyle(e,t,n,r),_=m._hasResult,c=m._result)),v=0;!_&&v<=4;)if(0===v?i=u.getStyle(e,t):1===v?(C=o.tables,w=3===r&&C?C.find(e,t):H,w&&te[n]&&(i=w._getStyle(e,t,n))):i=2===v?u.getStyle(e,-1):3===v?u.getStyle(-1,t):o.getDefaultStyle(r),v++,i&&i.charAt&&typeof i===z&&(i=o._name2Style(i)),i){if("font"===n&&i.themeFont&&!f&&(f=i.themeFont),i[n]!==P){c=i[n],_=!0;break}for(l=i.parentName;l&&(s=o._name2Style(l));){if(s[n]!==P){c=s[n],_=!0;break}l=s.parentName}}return"locked"===n?!!h(c)||c:_||f?("foreColor"!==n&&"backColor"!==n&&"font"!==n&&"borderLeft"!==n&&"borderTop"!==n&&"borderRight"!==n&&"borderBottom"!==n||(i=new a,i[n]=c,"font"===n&&f&&(i.themeFont=f),i._normalize(o._currentTheme),c=i[n]),c):P},getStyle:function(e,t,n){return this._getStyleImp(e,t,n,!0)},_getStyleImp:function(e,t,n,r){var o,i,l,s;if(h(n)&&(n=3),0!==n){if(o=this._getModel(n),(i=o.getStyle(e,t))instanceof a)return r&&this._clearStyleCache(),i;if(typeof i===z&&(l=this._name2Style(i))!==H)return s=new a,s._compose(l),r&&this._clearStyleCache(),s}return H},addNamedStyle:function(e){this._addNamedStyleImp(e),this._invalidate()},_addNamedStyleImp:function(e){if(e){if(!e.name)throw Error(ne.Exp_EmptyNamedStyle);var t=e.name.toUpperCase();this._namedStyles[t]=e}},getNamedStyle:function(e){return this._getNamedStyleImp(e,!0)},_getNamedStyleImp:function(e,t){var n,r=this._namedStyles;return r&&e?(e=e.toUpperCase(),n=r[e],n&&t&&this._clearStyleCache(),n):H},_clearStyleCache:function(){this._styleComposeCache=[{},{},{},{}]},removeNamedStyle:function(e){var t=this._namedStyles;t&&e&&(e=e.toUpperCase(),E(t,e)&&(delete t[e],this._clearStyleCache(),this._invalidate()))},getNamedStyles:function(){var e=[],t=this._namedStyles;return t&&A(t,function(t,n){e.push(n)}),this._clearStyleCache(),e},setStyle:function(e,t,n,r){h(r)&&(r=3);var o=this;o._setStyleObject(e,t,n,r),-1===e&&-1===t&&(o._composedDefaultStyle[r]=H),-1!==e&&-1!==t||n&&n.validator&&n.validator.condition()&&4===n.validator.condition().conType()&&n.validator.condition().getExpected(this,e<0?0:e,t<0?0:t),o._clearStyleCache(),o._invalidate()},_setStyleWithoutLocked:function(e,t,n,r){var o,i,l=this;l.options.isProtected?(o=l.getStyle(e,t,r),n?(i=o?o.locked:P,n.locked!==i&&(n.locked=i),l.setStyle(e,t,n,r)):o&&(i=o.locked,i!==P&&(n=new a,n.locked=i),l.setStyle(e,t,n,r))):l.setStyle(e,t,n,r)},getStyleName:function(e,t,n){var r=this._getStyleObject(e,t,n);return r instanceof a?r.name:r},setStyleName:function(e,t,n,r){typeof n===z&&(this._setStyleObject(e,t,n,r),this._invalidate())},_getStyleObject:function(e,t,n){var r,o;return h(n)&&(n=3),0!==n&&(o=this._getModel(n),r=o.getStyle(e,t)),r||H},_setStyleObject:function(e,t,n,r){var o,i,a,l,s,u,c,_,f;if(h(r)&&(r=3),0!==r){if(o=this,i=o._getStyleObject(e,t,r),a=o._getModel(r),l=ue(a),s=se(a),e<-1||e>=l||t<-1||t>=s)return;u=a.getStyle(e,t),a.setStyle(e,t,n),c=i&&i.cellType&&i.cellType.typeName||H,_=n&&n.cellType&&n.cellType.typeName||H,e===o._activeRowIndex&&t===o._activeColIndex&&c!==_&&y._isActiveElement(o)&&o._eventHandler._changeFocusHolder(),f="[styleinfo]",-1!==e&&-1!==t?o._raiseCellChanged(f,e,t,r,u,n):-1!==e&&-1===t?o._raiseRowChanged(e,r,f,n,u):-1===e&&-1!==t&&o._raiseColumnChanged(t,r,f,n,u)}},getDefaultStyle:function(e){var t,n,r,o,i,l,s;return h(e)&&(e=3),t=this,n=t._composedDefaultStyle,(r=n[e])?r:0!==e?(o=t._getModel(e),i=o.getStyle(-1,-1),typeof i===z&&(i=t._name2Style(i)),i||(i=new a,o.setStyle(-1,-1,i)),l=1===e||2===e,typeof i.hAlign===W&&(i.hAlign=l?1:3),typeof i.vAlign===W&&(i.vAlign=l?1:0),typeof i.imeMode===W&&(i.imeMode=1),i.font||typeof i.themeFont!==W||(i.themeFont="Body"),n[e]=i,i):(s=new a,s.locked=!0,n[e]=s,s)},setDefaultStyle:function(e,t){var n,r;h(t)&&(t=3),n=this,0!==t&&(r=n._getModel(t),r.setStyle(-1,-1,e)),n._composedDefaultStyle[t]=H,n._clearStyleCache(),n._invalidate()},_name2Style:function(e){var t,n=this._getNamedStyleImp(e,!1);return n||(t=this.parent,t?t._getNamedStyleImp(e,!1):H)},_getCompositeStyle:function(e,t,n,r,o,i,l,s){var u,c,_,f,d,g,p,m,v,C,w;if(h(n)&&(n=3),u=this,c=new a,0!==n){if(d=!1,g=u._getModel(n),p=u.tables,m=ue(g),v=se(g),0<=e&&e<m&&0<=t&&t<v&&(C=r!==P?r:g.getStyle(e,t),C&&C.charAt&&(C=u._name2Style(C)),C))for(c._compose(C,!0,10),d=!0,f=C.parentName;f&&(_=u._name2Style(f));)c._compose(_,!1,10),f=_.parentName;if(s)return c;if(l===P&&(l=3===n&&p?p.find(e,t):H),l&&(l._compose(e,t,c),d=!0),0<=e&&e<m&&(C=o!==P?o:g.getStyle(e,-1),C&&C.charAt&&(C=u._name2Style(C)),C))for(c._compose(C,!d,30),d=!0,f=C.parentName;f&&(_=u._name2Style(f));)c._compose(_,!1,30),f=_.parentName;if(0<=t&&t<v&&(C=i!==P?i:g.getStyle(-1,t),C&&C.charAt&&(C=u._name2Style(C)),C))for(c._compose(C,!d,40),d=!0,f=C.parentName;f&&(_=u._name2Style(f));)c._compose(_,!1,40),f=_.parentName}if(w=u.getDefaultStyle(n),w&&w.charAt&&(w=u._name2Style(w)),w)for(c._compose(w,!d,50),f=w.parentName;f&&(_=u._name2Style(f));)c._compose(_,!1,50),f=_.parentName;return c},getCellType:function(e,t,n){return this._getStyleProperty(e,t,"cellType",n)||this._getDefaultCellType(n)},_getDefaultCellType:function(e){var t,r;return h(e)&&(e=3),t=n(13).CellTypes,r=this._defaultCellType,r||(r=this._defaultCellType=new t.Text),3===e?r:1===e?new t.ColumnHeader:2===e?new t.RowHeader:0===e?new t.Corner:r},setCellType:function(e,t,n,r){var o=this._getStyleImp(e,t,r);o||(o=new a),o.cellType=n,this.setStyle(e,t,o,r)},_addSpanImp:function(e,t,n,r,o){var i,a,l,s,u,c,_,f=this;if(h(o)&&(o=3),i=f._getSpanModel(o),i.clear(e,t,n,r),a=d(e,t,n,r),l=f._getActualRange(a,o),s=f._adjustSpanRange(l,o),i.addSpan(s),3===o&&(u=f._selectionModel)){for(c=f.getSelections(),_=0;_<c.length;_++)c[_].intersect(e,t,n,r)&&(c[_]=c[_].union(a));u.fromArray(c)}f._invalidate()},_adjustSpanRange:function(e,t){var n=this.getRowCount(t),r=this.getColumnCount(t),o=e.row,i=e.col,a=e.rowCount,l=e.colCount;return o+a>n&&(a=n-o),i+l>r&&(l=r-i),d(o,i,a,l)},addSpan:function(e,t,n,o,i){var a,l,s,u,c,_=this;if((1!==n||1!==o)&&0!==i&&(a=_.getRowCount(i),l=_.getColumnCount(i),!(e>=a||t>=l||e<-1||t<-1)&&(s=!0,r._supportsCalc&&(3===i||h(i))&&(s=_._checkArrayFormula(e,t,n,o,!1)),s))){if(u=_._getSpanModel(i),u.hasPartSpans(e,t,n,o))throw Error(ne().Exp_InvalidRange);_._addSpanImp(e,t,n,o,i),c={sheet:_,row:e,col:t,rowCount:n,colCount:o,sheetArea:i,changeType:"addSpan"},ge._callFeatureHandler(_,j,c),_._trigger("spanChanged",c)}},removeSpan:function(e,t,n){var r,o,i,a,l=this;for(h(n)&&(n=3),r=l._getSpanModel(n),o=0;o<r.length;o++)if(i=r[o],i.row===e&&i.col===t){r.removeSpan(o,1);break}a={sheet:l,row:e,col:t,sheetArea:n,changeType:"removeSpan"},ge._callFeatureHandler(l,j,a),l._trigger("spanChanged",a),l._invalidate()},getSpans:function(e,t){return 0===t?[]:this._getSpanModel(t).getSpans(e)},getSpan:function(e,t,n){return 0===n?H:this._getSpanModel(n).find(e,t)},repaint:function(e){this._layoutSuspended<=0&&this._render.repaint(e)},_scrollByMoveCell:function(e,t){var n,r,o,i,a,l,s,u,c,_,f=this,d=de(f),h=fe(f),g=h?f._getNextVisualColumn(h-1):f._getFirstVisualColumn(),p=d?f._getNextVisualRow(d-1):f._getFirstVisualRow();if(t<f._scrollLeftCol&&t>=g&&f._setLeftColumn(f._getPrevVisualColumn(t+1)),t>f._getLastFullyVisibleColumn()&&t<=f._getLastVisualColumn()){for(n=0,r=t,o=f._getSheetLayout(),i=f._getSpanModel().find(e,r),i&&(r=i.col+i.colCount-1);r>f._scrollLeftCol&&!((n+=f._getZoomColumnWidth(r))>o._viewportWidth);)r--;a=f._getNextVisualColumn(r),f._setLeftColumn(a)}if(e<f._scrollTopRow&&e>=p&&f._setTopRow(f._getPrevVisualRow(e+1)),e>f._getLastFullyVisibleRow()&&e<=f._getLastVisualRow()){for(f._getFirstVisualRow(),l=0,s=e,u=f._getSpanModel().find(s,t),u&&(s=u.row+u.rowCount-1),c=f._getSheetLayout();s>f._scrollTopRow&&!((l+=f._getZoomRowHeight(s))>c._viewportHeight);)s--;_=f._getNextVisualRow(s),f._setTopRow(_)}t===f._getLastVisualColumn()&&f._setLeftColumn(f._getLastPageLeftColumn())},hitTest:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I=this;if(I._getSheetLayout(),r={x:e,y:t},o=I.rowOutlines,i=I.columnOutlines,o&&(a=o.hitTest(I,e,t)),!a&&i&&(a=i.hitTest(I,e,t)),a)r.outlineHitInfo=a;else{if(l=I._getRowViewportIndexFromY(t),s=I._getColumnViewportIndexFromX(e),r.rowViewportIndex=l,r.colViewportIndex=s,r.row=I._getRowIndexFromY(t,l),r.col=I._getColumnIndexFromX(e,s),r.hitTestType=I._getSheetArea(l,s),l>=0&&l<=2&&s>=0&&(u=I._getCellLayoutByCell(l,s,P,r.row,r.col),u&&!0!==n&&(r.row=u.row,r.col=u.col),c=I._activeRowIndex,_=I._activeColIndex,r.row>=c&&r.col===_&&!0!==n&&(f=I.getActualStyle(c,_),f.cellType&&f.cellType.expandHeight&&(d=I._getRowIndexFromY(t-f.cellType.expandHeight,l),r.row===c||d===c))))return r.row=c,r.cellTypeHitInfo=I._getCellTypeHitInfo(r,e,t),r;h=I._eventHandler,g=h._getDragMergeInfo&&h._getDragMergeInfo(r,e,t),g?r.dragMergeInfo=g:(p=h._getDragInfo&&h._getDragInfo(r,e,t),p?r.dragInfo=p:(m=h._getResizingRowCol(r,e,t,5),m?r.resizeInfo=m:(v=h._getFormulaRangeHitInfo?h._getFormulaRangeHitInfo(r,e,t):H,v?r.formulaRangeHitInfo=v:(C=I.comments,w=C&&C.hitTest(e,t),w?r.commentHitInfo=w:(y=I._floatingObjectModel,S=y&&y.hitTest(e,t),S?r.floatingObjectHitInfo=S:(x=I._rowFilter,b=x&&x.hitTest(r,e,t),b||(T=I.tables,R=T&&T.find(r.row,r.col),A=R&&R._rowFilter,b=A&&A.hitTest(r,e,t)),b?r.filterButtonHitInfo=b:r.cellTypeHitInfo=I._getCellTypeHitInfo(r,e,t)))))))}return r},getCellRect:function(e,t,n,r){var o,i,a,l,s,u,c=3;return-1===n?c=1:-1===r&&(c=2),o=this,i=o._getSheetLayout(),-1===n&&-1===r?new p(i._headerX,i._headerY,i._rowHeaderWidth,i._colHeaderHeight):(a=o._getBounds(),h(n)&&(n=o._getRowViewportIndex(e)),h(r)&&(r=o._getColumnViewportIndex(t)),l=o._getRowLayout(n,c).findRow(e),s=o._getColumnLayout(r,c).findCol(t),u=o._getCellLayout(n,r,c).findCell(e,t),u?new p(u.x-a.x,u.y-a.y,u.width,u.height):l&&s?new p(s.x-a.x,l.y-a.y,s.width,l.height):new p)},_setActiveCellCore:function(e,t,n){var r=this,o=r._eventHandler,i=!1;h(e)||(r._activeRowIndex=e,i=!0),h(t)||(r._activeColIndex=t,i=!0),!n&&o&&i&&o._changeFocusHolder()},_setActiveCellImp:function(e,t,n,r,o){var i,a=this,l=a._activeRowIndex,s=a._activeColIndex,u=a._getSpanModel().get(e,t);a._activeRowCount=u.rowCount,a._activeColCount=u.colCount,a._layoutSuspended<=0&&(i=a._getSpanModel().get(l,s),a._render._repaintSelection(d(l,s,i.rowCount,i.colCount))),a._activeRowViewportIndex=n,a._activeColViewportIndex=r,a._setActiveCellCore(e,t,o),a._leadingCellRow=e,a._leadingCellCol=t},setActiveCell:function(e,t,n,r){this._selectionModel&&this._setActiveCellAndSelection(e,t,n,r,2)},_setActiveCellAndSelection:function(e,t,n,r,o){var i,a,l=this,s=ue(l),u=se(l);e<0?e=0:e>=s&&(e=s-1),t<0?t=0:t>=u&&(t=u-1),l._clearSelectionImp(),i=2===o?y._isActiveElement(l):1===o,l._setActiveCellImp(e,t,n,r,!i),a=l._getSpanModel().get(e,t),l._setSelectedRange(a.row,a.col,a.rowCount,a.colCount),l._invalidate()},getActiveRowIndex:function(){return this._activeRowIndex},getActiveColumnIndex:function(){return this._activeColIndex},getRowResizable:function(e,t){return this._getRowInfos(t).getResizable(e)},setRowResizable:function(e,t,n){this._setRowColInfo(e,t,J,!0,n)},_setRowColInfo:function(e,t,n,o,i){h(i)&&(i=3);var a=this,l=o?a._getRowInfos(i):a._getColInfos(i),s;switch(n){case J:s=l.getResizable(e),l.setResizable(e,t);break;case"pageBreak":s=l.getPageBreak(e),l.setPageBreak(e,t);break;case Z:s=l.getVisible(e),l.setVisible(e,t),o&&r._supportsCalc&&3===i&&s!==t&&a.recalcRows([e]);break;case Y:s=l.getSize(e),l.setSize(e,t),!r._supportsCalc||3!==i||s===t||0!==s&&0!==t||a.recalcRows([e]);break;case U:s=l.getSize(e),l.setSize(e,t)}o?a._raiseRowChanged(e,i,n,t,s):a._raiseColumnChanged(e,i,n,t,s)},getColumnResizable:function(e,t){return this._getColInfos(t).getResizable(e)},setColumnResizable:function(e,t,n){this._setRowColInfo(e,t,J,!1,n)},getRowHeight:function(e,t){var n,r,o,i,a,l,s,u,c=this;if(h(t)&&(t=3),3===t||2===t){if(n=c._getModel(t),r=ue(n)||0,e<0||e>=r)return 0;for(o=c._rowStateProviders,i=0;i<o.length;i++)if(a=o[i],!a._isVisible(e))return 0}return l=c.defaults,s=l.rowHeight,1===t&&(s=l.colHeaderRowHeight),u=c._getRowInfos(t).getSize(e),u||0===u?u:s},_getActualRowHeight:function(e,t){var n,r,o,i;return h(t)&&(t=3),n=this,r=n.defaults,o=r.rowHeight,1===t&&(o=r.colHeaderRowHeight),i=n._getRowInfos(t).getActualSize(e),i||0===i?i:o},setRowHeight:function(e,t,n){this._setRowColInfo(e,t,Y,!0,n),this._needSyncVScrollbarSize=!0,this._invalidate()},getRowVisible:function(e,t,n){var r,o,i,a=this;if(h(t)&&(t=3),!n&&(3===t||2===t))for(r=a._rowStateProviders,o=0;o<r.length;o++)if(i=r[o],!i._isVisible(e))return!1;return this._getRowInfos(t).getVisible(e)},setRowVisible:function(e,t,n){var r=this;r._setRowColInfo(e,t,Z,!0,n),r._needSyncVScrollbarSize=!0,r._invalidate()},getColumnWidth:function(e,t){var n,r,o,i,a,l,s,u,c=this;if(h(t)&&(t=3),n=c.defaults,r=n.colWidth,2===t&&(r=n.rowHeaderColWidth),3===t||1===t){if(o=c._getModel(t),i=se(o)||0,e<0||e>=i)return 0;for(a=c._colStateProviders,l=0;l<a.length;l++)if(s=a[l],!s._isVisible(e))return 0}return u=this._getColInfos(t).getSize(e),u||0===u?u:r},_getActualColumnWidth:function(e,t){var n,r,o,i;return h(t)&&(t=3),n=this,r=n.defaults,o=r.colWidth,2===t&&(o=r.rowHeaderColWidth),i=n._getColInfos(t).getActualSize(e),i||0===i?i:o},setColumnWidth:function(e,t,n){this._setRowColInfo(e,t,U,!1,n),this._needSyncHScrollbarSize=!0,this._invalidate()},getColumnVisible:function(e,t){var n,r,o,i=this;if(h(t)&&(t=3),3===t||1===t)for(n=i._colStateProviders,r=0;r<n.length;r++)if(o=n[r],!o._isVisible(e))return!1;return i._getColInfos(t).getVisible(e)},setColumnVisible:function(e,t,n){var r=this;r._setRowColInfo(e,t,Z,!1,n),r._needSyncHScrollbarSize=!0,r._invalidate()},zoom:function(e){var t=this;return 0===arguments.length?t._zoomFactor:(e=V(e),!O(e)&&isFinite(e)&&(e>4?e=4:e<.25&&(e=.25),t._zoomInternal(e),t._needSyncHScrollbarSize=!0,t._needSyncVScrollbarSize=!0,t._invalidate()),t)},_zoomInternal:function(e){this._zoomFactor=e,ge._callFeatureHandler(this,j,{changeType:"zoomSheet"})},invalidateLayout:function(){var e=this,t=e._eventHandler;e._layoutModel=H,e._rowLayoutCache={colHeader:H,viewport:H,colFooter:H},e._colLayoutCache={rowHeader:H,viewport:H},ge._callFeatureHandler(e,j,{changeType:"invalidateLayout"}),t&&t._updateValidationUI&&y._isActiveElement(e)&&t._updateValidationUI(e._activeRowIndex,e._activeColIndex),e._needSyncHScrollbarSize&&(e._syncHScrollbarSize(),e._needSyncHScrollbarSize=!1),e._needSyncVScrollbarSize&&(e._syncVScrollbarSize(),e._needSyncVScrollbarSize=!1),e._dirty=!0},_invalidate:function(){var e=this;e._layoutSuspended<=0&&(e.invalidateLayout(),e.repaint())},getViewportHeight:function(e){var t=this._getSheetLayout();return 0===e?t._frozenHeight:1===e?t._viewportHeight:2===e?t._frozenTrailingHeight:0},getViewportWidth:function(e){var t=this._getSheetLayout();return 0===e?t._frozenWidth:1===e?t._viewportWidth:2===e?t._frozenTrailingWidth:0},getViewportTopRow:function(e){var t=this,n=de(t);return 0===e?0:1===e?k(n,t._scrollTopRow):2===e?k(n,ue(t)-_e(t)):-1},getViewportBottomRow:function(e){var t,n,r,o,i,a,l=this;if(2===e)return ue(l)-1;for(t=l.getViewportTopRow(e),n=l.getViewportHeight(e),r=0,o=0,i=ue(l)-_e(l),0===e&&(i=L(de(l),i)),a=t;a<i&&r<n;a++,o++)r+=l._getZoomRowHeight(a);return t+o-1},getViewportLeftColumn:function(e){var t=this,n=fe(t);return 0===e?0:1===e?k(n,t._scrollLeftCol):2===e?k(n,se(t)-ce(t)):-1},getViewportRightColumn:function(e){var t,n,r,o,i,a,l=this;if(2===e)return se(l)-1;for(t=l.getViewportLeftColumn(e),n=l.getViewportWidth(e),r=0,o=0,i=se(l)-ce(l),0===e&&(i=L(fe(l),i)),a=t;a<i&&o<n;a++,r++)o+=l._getZoomColumnWidth(a);return t+r-1},showCell:function(e,t,n,r){var o,i,a,l,s,u,c=this;e<0||e>=ue(c)||t<0||t>=se(c)||(o=c._getColumnViewportIndex(t),i=c._getRowViewportIndex(e),a=c.getViewportTopRow(i),l=c.getViewportLeftColumn(o),1===o&&(t=c._getNewLeftColumn(t,r)),1===i&&(e=c._getNewTopRow(e,n)),s=!1,1===i&&e!==a&&(e=L(e,c._getLastVisualScrollRow()),c._scrollTopRow=e,c._syncVScrollbarPosition(),s=!0),1===o&&t!==l&&(t=L(t,c._getLastVisualScrollColumn()),c._scrollLeftCol=t,c._syncHScrollbarPosition(),s=!0),s&&(u=c.parent,u&&!u.options.scrollbarShowMax&&(c._needSyncHScrollbarSize=!0,c._needSyncVScrollbarSize=!0),c._invalidate()))},_getRowViewportIndex:function(e){var t=this,n=1;return e<de(t)?n=0:e>=ue(t)-_e(t)&&(n=2),n},_getColumnViewportIndex:function(e){var t=this,n=1;return e<fe(t)?n=0:e>=se(t)-ce(t)&&(n=2),n},_getNewLeftColumn:function(e,t){var n=this,r=n._cachePool,o=n._getColumnViewportIndex(e),i=n.getViewportLeftColumn(o),a;if(0!==t)if(1===t)for(a=B((n.getViewportWidth(o)-r._getZoomColWidth(e))/2);0<e&&!((a-=r._getZoomColWidth(e-1))<0);e--);else if(2===t)for(a=n.getViewportWidth(o)-r._getZoomColWidth(e);0<e&&!((a-=r._getZoomColWidth(e-1))<0);e--);else if(3===t&&e>=i)for(a=n.getViewportWidth(o)-r._getZoomColWidth(e);i<e&&!((a-=r._getZoomColWidth(e-1))<0);e--);return e},_getNewTopRow:function(e,t){var n=this,r=n._cachePool,o=n._getRowViewportIndex(e),i=n.getViewportTopRow(o),a;if(0!==t)if(1===t)for(a=B((n.getViewportHeight(o)-r._getZoomRowHeight(e))/2);0<e&&!((a-=r._getZoomRowHeight(e-1))<0);e--);else if(2===t)for(a=n.getViewportHeight(o)-r._getZoomRowHeight(e);0<e&&!((a-=r._getZoomRowHeight(e-1))<0);e--);else if(3===t&&!(e<i||-1===i))for(a=n.getViewportHeight(o)-r._getZoomRowHeight(e);i<e&&!((a-=r._getZoomRowHeight(e-1))<0);e--);return e},showColumn:function(e,t){this.showCell(this._scrollTopRow,e,0,t)},showRow:function(e,t){this.showCell(e,this._scrollLeftCol,t,0)},suspendEvent:function(){this._eventSuspended++},resumeEvent:function(){--this._eventSuspended<0&&(this._eventSuspended=0)},isEventSuspended:function(){return this._eventSuspended>0},currentTheme:function(e){var t=this;return 0===arguments.length?(t._currentTheme||t._resetCurrentTheme(),t._currentTheme):(typeof e===z&&(e=x[e]?x[e]:new b(e)),t._currentTheme=e,t._render._resetDefaultFont(),t._clearStyleCache(),t._invalidate(),t)},_getDefaultTheme:function(){var e=S._getCssClassThemeStyle(""),t=N(e.zIndex),n=x.Office2007;return t>2007&&(n=x.Office),n},_resetCurrentTheme:function(){this._currentTheme=this._getDefaultTheme(),this._clearStyleCache()},reset:function(){var e=this;e._resetImp(),e._invalidate()},_resetImp:function(){var e,t,n,o,i,a,s=this;s._zoomFactor=1,s._initializeActiveCell(),s._activeRowViewportIndex=0,s._activeColViewportIndex=0,s.defaults={rowHeight:ge._defaultRowHeight,colWidth:ge._defaultColWidth,rowHeaderColWidth:ge._defaultRowHeaderColWidth,colHeaderRowHeight:ge._defaultColHeaderRowHeight},s._initOptions(),s._layoutModel=H,s._rowLayoutCache={colHeader:H,viewport:H,colFooter:H},s._colLayoutCache={rowHeader:H,viewport:H},s._scrollTopRow=0,s._scrollLeftCol=0,s.frozenRowCount(0),s.frozenColumnCount(0),s.frozenTrailingRowCount(0),
s.frozenTrailingColumnCount(0),this._eventHandler=new r._SheetEventHandler(this),e=s.parent,e&&(t=e.getActiveSheet())&&s.name()===t.name()&&s._setHost(e._vp),s._styleComposeCache=[{},{},{},{}],s._cachePool=new g(s),s._composedDefaultStyle={},r._supportsCalc&&s.resetCalc(),n=l._SheetModel,o=l._AxisModel,i=l._SpanModel,s._dataModel=a=new n(ge._defaultRowCount,ge._defaultColCount),s._rowHeaderModel=new n(a.rowCount,ge._defaultRowHeaderColumnCount),s._colHeaderModel=new n(ge._defaultColHeaderRowCount,a.colCount),s._rowInfos=new o,s._colInfos=new o,s._colHeaderRowInfos=new o,s._rowHeaderColInfos=new o,s._spanModel=new i,s._colHeaderSpanModel=new i,s._rowHeaderSpanModel=new i,s._tag=H,s._resetCurrentTheme(),s._namedStyles={},s._needSyncHScrollbarSize=!0,s._needSyncVScrollbarSize=!0,s.parent&&s.parent._paintSuspended?s._layoutSuspended=s.parent._paintSuspended:s._layoutSuspended=0,s.parent&&s.parent._eventSuspended?s._eventSuspended=s.parent._eventSuspended:s._eventSuspended=0,s._dirtySuspended=0,s._disposed=!1,s._containerDiv=H,s._rowStateProviders=[],s._colStateProviders=[],ge._callFeatureHandler(s,"init")},_initOptions:function(){var e=this;A(t,function(t,n){if(!h(n)){var r=n;"gridline"===t?r={color:S._getCssClassThemeStyle("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof r&&(r=s.extend({},n)),e.options[t]=r}})},_onAttached:function(e){var t,n=this;for(n.parent=e,t=0;t<e._paintSuspended;t++)n.suspendPaint();n._eventSuspended=e._eventSuspended,ge._callFeatureHandler(n,"attach",e)},_canChange:function(e,t,n,o,i,a){var l=this;return l.options.isProtected&&l._isAnyCellInRangeLocked(d(e,t,n,o))?(i&&l._raiseInvalidOperation(1,i),!1):!(r._supportsCalc&&!l._checkArrayFormula(e,t,n,o))||(a&&l._raiseInvalidOperation(1,a),!1)},clear:function(e,t,n,r,o,i){0!==o&&this._clearCore(e,t,n,r,o,i)},_clearCore:function(e,t,n,o,i,a,l,s){var u,c,_,f,d,g,p,m,v,C,w,y,S,x,b,T,R=this;try{if(u=r._supportsCalc,u&&R.suspendCalcService(),R.suspendPaint(),c=R.defaults,p=3,h(i)||i===p){if(r._supportsCalc&&!R._checkArrayFormula(e,t,n,o))return!1;if(1&a&&R.getDataSource&&R.getDataSource()){for(R.suspendEvent(),_=e;_<e+n;_++)if(!(l&&R._isRowFilterOut&&R._isRowFilterOut(_)))for(f=t;f<t+o;f++)R.setValue(_,f,H,i);R.resumeEvent()}}for(m={changeType:"clear",row:e,col:t,rowCount:n,colCount:o,sheetArea:i,type:a,ignoreTable:s},ge._callFeatureHandler(R,j,m),v=R._getModel(i),C=u&&R._getCalcModel(),_=-1===e?0:e,w=-1===e?ue(v):n,f=-1===t?0:t,y=-1===t?se(v):o,S=[],x=_;x<w;x++)l&&R._isRowFilterOut&&R._isRowFilterOut(x)&&S.push(x);if(v.clear(_,f,w,y,a,S),C&&1&a&&(C._unlinkCellExpression(_,f,w,y),C.clear(_,f,w,y)),8&a&&!(e>=0&&t>=0))if(t>=0)for(g=0;g<y;g++)R.setTag(-1,f+g,H,i);else if(e>=0)for(d=0;d<w;d++)l&&R._isRowFilterOut&&R._isRowFilterOut(_+d)||R.setTag(_+d,-1,H,i);else R.setTag(-1,-1,H,i);if(2&a&&!(e>=0&&t>=0))if(t>=0)for(g=0;g<y;g++)R.setStyle(-1,f+g,H,i);else if(e>=0)for(d=0;d<w;d++)l&&R._isRowFilterOut&&R._isRowFilterOut(_+d)||R.setStyle(_+d,-1,H,i);else R.setStyle(-1,-1,H,i);if(32&a){if(e<0)for(g=0;g<y;g++)R.setColumnVisible(f+g,!0,i),R.setColumnResizable(f+g,!0,i),R.setColumnWidth(f+g,2===i?c.rowHeaderColWidth:c.colWidth,i);if(t<0)for(d=0;d<w;d++)l&&R._isRowFilterOut&&R._isRowFilterOut(_+d)||(R.setRowVisible(_+d,!0,i),R.setRowResizable(_+d,!0,i),R.setRowHeight(_+d,1===i?c.colHeaderRowHeight:c.rowHeight,i))}for((h(i)||i===p)&&u&&1==(1&a)&&(b=R._getCalcModel())&&b._addCellsToDirty(e,t,n,o),T=[],d=0;d<w;d++)for(g=0;g<y;g++)T.push({row:_+d,col:f+g});R._raiseRangeDataChanged(e,t,w,y,T,2,i)}finally{R.resumePaint(),u&&R.resumeCalcService(!1)}},_adjustActiveCellToSelectable:function(){var e,t,n=this,r=n.options,o=r.protectionOptions;r.isProtected&&o&&(!1===o.allowSelectLockedCells||!1===o.allowSelectUnlockedCells)&&(e=n._activeRowIndex,t=n._activeColIndex,n._canSelect(e,t)||(n._clearSelectionImp(),n._moveActiveCellRight(e,t,!0),n._moveActiveCellEnd(4,e,t)))},setArray:function(e,t,n,o){var i,a,l,u,c=this;if(o=r._supportsCalc&&o,i=ue(c),a=se(c),n&&0<=e&&e<i&&0<=t&&t<a){r._supportsCalc&&c.suspendCalcService(),c.suspendPaint();try{A(n,function(n,r){s.isArray(r)?A(r,function(r,s){l=e+n,u=t+r,l<i&&u<a&&(o?c.setFormula(l,u,s):c.setValue(l,u,s,3,!0))}):(l=e+n,u=t,l<i&&u<a&&(o?c.setFormula(l,u,r):c.setValue(l,u,r,3,!0)))})}finally{r._supportsCalc&&c.resumeCalcService(),c.resumePaint()}}},getArray:function(e,t,n,o,i){var a,l,s=this,u=[],c=ue(s),_=se(s);if(i=i&&r._supportsCalc,0<=e&&e<c&&0<=t&&t<_)for(e+n>c&&(n=c-e),t+o>_&&(o=_-t),a=0;a<n;a++)for(u[a]=[],l=0;l<o;l++)u[a][l]=i?s.getFormula(e+a,t+l):s.getValue(e+a,t+l);return u},setTag:function(e,t,n,r){var o,i,a,l,s,u;if(h(r)&&(r=3),o=this,0!==r){if(i=o._getModel(r),a=ue(i),l=se(i),e<-1||e>=a||t<-1||t>=l)return;n=oe(n),u=o._eventSuspended>0,u||(s=o.getTag(e,t,r)),i.setValueForKey(e,t,X,n),u||s===n||(-1!==e&&-1!==t?o._raiseCellChanged(X,e,t,r,s,n):-1!==e&&-1===t?o._raiseRowChanged(e,r,X,n,s):-1===e&&-1!==t&&o._raiseColumnChanged(t,r,X,n,s))}},getTag:function(e,t,n){var r,o,i=this;return h(n)&&(n=3),0!==n?(r=i._getModel(n),o=r.getValueForKey(e,t,X),re(o)):H},tag:function(e){var t=this;return 0===arguments.length?re(t._tag):(t._tag=oe(e),t)},getParent:function(){return this.parent},getDirtyRows:function(){return ie(this,!0)},getInsertRows:function(){return ie(this,!1)},getDeletedRows:function(){var e=[],t=this._deletedRows;return t&&A(t,function(t,n){n&&!s.isFunction(n)&&e.push({row:n.row,originalItem:n.data})}),e},hasPendingChanges:function(){var e,t=this,n=t._deletedRows;return!!(n&&n.length>0)||(e=t._getModel()._dirtyNodes,!I(e))},clearPendingChanges:function(){this._getModel()._dirtyNodes={},this._deletedRows=[]},getDirtyCells:function(e,t,n,r){var o,i,a,l,s,u,c,_=this;if(h(e)&&(e=-1),h(t)&&(t=-1),(h(n)||n<=0)&&(n=1),(h(r)||r<=0)&&(r=1),o=[],i=_._getModel()._dirtyNodes,!I(i)){if(a=[],e>=0)for(l=e;l<e+n;l++)a.push(l);else for(s in i)E(i,s)&&a.push(N(s));A(a,function(e,n){var a,l;if((u=i[n])&&"e"===u.rs)if(t>=0)for(a=t;a<t+r;a++)(c=u[a])&&o.push(pe(_,n,a,c.oldValue));else for(l in u)O(l)||(c=u[l])&&o.push(pe(_,n,N(l),c.oldValue))})}return o},suspendDirty:function(){this._dirtySuspended++,this._getModel()._dirtySuspended++},resumeDirty:function(){var e=this,t=e._getModel();e._dirtySuspended--,t._dirtySuspended--,e._dirtySuspended<0&&(e._dirtySuspended=0,t._dirtySuspended=0)},isDirtySuspended:function(){return this._dirtySuspended>0},_init:function(e){this._name=e,this._setBounds(new p(0,0,0,0)),this._resetImp()},_getCanvasOffset:function(){var e,t=this,n=s(t._getCanvas()).offset();return n?(n.top+=D.body.clientTop||0,n.left+=D.body.clientLeft||0):n={top:0,left:0},e=F._gcGlobal.canvasOffset,e&&(n=e),n},_setHost:function(e){var t,n,r;e&&(t=this,t._disposed=!1,n=t._canvas,n&&t._dispose(!1),r=f("canvas"),s(r).attr("id",e.getAttribute("id")+"_vp").html(ne().NeedCanvasSupport).appendTo(e),_._adjustDevicePixel(r,H,t),t._canvas=r,t._doResize(),t.repaint(),t.parent&&t.parent._paintWorkbookBackgroundImage(),ge._callFeatureHandler(t,"setHost",s(r)))},_doResize:function(){var e,t,n,r,o,i,a,l,u=this,c=u._getCanvas();c&&c.parentNode&&(e=getComputedStyle(c.parentNode),t=e.width,n=e.height,r=t.indexOf("px"),r>0&&(t=t.substring(0,r)),r=n.indexOf("px"),r>0&&(n=n.substring(0,r)),o=N(t),i=N(n),O(o)&&(o=s(c.parentNode).width()),O(i)&&(i=s(c.parentNode).height()),0!==o&&0!==i&&(a=k(o,0),l=k(i,0),c.style.display="none",c.style.display="",c.width=a,c.height=l,c.style.width=a+"px",c.style.height=l+"px",a=c.clientWidth||c.width,l=c.clientHeight||c.height,u._bounds.width=a,u._bounds.height=l,_._setSize(c,a,l),u.invalidateLayout()))},_dispose:function(e){var t,n,r,o=this;_._disposeSheet(o),o.isEditing&&o.isEditing()&&o._endEditCore(),ge._callFeatureHandler(o,"dispose",e),t=o._canvas,t&&(n=t.parentNode,n&&n.removeChild(t),o._canvas=H),o._disposeStringWidthPre(),!1!==e&&(o._disposed=!0,r=o._cutCopyIndicatorManager,r&&r._dispose(),o.parent=H,o._dataModel=H,o._rowHeaderModel=H,o._colHeaderModel=H,o._rowInfos=H,o._colInfos=H,o._colHeaderRowInfos=H,o._rowHeaderColInfos=H,o._spanModel=H,o._colHeaderSpanModel=H,o._rowHeaderSpanModel=H,o._cachePool=H,o._imageLoader&&(o._imageLoader._dispose(),o._imageLoader=H),y._isActiveElement(o)&&y._setActiveElement(H,!0))},_disposeStringWidthPre:function(){var e=this._editingPre;e&&(s(e).remove(),this._editingPre=P)},_getModel:function(e){return 3===e||h(e)?this._dataModel:2===e?this._rowHeaderModel:1===e?this._colHeaderModel:H},_getRowInfos:function(e){return 1===e||0===e?this._colHeaderRowInfos:this._rowInfos},_getColInfos:function(e){return 2===e||0===e?this._rowHeaderColInfos:this._colInfos},_getValueImp:function(e,t,n,r){var o,i,a,l,s,u,c=this;return h(r)&&(r=3),o=3===r,i=H,o&&(a=c.tables)&&(l=a.find(t,n))&&(i=a._getValue(t,n),i=i._hasValue?i._value:H),h(i)&&(s=c._bindingManager,u=H,s&&s._dataSource&&o&&(u=s.getValue(t,n)),i=u&&u.hasBinding?u.value:e.getValue(t,n)),i=re(i)},_getActualRange:function(e,t){var n,r,o,i,a,l;return h(t)&&(t=3),n=d(-1,-1,-1,-1),e&&(r=this,o=e.row,i=e.col,a=e.rowCount,l=e.colCount,-1===i&&(i=0,l=r.getColumnCount(t)),-1===o&&(o=0,a=r.getRowCount(t)),n.col=i,n.row=o,n.colCount=l,n.rowCount=a),n},getRangeRect:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,m,v,C,w=new p(-1,-1,-1,-1),y=this,S=y._getSheetLayout();if(0===S.width||0===S.height)return w;if(r=y._getViewportColumnLayout(t),o=y._getViewportRowLayout(e),!r||0===r.length||!o||0===o.length)return w;i=y._getActualRange(n),a=y._cachePool,l=i.row,s=i.row+i.rowCount-1,u=i.col,c=i.col+i.colCount-1,_=de(y),f=ue(y)-_e(y)-1,d=fe(y),h=se(y)-ce(y)-1,g=r[0].col,m=r[r.length-1].col,v=o[0].row,C=o[o.length-1].row;function x(e,t){for(;e>t;)if(e--,y.getColumnVisible(e))return e;return e}function b(e,t){for(;e<t;)if(e++,y.getColumnVisible(e))return e;return e}function T(e,t){for(;e>t;)if(e--,y.getRowVisible(e))return e;return e}function R(e,t){for(;e<t;)if(e++,y.getRowVisible(e))return e;return e}return u<g&&(u=x(g,u)),c>m&&(c=b(m,c)),l<v&&(l=T(v,l)),s>C&&(s=R(C,s)),c<u||s<l?w:(0===t?u<d&&(w.x=S._frozenX+ae(a,0,u-1),w.width=ae(a,u,c)):1===t?u<=h&&c>=d&&(w.x=u<g?r[0].x-ae(a,u,g-1):r[0].x+ae(a,g,u-1),w.width=ae(a,u,c)):2===t&&c>h&&(w.x=u<g?S._frozenTrailingX-ae(a,u,g-1):S._frozenTrailingX+ae(a,g,u-1),w.width=ae(a,u,c)),0===e?l<_&&(w.y=S._frozenY+le(a,0,l-1),w.height=le(a,l,s)):1===e?l<=f&&s>=_&&(w.y=l<v?o[0].y-le(a,l,v-1):o[0].y+le(a,v,l-1),w.height=le(a,l,s)):2===e&&s>f&&(w.y=l<v?S._frozenTrailingY-le(a,l,v-1):S._frozenTrailingY+le(a,v,l-1),w.height=le(a,l,s)),w)},_getRangeWholeRect:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g=this,m=new p(-1,-1,-1,-1),v=g._getSheetLayout();if(0===v.width||0===v.height)return m;if(t=g._getActualRange(e),n=fe(g),r=de(g),o=ce(g),i=_e(g),a=g._cachePool,l=t.row,s=t.row+t.rowCount-1,u=t.col,c=t.col+t.colCount-1,_=ue(g),f=se(g),u<n)m.x=v._frozenX+ae(a,0,u-1),m.width=ae(a,u,L(c,n-1)),n<=c&&c<f-o?(d=g._getViewportColumnLayout(1))&&d.length>0&&(m.width+=ae(a,d[0].col,L(c,d[d.length-1].col))):c>=f-o&&(d=g._getViewportColumnLayout(2))&&d.length>0&&(m.width=d[0].x-m.x,m.width+=ae(a,f-o,L(c,f-1)));else if(u<f-o){if(!(d=g._getViewportColumnLayout(1))||0===d.length||u>d[d.length-1].col||c<d[0].col)return m;m.x=v._viewportX+ae(a,d[0].col,u-1),n<=c&&c<f-o?m.width=ae(a,k(u,d[0].col),L(c,d[d.length-1].col)):c>=f-o&&(d=g._getViewportColumnLayout(2))&&d.length>0&&(m.width=d[0].x-m.x,m.width+=ae(a,f-o,L(c,f-1)))}else u<f&&(d=g._getViewportColumnLayout(2))&&d.length>0&&(m.x=v._frozenTrailingX+ae(a,d[0].col,u-1),m.width=ae(a,u,L(c,f-1)));if(l<r)m.y=v._frozenY+le(a,0,l-1),m.height=le(a,l,L(s,r-1)),r<=s&&s<_-i?(h=g._getViewportRowLayout(1))&&h.length>0&&(m.height+=le(a,h[0].row,L(s,h[h.length-1].row))):s>=_-i&&(h=g._getViewportRowLayout(2))&&h.length>0&&(m.height=h[0].y-m.y,m.height+=le(a,_-i,L(s,_-1)));else if(l<_-i){if(!(h=g._getViewportRowLayout(1))||0===h.length||l>h[h.length-1].row||s<h[0].row)return m;m.y=v._viewportY+le(a,h[0].row,l-1),r<=s&&s<_-i?m.height=le(a,k(l,h[0].row),L(s,h[h.length-1].row)):s>=_-i&&(h=g._getViewportRowLayout(2))&&h.length>0&&(m.height=h[0].y-m.y,m.height+=le(a,_-i,L(s,_-1)))}else l<_&&(h=g._getViewportRowLayout(2))&&h.length>0&&(m.y=v._frozenTrailingY+le(a,h[0].row,l-1),m.height+=le(a,l,L(s,_-1)));return m},_getCanvas:function(){return this._canvas},_getStringWidth:function(e,t){return this._getStringWidthByCanvas(e,t)+1},_getStringWidthByCanvas:function(e,t){var n="",r=this._render;return n=t||r._getZoomFont(r._getDefaultFont()),o._WordWrapHelper._measureText(e,n)},_getColumnViewportIndexFromX:function(e){var t=this._getSheetLayout(),n=H;return t._headerX<e&&e<t._headerX+t._rowHeaderWidth?n=-1:t._frozenX<e&&e<t._frozenX+t._frozenWidth?n=0:t._viewportX<e&&e<t._viewportX+t._viewportWidth?n=1:t._frozenTrailingX<e&&e<t._frozenTrailingX+t._frozenTrailingWidth&&(n=2),n},_getRowViewportIndexFromY:function(e){var t=this._getSheetLayout(),n=H;return t._headerY<e&&e<t._headerY+t._colHeaderHeight?n=-1:t._frozenY<e&&e<t._frozenY+t._frozenHeight?n=0:t._viewportY<e&&e<t._viewportY+t._viewportHeight?n=1:t._frozenTrailingY<e&&e<t._frozenTrailingY+t._frozenTrailingHeight&&(n=2),n},_getRowIndexFromY:function(e,t){var n,r;if((n=-1===t?this._getColumnHeaderRowLayout():this._getViewportRowLayout(t))&&(r=n.findY(e)))return r.row},_getColumnIndexFromX:function(e,t){var n,r;if((n=-1===t?this._getRowHeaderColumnLayout():this._getViewportColumnLayout(t))&&(r=n.findX(e)))return r.col},_isActiveCell:function(e,t){var n=this;return n._activeRowIndex<=e&&e<n._activeRowIndex+n._activeRowCount&&n._activeColIndex<=t&&t<n._activeColIndex+n._activeColCount},_isColumnSelected:function(e){var t=this._selectionModel;return!!t&&t._isColumnSelected(e)},_isRowSelected:function(e){var t=this._selectionModel;return!!t&&t._isRowSelected(e)},_isSelected:function(e,t,n,r){var o,i,a=this,l=a._selectionModel;return!!l&&(o=ue(a),i=se(a),l._isSelected(e,t,n,o,i,r))},_isAllSelected:function(e,t,n){var r,o,i=this,a=i._selectionModel;return!!a&&(r=ue(i),o=se(i),a._isAllSelected(e,t,n,r,o))},_isHover:function(e,t,n){var r,o,i,a,l,s,u=this,c=u._currentTarget;if(c&&!c.resizeInfo&&!h(n)){if(a=c.hitTestType,l=c.row,s=c.col,1===n)return r=!1,o=u._getSpanModel(1).find(l,s),o&&(r=o.contains(e,t,1,1)),i=e===l&&t===s||r,a===n&&i;if(2===n)return r=!1,o=u._getSpanModel(2).find(l,s),o&&(r=o.contains(e,t,1,1)),i=e===l&&t===s||r,a===n&&i;if(3===n)return a===n&&e===l&&t===s;if(0===n)return a===n}return!1},_indexToLetters:function(e){for(var t,n="A",r=n.charCodeAt(0),o="";e>0;e=parseInt((e-1)/26),10)t=(e-1)%26,o=String.fromCharCode(r+t)+o;return o},_getSheetArea:function(e,t){return e>=0&&e<=2&&t>=0?3:e>=0&&e<=2&&t<0?2:e<0&&t>=0?1:e<0&&t<0?0:H},_setFocus:function(e){var t=this._eventHandler;t&&t._setFocus(e)},_getHost:function(){var e,t=this,n=t.parent,r=n&&n._host;return r||(e=t._canvas,r=e&&e.parentElement),r},_initializeActiveCell:function(){var e=this,t=0,n=0;e._activeRowIndex=t,e._activeColIndex=n,e._activeRowCount=1,e._activeColCount=1,e._leadingCellRow=t,e._leadingCellCol=n},_getZoomRowHeight:function(e,t){var n=this,r=n.getRowHeight(e,t),o=n._zoomFactor;return 1!==o&&(r*=o),B(r)},_getZoomColumnWidth:function(e,t){var n=this,r=n.getColumnWidth(e,t),o=n._zoomFactor;return 1!==o&&(r*=o),B(r)},_createLayout:function(){var e,t,n,r,o,i,a,l,s,u=this,c=u._getBounds(),_=u.options,f=_.borderWidth,d=new p(c.x+f,c.y+f,k(0,c.width-2*f),k(0,c.height-2*f)),h=d.width,g=d.height,m={x:d.x,y:d.y,width:d.width,height:d.height,_rowHeaderWidth:0,_colHeaderHeight:0,_frozenWidth:0,_frozenHeight:0,_frozenTrailingWidth:0,_frozenTrailingHeight:0,_footerHeight:0,_footerWidth:0,_footerX:0,_footerY:0,_frozenX:0,_frozenY:0,_frozenTrailingX:0,_frozenTrailingY:0,_viewportX:0,_viewportY:0,_viewportHeight:0,_viewportWidth:0,_headerX:0,_headerY:0,_headerCornerRect:function(){var e=this;return new p(e.x,e.y,e._rowHeaderWidth,e._colHeaderHeight)},_colHeaderRect:function(e){var t=this;return 0===e?new p(t._frozenX,t.y,t._frozenWidth,t._colHeaderHeight):1===e?new p(t._viewportX,t.y,t._viewportWidth,t._colHeaderHeight):2===e?new p(t._frozenTrailingX,t.y,t._frozenTrailingWidth,t._colHeaderHeight):H},_rowHeaderRect:function(e){var t=this;return 0===e?new p(t.x,t._frozenY,t._rowHeaderWidth,t._frozenHeight):1===e?new p(t.x,t._viewportY,t._rowHeaderWidth,t._viewportHeight):2===e?new p(t.x,t._frozenTrailingY,t._rowHeaderWidth,t._frozenTrailingHeight):H},_viewportRect:function(e,t){var n=this;if(0===e){if(0===t)return new p(n._frozenX,n._frozenY,n._frozenWidth,n._frozenHeight);if(1===t)return new p(n._viewportX,n._frozenY,n._viewportWidth,n._frozenHeight);if(2===t)return new p(n._frozenTrailingX,n._frozenY,n._frozenTrailingWidth,n._frozenHeight)}else if(1===e){if(0===t)return new p(n._frozenX,n._viewportY,n._frozenWidth,n._viewportHeight);if(1===t)return new p(n._viewportX,n._viewportY,n._viewportWidth,n._viewportHeight);if(2===t)return new p(n._frozenTrailingX,n._viewportY,n._frozenTrailingWidth,n._viewportHeight)}else if(2===e){if(0===t)return new p(n._frozenX,n._frozenTrailingY,n._frozenWidth,n._frozenTrailingHeight);if(1===t)return new p(n._viewportX,n._frozenTrailingY,n._viewportWidth,n._frozenTrailingHeight);if(2===t)return new p(n._frozenTrailingX,n._frozenTrailingY,n._frozenTrailingWidth,n._frozenTrailingHeight)}return H}};if(u._getOutlineLayout&&(e=u._getOutlineLayout(),m.x+=e.width,m.y+=e.height,h-=e.width,g-=e.height),_.rowHeaderVisible)for(o=u.getColumnCount(2),r=0;r<o;r++)m._rowHeaderWidth+=u._getZoomColumnWidth(r,2);if(_.colHeaderVisible)for(n=u.getRowCount(1),t=0;t<n;t++)m._colHeaderHeight+=u._getZoomRowHeight(t,1);if((i=fe(u))>0)for(o=se(u),r=0;r<i&&r<o;r++)u.getColumnVisible(r)&&(m._frozenWidth+=u._getZoomColumnWidth(r));if((a=de(u))>0)for(n=ue(u),t=0;t<a&&t<n;t++)u.getRowVisible(t)&&(m._frozenHeight+=u._getZoomRowHeight(t));if((l=ce(u))>0)for(o=se(u),r=k(i,o-l);r<o;r++)m._frozenTrailingWidth+=u._getZoomColumnWidth(r);if((s=_e(u))>0)for(n=ue(u),t=k(a,n-s);t<n;t++)m._frozenTrailingHeight+=u._getZoomRowHeight(t);return h-=m._rowHeaderWidth,g-=m._colHeaderHeight,h-=m._frozenWidth,g-=m._frozenHeight,h-=m._frozenTrailingWidth,g-=m._frozenTrailingHeight,g-=m._footerHeight,m._viewportWidth=k(0,h),m._viewportHeight=k(0,g),m._headerX=m.x,m._headerY=m.y,m._frozenX=m._headerX+m._rowHeaderWidth,m._frozenY=m._headerY+m._colHeaderHeight,m._viewportX=m._frozenX+m._frozenWidth,m._viewportY=m._frozenY+m._frozenHeight,m._frozenTrailingX=m._viewportX+m._viewportWidth,m._frozenTrailingY=m._viewportY+m._viewportHeight,m._footerX=m._headerX,m._footerY=m.y+m.height-m._footerHeight,m},_getSheetLayout:function(){var e=this;return e._layoutModel||(e._layoutModel=e._createLayout()),e._layoutModel},_getColumnLayout:function(e,t){return h(t)||3===t||1===t?this._getViewportColumnLayout(e):2===t?this._getRowHeaderColumnLayout():H},_getRowHeaderColumnLayout:function(){var e=this;return e._colLayoutCache.rowHeader||(e._colLayoutCache.rowHeader=e._createRowHeaderColumnLayout()),e._colLayoutCache.rowHeader},_getViewportColumnLayout:function(e){var t=this;return t._colLayoutCache.viewport||(t._colLayoutCache.viewport={}),t._colLayoutCache.viewport[e]||(t._colLayoutCache.viewport[e]=t._createViewportColumnLayout(e)),t._colLayoutCache.viewport[e]},_createRowHeaderColumnLayout:function(){var e,t,n=new R,r=this._getSheetLayout(),o=r._headerX,i=this.getColumnCount(2);for(t=0;t<i;t++)e=this._getZoomColumnWidth(t,2),n.push(new T(-1,t,o,-1,e,-1)),o+=e;return n},_createViewportColumnLayout:function(e){var t,n,r,o,i,a=this,l=new R,s=a._getSheetLayout(),u=se(a),c=a._cachePool,_=fe(a),f=ce(a);if(0===e)for(n=s._frozenX,u=L(_,u),t=0;t<u;t++)r=c._getZoomColWidth(t),l.push(new T(-1,t,n,-1,r,-1)),n+=r;else if(1===e)for(n=s._viewportX,u-=f,o=s._viewportWidth,i=k(_,a._scrollLeftCol),t=i;o>0&&t<u;t++)r=c._getZoomColWidth(t),l.push(new T(-1,t,n,-1,r,-1)),n+=r,o-=r;else if(2===e)for(n=s._frozenTrailingX,t=k(_,u-f);t<u;t++)r=c._getZoomColWidth(t),l.push(new T(-1,t,n,-1,r,-1)),n+=r;return l},_getRowLayout:function(e,t){return h(t)||3===t||2===t?this._getViewportRowLayout(e):1===t?this._getColumnHeaderRowLayout():H},_getAllRowLayout:function(e){var t,n,r=new R;for(t=0;t<3;t++)(n=this._getRowLayout(t,e))&&n.length>0&&(r=s.merge(r,n));return r},_getAllColumnLayout:function(e){var t,n,r=new R;for(t=0;t<3;t++)(n=this._getColumnLayout(t,e))&&n.length>0&&(r=s.merge(r,n));return r},_getColumnHeaderRowLayout:function(){var e=this;return e._rowLayoutCache.colHeader||(e._rowLayoutCache.colHeader=e._createColumnHeaderRowLayout()),e._rowLayoutCache.colHeader},_getViewportRowLayout:function(e){var t=this;return t._rowLayoutCache.viewport||(t._rowLayoutCache.viewport={}),t._rowLayoutCache.viewport[e]||(t._rowLayoutCache.viewport[e]=t._createViewportRowLayout(e)),t._rowLayoutCache.viewport[e]},_createColumnHeaderRowLayout:function(){var e,t,n=new R,r=this._getSheetLayout(),o=r._headerY,i=this.getRowCount(1);for(t=0;t<i;t++)e=this._getZoomRowHeight(t,1),n.push(new T(t,-1,-1,o,-1,e)),o+=e;return n},_createViewportRowLayout:function(e){var t,n,r,o,i,a=this,l=new R,s=de(a),u=_e(a),c=a._getSheetLayout(),_=ue(a),f=a._cachePool;if(0===e)for(n=c._frozenY,_=L(s,_),t=0;t<_;t++)r=f._getZoomRowHeight(t),l.push(new T(t,-1,-1,n,-1,r)),n+=r;else if(1===e)for(n=c._viewportY,_-=u,o=c._viewportHeight,i=k(s,a._scrollTopRow),t=i;o>0&&t<_;t++)r=f._getZoomRowHeight(t),l.push(new T(t,-1,-1,n,-1,r)),n+=r,o-=r;else if(2===e)for(n=c._frozenTrailingY,t=k(s,_-u);t<_;t++)r=f._getZoomRowHeight(t),l.push(new T(t,-1,-1,n,-1,r)),n+=r;return l},_getCellLayout:function(e,t,n){var r,o,i,a,l,s=this,u=s.getRowCount(n),c=s.getColumnCount(n),_=s._getRowLayout(e,n),f=s._getColumnLayout(t,n),h=new R;return _&&_.length>0&&f&&f.length>0&&(r=_[0].row,o=f[0].col,i=_[_.length-1].row,a=f[f.length-1].col,(l=s.getSpans(d(r,o,i-r+1,a-o+1),n))&&l.length>0&&s._addCellLayout(l,r,o,i,a,h,u,c,n,_,f)),h},_getCellLayoutByCell:function(e,t,n,r,o){var i,a,l,s,u=this,c=u.getRowCount(n),_=u.getColumnCount(n),f=u._getRowLayout(e,n),d=u._getColumnLayout(t,n),h=new R;return f&&f.length>0&&d&&d.length>0?(i=f[0].row,a=d[0].col,l=u.getSpan(r,o,n),l&&(s=[],s.push(l),u._addCellLayout(s,i,a,l.row+l.rowCount,l.col+l.colCount,h,c,_,n,f,d)),h.length>0?h[0]:H):H},_addCellLayout:function(e,t,n,r,o,i,a,l,s,u,c){var _,f,d,h,g,p,m,v,C,w,y,S,x,b,R,A,I,M,E,F,D=e.length;if(!(D<=0)){for(_=this,d=r+1,h=o+1,g=[],p=[],m=[],v=[],C=0,w=0,f=t-1;f>=0;f--)g[f]=_._getZoomRowHeight(f,s),w-=g[f],v[f]=w;for(w=0,f=t;f<d;f++)v[f]=w,g[f]=_._getZoomRowHeight(f,s),w+=g[f];for(f=n-1;f>=0;f--)p[f]=_._getZoomColumnWidth(f,s),C-=p[f],m[f]=C;for(C=0,f=n;f<h;f++)m[f]=C,p[f]=_._getZoomColumnWidth(f,s),C+=p[f];for(y=0;y<D;y++)if(S=e[y],S.intersect(t,n,r-t+1,o-n+1)){if((x=S.row+S.rowCount)>d){for(f=d;f<x;f++)g.push(_._getZoomRowHeight(f,s)),v.push(v[f-1]+g[f]);d=x}if((b=S.col+S.colCount)>h){for(f=h;f<b;f++)p.push(_._getZoomColumnWidth(f,s)),m.push(m[f-1]+p[f]);h=b}for(R=m[S.col],A=v[S.row],I=0,M=0,F=S.col;F<S.col+S.colCount&&F<l;F++)I+=p[F];for(E=S.row;E<S.row+S.rowCount&&E<a;E++)M+=g[E];i.push(new T(S.row,S.col,c[0].x+R,u[0].y+A,I,M,S.rowCount,S.colCount))}}},_syncHScrollbarPosition:function(){var e=this,t=e.parent,n=e._getScrollableColumn(e._scrollLeftCol);-1!==n&&n!==e._scrollLeftCol&&(e._scrollLeftCol=n),t&&t._scrollbarH&&t._scrollbarH.value(e._getVisibleColIndex(e._scrollLeftCol))},_syncVScrollbarPosition:function(){var e=this,t=e.parent,n=e._getScrollableRow(e._scrollTopRow);-1!==n&&n!==e._scrollTopRow&&(e._scrollTopRow=n),t&&t._scrollbarV&&t._scrollbarV.value(e._getVisibleRowIndex(e._scrollTopRow))},_syncHScrollbarSize:function(){var e=this,t=e.parent;t&&t._resizeHScrollBar&&(t.options.scrollIgnoreHidden&&(e._columnIndexInfo=e._getColumnIndexInfo(!0)),t._resizeHScrollBar())},_syncVScrollbarSize:function(){var e=this,t=e.parent;t&&t._resizeVScrollBar&&(t.options.scrollIgnoreHidden&&(e._rowIndexInfo=e._getRowIndexInfo(!0)),t._resizeVScrollBar())},_getFirstPageLeftColumn:function(){var e=this,t=0,n=fe(e);return t=n>0?e._getNextVisualColumn(n-1):e._getFirstVisualColumn()},_getFirstPageTopRow:function(){var e=this,t=0,n=de(e);return t=n>0?e._getNextVisualRow(n-1):e._getFirstVisualRow()},_getFirstVisualColumn:function(e){return this._getNextVisualColumn(-1,e)},_getNextVisualColumn:function(e,t){for(var n=this,r=n.getColumnCount(t)-1-ce(n);e<r;)if(e++,n.getColumnVisible(e,t)&&n._getZoomColumnWidth(e,t)>0)return e;return H},_getPrevVisualColumn:function(e,t){for(var n=this,r=fe(n);e>r;)if(e--,n.getColumnVisible(e,t)&&n._getZoomColumnWidth(e,t)>0)return e;return H},_getFirstVisualRow:function(e){return this._getNextVisualRow(-1,e)},_getNextVisualRow:function(e,t,n){for(var r=this,o=r.getRowCount(t),i=n?o-1:o-1-_e(r);e<i;)if(e++,r.getRowVisible(e,t)&&r._getZoomRowHeight(e,t)>0)return e;return H},_getPrevVisualRow:function(e,t,n){for(var r=this,o=n?0:de(r);e>o;)if(e--,r.getRowVisible(e,t)&&r._getZoomRowHeight(e,t)>0)return e;return H},_invalidateVScrollbar:function(){var e=this.parent;e&&e.options.scrollIgnoreHidden&&(this._needSyncVScrollbarSize=!0),this._syncVScrollbarPosition()},_invalidateHScrollbar:function(){var e=this.parent;e&&e.options.scrollIgnoreHidden&&(this._needSyncHScrollbarSize=!0),this._syncHScrollbarPosition()},_getVisibleRowIndex:function(e){var t,n=this.parent;return n&&n.options.scrollIgnoreHidden?(t=this._getRowIndexInfo().visibleIndex,t[e]):e},_getOriginalRowIndex:function(e){var t,n=this.parent;return n&&n.options.scrollIgnoreHidden?(t=this._getRowIndexInfo().originalIndex,t[e]):e},_getVisibleColIndex:function(e){var t,n=this.parent;return n&&n.options.scrollIgnoreHidden?(t=this._getColumnIndexInfo().visibleIndex,t[e]):e},_getOriginalColIndex:function(e){var t,n=this.parent;return n&&n.options.scrollIgnoreHidden?(t=this._getColumnIndexInfo().originalIndex,t[e]):e},_getColumnIndexInfo:function(e){var t,n,r,o,i,a,l,s,u=this;if(u._columnIndexInfo&&!e)return u._columnIndexInfo;if(t=fe(u),n=se(u)-ce(u)-t,r=t,o=r+n-1,i=u._cachePool,a={visibleIndex:{},originalIndex:{}},o-r+1<=0)return a;for(l=0,s=r;s<=o;s++)a.originalIndex[l]=s,a.visibleIndex[s]=l,i._getZoomColWidth(s)>0&&l++;for(s--,l--;i._getZoomColWidth(s)<=0&&s>=r;)a.originalIndex[l]=s,a.visibleIndex[s]=l,s--;return a},_getRowIndexInfo:function(e){var t,n,r,o,i,a,l,s,u=this;if(u._rowIndexInfo&&!e)return u._rowIndexInfo;if(t=de(u),n=ue(u)-_e(u)-t,r=t,o=r+n-1,i=u._cachePool,a={visibleIndex:{},originalIndex:{}},o-r+1<=0)return a;for(l=0,s=r;s<=o;s++)a.originalIndex[l]=s,a.visibleIndex[s]=l,i._getZoomRowHeight(s)>0&&l++;for(s--,l--;i._getZoomRowHeight(s)<=0&&s>=r;)a.originalIndex[l]=s,a.visibleIndex[s]=l,s--;return a},_getScrollableRow:function(e,t){var n,r=this,o=de(r),i=ue(r)-_e(r)-1;if(t){if(e>i&&(e=i),(n=r._getPrevVisualRow(e+1))!==H&&n>=o)return n}else if(e<o&&(e=o),(n=r._getNextVisualRow(e-1))!==H&&n<=i)return n;return-1},_getScrollableColumn:function(e,t){var n,r=this,o=fe(r),i=se(r)-ce(r)-1;if(t){if(e>i&&(e=i),(n=r._getPrevVisualColumn(e+1))!==H&&n>=o)return n}else if(e<o&&(e=o),(n=r._getNextVisualColumn(e-1))!==H&&n<=i)return n;return-1},_getTopRowWhenLastRowShowComplete:function(e,t,n){var r,o,i,a,l;if(n<t)return n;for(r=0,o=this._cachePool,i=n,a=n;i>=t;i--)if(!((l=o._getZoomRowHeight(i))<=0)){if((r+=l)>e)break;a=i}return a},_getLeftColWhenLastColShowComplete:function(e,t,n){var r,o,i,a,l;if(n<t)return n;for(r=0,o=this._cachePool,i=n,a=n;i>=t;i--)if(!((l=o._getZoomColWidth(i))<=0)){if((r+=l)>e)break;a=i}return a},_getPageValueH:function(){var e,t,n,r=this._getSheetLayout(),o=this._getColumnLayout(1,3),i=0,a=0;if(o)for(e=0;e<o.length;e++)t=o[e].width,i+=t,t>0&&a++;return a=0===a?1:a,n=i/a,0===n?1:B(r._viewportWidth/n)},_getPageValueV:function(){var e,t,n,r=this._getSheetLayout(),o=this._getRowLayout(1,3),i=0,a=0;if(o)for(e=0;e<o.length;e++)t=o[e].height,i+=t,t>0&&a++;return a=0===a?1:a,n=i/a,0===n?1:B(r._viewportHeight/n)},_getLastVisualScrollRow:function(e){var t,n,r,o,i,a,l;return h(e)&&(e=3),t=this,n=t.parent,r=de(t),o=_e(t),n&&n.options.scrollbarMaxAlign?(i=t._getSheetLayout(),t._getTopRowWhenLastRowShowComplete(i._viewportHeight,r,ue(t)-o-1)):(a=t.getRowCount(e),3!==e&&2!==e||(a-=o),l=t._getPrevVisualRow(a,e),l===H&&(l=r),l)},_getLastVisualScrollColumn:function(e){var t,n,r,o,i,a;return h(e)&&(e=3),t=this,n=t.parent,r=fe(t),n&&n.options.scrollbarMaxAlign?(o=t._getSheetLayout(),t._getLeftColWhenLastColShowComplete(o._viewportWidth,r,se(t)-ce(t)-1)):(i=t.getColumnCount(e),3!==e&&1!==e||(i-=ce(t)),a=t._getPrevVisualColumn(i,e),a===H&&(a=r),a)},_getLastNonNullRowAndCol:function(){var e,t,n,r,o,i,a,l,s=this,u=de(s),c=fe(s),_=ue(s)-_e(s)-1,f=se(s)-ce(s)-1,d=s._getRowInfos(3),h=s._getColInfos(3);return d&&(e=d._getItems(),e.length>0&&e.length-1>u&&(u=e.length-1)),h&&(e=h._getItems(),e.length>0&&e.length-1>c&&(c=e.length-1)),t=s._getModel(),t._lastNonNullRow>u&&(u=t._lastNonNullRow),t._lastNonNullColumn>c&&(c=t._lastNonNullColumn),n=s._getModel(2),n._lastNonNullRow>u&&(u=n._lastNonNullRow),r=s._getModel(1),r._lastNonNullColumn>c&&(c=r._lastNonNullColumn),o=s._getSpanModel(),o._lastNonNullRow>u&&(u=o._lastNonNullRow),o._lastNonNullColumn>c&&(c=o._lastNonNullColumn),i=s._getSpanModel(2),i._lastNonNullRow>u&&(u=i._lastNonNullRow),a=s._getSpanModel(1),a._lastNonNullColumn>c&&(c=a._lastNonNullColumn),l=ge._features,l&&A(l,function(e,t){var n,r=t.lastNonNullRowAndCol;r&&(n=r.call(s),u=k(u,n.lastNonNullRow),c=k(c,n.lastNonNullCol))}),u>_&&(u=_),c>f&&(c=f),{lastNonNullRow:u,lastNonNullCol:c}},_setTopRow:function(e){var t,n=this,r=n._scrollTopRow;e>=n._getFirstPageTopRow()&&e<=n._getLastVisualScrollRow()&&e!==r&&(t=n.parent,t&&(t._scrollService._vScrollTo(e),n._syncVScrollbarPosition()),t&&!t.options.scrollbarShowMax&&n._syncVScrollbarSize())},_setLeftColumn:function(e){var t,n=this,r=n._scrollLeftCol;e>=n._getFirstPageLeftColumn()&&e<=n._getLastVisualScrollColumn()&&e!==r&&(t=n.parent,t&&(t._scrollService._hScrollTo(e),n._syncHScrollbarPosition()),t&&!t.options.scrollbarShowMax&&n._syncHScrollbarSize())},_getSpanModel:function(e){return h(e)||3===e?this._spanModel:1===e?this._colHeaderSpanModel:2===e?this._rowHeaderSpanModel:void 0},_getCellTypeHitInfo:function(e,t,n){var r,o,i,a,l,s,u,c=this,_=e.row,f=e.col,d=e.hitTestType;return h(_)||h(f)?H:(r=c.getSpan(_,f,d),r&&(_=r.row,f=r.col),o=c.getActualStyle(_,f,d),i=1===d?-1:P,a=2===d?-1:P,l=c.getCellRect(_,f,i,a),s={sheet:c,row:_,col:f,sheetArea:d},u=o.cellType||c._getDefaultCellType(d),u._getHitInfoWrapper(t,n,o,l,s))},_disposeUserEvents:function(){this.unbindAll(),this._unbindAll()},_isAnyCellInRangeLocked:function(e){var t,n,r,o,i,a,l=this._getActualRange(e),s=l.row,u=l.col,c=s+l.rowCount,_=u+l.colCount;for(n=s;n<c;n++)for(r=u;r<_;r++)if(o=this.getSpan(n,r),i=o?o.row:n,a=o?o.col:r,t=this.getActualStyle(i,a),!0===t.locked)return!0;return!1},_isValidRange:function(e,t,n,r,o,i){if(-1<=e&&e<o&&-1<=t&&t<i){if(-1===e&&-1===t)return!0;if(-1===e){if(0!==r&&t+r<=i)return!0}else if(-1===t){if(0!==n&&e+n<=o)return!0}else if(0!==r&&t+r<=i&&0!==n&&e+n<=o)return!0}return!1},_hasPartSpans:function(e,t,n,r){var o,i,a,l=this;return!(e<0&&t<0)&&(e<0&&(o=l._getSpanModel(1))&&o.length>0?o.hasPartSpans(-1,t,-1,r):t<0&&(i=l._getSpanModel(2))&&i.length>0?i.hasPartSpans(e,-1,n,-1):!!((a=l._getSpanModel())&&a.length>0)&&a.hasPartSpans(e,t,n,r))},suspendPaint:function(){var e=this,t=e._layoutSuspended;e._layoutSuspended++,0===t&&ge._callFeatureHandler(e,K,{suspend:!0})},resumePaint:function(){var e,t=this;--t._layoutSuspended<=0&&(t._layoutSuspended=0,ge._callFeatureHandler(t,K,{suspend:!1}),(e=t.parent)&&e.getActiveSheet()!==t||t._invalidate())},isPaintSuspended:function(){return this._layoutSuspended>0},_cellRangeInflate:function(e,t){var n,r,o=this,i=e&&e.length;for(n=0;n<i;n++)if(r=e[n],t.intersect(r.row,r.col,r.rowCount,r.colCount))return e.splice(n--,1),o._cellRangeInflate(e,t.union(r));return t},_getClipboardHelper:function(){var e=this,t=e.parent;return e._clipboardHelper||(e._clipboardHelper=t&&t._clipboardHelper),e._clipboardHelper},_getImageLoader:function(){if(!this._imageLoader){var e=this;e._imageLoader=new i(function(){e._imageLoader&&e.repaint()})}return this._imageLoader},_commandManager:function(){
var e=this,t=e.parent;if(t)return t.commandManager()},_raiseInvalidOperation:function(e,t){this._trigger(m.InvalidOperation,{sheet:this,sheetName:this._name,invalidType:e,message:t})},_raiseCellChanged:function(e,t,n,r,o,i){var a={sheet:this,sheetName:this._name,row:t,col:n,sheetArea:r,propertyName:e,oldValue:o,newValue:i};this._trigger(m.CellChanged,a)},_raiseValueChanged:function(e,t,n,r){this._trigger(m.ValueChanged,{sheet:this,sheetName:this._name,row:e,col:t,oldValue:n,newValue:r})},_raiseColumnChanged:function(e,t,n,r,o){var i={sheet:this,sheetName:this._name,col:e,sheetArea:t,propertyName:n,newValue:r,oldValue:o};"addColumns"!==n&&"deleteColumns"!==n||(i.count=r),this._trigger(m.ColumnChanged,i)},_raiseRowChanged:function(e,t,n,r,o){var i={sheet:this,sheetName:this._name,row:e,sheetArea:t,propertyName:n,newValue:r,oldValue:o};"addRows"!==n&&"deleteRows"!==n||(i.count=r),this._trigger(m.RowChanged,i)},_raiseSelectionChanging:function(e,t){return!!this._eventHandler._notEqualSelecions(e,t)&&(this._trigger(m.SelectionChanging,{sheet:this,sheetName:this._name,oldSelections:e,newSelections:t}),!0)},_raiseSelectionChanged:function(e){this._trigger(m.SelectionChanged,{sheet:this,sheetName:this._name,oldSelections:e,newSelections:this.getSelections()})},_raiseRangeDataChanged:function(e,t,n,r,o,i,a,l){var s={sheet:this,sheetName:this._name,row:e,col:t,rowCount:n,colCount:r,changedCells:o,action:i};a&&(s.sheetArea=a),l&&(s.value=l),o&&o.length>0&&(this._trigger(m.RangeChanged,s),this._trigger(m.FormulatextboxRangeChanged,s))},_raiseEditorStatusChanged:function(e,t){var n={sheet:this,sheetName:this._name,oldStatus:e,newStatus:t};this._trigger(m.EditorStatusChanged,n)},_getElem:function(){return this._$elem||(this._$elem=s(f("input"))),this._$elem},bind:function(e,t,n){this._getElem().bind(e+q,t,n)},unbind:function(e,t){this._getElem().unbind(e+q,t)},_trigger:function(e,t){this.updateEventsData&&this.updateEventsData(e,t),0===this._eventSuspended&&this._getElem().trigger(e,t)},unbindAll:function(){this.unbind(q)},_bind:function(e,t,n){e.indexOf(".")>=0?this.bind(e,t,n):this.bind(e+Q,t,n)},_unbind:function(e,t){e.indexOf(".")>=0?this.unbind(e,t):this.unbind(e+Q,t)},_unbindAll:function(){this.unbind(Q)},_getBounds:function(){var e=this._bounds;return new p(e.x,e.y,e.width,e.height)},_setBounds:function(e){this._bounds=new p(e.x,e.y,e.width,e.height)}},r.Worksheet=ge,e.exports=r}()},function(e,t,n){!function(){"use strict";var e,t,r,o,i,a,l,s=n(2),u=n(5),c=n(19),_=u._Types._inherit,f=u._Types._extend,d=s.maxRowCount=1048576,h=s.maxColumnCount=16384,g=s.BAND_INDEX_CONST,p=[1,26,676],m=void 0,v=null,C=["#all","#data","#headers","#totals","#this row"],w=s.Expression,y=s.isNumber,S=s._isLetter,x=s.FormulaToken,b=s.Errors.Reference;function T(e,t){var n=t+1;return e<0?e%n+n:e>t?e%n:e}e=s.ErrorSource=function(e){_(t,e);function t(t){e.call(this,v),this._sheetName=t}return t}(s.CalcSource),f(e.prototype,{startCalculation:function(){},endCalculation:function(){},getValue:function(){return b},getReference:function(){new s.CalcReference(self,[s._createCellIdentity(0,0)]).getValue=function(){return b}},referenceToArray:function(){var e=[b];return e.isError=!0,e},getName:function(){return this._sheetName},setValue:function(){}});function R(t){return new e(t)}function A(e,t,n,r,o,i,a){return 3===a||n>=0&&r>=0||1===a&&n>=0||2===a&&r>=0}function I(e,t,n,r){var o,i,a=g,l={_row:a,_col:a,_rowRelative:!0,_columnRelative:!0,_success:!1,_endIndex:0,_isFullMatch:!0},s=t?E(e,n,r,0):M(e,0);return s._isRow?(l._row=s._elementIndex,l._rowRelative=s._isRelative):(l._col=s._elementIndex,l._columnRelative=s._isRelative),l._endIndex=s._endIndex,l._success=s._success,!s._success||s._endIndex>=e.length?l:!t&&s._isRow||t&&!s._isRow?{_success:!1}:(o=e[l._endIndex],!t&&(y(o)||"$"===o)||t&&("C"===o||"c"===o)?(i=t?E(e,n,r,l._endIndex):M(e,l._endIndex),l._endIndex=i._endIndex,!i._success||!t&&!i._isRow||t&&i._isRow?(l._success=!1,l):(l._endIndex<e.length&&(l._isFullMatch=!1),t?(l._col=i._elementIndex,l._columnRelative=i._isRelative):(l._row=i._elementIndex,l._rowRelative=i._isRelative),l._success=!0,l)):{_success:!1})}t=[1,10,100,1e3,1e4,1e5,1e6,1e6];function M(e,n){var r,o,i,a,l,s,u,c,_={_isRelative:!0,_success:!1},f=e.length;if(n>=f)return _;if("$"===e[n]&&(_._isRelative=!1,n++),n>=f)return _;if(r=n,o=0,i=e[r],y(i)&&"0"!==i){for(_._isRow=!0;r<f&&y(i);)++r<f&&(i=e[r]);if(r-n>7)return _;for(a=r-1,l=0;a>=n;a--,l++)o+=(e[a].charCodeAt()-48)*t[l];if(o<=d)return _._elementIndex=o-1,_._endIndex=r,_._success=!0,_}else if(S(i)){for(_._isRow=!1;r<f&&S(i);)++r<f&&(i=e[r]);if((s=r-n)>3)return _;for(o=0,u=r-1,c=u;c>=n;c--)o+=((32|e[c].charCodeAt(0))-96)*p[u-c];if(o<=h)return _._elementIndex=o-1,_._endIndex=r,_._success=!0,_}return _}function E(e,t,n,r){var o,i,a,l,s,u=g,c={endIndex:r,elementIndex:u,isRow:!0,isRelative:!1,success:!1},_=e.length;if(r>=_)return c;if(o=r,"R"===(i=e[o])||"r"===i)c._isRow=!0,a=t;else{if("C"!==i&&"c"!==i)return c;c._isRow=!1,a=n}if(r++,o++,r>=_)return c._endIndex=r,c._elementIndex=a,c._isRelative=!0,c._success=!0,c;if(i=e[o],"["===i&&(r++,o++,c._isRelative=!0),r>=_)return c;if(l=!1,i=e[o],c._isRelative&&"-"===i&&(r++,o++,l=!0),r>=_)return c;if(i=e[o],!y(i))return c._isRelative?c:(c._endIndex=r,c._elementIndex=a,c._isRelative=!0,c._success=!0,c);for(;o<_&&y(i);)++o<_&&(i=e[o]);if(s=parseInt(e.slice(r,o).join(""),10),c._isRelative){if(o>=_||"]"!==e[o])return c;o++}return s<(c._isRow?d:h)?(c._isRelative?(s=l?-s:s,c._elementIndex=s+a):c._elementIndex=s-1,c._endIndex=o,c._success=!0,c):void 0}function F(e,t,n,r){var o,i=e.row,a=e.column;if(n.source===s.BangSource)r.push("!");else if(n.source&&!(o=V(e,r,n.source,n.endSource)))return void r.push("#","R","E","F","!");8===n.type||5===n.type?r.push(""+n.value):n.value&&n._error?r.push(""+n.value):n._isCell?D(e.useR1C1,i,a,n.row,n.column,n.rowRelative,n.columnRelative,r):N(e.source,e.useR1C1,i,a,n.row,n.column,n.endRow,n.endColumn,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,r,n._getRangeType())}function D(e,t,n,r,o,i,a,l,u){var c,_,f,g,m,v;if(u=u||0,c=d-1,(0===u||1===u)&&r>-c&&r<=2*c&&(r+=i?t:0,r=T(r,c)),_=h-1,(0===u||2===u)&&o>-_&&o<=2*_&&(o+=a?n:0,o=T(o,_)),!A(t,n,r,o,i,a,u))return void l.push(""+s.Errors.Reference);if(e){if(l.push("R"),r>=0&&(t!==r||!i)&&(i?l.push("["+(r-t)+"]"):(r++,l.push(r+""))),o<0)return;if(l.push("C"),n===o&&a||(a?l.push("["+(o-n)+"]"):(o++,l.push(o+""))),i&&r<0||!i&&r<=0)return}else{if(o>=0){for(a||l.push("$"),f=o,g=1,m=p.length;g<m;g++)v=p[m-g],o=parseInt(f/v,10),f%=v,0!==o&&l.push(String.fromCharCode(o+65-1));l.push(String.fromCharCode(f+65))}if(r<0)return;r++,i||l.push("$"),l.push(r+"")}}function N(e,t,n,r,o,i,a,l,s,u,c,_,f,h){h=h||0,3===h&&(o=0,a=e?e.getRowCount():d-1,h=1),D(t,n,r,o,i,s,u,f,h);var p=g;(!t||o!==a||i!==l||a!==p&&l!==p)&&(a===p&&l===p||(f.push(":"),D(t,n,r,a,l,c,_,f,h)))}function V(e,t,n,r){if(e.getExternalSourceToken){if(n!==s.BangSource){var o=O(e,e.getExternalSourceToken(n).split(""),r&&e.getExternalSourceToken(r).split(""));if(!(o.length>0))return!1;t.push.apply(t,o)}return t.push("!"),!0}return!1}function O(e,t,n){var r,o;if(!t||0===t.length||H(e,t)||H(e,n))return[];if(r=t,k(t,!1)||n&&k(n,!1)){for(r=["'"],o=0;o<t.length;o++)"'"===t[o]&&r.push("'"),r.push(t[o]);if(n)for(r.push(":"),o=0;o<n.length;o++)"'"===n[o]&&r.push("'"),r.push(n[o]);r.push("'")}if(n)for(r.push(":"),o=0;o<n.length;o++)r.push(n[o]);return r}function H(e,t){if(!t||0===t.length||!e._toStandard)return!1;var n="'"===t[0]?1:0;return"["===t[n]&&t.indexOf("]")>n}function P(e,t){var n,r,o;if(!e||0===e.length)return!0;if(!t){if(s.isNumber(e[0]))return!1;if(n=B(e),n._success&&n._endIndex<=e.length)return!1}for(o=0;o<e.length;o++)if(r=e[o],t){if("*"===r||":"===r||"["===r||"]"===r||"?"===r||"\\"===r||"/"===r)return!1}else if(" "===r||"'"===r||"["===r||"]"===r||"?"===r||"\\"===r||"%"===r||'"'===r||"("===r||")"===r||"|"===r||"{"===r||"}"===r||"#"===r||"@"===r||"!"===r||"$"===r||"^"===r||"\uff08"===r||"\uff09"===r||s.operaterTypesMap[r])return!1;return!0}c._validateSheetName=P;function L(e,t){var n,r;if(!e||0===e.length)return!0;for(r=0;r<e.length;r++)if(n=e[r],t){if("*"===n||":"===n||"["===n||"]"===n||"?"===n)return!1;if("'"===n&&(0===r||r>=e.length-1||"'"!==e.charAt(r+1)))return!1}else if("'"===n||"["===n||"]"===n||"?"===n||"%"===n||s.operaterTypesMap[n])return!1;return!0}function k(e,t){var n,r,o;return!!s.isDigit(e[0])||(n=[],r=e,"["===e[0]&&(o=e.lastIndexOf("]"))>0&&(n=e.slice(1,o),r=e.slice(o+1)),!L(n)||!P(r,t))}function B(e){var t=I(e,!1,0,0);return t._success||(t=I(e,!0,0,0)),t}r=c.SheetReferenceResolver=function(e){this._sheet=e,this.priority=8e3},_(r,s.TokenResolver);function W(e){var t=new s.Expression(8);return t.value=e,t}function z(e){var t=e;return e&&e.length>=3&&"["===e[0]&&"0"===e[1]&&"]"===e[2]&&(t=3===e.length?"":e.subString(3)),t}f(r.prototype,{resolveToken:function(e,t,n,r){var o,i,a,l,u,c,_,f,d,h,p,m,C,w,y=e.useR1C1,S=e.row,x=e.column,b=n.length,T=n[r],A=T._stringValue,M=T._type,E=T._subType;if(0!==M&&6!==E)return!1;if(0===M&&0===E&&r<b-2&&":"===n[r+1]._stringValue&&12===n[r+2]._subType&&n[r+2]._stringValue.indexOf(":")<0||0===M&&12===E){if(A&&(A.indexOf(":")>0?(_=A.indexOf(":"),u=A.substring(1,_-1),c=A.substring(_+1,A.length-2)):(u=A,"'"===u.charAt(0)&&(u=u.substring(1,u.length-1)),0===E&&(c=n[r+2]._stringValue))),r++,l=!!u,u=z(u),u&&(i=A?e.getExternalSource("",u):s.BangSource,i=i||R(u),(c=z(c))&&(a=e.getExternalSource("",c),a=a||R(c),r+=2)),!(T=n[r]))return W(A);A=T._stringValue}if(f=r===b-1?v:n[r+1],U(n,T,r,y,!0)){if(d=I(T._value,y,S,x),!d._success&&!l)return!1;if(T._subType=7,d._success&&d._isFullMatch){if(h=d._row,p=d._col,m=d._rowRelative,C=d._columnRelative,r<b-2&&5===f._type&&":"===f._stringValue&&(f=n[r+2],U(n,f,r+2,y,!1)&&(w=I(f._value,y,S,x),w._success&&h===g==(w._row===g)&&p===g==(w._col===g))))return S=h===g?0:S,x=p===g?0:x,{index:r+3,expr:s._createRangeExpression(i,a,h-(m?S:0),p-(C?x:0),w._row-(w._rowRelative?S:0),w._col-(w._columnRelative?x:0),m,C,w._rowRelative,w._columnRelative)};if(h===g||p===g){if(y)return h-=h!==g&&m?S:0,p-=p!==g&&C?x:0,{index:r+3,expr:s._createRangeExpression(i,a,h,p,h,p,m,C,m,C)};if(!i)return!1;o=W(A)}if(!o)return{index:r+1,expr:s._createCellExpression(i,a,h-(m?S:0),p-(C?x:0),m,C)}}else o=W(A)}else if(6===T._subType)o=new s.Expression(5),o.value=s.CalcError.parse(T._stringValue);else{if(!i)return!1;o=W(A)}return i&&(o.source=i),a&&(o.endSource=a),{index:r+1,expr:o}},unparse:function(e,t,n,r){return(1===n.type||8===n.type||5===n.type)&&(F(e,t,n,r),!0)}});function U(e,t,n,r,o){return 0===t._type&&0===t._subType||!r&&0===t._type&&4===t._subType&&(!o||n<e.length-2&&":"===e[n+1]._stringValue&&0===e[n+2]._type&&4===e[n+2]._subType)}c.StructReferencePortions={ThisRow:1,Headers:2,Data:3,Totals:8,HeadersAndData:6,DataAndTotals:12,All:14,NotSpecific:16},c.StructReferenceColumnSpecifier={All:1,NotSpecific:1,SingleColumn:2,ColumnRange:4};function Y(e,t,n,r,o){return t<=e.startRow()&&n<=e.startColumn()&&t+r>e.endRow()&&n+o>e.endColumn()}o=function(){var e=new w(13);return e.tableName=function(){return this._baseTable.tableName()},e.baseTable=function(){return this._baseTable},e._updateCatch=function(){this._catchedTableStartColumn=this._baseTable.startColumn()},e.columnReferenceStart=function(){return this._columnReferenceStartInTable+this._baseTable.startColumn()},e.columnReferenceEnd=function(){return this._columnReferenceEndInTable+this._baseTable.startColumn()},e.referencePortions=function(){return this._referencePortions},e.referenceColumnSpecifier=function(){return this._referenceColumnSpecifier},e.source=function(){return this._baseTable.source()},e.getRange=function(e,t,n){var r,o,i,a,l,u,c,_,f,d,h=this,g=h._baseTable;switch(h._updateCatch(),c=g.startRow(),_=g.endRow(),f=g.hasTotalsRow(),d=g.hasHeadersRow(),h._referencePortions){case 3:case 16:r=d?c+1:c,i=f?_-1:_;break;case 2:if(d)r=c,i=c;else{if(!n)return v;r=c-1,i=c-1}break;case 8:if(f)r=_,i=_;else{if(!n)return v;r=_+1,i=_+1}break;case 1:r=e,i=e;break;case 6:r=c+(n&&!d?-1:0),i=f?_-1:_;break;case 12:r=d?c+1:c,i=_+(n&&!f?1:0);break;case 14:default:r=c+(n&&!d?-1:0),i=_+(n&&!f?1:0)}return o=h.columnReferenceStart(),a=h.columnReferenceEnd(),i<r||!n&&r<c||!n&&i>_?v:(l=i-r+1,u=a-o+1,s._createRangeIdentity(r,o,l,u))},e.offsetWhenInsertRemoveColumn=function(e,t,n){var r,i,a=this,l=a._catchedTableStartColumn;return e<l||e===l&&n||e>a._columnReferenceEndInTable+l?a:(t=n?t:-t,r=e-l,i=o(),i._baseTable=a._baseTable,i._columnReferenceEndInTable=a._columnReferenceEndInTable+t,i._columnReferenceStartInTable=a._columnReferenceStartInTable,e<=l+a._columnReferenceStartInTable&&(i._columnReferenceStartInTable+=t,i._columnReferenceStartInTable<r&&(i._columnReferenceStartInTable=r)),i._referenceColumnSpecifier=a._referenceColumnSpecifier,i._referencePortions=a._referencePortions,i._columnReferenceEndInTable<i._columnReferenceStartInTable?s._referenceErrorExpr:i)},e.offsetWhenCopy=function(e,t,n,r,o,i,a,l,u,_){var f,d,h,g=this,p=n-o,m=r-i,v=a-o,C=l-i,w=new c.SheetParserContext(t._sheet,t._service.useR1C1,s._createCellIdentity(n,r)),y=w.getTableByIndex(n,r);return y?(e===t?f=w.getTableByIndex(p,m):(d=new c.SheetParserContext(e._sheet,e._service.useR1C1,s._createCellIdentity(p,m)),f=d.getTableByIndex(p,m)),f===y?g._offsetColumn(i):f===g._baseTable&&Y(f,v,C,u,_)&&Y(y,a,l,u,_)?(h=g.offset(),h._baseTable=y,h):g.offset()):g.offset()},e._offsetColumn=function(e){var t,n=this,r=o();return r._baseTable=n._baseTable,r._columnReferenceEndInTable=n._columnReferenceEndInTable,r._columnReferenceStartInTable=n._columnReferenceStartInTable,2===n._referenceColumnSpecifier&&e&&(t=n._baseTable.endColumn()-n._baseTable.startColumn()+1,e%=t,r._columnReferenceStartInTable+=e,r._columnReferenceStartInTable<0&&(r._columnReferenceStartInTable+=t),r._columnReferenceEndInTable=r._columnReferenceStartInTable),r._referenceColumnSpecifier=n._referenceColumnSpecifier,r._referencePortions=n._referencePortions,r},e.offset=function(){var e=this,t=o();return t._baseTable=e._baseTable,t._referencePortions=e._referencePortions,t._columnReferenceStartInTable=e._columnReferenceStartInTable,t._columnReferenceEndInTable=e._columnReferenceEndInTable,t._referenceColumnSpecifier=e._referenceColumnSpecifier,t},e._inTable=function(e,t){var n=this._baseTable;return e>=n.startRow()&&t>=n.startColumn()&&e<=n.endRow()&&t<=n.endColumn()},e},i=c.StructureReferenceResolver=function(e){s.TokenResolver.call(this),this._sheet=e,this.priority=7900},_(i,s.TokenResolver),f(i.prototype,{resolveToken:function(e,t,n,r){var a,l,s=n[r];if(0===s._type&&0===s._subType)if(s=s._stringValue,"]"===s.charAt(s.length-1))try{return a=o(),G(e,s.split(""),a),a}catch(e){}else if(l=e.getTableByName(s))return i.create(l);return v},unparse:function(e,t,n,r){var o,i,a,l,u,c,_;return 13===n.type&&(o=n,e._structureToRange?(i=o.getRange(e.row,e.column,!0),a=s._createRangeExpression(o.source(),v,i.row,i.col,i.row+i.rowCount-1,i.col+i.colCount-1,!1,!1,!1,!1),F(e,t,a,r),!0):16===o._referencePortions&&1===o._referenceColumnSpecifier?(r.push(o._baseTable.tableName()),void(e._toStandard&&r.push("[]"))):(l=e.source===o._baseTable.source()&&o._inTable(e.row,e.column),l&&!e._toStandard||r.push(o._baseTable.tableName()),r.push("["),16!==o._referencePortions&&(u=oe(o._referencePortions,1!==o._referenceColumnSpecifier,e._toStandard),r.push(u)),1!==o._referenceColumnSpecifier&&(1===o._referencePortions&&!e._toStandard||16===o._referencePortions||r.push(", "),c=o._baseTable.getColumnName(o._columnReferenceStartInTable),c=Q(c.split("")).join(""),4===o._referenceColumnSpecifier?(_=o._baseTable.getColumnName(o._columnReferenceEndInTable),_=Q(_.split("")).join(""),r.push("[",c,"]:[",_,"]")):1===o._referencePortions&&!e._toStandard&&!$(c)||16===o._referencePortions?r.push(c):r.push("[",c,"]")),r.push("]"),!0))}}),i.create=function(e,t,n,r,i){void 0===t&&(t=16),void 0===n&&(n=1),r=r||0,void 0===i&&(i=e.endColumn()-e.startColumn());var a=o();return a._baseTable=e,a._referencePortions=t,a._columnReferenceStartInTable=r,a._columnReferenceEndInTable=i,a._referenceColumnSpecifier=n,a};function G(e,t,n){var r,o,i,a,l,s,u,c,_=n,f=0,d=t[f],h=ne(e,t,f,d),g=h._table;for(g||re(),_._baseTable=g,f=h._charIndex,f++,d=t[f],r=f;" "===d;)f++,d=t[f];for("@"!==d&&"["!==d&&(f=r,d=t[f]),o=1,i=!1,a=!1,l=t.length;0!==o&&f<l;)if("["===d&&(o++,f++,d=t[f]),"#"===d)i&&o<=1&&re(),h=te(t,f,d,o),s=h._portion,f=h._charIndex,d=h._currentChar,o=h._lbracketLever,i?2===_._referencePortions&&3===s||2===s&&3===_._referencePortions?_._referencePortions=6:3===_._referencePortions&&8===s||3===s&&8===_._referencePortions?_._referencePortions=12:re():_._referencePortions=s,i=!0;else if("@"===d){for((o>1||i)&&re(),i=!0,_._referencePortions=1,f++,d=t[f];" "===d;)f++,d=t[f];","===d&&re()}else{for(u=f;"]"!==d&&"["!==d;)if("'"===d&&f++,","===d){for(f++,d=t[f],c=f;" "===d;)f++,d=t[f];if("["===d){f=c,d=",";break}}else f++,d=t[f];if(f>u&&((a||"["===d&&o>1)&&re(),h=j(_,t,f,d,o,u),f=h._charIndex,d=h._currentChar,o=h._lbracketLever,a=!0),"]"===d){if(0===--o)break;f>=t.length&&re(),f++,d=t[f]}","===d&&(f++,d=t[f])}i||(_._referencePortions=16),a||(_._columnReferenceStartInTable=0,_._columnReferenceEndInTable=_._baseTable.endColumn()-_._baseTable.startColumn(),_._referenceColumnSpecifier=1)}function X(e,t,n){return e.slice(t,n).join("")}function j(e,t,n,r,o,i){var a,l,s,u,c,_,f=e,d=[],h="",g=!1,p=!1;if(o>1)g=!0,o--,d=t.slice(i,n),n++,":"===(r=t[n])&&(n++,r=t[n],p="["===r,a=ee(t,n,r,o),h=a._columnEndString,n=a._charIndex,r=a._currentChar,o=a._lbracketLever);else if("["===r){for(p=!0,l=n-1,r=t[l];" "===r;)l--,r=t[l];":"!==r&&re(),d=t.slice(i,l),d=K(d),r=t[n],a=ee(t,n,r,o),h=a._columnEndString,n=a._charIndex,r=a._currentChar,o=a._lbracketLever}else f._referencePortions!==m&&16!==f._referencePortions||(g=!0),s=t.slice(i,n),l=s.indexOf(":"),l>0?(d=s.slice(0,l),h=s.slice(l+1),"["!==h[0]&&re()):d=s;if(u=J(f,d,g),h?(c=J(f,h,p),f._referenceColumnSpecifier=4):(c=u,f._referenceColumnSpecifier=2),u>c&&(_=u,u=c,c=_),f._columnReferenceStartInTable=u,f._columnReferenceEndInTable=c,++n<t.length)for(r=t[n];" "===r;)n++,r=t[n];return{_charIndex:n,_currentChar:r,_lbracketLever:o}}function K(e){for(var t=e.length-1;t>=0&&" "===e[t];)t--;for(;t>=0&&" "!==e[t];)t--;return t>=0?e.substr(t+1,e.length-t-1):e}function Z(e){for(var t=0,n=e.length,r=0;t<n&&" "===e[t];)t++;for(r=t,t=n-1;t>r&&" "===e[t];)t++;return t>=r?e.slice(r,t+1):e}function J(e,t,n){var r,o,i,a;if(t&&q(t,n)){for(r=[],o=0,i=t.length;o<i;o++)"'"===t[o]&&o<i-1&&"'"!==t[o+1]||r.push(t[o]);return t=r,a=e._baseTable.getColumnIndexInTable(t.join("")),a<0&&re(),a}return-1}function q(e,t){var n,r,o;if(t)return!0;if(n="",n=e[0],r=n,"#"===n||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return!1;for(o=1;o<e.length;o++){if(" "===(n=e[o])||","===n||":"===n||"["===n&&"'"!==r||"]"===n&&"'"!==r||"@"===n&&"'"!==r||"#"===n&&"'"!==r)return!1;r=n}return!0}function Q(e){var t,n,r=[];for(n=0;n<e.length;n++)t=e[n],"["!==t&&"]"!==t&&"@"!==t&&"#"!==t&&"'"!==t||r.push("'"),r.push(t);return r}function $(e){var t,n="";if("#"===(n=e[0])||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return!0;for(t=1;t<e.length;t++)if(" "===(n=e[t])||","===n||":"===n||"["===n||"]"===n||"@"===n||"#"===n)return!0;return!1}function ee(e,t,n,r){var o,i,a=!1;if("["===n)for(a=!0,r++,t++,n=e[t];" "===n;)t++,n=e[t];for(o=t;"]"!==n&&(","!==n||r>1);)"'"===n&&t++,t++,n=e[t];return t<=o&&re(),i=e.slice(o,t),r>1&&r--,a||(i=Z(i)),{_columnEndString:i,_charIndex:t,_currentChar:n,_lbracketLever:r}}a={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1};function te(e,t,n,r){for(var o,i,l,s,u=14,c=t;"]"!==n;)"'"===n&&t++,t++,n=e[t];for(o=X(e,c,t).toLowerCase().trim(),i=!1,l=0;l<C.length;l++)if(s=C[l],o===s){u=a[o],i=!0;break}if(i||re(),++t>=e.length)r--;else{for(n=e[t];" "===n;)t++,n=e[t];if(","===n){for(r<=1&&re(),t++,n=e[t];" "===n;)t++,n=e[t];for("["===n&&(r++,t++,n=e[t]);" "===n;)t++,n=e[t]}r>1&&r--}return{_portion:u,_charIndex:t,_currentChar:n,_lbracketLever:r}}function ne(e,t,n,r){for(var o,i,a=0,l=t.length;"["!==r&&n<l;)n++,r=t[n];return a=n,a>0?(i=X(t,0,a),o=e.getTableByName(i)):o=e.getTableByIndex(e.row,e.column),{_table:o,_charIndex:n,_currentChar:r}}function re(){throw u._getResource(s.SR)().Exp_FormulaInvalid}function oe(e,t,n){switch(e){case 1:return n?"[#This Row]":"@";case 2:return t?"[#Headers]":"#Headers";case 3:return t?"[#Data]":"#Data";case 8:return t?"[#Totals]":"#Totals";case 6:return"[#Headers], [#Data]";case 12:return"[#Data], [#Totals]"}return t?"[#All]":"#All"}l=s.Parser.prototype,l.parseReferenceExpressionInfos=function(e,t,n,r,o){var i,a,l,u=this;u.setParserOption(o),i=[],a=e.split("");try{l=t._getSheetSource().getParserContext(t._getCalcServiceInternal().useR1C1,s._createCellIdentity(n,r),v),i=u.parseToTokens(l,a,!1)}catch(e){}return i=ie(i,a),this.getExpressToken(i,a,t,n,r)};function ie(e,t){var n,r,o,i,a,l,s=0;for(e.unshift(new x("=",1,0,0,0)),o=e.length-1;o>0;o--)e[o]._index===e[o-1]._index&&e[o]._stringValue===e[o-1]._stringValue&&(e=e.splice(o,1));for(i=0;i<e.length-1;i++)r=ae(e[i]),(s=e[i+1]._index-e[i]._index-r)>0&&(n=new x(t.slice(e[i]._index+r,e[i+1]._index),7,e[i]._index+r),e.splice(i+1,0,n));for(r=ae(e[i]),e.length>0&&t.length>e[i]._index+r&&(n=new x(t.slice(e[i]._index+r,t.length),7,e[i]._index+r),e.splice(i+1,0,n)),a=0;a<e.length;a++)l=e[a]._stringValue.trim(),3===e[a]._subType?e[a]._stringValue='"'+e[a]._stringValue+'"':"("===l||"{"===l?(e[a]._type=1,e[a]._subType=1):")"!==l&&"}"!==l||(e[a]._type=1,e[a]._subType=2);return e}function ae(e){return 1===e._type&&"ARRAY"===e._stringValue?1:0===e._type&&3===e._subType?e._stringValue.length+2:0===e._type&&12===e._subType?e._stringValue.length+3:e._stringValue.length}function le(e,t,n){var r,o;e&&t&&(r=t.getName&&t.getName()||"!",o=e[r],o||(o=e[r]=[],e.sheets||(e.sheets=[]),e.sheets.push(r)),o.push(n))}l.getExpressToken=function(e,t,n,r,o){var i,a,l,u,_,f,d,h,g,p,C,w,y,S,b,T,R,A=m,I=n._getSheetSource(),M=n._getCalcServiceInternal();for(M?(i=new c.SheetParserContext(n,M.useR1C1,s._createCellIdentity(r,o)),A=new s.EvaluateContext(I,s._createCellIdentity(r,o),!1)):i=new s.ParserContext(v,!1,s._createCellIdentity(0,0)),i.ignoreError=!0,a=[],l=0;l<e.length;l++)try{if(u=e[l],"["===u._stringValue||"#"===u._value[0]||3===u._subType){a.push({text:u._stringValue,type:u._type,subType:u._subType,canDrag:!1,ranges:u.ranges,value:u._stringValue});continue}if(_=[],l=this.buildExpressionInfo(i,e,l,_),_.length>0){for(d=0;d<_.length;d++)if((h=_[d])instanceof x)a.push({text:h._stringValue,type:h._type,subType:h._subType,canDrag:f,ranges:[],value:h._stringValue});else if(h._expr){if(g=h._expr,p=t.slice(h._index,h._endIndex+1).join(""),C=[],w={},f=!0,y=g.getRange&&g.getRange(r,o),8===g.type)f=!1,A&&(S=A.getName(g.value),se(S,C,w,A,r,o));else if(13===g.type)f=!1,g.source()===I&&y?C.push(y):C=null,le(w,g.source(),y);else if(1===g.type)if(g.endSource)for(b=g.source,T=g.endSource,R=b.getSources(T),d=0;d<R.length;d++){if(R[d]===I){C.push(y);break}le(w,R[d],y)}else le(w,g.source||I,y),g.source&&g.source!==I||C.push(y);else C=null;C&&C.length>0?a.push({text:p,type:0,subType:7,canDrag:f,ranges:C,value:p,sheetRanges:w}):a.push({text:p,type:u._type,subType:u._subType,canDrag:f,ranges:C,value:p,sheetRanges:w})}}else a.push({text:u._stringValue,type:u._type,subType:u._subType,canDrag:!1,ranges:u.ranges,value:u._stringValue})}catch(e){a.push({text:u._stringValue,type:u._type,subType:u._subType,canDrag:!1,ranges:u.ranges,value:u._stringValue})}return a};function se(e,t,n,r,o,i){var a,l,u,c;if(e){for(;10===e.type;)e=e.value;if(12===e.type&&(l=e,e=l.value),e.type>=2&&e.type<=6);else if(1===e.type)a=e.getRange(o,i),!r.source||e.source&&e.source!==r.source||t.push(a),le(n,e.source||r.source,a);else if(13===e.type)a=e.getRange(o,i),e.source()===r.source&&a&&t.push(a),le(n,e.source()||r.source,a);else if(8===e.type)u=v,e.source?e.source._getCalcServiceInternal()&&(u=new s.EvaluateContext(e.source,!1,s._createCellIdentity(o,i))):u=r,se(u.getName(e.value),t,n,u,o,i);else if(9===e.type)se(e.value,t,n,r,o,i),e.value2&&se(e.value2,t,n,r,o,i);else if(7===e.type)for(c=0;c<e.arguments.length;c++)se(e.arguments[c],t,n,r,o,i)}}l.buildExpressionInfo=function(e,t,n,r){var o,i,a,l,s,u=t[n];return u&&"function"!=typeof u&&0===u._type?(o=[],i=this.resolveToken(e,t,o,n)-1,a=o[0],1===a.type||13===a.type||8===a.type||5===a.type&&a.source?(l=t[i],s={_index:u._index,_endIndex:l._endIndex,_expr:a},r.push(s),i):n):n}}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p=n(5),m=n(2),v=n(1),C=v.CalcEngine={};v._supportsCalc=!0,t=p._Types,r=p._StringHelper,o=t._extend,i=t._isEmptyObject,a=null,l=void 0,s=["v","n","s","b","d","sn"],u=m.Errors.Value,c=t._inherit,_=function(e){return m.Convert._isNumber(e,!0)},f=m.Convert._isError,d=C.SheetRangeReference=function(e){c(t,e);function t(t){e.call(this,a),this.references=t}return t.prototype.toArray=function(e,t,n,r,o){var i,a,l=this.references,s=[];for(i=0;i<l.length;i++){if(a=l[i]._source.referenceToArray(l[i],e,t,n,r,o),a.isError&&n)return a;t?Array.prototype.push.apply(s,a):s.push(a[0]),i||(s.rowCount=a.rowCount,s.colCount=a.colCount)}return s.rangeCount=l.length,s},t}(m.CalcReference),h=C.SheetParserContext=function(e){c(t,e);function t(t,n,r,o){e.call(this,t&&t._getSheetSource(),n,r,o),this._sheet=t,this.addResolver(new C.SheetReferenceResolver(t)),this.addResolver(new C.StructureReferenceResolver(t))}return t}(m.ParserContext),o(h.prototype,{getExternalSource:function(e,t){var n,o,i,l=this,s=l._sheet.parent;if(e&&(!s||s.name!==e))return a;if(!s)return r._compareStringIgnoreCase(l._sheet._name,t)?l._sheet._getSheetSource():a;if((n=s.sheets)&&n.length>0)for(o=0;o<n.length;o++)if(i=n[o],r._compareStringIgnoreCase(i._name,t))return i._getSheetSource();return m.ParserContext.prototype.getExternalSource.call(this,e,t)},getExternalSourceToken:function(e){return e.getName()},getTableByName:function(e){var t,n,r=this._sheet.tables,o=r?r.findByName(e):a;if(!o&&(t=this._sheet.parent&&this._sheet.parent.sheets))for(n=0;n<t.length&&(!(r=t[n].tables)||!(o=r.findByName(e)));n++);return o},getTableByIndex:function(e,t){var n=this._sheet.tables;return n?n.find(e,t):a},setSource:function(e){this.source=e,e&&e.getSheet&&(this._sheet=e.getSheet())}}),g=C.SheetSource=function(e){c(t,e);function t(t){e.call(this,a),this._sheet=t}return t}(m.CalcSource),o(g.prototype,{startCalculation:function(){if(!this._valueCaches){var e=this.getRowCount(),t=this.getColumnCount();this._valueCaches={rowCount:e,colCount:t},this._changedCells=[]}},endCalculation:function(){this._valueCaches=a;var e=this._changedCells;e&&e.length>0&&this._sheet._trigger(n(17).Events.RangeChanged,{sheet:this._sheet,sheetName:this._sheet.name(),row:0,col:0,rowCount:this._sheet.getRowCount(),colCount:this._sheet.getColumnCount(),changedCells:e,action:6}),this._changedCells=a},clearValueCache:function(){this._valueCaches=a},getValue:function(e,t){var n,r,o,i,c,_,f,d,h,g=this,p=g._sheet;if(e.row!==l)n=e.row,r=e.col;else{if(e.name)return null;n=arguments[0],r=arguments[1],t=arguments[2]}return t=t||0,n<0||r<0?u:p._isValidatingCell&&p._validatingRow===n&&p._validatingColumn===r?p._validatingValue:(o=g._valueCaches,i=s[t],o?(c=o.rowCount,_=o.colCount,n>=c?a:r>=_?a:(f=o[n],f||(f=o[n]={}),d=f[r],d||(d=f[r]={v:p.getValue(n,r)}),h=d[i],h===l&&(h=m.Convert._convertValue(d.v,t,!0),d[i]=h),h)):n>=g.getRowCount()?a:r>=g.getColumnCount()?a:g._sheet.getValue(n,r))},getReference:function(e){var t=this;return-1===e.row&&(e.row=0,e.rowCount=t.getRowCount()),-1===e.col&&(e.col=0,e.colCount=t.getColumnCount()),new m.CalcReference(t,[e])},getSheetRangeReference:function(e){var t,n,r,o,i,a=this._sheet&&this._sheet.parent;if(e.endSource&&a&&a.sheets&&e.endSource instanceof g){for(t=a.sheets,n=!1,o=[],i=0;i<t.length;i++){if((r=t[i]._getSheetSource())===this)n=!0;else if(r===e.endSource){o.push(r.getReference(e));break}n&&o.push(r.getReference(e))}return new d(o)}},getSources:function(e){var t,n,r,o,i;if(this._sheet&&this._sheet.parent&&this._sheet.parent.sheets&&e instanceof g){for(t=this._sheet.parent.sheets,n=!1,o=[],i=0;i<t.length;i++){if(r=t[i]._getSheetSource(),r===this&&(n=!0),r===e){o.push(r);break}n&&o.push(r)}return o}},referenceToArray:function(e,t,n,r,o,i){var c,_,f,d,h,g,p,v,C,w,y,S,x,b,T,R,A=this,I=1,M=1,E=[],F=A._sheet,D=A._valueCaches,N=s[t],V=e.getRangeCount();if(0===V)return E.isError=!0,[];if(D&&(v=e.getRangeCount()+"_"+e.getRow(0)+"_"+e.getColumn(0)+"_"+e.getRowCount(0)+"_"+e.getColumnCount(0)+"_"+t+"_"+n,h=D[v]))return E=h,E.rowCount=h.rowCount,E.colCount=h.colCount,E.rangeCount=h.rangeCount,E;for(C=this.getRowCount(),w=this.getColumnCount(),n=n===l||n,y=0;y<V;y++){if(n||(g=[],E.push(g)),0===(I=e.getRowCount(y)))return E.isError=!0,[];if(0===(M=e.getColumnCount(y)))return E.isError=!0,[];if(f=e.getRow(y),d=e.getColumn(y),f>=C||d>=w)return E=[a],E.rowCount=1,E.colCount=1,E.rangeCount=1,E;for(f+I>C&&(I=C-f),d+M>w&&(M=w-d),b=F._isValidatingCell,T=0;T<I;T++)for(c=f+T,n||(S=[],g.push(S)),D&&(D[c]||(D[c]={}),p=D[c]),R=0;R<M;R++){if(_=d+R,b&&F._validatingRow===c&&F._validatingColumn===_)h=F._validatingValue,b=!1;else{if(D?(x=p[_],x?h=x.v:(h=F.getValue(c,_),x=p[_]={v:h})):h=F.getValue(c,_),r&&m.Convert._isError(h))return E=[h],E.isError=!0,E;if(x&&x[N]!==l)h=x[N];else if(h=m.Convert._convertValue(h,t,!0,i),x&&(x[N]=h),o&&x===h)return E=[u],E.isError=!0,E}(!i||h!==a&&void 0!==h&&""!==h)&&(n?E.push(h):S.push(h))}}return n||1!==V||(E=E[0]),E.rowCount=I,E.colCount=M,E.rangeCount=V,D&&(D[v]=E,D[v].rowCount=I,D[v].colCount=M,D[v].rangeCount=V),E},getColumnCount:function(){return this._sheet.getColumnCount()},getRowCount:function(){return this._sheet.getRowCount()},isHiddenRow:function(e,t){var n=this._sheet;return!((!n._hasRowFilterOut||!n._hasRowFilterOut())&&t)&&0===n.getRowHeight(e)},getName:function(){return this._sheet.name()},setValue:function(e,t,r){var i,a,s,u,c,_,f,d,h,g,p,m,v,C,w,y=this,S=y._sheet;if(e.row!==l)i=e.row,a=e.col;else{if(e.name)return;i=arguments[0],a=arguments[1],t=arguments[2]}s=y._valueCaches,s&&(u=s[i])&&(c=u[a])&&(c.v=t,void 0!==c.b&&(c.b=l),void 0!==c.d&&(c.d=l),void 0!==c.n&&(c.n=l),void 0!==c.s&&(c.s=l)),_=S._getModel(),f=!1,d=S.tables,h=d&&d.find(i,a),h&&(g=h.showHeader()&&i===h.headerIndex(),p=h.showFooter()&&i===h.footerIndex(),g||p||(f=h._setValue(i,a,t))),m=S._bindingManager,!f&&m&&m._dataSource&&(v=m.getValue(i,a),v.hasBinding&&(s?(w=s.bindingRows=s.bindingRows||{},(C=w[i])||(C=w[i]=o({},S.getDataItem(i)))):C=o({},S.getDataItem(i)),_._updateDirty(i,a,{_originalItem:C,_oldValue:v.value}),m.setValue(i,a,t)),f=v.hasBinding),f||_.setValue(i,a,t),this._changedCells?this._changedCells.push({row:i,col:a}):this._sheet._trigger(n(17).Events.CellChanged,{sheet:this._sheet,sheetName:this._sheet.name(),row:i,col:a,sheetArea:3,propertyName:"value",oldValue:r,newValue:t})},getCustomFunction:function(e){return this._sheet?this._sheet._findCustomFunction(e):a},getCustomName:function(e){var t=this._sheet?this._sheet.getCustomName(e):a;return t?t.getExpression():a},getSheet:function(){return this._sheet},getParserContext:function(e,t,n){return t=t||m._createCellIdentity(0,0),new h(this._sheet,e,t,n)},setFormula:function(e,t,n){},setArrayFormula:function(e,t,n,r,o){},setFormulaByName:function(e,t){},refresh:function(){this._sheet.repaint()},toJSON:function(e,t,n,r){var o,a,l,s,u,c,_,f,d=t,h=e.data||{},g=!0;for(c=0;c<=n;c++)if(o=h.dataTable||{},a=d[c]){for(s=o[c],g=!s,s=s||{},_=0;_<=r;_++)if((l=a[_])&&l._expr){u=s[_]||{};try{f=this._getCalcServiceInternal().unparse(this,l._expr,c,_,!1,!0),l._arrayInfo?l._arrayInfo.row===c&&l._arrayInfo.col===_&&(u.arrayInfo=l._arrayInfo,u.formula=f):u.formula=f,g=!1,s[_]=u}catch(e){}}g||(o[c]=s),i(o)||(h.dataTable=o)}i(h)||(e.data=h)}}),C.SpreadSource=function(e){c(t,e);function t(t){e.call(this,a),this._spread=t}return t.prototype.getCustomFunction=function(e){return this._spread?this._spread.getCustomFunction(e):a},
t.prototype.getCustomName=function(e){var t=this._spread?this._spread.getCustomName(e):a;return t?t.getExpression():a},t}(m.CalcSource);function w(e,t,r,o,i){var a,s=e&&e instanceof n(17).Worksheet&&e,u=new m.Parser;return r=r===l?0:r,o=o===l?0:o,a=new h(s,!!i,m._createCellIdentity(r,o)),u.parse(a,t)}C.formulaToExpression=w;function y(e,t,r,o,i,a){var s,u=e&&e instanceof n(17).Worksheet&&e,c=new m.Parser;return r=r===l?0:r,o=o===l?0:o,s=new h(u,!!i,m._createCellIdentity(r,o)),s._structureToRange=a,c.unparse(s,t)}C.expressionToFormula=y;function S(e,t,n,r,o){var i=w(e,t,n,r,o);return C.evaluateExpression(e,i,n,r)}C.evaluateFormula=S;function x(e,t,n,r){var o,i=e._getCalcServiceInternal();return n===l&&(n=e.getActiveRowIndex()),r===l&&(r=e.getActiveColumnIndex()),o=e._getSheetSource(),i._evaluateParsedFormula(o,t,m._createCellIdentity(n,r),!1,!0)}C.evaluateExpression=x;function b(e,t,n,r,o){var i,l,s,u=e.row,c=e.col,_=e.row+e.rowCount-1,f=e.col+e.colCount-1,d=!1,h=!1,g=!1,p=!1;return arguments.length>=4&&(d=0!=(1&r),h=0!=(4&r),g=0!=(2&r),p=0!=(8&r),u-=d?t:0,_-=h?t:0,c-=g?n:0,f-=p?n:0),o&&(l=T(e,o,t),s=R(e,o,t),l&&s)?i=C.StructureReferenceResolver.create(o,l,s,e.col-o.dataRange().col,e.col+e.colCount-o.dataRange().col-1):(1===e.rowCount&&1===e.colCount?i=m._createCellExpression(a,a,u,c,d,g):(e.row<0&&(u=_=m.BAND_INDEX_CONST),e.col<0&&(c=f=m.BAND_INDEX_CONST),i=m._createRangeExpression(a,a,u,c,_,f,d,g,h,p)),i)}C.rangeToExpression=b;function T(e,t,n){if(1===e.rowCount){if(t.hasHeadersRow()&&e.row===t.startRow())return 2;if(t.hasTotalsRow()&&e.row===t.endRow())return 8;if(n===e.row)return 1}else{if(t.hasHeadersRow()&&e.row===t.startRow()){if(e.rowCount===t.dataRange().rowCount+1)return 6;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1+1)return 14}if(e.row===t.dataRange().row){if(e.rowCount===t.dataRange().rowCount)return 3;if(t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1)return 12}}return l}function R(e,t,n){return e.col===t.startColumn()&&e.colCount===t.dataRange().colCount?1:1===e.colCount?2:e.col>=t.startColumn()&&e.col+e.colCount-1<=t.endColumn()?4:l}function A(e,t,n,r,o){var i=C.rangeToExpression(e,t,n,r),l=new h(a,!!o,m._createCellIdentity(t,n));return(new m.Parser).unparse(l,i)}C.rangeToFormula=A;function I(e,t,n,r,o,i,a){var l=C.rangeToExpression(t,n,r,o,a),s=new h(e,!!i,m._createCellIdentity(n,r));return(new m.Parser).unparse(s,l)}C.rangeToFormulaWithStructReference=I;function M(e,t,n,r){var o,i,a,l,s,u,c,_,f;if(!t)return null;if(n=n||0,r=r||0,o=e._getCalcServiceInternal(),i=o.parse(e._getSheetSource(),t,n,r,!0,!0))if((a=i.source)&&13===i.type)a=i.source();else if(1===i.type&&i.endSource){for(l=i.source,s=i.endSource,u=l.getSources(s),c=!1,_=0;_<u.length;_++)if(u[_]===e._getSheetSource()){c=!0;break}i=c&&i}return!i||!i.getRange||a&&a!==e._getSheetSource()?null:(f=i.getRange(n,r),f?new v.Range(f.row,f.col,f.rowCount,f.colCount):null)}C.formulaToRange=M;function E(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h=[],g=[];if(!t)return h;for(o={},n=n||0,r=r||0,i=new m.Parser,a=i.parseReferenceExpressionInfos(t,e,n,r),l=0;l<a.length;l++)for(s=a[l].sheetRanges,u=0;s&&u<s.sheets.length;u++)for(c=s.sheets[u],g=o[c],g||(o[c]=g=[],h.push({sheetName:c,ranges:g})),_=s[c],f=0;f<_.length;f++)d=_[f],g.push(new v.Range(d.row,d.col,d.rowCount,d.colCount));return h}C.formulaToRanges=E;function F(e,t,n,r,o){var i,l,s,u="",c=new m.Parser,_=new h(a,!!o,m._createCellIdentity(t,n));for(i=0;i<e.length;i++)l=C.rangeToExpression(e[i],t,n,r),s=c.unparse(_,l),u+=i>0?", "+s:s;return u}C.rangesToFormula=F,C.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15};function D(e,t,n,r,o,i,a){var l,s,u,c,d=r.getValue(t,n),h=!1,g=100,m=.001,v=.01,C=(_(d)?+d:0)-a,w=r.getValue(o,i),y=(_(w)?+w:0)-a;if(_(w)&&Math.abs(y)<m)h=!0;else if(f(w))h=!1;else for(l=C+(0===C?v:v*C),u=0;!h&&u<g;u++)l=p._NumberHelper._fixNumber(l,13),e.setValue(t,n,l),w=r.getValue(o,i),s=(_(w)?+w:0)-a,_(w)&&Math.abs(s)<m?h=!0:f(w)?l=(C+l)/2:C-l==0?l=C+(0===C?v:v*C):y-s==0?l=C+2*(l-C):(c=l-s*(C-l)/(y-s),C=l,y=s,l=c);return h||e.setValue(t,n,d),h}C.goalSeek=D,e.exports=C}()},function(e,t,n){!function(){"use strict";var e,t,r=n(2),o=r.Errors,i=Math.min,a=Math.max,l=r._createRange,s=void 0,u=null,c=r.Convert,_=c._isError,f=r._createCellExpression,d=r._createRangeExpression,h=r._createErrorExpression,g=r._createParenthesesExpression,p=r._createOperatorExpression,m=r._createFunctionExpression,v=o.Reference,C=r._referenceErrorExpr,w=r.BAND_INDEX_CONST;function y(e,t){var n,r,o,l;return t||(t=this),n=a(e.row,t.row),r=a(e.column,t.col),o=i(e.row+e.rowCount,t.row+t.rowCount),l=i(e.column+e.colCount,t.col+t.colCount),n>=o||r>=l?u:{row:n,col:r,rowCount:o-n,colCount:l-r,intersectWith:y}}e=function(){function e(e,t,n,r,o,i,a,l){var s=this;s._fromModel=e,s._fromRow=t,s._fromColumn=n,s._toModel=r,s._toRow=o,s._toColumn=i,s._rowCount=a,s._columnCount=l}return e}(),e.prototype={_rowOffset:function(){return this._toRow-this._fromRow},_colOffset:function(){return this._toColumn-this._fromColumn},_sourceContains:function(e,t,n,r,o){var i=this;return i._fromModel===e&&(-1===i._fromRow||i._fromRow<=t&&t+r<=i._fromRow+i._rowCount)&&(-1===i._fromColumn||i._fromColumn<=n&&n+o<=i._fromColumn+i._columnCount)},_destinationContains:function(e,t,n,r,o){var i=this;return i._toModel===e&&(-1===i._toRow||i._toRow<=t&&t+r<=i._toRow+i._rowCount)&&(-1===i._toColumn||i._toColumn<=n&&n+o<=i._toColumn+i._columnCount)},intersectWith:function(e,t,n,r,o){var i,a,l=this;return l._toModel!==e?u:(i=l._createValidCellRange(e,t,n,r,o),a=l._createValidCellRange(e,l._fromRow,l._fromColumn,r,o),a.intersectWith(i))},_createValidCellRange:function(e,t,n,r,o){var i=-1===t?0:t,a=-1===t||-1===r?e.rowCount:r;return{row:i,column:-1===n?0:n,rowCount:a,columnCount:-1===n||-1===o?e.colCount:o,intersectWith:y}}},t=r.CalcOperatorAdjustor=function(){function e(){}return e._copyExpression=function(t,n,o,a,l,s,u,c,_,f,d){var g,p,m,C,w,y=o,S=e,x=S._copyExpression;if(!o)return y;if(g=i(n.getRowCount(),r.MAX_ROW_COUNT),p=i(n.getColumnCount(),r.MAX_COLUMN_COUNT),10===o.type)y=r._createParenthesesExpression(x.call(S,t,n,o.value,a,l,s,u,c,_,f,d));else if(1===o.type&&o._isCell){if(o.rowRelative&&(o.row+a<0||o.row+a>=g)||o.columnRelative&&(o.column+l<0||o.column+l>=p))return h(v,o.source);y=o.offset(0,0,!1)}else if(1===o.type){if(m=o,m.rowRelative&&!o.isFullColumn&&(m.row+a<0||m.row+a>g)||m.columnRelative&&!o.isFullRow&&(m.column+l<0||m.column+l>p)||m.endRowRelative&&!o.isFullColumn&&(m.endRow+a<0||m.endRow+a>g)||m.endColumnRelative&&!o.isFullRow&&(m.endColumn+l<0||m.endColumn+l>p))return h(v,o.source,o.endSource);y=o.offset(0,0,!1)}else if(9===o.type)y=r._createOperatorExpression(o.operatorType,x.call(S,t,n,o.value,a,l,s,u,c,_,f,d),o.value2&&x.call(S,t,n,o.value2,a,l,s,u,c,_,f,d));else if(7===o.type){if(C=[],o.arguments&&o.arguments.length>0)for(w=0;w<o.arguments.length;w++)C[w]=x.call(S,t,n,o.arguments[w],a,l,s,u,c,_,f,d);y=r._createFunctionExpression(o,C)}else 13===o.type&&(y=o.offsetWhenCopy(t,n,a,l,s,u,c,_,f,d));return y},e.copyFormula=function(t,n,o,a,l,u,c,_,f){var d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O=t,H=a,P=t.getSource(),L=a.getSource(),k=e;if(O&&H){for(d=n,h=o,g=l,p=u,m=c,v=_,n<0&&(d=0,m=i(t.rC(),a.rC())),o<0&&(h=0,v=i(t.cC(),a.cC())),l<0&&(g=0),u<0&&(p=0),O&&O._unlinkCellExpression(g,p,m,v),C=new r.CalcSourceModel(t._getCalcServiceInternal(),P),w=0;w<m;w++)for(y=0;y<v;y++)O._copyExpr(C,w+d,y+h,w,y);for(S={},x=a._getCalcServiceInternal(),w=0;w<m;w++)if(!f||!L.isHiddenRow(w+g))for(b=w+g,y=0;y<v;y++)if(T=y+p,R=C._getExpr(w,y)){if(R===S)continue;if(R=k._copyExpression(P,L,C._getExpr(w,y),b,T,l-n,u-o,l,u,m,v),A=C._getArrayInfo(w,y),L)if(A){for(I=m-w<A.rowCount?m-w:A.rowCount,M=v-y<A.colCount?v-y:A.colCount,E=0;E<I;E++)for(F=0;F<M;F++)C._setExpr(w+E,y+F,R);a.setArrayFormula(b,T,I,M,x.unparse(L,R,b,T))}else D=R?x.unparse(L,R,b,T):s,L.setFormula(b,T,D),N=C._getWorkingExpr(w,y),N&&(V=new r.EvaluateContext(L,r._createCellIdentity(b,T),!1),N=r._mappingArray(V,R,!1,0,0),N=N===R?s:N),H._setCellExpression(b,T,R,N,A);else H._setExpr(w+g,y+p,R),H._setArrayInfo(w+g,y+p,A)}else H&&H.getExpression(b,T)&&H._clearAllExpr(b,T)}},e.moveFormula=function(e,t,n,r,o,a,c,_){var f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A=e._getCalcModel(),I=r._getCalcModel(),M=A._getCalcServiceInternal();if(A&&I){for(f=M._getOperatorAdjustor(),t<0&&(t=0,c=i(e.getRowCount(),r.getRowCount())),o<0&&(o=0),n<0&&(n=0,_=i(e.getColumnCount(),r.getColumnCount())),a<0&&(a=0),d=!(e===r&&e._name===r._name),A._unlinkCellExpression(t,n,c,_),B(A,t,n,c,_),I._unlinkCellExpression(o,a,c,_),B(I,o,a,c,_),h=[],g=0;g<c;g++)for(p=0;p<_;p++)m=A._getExpr(g+t,p+n),v=A._getArrayInfo(g+t,p+n),C=A._getWorkingExpr(g+t,p+n),m?(h.push({_expr:m,_arrayInfo:v,_workingExpr:C}),A._clearAllExpr(g+t,p+n)):h.push(u);for(y=d?{}:null,g=0;g<c;g++)for(S=g+o,p=0;p<_;p++)x=h.shift(),b=p+a,x?(m=x._expr,v=x._arrayInfo,M&&v&&v.row===t+g&&v.col===n+p&&(w=l(S,b,v.rowCount,v.colCount)),v&&(v.row=S,v.col=b),I._setExpr(S,b,m),I._setArrayInfo(S,b,v?w:s),I._setWorkingExpr(S,b,x._workingExpr),d&&(y[S+", "+b]=m)):(I._setExpr(S,b,s),I._setArrayInfo(S,b,s));f._addCellsToAdjust(A,t,n,c,_),f._addCellsToAdjust(I,o,a,c,_),T=A.getSource().getSheet(),R=T._validations&&(T.parent||T)._getValidatorsWithFormula(),f._adjustFormulasOnMoveSwap(R,A.getSource(),t,n,I.getSource(),o,a,c,_,!0,y),!0===d&&f._adjustFormulasOnMoveSwap(R,A.getSource(),t,n,I.getSource(),o,a,c,_,!0,y)}},e}(),t.prototype={isAdjustCell:function(e){return e.preAdj||e===this._head},isAdjust:function(e){return e.preAdj||e===this._head},_addAdjust:function(e,t){var n=this,r,o;if(0===t)r=n._head,o=n._tail;else if(1===t)r=n._headRows,o=n._tailRows;else if(2===t)r=n._headCols,o=n._tailCols;else{if(3!==t)return;r=n._headNamIDs,o=n._tailNameIDs}e&&!e.preAdj&&e!==r&&(r?o.nextAdj=e:0===t?n._head=e:1===t?n._headRows=e:2===t?n._headCols=e:n._headNamIDs=e,e.preAdj=o,e.nextAdj=u,0===t?n._tail=e:1===t?n._tailRows=e:2===t?n._tailCols=e:n._tailNameIDs=e)},_removeAdjust:function(e,t){var n,r,o,i=this;if(0===t)n=i._head;else if(1===t)n=i._headRows;else if(2===t)n=i._headCols;else{if(3!==t)return;n=i._headNamIDs}e&&(e.preAdj||e===n)&&(r=e.preAdj,o=e.nextAdj,r?r.nextAdj=o:0===t?i._head=o:1===t?i._headRows=o:2===t?i._headCols=o:i._headNamIDs=o,o?o.preAdj=r:0===t?i._tail=r:1===t?i._tailRows=r:2===t?i._tailCols=r:i._tailNameIDs=r,e.preAdj=u,e.nextAdj=u)},_adjustFormulasOnAddRemove:function(e,t,n,r,o){this._adjustFormulasOnOperator(e,A,t,n,r,o);var i=0,a=0,l=0,s=0;0===t&&(r&&o?l=n:r?i=n:o?s=n:a=n),I(e,A,t,n,i,a,l,s,r,o)},_adjustFormulasOnOperator:function(e,t,n,r,o,i){for(var a,u,c,_,f,d,h,g,p,m,v,C=this,w={};C._head;)if(a=C._head._sourceModel,f=a.getSource(),u=C._head.row,c=C._head.column,w[u]&&w[u][c])C._removeAdjust(C._head,0);else{if(_=a._getExpr(u,c))if(_=t.call(C,f,u,c,_,e,n,r,o,i),d=a._getArrayInfo(u,c))for(d=l(u,c,d.rowCount,d.colCount),h=u;h<u+d.rowCount;h++)for(w[h]||(w[h]={}),g=c;g<c+d.colCount;g++)a._setExpression(h,g,_,d,h===u&&g===c),w[h][g]=!0;else a._setExpression(u,c,_,d,!0);else(a.getRowExpression&&a.getRowExpression(u)||a.getColumnExpression&&a.getColumnExpression(c))&&a._addCellsToDirty(u,c,1,1);C._removeAdjust(C._head,0)}for(;C._headRows;)a=C._headRows._sourceModel,u=C._headRows.row,a.getRowExpression&&(_=a.getRowExpression(u))&&a._setExpression&&a._setExpression(u,-1,t.call(C,f,u,-1,_,e,n,r,o,i),s,!0),C._removeAdjust(C._headRows,1);for(;C._headCols;)a=C._headCols._sourceModel,c=C._headCols.column,a.getColumnExpression&&(_=a.getColumnExpression(c))&&a._setExpression&&a._setExpression(-1,c,t.call(C,f,-1,c,_,e,n,r,o,i),s,!0),C._removeAdjust(C._headCols,2);for(;C._headNamIDs;)p=C._headNamIDs,m=p.name,a=p._sourceModel,_=a.getExpressionByName(m),v=t.call(C,a.getSource(),0,0,_,e,n,r,o,i),a._setExpressionByName(m,v),C._removeAdjust(C._headNamIDs,3)},_adjustFormulasOnRemoveSheet:function(e){var t=this;B(e.getCalcSourceModel(),0,0,e.getRowCount(),e.getColumnCount()),t._adjustFormulasOnOperator(e,N),I(e,N,0,0,0,0,0,0,!0,!1)},_adjustFormulasOnMoveSwap:function(t,n,r,o,i,a,u,c,_,f,d){var h,g,p,m,v,C,w,y,S,x,b,T=this,R=H,A=new e(n,r,o,i,a,u,c,_),I={};for(t&&P(t,A,f);T._head;)if(h=T._head._sourceModel,g=T._head.row,p=T._head.column,I[g]&&I[g][p])T._removeAdjust(T._head,0);else{if(m=h.getExpression(g,p),v=h.getSource(),m)if(d&&d[g+", "+p]&&(v=n),m=R.call(T,v,g,p,m,A,f),C=h._getArrayInfo(g,p))for(C=l(g,p,C.rowCount,C.colCount),w=g;w<g+C.rowCount;w++)for(I[w]||(I[w]={}),y=p;y<p+C.colCount;y++)h._setExpression(w,y,m,C,w===g&&y===p),I[w][y]=!0;else h._setExpression(g,p,m,C,!0);else(h.getRowExpression&&h.getRowExpression(g)||h.getColumnExpression&&h.getColumnExpression(p))&&h._addCellsToDirty(g,p,1,1);T._removeAdjust(T._head,0)}for(;T._headRows;)h=T._headRows._sourceModel,g=T._headRows.row,h.getRowExpression&&(m=h.getRowExpression(g))&&h._setRowExpression&&h._setRowExpression(g,R.call(T,v,g,-1,m,A,f),s),T._removeAdjust(T._headRows,1);for(;T._headCols;)h=T._headCols._sourceModel,p=T._headCols.column,h.getColumnExpression&&(m=h.getColumnExpression(p))&&h._setColumnExpression&&h._setColumnExpression(p,R.call(T,v,-1,p,m,A,f),s),T._removeAdjust(T._headCols,2);for(;T._headNamIDs;)S=T._headNamIDs,x=S.name,h=S._sourceModel,m=h.getExpressionByName(x),b=R.call(T,v,0,0,m,A,f),h._setExpressionByName(x,b),T._removeAdjust(T._headNamIDs,3)},_addCellsToAdjust:function(e,t,n,r,o){var i,a,l,s,u,c=this,_=t+r,f=n+o;for(l=t;l<_;l++)for(s=n;s<f;s++)i=e._getCalc(l,s),a=e._getExpr(l,s),(i||a)&&(c._removeAdjust(i,0),e._removeCalc(l,s,0),u=e._getCellCalc(l,s,!0),c._addAdjust(u,0))},_addColumnsToAdjust:function(e,t,n){var r,o,i=this;for(r=t;-1!==r&&r<t+n;r++)(e._getCalc(-1,r)||e._getExpr(-1,r))&&(e._removeCalc(-1,r,2),o=e._getColumnCalc(r,!0),i._addAdjust(o,2))},_addRowsToAdjust:function(e,t,n){var r,o,i=this;for(r=t;-1!==r&&r<t+n;r++)(e._getCalc(r,-1)||e._getExpr(r,-1))&&(e._removeCalc(r,-1,1),o=e._getRowCalc(r,!0),i._addAdjust(o,1))},_addVolatitleToAdjust:function(e){var t,n,o,i,a,l=this,s=e._getCalcServiceInternal().getAllSouceModels();for(i=0;i<s.length;i++)for(t=s[i],n=t._getAllVolatitles(),a=0;a<n.length;a++)(o=n[a])&&o.isVolatile&&o instanceof r.CellCalc&&!l.isAdjustCell(o)&&l._addAdjust(o,0)},onBeforeAddRemoveRows:function(e,t){var n=e.rC(),r=e.cC();e._unlinkCellExpression(t,0,n-t,r),e._unlinkRowExpression(t,n-t),B(e,t,-1,n-t,-1)},onAfterAddRemoveRows:function(e,t,n,r){var o=this,i=e.rC(),a=e.cC();r?e._addCellsToDirty(t,0,n,a):i+=n,o._addCellsToAdjust(e,t,0,i-t,a),o._addRowsToAdjust(e,t,i-t),o._addVolatitleToAdjust(e),o._adjustFormulasOnAddRemove(e.getSource(),t,n,!0,r),e._getCalcServiceInternal().autoCalculation&&e._getCalcServiceInternal().recalculateAll(!1)},onAfterAddRemoveColumns:function(e,t,n,r){var o=this,i=e.rC(),a=e.cC();r?e._addCellsToDirty(0,t,i,n):a+=n,o._addCellsToAdjust(e,0,t,i,a-t),o._addColumnsToAdjust(e,t,a-t),o._addVolatitleToAdjust(e),o._adjustFormulasOnAddRemove(e.getSource(),t,n,!1,r),e._getCalcServiceInternal().autoCalculation&&e._getCalcServiceInternal().recalculateAll(!1)},onBeforeAddRemoveColumns:function(e,t){var n=e.rC(),r=e.cC();e._unlinkCellExpression(0,t,n,r-t),e._unlinkColumnExpression(t,r-t),B(e,-1,t,-1,r-t)},onAfterRemoveName:function(e,t){var n=e._getNameCalc(t,!1);n&&(n.updateListening(!0,!1),n._addToDirty(),n.updateListeningOnRemoved())},adjustFormulaOnRemoveName:function(e,t,n){return W(e,t,n)},invalidName:function(e,t){var n,r;t&&(n=e.getCalcSourceModel(),(r=n._getNameCalc(t.toUpperCase(),!0))&&r._addListenersToAdjust())},onAfterRemoveTable:function(e,t){var n,r,o,i,a,s,u,c,_,f,d=this;for(a=0;a<e.length;a++)s=e[a],B(s.source().getCalcSourceModel(),s.startRow(),s.startColumn(),s.endRow()-s.startRow()+1,s.endColumn()-s.startColumn()+1);for(u={};d._head;)if(n=d._head._sourceModel,r=d._head.row,o=d._head.column,u[r]&&u[r][o])d._removeAdjust(d._head,0);else{if(i=n._getExpr(r,o))if(i=S(i,e,r,o,t),c=n._getArrayInfo(r,o))for(c=l(r,o,c.rowCount,c.colCount),_=r;_<r+c.rowCount;_++)for(u[_]||(u[_]={}),f=o;f<o+c.colCount;f++)n._setExpression(_,f,i,c,_===r&&f===o),u[_][f]=!0;else n._setExpression(r,o,i,c,!0);else(n.getRowExpression&&n.getRowExpression(r)||n.getColumnExpression&&n.getColumnExpression(o))&&n._addCellsToDirty(r,o,1,1);d._removeAdjust(d._head,0)}}};function S(e,t,n,o,i){var a,l,s,c,_,f,d,h,g,p,m,v,C,w,y,x,b,T=S;if(9===e.type){if(a=e.value,l=e.value2,s=T(a,t,n,o,i),c=l&&T(l,t,n,o,i),a!==s||l!==c)return r._createOperatorExpression(e.operatorType,s,c)}else if(7===e.type){for(_=!1,f=[],d=0;d<e.arguments.length;d++)h=e.arguments[d],g=T(h,t,n,o,i),_=_||h!==g,f.push(g);if(_)return r._createFunctionExpression(e,f)}else if(10===e.type){if(p=e,m=p.value,v=T(m,t,n,o,i),m!==v)return r._createParenthesesExpression(v)}else if(13===e.type)for(C=e,d=0;d<t.length;d++)if(C.baseTable()===t[d])return i?r._referenceErrorExpr:(w=C.getRange(-1===n?0:n,-1===o?0:o,!0),y=-1===n||1===C.referencePortions(),x=1===w.rowCount&&1===w.columnCount,b=C.source(),x?r._createCellExpression(b,u,w.row,w.col,y,!1):new r._createRangeExpression(b,u,w.row,w.col,w.row+w.rowCount-1,w.col+w.colCount-1,y,!1,y,!1));return e}t.adjustExpressionOnRemoveTable=S;function x(e,t,n,r,o,i,a,l,s,u){var c,_;return n>=0||!o?(c=r+(o?n:0),_=i+(a?n:0),l===e&&s+u<=n&&(c-=o?u:0,_-=a?u:0),l===t&&(s<=c?(c+=u,_+=u):s<=_&&(_+=u)),c-=o?n:0,_-=a?n:0,{index:c,endIndex:_}):{index:r,endIndex:i}}function b(e,t,n,r,o,i,a,l,s,u){if(t){var c=s?o.row:o.column,f=s?o.rowRelative:o.columnRelative,d;if(s&&n>=0||!s&&r>=0||!f){if(u)d=x(e,t,s?n:r,c,f,-1,!1,i,a,l).index;else if(d=E(e,t,s?n:r,c,f,i,a,l),_(d))return h(d);d!==c&&(o=o.offset(s?d-c:0,s?0:d-c,!0))}}return o}function T(e,t,n,r,o,i,a,l,s,u){var c,f,d,g,p,m,v,C;if(t){if(3===(c=o._getRangeType())||s&&2===c||!s&&1===c)return o;if(f=s?o.rowRelative:o.columnRelative,d=s?o.endRowRelative:o.endColumnRelative,g=s?o.row:o.column,p=s?o.endRow:o.endColumn,s&&n>=0||!s&&r>=0||!f||!d){if(u)m=x(e,t,s?n:r,g,f,p,d,i,a,l);else if(m=F(e,t,s?n:r,g,f,p,d,i,a,l),_(m))return h(m);v=m.index,C=m.endIndex,v===g&&C===p||(o=o.offset2(s?v-g:0,s?0:v-g,s?C-p:0,s?0:C-p))}}return o}function R(e,t,n,r,o,i,a,l,s){if(t){var u=o;if(u&&t===u.source())return u.offsetWhenInsertRemoveColumn(a,l,s)}return o}function A(e,t,n,r,o,i,a,l,c){var _,f,d,h,v,C,w,y,S=A,x=r;if(1===r.type&&r._isCell)x=b(e,r.source||e,t,n,r,o,i,a,l,c);else if(1===r.type)x=T(e,r.source||e,t,n,r,o,i,a,l,c);else if(10===r.type)(_=S(e,t,n,r.value,o,i,a,l,c))!==r.value&&(x=g(_));else if(9===r.type)f=S(e,t,n,r.value,o,i,a,l,c),d=r.value2&&S(e,t,n,r.value2,o,i,a,l,c),f===r.value&&d===r.value2||(x=p(r.operatorType,f,d));else if(7===r.type){for(h=u,w=r,y=w.arguments.length,C=0;C<y;C++)if(v=w.arguments[C],(_=S(e,t,n,v,o,i,a,l,c))!==v){h=[],h[C]=_;break}if(h){for(C=0;C<y;C++)v=w.arguments[C],h[C]!==s&&h[C]!==u||(h[C]=S(e,t,n,v,o,i,a,l,c));x=m(w,h)}}else l||13!==r.type||(x=R(e,e,t,n,r,o,i,a,c));return x}function I(e,t,n,r,o,i,a,l,s,u){var c=function(o,i,a,l){return t.call(this,o,a,l,i,e,n,r,s,u)},_=e.getSheet();M(_._validations&&(_.parent||_)._getValidatorsWithFormula(),c,s)}function M(e,t,n){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x;if(e)for(u=0;u<e.length;u++){for(c=!0,_=!0,f=r.maxRowCount-1,d=r.maxColumnCount-1,o=e[u].validator,h=o._ranges,g=0,p=h.length;g<p&&(m=h[g],v=m.rowCount,C=m.colCount,l=m.row,s=m.col,-1!==v&&(_=!1,f=f>l?l:f),-1!==C&&(c=!1,d=d>s?s:d),c||_);g++);if(!(n&&_||!n&&c)&&(a=e[u].sheet,w=a._getSheetSource(),i=o.condition(),(y=i.getExpressions())&&y.length>0)){for(S=0;S<y.length;S++)x=y[S],y[S]=t(w,x,f,d);i.setExpressions(y)}}}function E(e,t,n,r,o,i,a,l){if(n>=0||!o){var s=r+(o?n:0);if(i===e&&a<=n&&(s+=o?l:0),i===t)if(a+l<=s)s-=l;else if(a<=s)return v;return s-=o?n:0}return r}function F(e,t,n,r,o,i,a,l,s,u){var c,_,f;if(n>=0||!o){if(c=r+(o?n:0),_=i+(a?n:0),f=s+u-1,l===e&&s<=n&&(c+=o?u:0,_+=a?u:0),l===t)if(f<c)c-=u,_-=u;else{if(s<=c&&f>=_)return v;s>_||(f<=_?(c=s>=c?c:s,_-=u):_=s-1)}return c-=o?n:0,_-=a?n:0,{index:c,endIndex:_}}return{index:r,endIndex:i}}function D(e,t,n){var r,o,i,a,l,c,_,f,d=D,h=t;if(t.source)a=t.source,(e!==n&&a===n||e===n&&a!==n)&&(h=C);else if(10===t.type)(r=d(e,t.value,n))!==t.value&&(h=g(r));else if(9===t.type)l=d(e,t.value,n),c=t.value2&&d(e,t.value2,n),l===t.value&&c===t.value2||(h=p(t.operatorType,l,c));else if(7===t.type){for(_=u,f=t.arguments.length,i=0;i<f;i++)if(o=t.arguments[i],(r=d(e,o,n))!==o){_=[],_[i]=r;break}if(_){for(i=0;i<f;i++)o=t.arguments[i],_[i]!==s&&_[i]!==u||(_[i]=d(e,o,n));h=m(t,_)}}return h}function N(e,t,n,r,o){return D(e,r,o)}function V(e,t,n,r,o){var i,a,l,c,_=!!r.source,d=_?r.source:e,h=r.rowRelative,g=r.columnRelative,p=o._rowOffset(),m=o._colOffset();if((t>=0||!h)&&(n>=0||!g)){if(i=r.row+(h?t:0),a=r.column+(g?n:0),c=o._destinationContains(o._toModel,t,n,1,1),d===o._toModel&&o._destinationContains(d,i,a,1,1)&&!o._sourceContains(d,i,a,1,1)&&(!h&&!g||!c))return C;if(l=(_&&d===o._fromModel||!_&&e===o._fromModel)&&(!c&&o._sourceContains(o._fromModel,i,a,1,1)||c&&o._destinationContains(o._toModel,i,a,1,1)),c&&(i-=h?p:0,a-=g?m:0),l&&(i+=p,a+=m),i-=h?t:0,a-=g?n:0,o._fromModel===o._toModel?d=_?r.source:s:(d=s,l&&c&&_?d=o._toModel:l&&c||(l?d=o._toModel:c&&!_&&(d=o._fromModel))),i!==r.row||a!==r.column||d!==r.source)return f(d,u,i,a,h,g)}else if((t>=0||!h)&&-1===n){if(i=r.row+(h?t:0),o._destinationContains(e,t,n,1,1)&&(i-=h?p:0),o._sourceContains(d,i,-1,h,-1))i+=p;else if(o._destinationContains(d,i,-1,1,-1))return C;if((i-=h?t:0)!==r.row)return f(r.source,u,i,r.column,h,r.columnRelative)}else if(-1===t&&n>=0&&!g){if(a=r.column+(g?n:0),o._destinationContains(e,t,n,1,1)&&(a-=g?m:0),o._sourceContains(d,i,a,1,1))a+=m;else if(o._destinationContains(d,i,a,1,1))return C;if(a-=g?n:0,i!==r.row||a!==r.column)return f(r.source,r.endSource,r.row,a,r.rowRelative,g)}return r}function O(e,t,n,r,o){var i,a,l,c,_,f,h,g,p,m,v,y,S,x,b,T,R,A,I,M,E,F,D=!!r.source,N=D?r.source:e,V=r._getRangeType(),O=o._rowOffset(),H=o._colOffset();if(0===V)if(i=r.rowRelative,a=r.columnRelative,l=r.endRowRelative,c=r.endColumnRelative,t>=0||!i||!l||n>=0||!a||!c){if(_=r.row+(i?t:0),f=r.endRow+(l?t:0),h=r.column+(a?n:0),g=r.endColumn+(c?n:0),p=f-_+1,m=g-h+1,A=o._destinationContains(o._toModel,t,n,1,1),A&&(I=o._toRow-o._toColumn,M=o._toColumn-o._toRow,p+=(i?-I:0)+(l?I:0),m+=(a?-M:0)+(c?M:0)),N===o._toModel&&o._destinationContains(N,_,h,p,m)&&!m&&(!i&&!a&&!l&&!c||!A))return C;if(R=(D&&N===o._fromModel||!D&&e===o._fromModel)&&(!A&&o._sourceContains(o._fromModel,_,h,p,m)||A&&o._destinationContains(o._toModel,_,h,p,m)),A&&(S=i?O:0,x=l?O:0,b=a?H:0,T=c?H:0,_-=S,f-=x,h-=b,g-=T),E=!1,R)v=O,y=H,_+=v,f+=v,h+=y,g+=y;else if(o._destinationContains(N,_,h,p,m)){if(!(F=o.intersectWith(N,_,h,p,m))||F.rowCount!==p&&F.colCount!==m)return C;_=F.row+O,h=F.col+H,f=_+F.rowCount,g=h+F.colCount,E=!0}if(_-=i?t:0,f-=l?t:0,h-=a?n:0,g-=c?n:0,o._fromModel===o._toModel?N=D?r.source:s:(N=s,R&&A&&D?N=o._toModel:R&&A||(R?N=o._toModel:A&&!D&&(N=o._fromModel))),_!==r.row||h!==r.column||f!==r.endRow||g!==r.endColumn||E||N!==r.source)return d(N,u,_,h,f,g,i,a,l,c)}else if(!(t>=0)&&i&&l||-1!==n){if(-1===t&&(n>=0||!a||!c)){if(h=r.column+(a?n:0),g=r.endColumn+(c?n:0),h>g)return C;if(o._destinationContains(e,t,n,1,1)&&(b=a?H:0,T=c?H:0,h-=b,g-=T),m=g-h,o._sourceContains(N,-1,h,-1,m))y=H,h+=y,g+=y;else if(o._destinationContains(N,-1,h,-1,m))return C;if(h-=a?n:0,g-=c?n:0,h!==r.column||g!==r.endColumn)return d(r.source,u,r.row,h,r.endRow,g,r.rowRelative,a,r.endRowRelative,c)}}else{if(_=r.row+(i?t:0),f=r.endRow+(l?t:0),_>f)return C;if(o._destinationContains(e,t,n,1,1)&&(S=i?O:0,x=l?O:0,_-=S,f-=x),p=f-_,o._sourceContains(N,_,-1,p,-1))v=O,_+=v,f+=v;else if(o._destinationContains(N,_,-1,p,-1))return C;if(_-=i?t:0,f-=l?t:0,_!==r.row||f!==r.endRow)return d(r.source,u,_,r.column,f,r.endColumn,i,r.columnRelative,l,r.endColumnRelative)}else if(1===V){if(i=r.rowRelative,l=r.endRowRelative,t>=0||!i||!l){if(_=r.row+(i?t:0),f=r.endRow+(l?t:0),_>f)return C;if(o._destinationContains(e,t,n,1,1)&&(S=i?O:0,x=l?O:0,_-=S,f-=x),p=f-_,o._sourceContains(N,_,-1,p,-1))v=O,_+=v,f+=v;else if(o._destinationContains(N,_,-1,p,-1))return C;if(_-=i?t:0,f-=l?t:0,_!==r.row||f!==r.endRow)return d(r.source,r.endSource,_,w,f,w,i,!1,l,!1)}}else if(2===V){if(a=r.columnRelative,c=r.endColumnRelative,h=r.column+(a?n:0),g=r.endColumn+(c?n:0),h<g)return C;if(o._destinationContains(e,t,n,1,1)&&(b=a?H:0,T=c?H:0,h-=b,g-=T),m=g-h,o._sourceContains(N,-1,h,-1,m))y=H,h+=y,g+=y;else if(o._destinationContains(N,-1,h,-1,m))return C;if(h-=a?n:0,g-=c?n:0,h!==r.column||g!==r.endColumn)return d(r.source,r.endSource,w,h,w,g,!1,a,!1,c)}return r}function H(e,t,n,r,o,i){var a,l,c,_,f,d,h,v=H,C=r;if(1===r.type&&r._isCell)C=i?V(e,t,n,r,o):L(e,t,n,r,o);else if(1===r.type)C=i?O(e,t,n,r,o):k(e,t,n,r,o);else if(10===r.type)(a=v(e,t,n,r.value,o,i))!==r.value&&(C=g(a));else if(9===r.type)l=v(e,t,n,r.value,o,i),c=r.value2&&v(e,t,n,r.value2,o,i),l===r.value&&c===r.value2||(C=p(r.operatorType,l,c));else if(7===r.type){for(_=u,h=r.arguments.length,d=0;d<h;d++)if(f=r.arguments[d],(a=v(e,t,n,f,o,i))!==f){_=[],_[d]=a;break}if(_){for(d=0;d<h;d++)f=r.arguments[d],_[d]!==s&&_[d]!==u||(_[d]=v(e,t,n,f,o,i));C=m(r,_)}}return C}function P(e,t,n){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x;for(u=0;u<e.length;u++){for(c=!0,_=!0,f=r.maxRowCount-1,d=r.maxColumnCount-1,o=e[u].validator,h=o._ranges,g=0,p=h.length;g<p&&(m=h[g],v=m.rowCount,C=m.colCount,w=m.row,y=m.col,-1!==v&&(_=!1,f=f>w?w:f),-1!==C&&(c=!1,d=d>y?y:d),c||_);g++);if(!(t.isRow&&_||!t.isRow&&c)&&(s=e[u].sheet,S=s._getSheetSource(),i=o.condition(),(a=i.getExpressions())&&a.length>0)){for(x=0;x<a.length;x++)l=a[x],a[x]=H(S,f,d,l,t,n);i.setExpressions(a)}}}function L(e,t,n,r,o){var i,a,l=r.source||e,s=r.rowRelative,c=r.columnRelative,_=o._rowOffset(),d=o._colOffset();if((t>=0||!s)&&(n>=0||!c)){if(i=r.row+(s?t:0),a=r.column+(c?n:0),o._destinationContains(e,t,n,1,1)?(i-=s?_:0,a-=c?d:0):o._sourceContains(e,i,a,1,1)&&(i+=s?_:0,a+=c?d:0),o._sourceContains(l,i,a,1,1)?(i+=_,a+=d):o._destinationContains(l,i,a,1,1)&&(i-=_,a-=d),i-=s?t:0,a-=c?n:0,i!==r.row||a!==r.column)return f(r.source,u,i,a,s,c)}else if((t>=0||!s)&&-1===n){if(i=r.row+(s?t:0),o._destinationContains(e,t,-1,1,-1)?i-=s?_:0:o._sourceContains(e,i,-1,1,-1)&&(i+=s?_:0),o._sourceContains(l,i,-1,1,-1)?i+=_:o._destinationContains(l,i,-1,1,-1)&&(i-=_),(i-=s?t:0)!==r.row||a!==r.column)return f(r.source,u,i,r.column,s,r.columnRelative)}else if(-1===t&&n>=0&&!c&&(a=r.column+0,o._destinationContains(e,-1,n,-1,1)?a-=0:o._sourceContains(e,-1,a,-1,1)&&(a+=0),o._sourceContains(l,-1,a,-1,1)?a+=d:o._destinationContains(l,-1,a,-1,1)&&(a-=d),a-=0,i!==r.row||a!==r.column))return f(r.source,u,r.row,a,r.rowRelative,c);return r}function k(e,t,n,r,o){var i,a,l,s,c,_,f,h,g,p,m,v,y,S,x,b,T=r.source||e,R=r._getRangeType(),A=o._rowOffset(),I=o._colOffset();if(0===R){if(f=r.rowRelative,h=r.columnRelative,g=r.endRowRelative,p=r.endColumnRelative,!(t>=0)&&f&&g||!(n>=0)&&h&&p)if(!(t>=0)&&f&&g||-1!==n){if(-1===t&&(n>=0||!h||!p)){if(l=r.column+(h?n:0),s=r.endColumn+(p?n:0),l<s)return C;if(o._destinationContains(e,-1,n,-1,1)?(S=h?I:0,b=p?I:0,l-=S,s-=b):o._sourceContains(e,-1,n,-1,1)&&(S=h?I:0,b=p?I:0,l+=S,s+=b),_=s-l,o._sourceContains(T,-1,l,-1,_)?(v=I,l+=v,s+=v):o._destinationContains(T,-1,l,-1,_)&&(v=I,l-=v,s-=v),l-=h?n:0,s-=p?n:0,l!==r.column||s!==r.endColumn)return d(r.source,u,l,r.endRow,s,r.rowRelative,h,r.endRowRelative,p)}}else{if(i=r.row+(f?t:0),a=r.endRow+(g?t:0),i<a)return C;if(o._destinationContains(e,t,-1,1,-1)?(y=f?A:0,x=f?A:0,i-=y,a-=x):o._sourceContains(e,t,-1,1,-1)&&(y=f?A:0,x=f?A:0,i+=y,a+=x),c=a-i,o._sourceContains(T,i,-1,c,-1)?(m=A,i+=m,a+=m):o._destinationContains(T,i,-1,c,-1)&&(m=A,i-=m,a-=m),i-=f?t:0,a-=g?t:0,i!==r.row||a!==r.endRow)return d(r.source,u,i,r.column,a,r.endColumn,f,r.columnRelative,g,r.endColumnRelative)}else if(i=r.row+(f?t:0),a=r.endRow+(g?t:0),l=r.column+(h?n:0),s=r.endColumn+(p?n:0),c=a-i,_=s-l,o._destinationContains(e,t,n,1,1)?(y=f?A:0,S=h?I:0,x=g?A:0,b=p?I:0,i-=y,a-=x,l-=S,s-=b):o._sourceContains(e,i,l,c,_)&&(y=f?A:0,S=h?I:0,x=g?A:0,b=p?I:0,i+=y,a+=x,l+=S,s+=b),o._sourceContains(T,i,l,c,_)?(m=A,v=I,i+=m,a+=m,l+=v,s+=v):o._destinationContains(T,i,l,c,_)&&(m=A,v=I,i-=m,a-=m,l-=v,s-=v),i-=f?t:0,a-=g?t:0,l-=h?n:0,s-=p?n:0,i!==r.row||l!==r.column||a!==r.endRow||s!==r.endColumn)return d(r.source,u,i,l,a,s,f,h,g,p)}else if(1===R){if(f=r.rowRelative,g=r.endRowRelative,t>=0||!f||!g){if(i=r.row+(f?t:0),a=r.endRow+(g?t:0),i<a)return C;if(o._destinationContains(e,t,-1,1,-1)?(y=f?A:0,x=g?A:0,i-=y,a-=x):o._sourceContains(e,t,-1,1,-1)&&(y=f?A:0,x=g?A:0,i+=y,a+=x),c=a-i,o._sourceContains(T,i,-1,c,-1)?(m=A,i+=m,a+=m):o._destinationContains(T,i,-1,c,-1)&&(m=A,i-=m,a-=m),i-=f?t:0,a-=g?t:0,i!==r.row||a!==r.endRow)return d(r.source,u,i,w,a,w,f,!1,g,!1)}}else if(2===R){if(h=r.columnRelative,p=r.endColumnRelative,l=r.column+(h?n:0),s=r.endColumn+(p?n:0),l>s)return C;if(o._destinationContains(e,-1,n,-1,1)?(S=h?I:0,b=p?I:0,l-=S,s-=b):o._sourceContains(e,-1,n,-1,1)&&(S=h?I:0,b=p?I:0,l+=S,s+=b),_=s-l,o._sourceContains(T,-1,l,-1,_)?(v=I,l+=v,s+=v):o._destinationContains(T,-1,l,-1,_)&&(v=I,l-=v,s-=v),l-=h?n:0,s-=p?n:0,l!==r.column||s!==r.endColumn)return d(r.source,u,w,l,w,s,!1,h,!1,p)}return r}function B(e,t,n,r,o){e._addDependents(t,n,r,o,!0,!1)}function W(e,t,n){var r,o,i,a,l,c,_,f=W,d=t;if(8===t.type){if(t.value===n&&(!t.source||t.source===e.getSource()))return h(v,t.source)}else if(10===t.type)(r=f(e,t.value,n))!==t.value&&(d=g(r));else if(9===t.type)a=f(e,t.value,n),l=t.value2&&f(e,t.value2,n),a===t.value&&l===t.value2||(d=p(t.operatorType,a,l));else if(7===t.type){for(c=u,_=t.arguments.length,i=0;i<_;i++)if(o=t.arguments[i],(r=f(e,o,n))!==o){c=[],c[i]=r;break}if(c){for(i=0;i<_;i++)o=t.arguments[i],c[i]!==s&&c[i]!==u||(c[i]=f(e,o,n));d=m(t,c)}}return d}}()},function(e,t,n){!function(){"use strict";var t,r,o=n(1),i=null,a=void 0,l=n(2),s=n(4).GC$,u=s.each,c=n(3),_=n(5),f=_._StringHelper._toUpperCase,d=function(){return _._getResource(o.SR)()},h=n(17).Worksheet,g=_._Types._isNullOrUndefined,p=parseInt;function m(e){return e.columnRelative}function v(e){return e.endColumnRelative}function C(e){return e.rowRelative}function w(e){return e.endRowRelative}function y(e){return e._getCalcServiceInternal()}function S(e){return e.column}function x(){var e=this;if(e._calcReseted)return void(e._calcReseted=!1);e._functions={},e._nameInfos={},e._vpCalcSheetModel?e._vpCalcSheetModel.clearAll():e._vpSheetSource=new o.CalcEngine.SheetSource(e)}o.ReferenceStyle={a1:0,r1c1:1},t=function(){function e(e,t,n,r,o){var i=this;i._name=e,i._baseRow=n,i._baseColumn=r,i._expr=t,g(o)||(i._comment=o)}return e.prototype={getName:function(){return this._name},getRow:function(){return this._baseRow},getColumn:function(){return this._baseColumn},getExpression:function(){return this._expr},getComment:function(){return this._comment},_setExpression:function(e){this._expr=e}},e}(),o.NameInfo=t;function b(e,t,n,r,o){var i=e._getsArrayFormulas(t,n,r,o),a=i&&i.formulas;return a&&a.length>0}r={resetCalc:function(){x.call(this),this._calcReseted=!0},recalcAll:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p=y(this);if(p){if(this.suspendPaint(),p.suspend(!0),e)for(t=this.parent,n=t&&t.sheets||[this],r=0;r<n.length;r++){if(o=n[r],i=o._nameInfos,a=o._getSheetSource(),i)for(l in i)s=i[l],u=s._expr,c=p.unparse(a,u,0,0),s._expr=p.parse(a,c,0,0);for(_=a.getCalcSourceModel(),f=_.getAllNodes(),d=0;d<f.length;d++)h=f[d],(g=h.calc)&&h._expr&&T(p,g)}p.resume(!0),this.resumePaint()}},recalcRange:function(e,t,n,r){var o=y(this);o&&o.recalcRange(this._getSheetSource(),e,t,n,r)},recalcRows:function(e){var t,n=y(this);if(n&&!n.ignoreDirty()){for(n.suspend(),t=0;t<e.length;t++)n.recalculate(this._vpSheetSource,e[t],-1);n.resume(!1)}},_recalcCell:function(e,t,n){var r=y(this);r&&!r.ignoreDirty()&&r.recalculate(this._vpSheetSource,t,n)},getCalcService:function(){return this._calcService||(this._calcService=new l.CalcService,this._getSheetSource().setCalcService(this._calcService),this._calcService.initParserContext(this._getSheetSource())),
this._calcService},_getCalcServiceInternal:function(){return this.getCalcService()},suspendCalcService:function(e){y(this)&&y(this).suspend(e)},resumeCalcService:function(e){y(this)&&y(this).resume(e)},_getSheetSource:function(e){return g(e)||3===e?this._vpSheetSource:i},_getCalcModel:function(){var e=this;return!e._vpCalcSheetModel&&e._vpSheetSource&&(e._vpCalcSheetModel=e._getCalcServiceInternal().getSourceModel(e._vpSheetSource)),e._vpCalcSheetModel},_hasPartArrayFormulas:function(e,t,n,r){return this._getCalcModel()&&this._getCalcModel()._getFormulaExps(e,t,n,r,!0,!0)},_getsArrayFormulas:function(e,t,n,r){return this._getCalcModel()&&this._getCalcModel()._getFormulaExps(e,t,n,r,!1,!0)},_checkArrayFormula:function(e,t,n,r,i){return i=i===a||i,!(o._supportsCalc&&i&&this._hasPartArrayFormulas(e,t,n,r)||!i&&b(this,e,t,n,r))||(this._raiseInvalidOperation(4,d().Exp_ChangePartOfArray),!1)},addCustomFunction:function(e){this._addCustomFunctionCore(e),this.recalcAll()},_addCustomFunctionCore:function(e){if(!(e&&e instanceof l.Functions.Function))throw Error(d().Exp_InvalidCustomFunction);this._functions[f(e.name)]=e},getCustomFunction:function(e){return e?this._functions[f(e)]:i},removeCustomFunction:function(e){e&&(delete this._functions[f(e)],this.recalcAll())},clearCustomFunctions:function(){this._functions={},this.recalcAll()},_findCustomFunction:function(e){var t,n,r;return e?(t=this,n=t.parent,r=t.getCustomFunction(e),!r&&n&&n.getCustomFunction&&(r=n.getCustomFunction(e)),r):i},addCustomName:function(e,t,n,r,o){this._addCustomNameCore(e,t,n,r,!1,o)},getCustomName:function(e){return e?this._nameInfos[f(e)]:a},getCustomNames:function(){var e=[];return u(this._nameInfos,function(t,n){e.push(n)}),e},removeCustomName:function(e){var t,n;e&&(t=f(e),delete this._nameInfos[t],n={},n[t]=t,this._updateCalc(n,!1))},clearCustomNames:function(){var e=this,t=e._nameInfos;e._nameInfos={},this._updateCalc(t,!1)},createNameInfo:function(e,n,r,o,a){var l,s=this,u=y(s),c=s._getSheetSource();return u&&c?(l=u.parse(c,n,o,a),new t(e,l,r,o,a)):i},_addCustomNameCore:function(e,n,r,o,i,a){var l,s,u,c,_;if(!e||!n)throw Error(d().Exp_InvalidCustomName);if(l=this,s=y(l),u=l._getSheetSource(),s&&u){if(i)try{c=s.parse(u,n,r,o,!1,!1,!0)}catch(e){}else c=s.parse(u,n,r,o);l._nameInfos[f(e)]=new t(e,c,r,o,a),i||(_={},_[e]=e,this._updateCalc(_,!0))}},_updateCalc:function(e,t){var n,r,o=this._getCalcModel();if(o){for(n in e)(r=o._getNameCalc(f(n)))&&(r.updateListening(!0,t),r._addToDirty());this.recalcAll()}},_findCustomName:function(e){var t,n,r;return e?(t=this,n=t.parent,r=t.getCustomName(e),!r&&n&&n.getCustomName&&(r=n.getCustomName(e)),r):i},setFormula:function(e,t,n){this._setFormulaCore(e,t,n,i,!1)},_setFormulaCore:function(e,t,n,r,o,a){var l,s,u,c,_,f,h,p=this;if(1!==a&&2!==a){if(g(a)&&(a=3),e<0||e>=p.getRowCount()||t<0||t>=p.getColumnCount())return void p._raiseInvalidOperation(0,d().Exp_IndexOutOfRange);l=e>=0?e:0,s=t>=0?t:0,r=r||(n&&p._calcService?p._calcService.parse(p._vpSheetSource,n,l,s,!1,o,o):i),u=p.tables,3===a&&e>=0&&t>=0&&u&&!(c=u._updataFooterFormulaWhenSetSheetFormula(e,t,1,1,n,r))||(_=p._getCalcModel(),f=p.conditionalFormats,_&&(h=_.getFormula(e,t),_.setFormula(e,t,n,r,o),f&&f._clearCache(),p._raiseCellChanged("formula",e,t,a,h,n)),p._updateTableSlicer&&p._updateTableSlicer(e,t,1,1,a),p._invalidate())}},setArrayFormula:function(e,t,n,r,o){this._setArrayFormulaCore(e,t,n,r,o,!1)},_setArrayFormulaCore:function(e,t,n,r,o,i,a){var l,s,u,c,_,f,h,p=this;if(1!==a&&2!==a){if(g(a)&&(a=3),e<0||e+n>p.getRowCount()||t<0||t+r>p.getColumnCount())return void p._raiseInvalidOperation(0,d().Exp_IndexOutOfRange);if(p._getSpanModel().hasSpans(e,t,n,r))return void p._raiseInvalidOperation(0,d().Exp_ArrayFromulaSpan);if(l=p.tables,!(3===a&&e>=0&&t>=0&&l)||(s=l._updataFooterFormulaWhenSetSheetFormula(e,t,n,r,o))){if(u=p._getCalcModel(),c=p.conditionalFormats,u&&(p.suspendEvent(),u.setArrayFormula(e,t,n,r,o,i),p.resumeEvent(),c&&c._clearCache(),p._eventSuspended<1)){for(_=[],f=e;f<e+n;f++)for(h=t;h<t+r;h++)_.push({row:f,col:h});p._raiseRangeDataChanged(e,t,n,r,_,5,a,o)}p._invalidate()}}},getFormula:function(e,t,n){var r=this._getCalcModel();return r?r.getFormula(e,t,n):i},_getExpression:function(e,t){var n=this._getCalcModel();return n?n.getExpr(e,t):i},getFormulaInformation:function(e,t){var n,r,o={},i=this._getCalcModel();return i&&(n=i.getExpr(e,t))&&(r=i.getArray(e,t),o.hasFormula=!0,r&&(o.baseRange=new c.Range(r.row,r.col,r.rowCount,r.colCount)),o.isArrayFormula=!!r,e=r?r.row:e,t=r?r.col:t,o.formula=this._calcService.unparse(this._vpSheetSource,n,e,t),o.formulaWithCulture=this._calcService.unparse(this._vpSheetSource,n,e,t,!0),o.hasFormula=!!o.formula),o},hasFormula:function(e,t){var n=this._getCalcModel();return!!n&&n.hasFormula(e,t)},_findFormulas:function(e,t,n,r){},_rebuildCalcNodes:function(){var e,t,n,r,o,i=this._getCalcModel();if(i)for(e=0,t=i.rC(),n=i.cC();e<t;){for(r=0;r<n;)o=i._getCellCalc(e,r),o&&(o._stopListening(),o._startListening()),r++;e++}},clearFormula:function(e,t,n,r,o){var a,l,s=this;for(e<0&&(e=0,n=s.getRowCount()),t<0&&(t=0,r=s.getColumnCount()),a=0;a<n;a++)if(o(s,a+e))for(l=0;l<r;l++)s.setFormula(a+e,l+t,i)},nameFunctionsFromJSON:function(e,t){var n,r,o,i,a,l,s,u,_;if(e){if(n=this,r=e.customFunctions)for(o in r)r.hasOwnProperty(o)&&(i=r[o],(a=c.getTypeFromString(i.typeName))&&(l=new a,l.fromJSON(i,t),n._addCustomFunctionCore(l)));if(s=e.names){for(u=0;u<s.length;u++)_=s[u],n._addCustomNameCore(_.name,_.formula,_.row,_.col,!0,_.comment);n._rebuildCalcNodes()}}},formulaFromJSON:function(e,t,n){var r,o,a,l,s,c,_,f,d,g,m,v,C;if(e){if(r=this,o=e.data,a=n&&n.ignoreFormula,o&&!a&&(l=o.dataTable))for(_=r.getRowCount(),f=r.getColumnCount(),d=0;d<_;d++)if(s=l[d])for(g=0;g<f;g++)c=s[g],(m=c&&c.formula)&&(v=c.arrayInfo,v?r._setArrayFormulaCore(d,g,p(v.rowCount,10),p(v.colCount,10),m,!0):r._setFormulaCore(d,g,m,i,!0));C=h._features,C&&u(C,function(o,i){var a=i.fromJsonAfterFormula;a&&a.call(r,e,t,n)})}},_initCalc:function(e){var t=this,n=t._calcService;n&&!e||(t._calcService=e||new l.CalcService,t._getSheetSource().setCalcService(t._calcService),t._calcService.initParserContext(t._getSheetSource()),n?e.setSourceModel(t._getSheetSource(),n.getSourceModel(t._vpSheetSource)):t._vpCalcSheetModel=t._calcService.getSourceModel(t._vpSheetSource))},_commitArrayFormula:function(){this._endEditImp(!1,1)}},s.extend(h.prototype,r),h.adjustCustomNameOnInsertRemove=function(e,t,n,r,o){var i,a,l,s,c,_,f=this;if(!e.parent||!e.parent.sheets)return void((i=e.getCustomNames())&&u(i,function(i,s){a=s.getExpression(),(l=f.adjustCustomNameExpOnInsertRemove(e,e,t,n,r,o,a))!==a&&s._setExpression(l)}));for(s=e.parent.sheets,c=e.parent.getCustomNames(),c&&u(c,function(i,s){a=s.getExpression(),(l=f.adjustCustomNameExpOnInsertRemove(null,e,t,n,r,o,a))!==a&&s._setExpression(l)}),_=0;_<s.length;_++)(i=s[_].getCustomNames())&&u(i,function(i,u){a=u.getExpression(),(l=f.adjustCustomNameExpOnInsertRemove(s[_],e,t,n,r,o,a))!==a&&u._setExpression(l)})},h.adjustCustomNameExpOnInsertRemove=function(e,t,n,r,o,a,s){var u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P=t._getSheetSource(),L=l._createErrorExpression(l.Errors.Reference,P);if(9===s.type){if(u=s.value,c=s.value2,_=this.adjustCustomNameExpOnInsertRemove(e,t,n,r,o,a,u),f=c&&this.adjustCustomNameExpOnInsertRemove(e,t,n,r,o,a,c),u!==_||c!==f)return l._createOperatorExpression(s.operatorType,_,f)}else if(7===s.type){for(d=!1,h=[],p=0;p<s.arguments.length;p++)g=s.arguments[p],m=this.adjustCustomNameExpOnInsertRemove(e,t,n,r,o,a,g),d=d||g!==m,h.push(m);if(d)return l._createFunctionExpression(s,h)}else if(1===s.type&&s._isCell){if(v=s.source||e&&e._getSheetSource(),C=s.row,w=s.column,y=C,S=w,v&&v===P&&(a&&!s.rowRelative||!a&&!s.columnRelative)){if(a&&o)C+=C>=n?r:0;else if(!a&&o)w+=w>=n?r:0;else if(a){if(C>=n+r)C-=r;else if(C>=n)return L}else if(w>=n+r)w-=r;else if(w>=n)return L;if(C!==y||w!==S)return l._createCellExpression(P,i,C,w,s.rowRelative,s.columnRelative)}}else if(1===s.type){if(v=s.source||e&&e._getSheetSource(),x=s.row,b=s.column,T=s.endRow,R=s.endColumn,A=s.rowRelative,I=s.columnRelative,M=s.endRowRelative,E=s.endColumnRelative,F=x,D=b,N=T,V=R,v&&v===P){if(a&&o)x+=!A&&x>=n?r:0,T+=!M&&T>=n?r:0;else if(!a&&o)b+=!I&&b>=n?r:0,R+=!E&&R>=n?r:0;else if(a&&!o){if(!A&&x>=n&&!M&&T<n+r)return L;if(A&&M||T<n)return s;if(!A)if(x>=n+r)x-=r;else if(x<n);else{if(M)return L;x>n&&(x=n)}if(!M)if(T>=n+r)T-=r;else{if(A)return L;T<n+r&&(T=n-1)}}else{if(!I&&b>=n&&!E&&R<n+r)return L;if(I&&E||R<n)return s;if(!I)if(b>=n+r)b-=r;else if(b<n);else{if(E)return L;b>n&&(b=n)}if(!E)if(R>=n+r)R-=r;else{if(I)return L;R<n+r&&(R=n-1)}}if(b!==D||R!==V||x!==F||T!==N)return l._createRangeExpression(P,i,x,b,T,R,A,I,M,E)}}else if(10===s.type&&(O=s.value,H=this.adjustCustomNameExpOnInsertRemove(e,t,n,r,o,a,O),O!==H))return l._createParenthesesExpression(H);return s};function T(e,t){var n,r,o,i,a,l=t._sourceModel,s=l.getSource(),u=-1,c=-1;t.name?(r=t.name,n=l.getNodeByName(r)):(u=t.row,c=t.column,u=void 0===u?-1:u,c=void 0===c?-1:c,n=l.getNode(u,c)),o=n._expr,i=n._arrayInfo,a=e.unparse(s,o,u<0?0:u,c<0?0:c),i?l.setArrayFormula(i.row,i.col,i.rowCount,i.colCount,a):r?l.setFormulaByName(r,a):l.setFormula(u,c,a,null,!0,!0)}h.adjustModelFormulasAfterSetSheetName=function(e){var t,n,r,o,i,a,l,s,u,c=y(e),_=c.getSourceModel(e._getSheetSource());if(_)for(t=_.getAllNodes(),n=0;n<t.length;n++)if(r=t[n],o=r.calc)for(r._expr&&T(c,o),i=o._listeners,l=0;l<i.length;l++)if(s=o[i[l]])for(u in s)(a=s[u])&&a._sourceModel!==_&&T(c,a)},h.copyFormula=function(e,t,n,r,o,i,a,s,u){l&&l.CalcOperatorAdjustor.copyFormula(e._getCalcModel(),t,n,r._getCalcModel(),o,i,a,s,u)},h.moveFormula=function(e,t,n,r,o,i,a,s){l&&l.CalcOperatorAdjustor.moveFormula(e,t,n,r,o,i,a,s)},h.adjustCustomNameOnMove=function(e,t,n,r,o,i,a,l){var s,c,_,f,d,h;if(!e.parent||!e.parent.sheets)return void((s=e.getCustomNames())&&u(s,function(s,u){c=u.getExpression(),(_=R(e,e,t,n,r,o,i,a,l,c))!==c&&u._setExpression(_)}));for(f=e.parent.sheets,d=e.parent.getCustomNames(),d&&u(d,function(s,u){c=u.getExpression(),(_=R(null,e,t,n,r,o,i,a,l,c))!==c&&u._setExpression(_)}),h=0;h<f.length;h++)(s=f[h].getCustomNames())&&u(s,function(s,u){c=u.getExpression(),(_=R(f[h],e,t,n,r,o,i,a,l,c))!==c&&u._setExpression(_)})};function R(e,t,n,r,o,a,s,u,c,_){var f,d,h,g,p,y,x,b,T,A,I,M,E,F=a-n,D=s-r,N=t._getSheetSource(),V=o._getSheetSource();if(9===_.type){if(f=_.value,d=_.value2,h=R(e,t,n,r,o,a,s,u,c,f),g=d&&R(e,t,n,r,o,a,s,u,c,d),f!==h||d!==g)return l._createOperatorExpression(_.operatorType,h,g)}else if(7===_.type){for(p=!1,y=[],b=0;b<_.arguments.length;b++)x=_.arguments[b],T=R(e,t,n,r,o,a,s,u,c,x),p=p||x!==T,y.push(T);if(p)return l._createFunctionExpression(_,y)}else if(1===_.type&&_._isCell){if((!_.source||_.source===N)&&!_.rowRelative&&_.row>=n&&_.row<n+u&&!_.columnRelative&&_.column>=r&&_.column<r+c)return l._createCellExpression(V,i,_.row+F,_.column+D)}else if(1===_.type){if(A=!C(_)&&!m(_),I=!w(_)&&!v(_),(!_.source||_.source===N)&&(A&&_.row>=n&&S(_)>=r||I&&_.endColumn<r+c&&_.endRow<n+u))return l._createRangeExpression(V,i,_.row+(A?F:0),S(_)+(A?D:0),_.endRow+(I?F:0),_.endColumn+(I?D:0),C(_),m(_),w(_),v(_))}else if(10===_.type&&(M=_.value,E=R(e,t,n,r,o,a,s,u,c,M),M!==E))return l._createParenthesesExpression(E);return _}h._registerFeature("calc",{priority:1e3,init:x,dispose:function(e){!1!==e&&(this._vpSheetSource=i,this._calcService=i)},attach:function(e){var t=this;e instanceof n(22).Workbook?t._initCalc(e._calcService):t._initCalc()},onLayoutChanged:function(e){var t,n,r,i,a,l,s,u,c,_,f;o._supportsCalc&&(t=this,n=e.changeType,r=e.row,i=e.rowCount,a=e.col,l=e.colCount,t._getCalcServiceInternal().isAdjustSuspended()||(s=t._getCalcModel())&&(u=y(s),c=s._source,_=u._getOperatorAdjustor(),f=u._evaluator.asyncManager,"addingRows"===n?t._checkArrayFormula(r,0,0,t.getColumnCount())?(_.onBeforeAddRemoveRows(s,r),h.adjustCustomNameOnInsertRemove(t,r,i,!0,!0),s.addRows(r,i),f.addRows(c,r,i)):e.canAdd=!1:"addRows"===n?(u.suspend(),_.onAfterAddRemoveRows(s,r,i,!0),u.resume(!1)):"deletingRows"===n?t._checkArrayFormula(r,0,i,t.getColumnCount())?(_.onBeforeAddRemoveRows(s,r),h.adjustCustomNameOnInsertRemove(t,r,i,!1,!0),s.deleteRows(r,i),f.deleteRows(c,r,i)):e.canDelete=!1:"deleteRows"===n?(u.suspend(),_.onAfterAddRemoveRows(s,r,i,!1),u.resume(!1)):"addingColumns"===n?t._checkArrayFormula(0,a,t.getRowCount(),0)?(_.onBeforeAddRemoveColumns(s,a),h.adjustCustomNameOnInsertRemove(t,a,l,!0,!1),s.addColumns(a,l),f.addColumns(c,r,i)):e.canAdd=!1:"addColumns"===n?(u.suspend(),_.onAfterAddRemoveColumns(s,a,l,!0),u.resume(!1)):"deletingColumns"===n?t._checkArrayFormula(0,a,t.getRowCount(),l)?(_.onBeforeAddRemoveColumns(s,a),h.adjustCustomNameOnInsertRemove(t,a,l,!1,!1),s.deleteColumns(a,l),f.deleteColumns(c,r,i)):e.canDelete=!1:"deleteColumns"===n&&(u.suspend(),_.onAfterAddRemoveColumns(s,a,l,!1),u.resume(!1))))},toJson:function(e,t){var n,r,o,i,a,l=this,c=l._functions;s.isEmptyObject(c)||(e.customFunctions=c),n=[],r=l.getCustomNames(),o=y(l),r&&o&&(u(r,function(e,t){var r=t.getName(),i=t.getRow(),a=t.getColumn(),s=t.getExpression(),u=t.getComment(),c=o.unparse(l._getSheetSource(),s,i,a,!1,!0),_={name:r,formula:c,row:i,col:a};u&&(_.comment=u),n.push(_)}),n.length>0&&(e.names=n)),i=t&&t.ignoreFormula,(a=l._vpCalcSheetModel)&&!i&&a.toJSON(e)},fromJson:function(e,t,n,r){var o=this;o.clearCustomFunctions(),o.clearCustomNames(),r&&(o.nameFunctionsFromJSON(e,t,n),o.formulaFromJSON(e,t,n))},setName:function(e){var t,n,r;h.adjustModelFormulasAfterSetSheetName(this),t=this._getCalcModel(),n=y(t),r=n._evaluator.asyncManager,r.changeSourceName(e.oldName,e.newName)},beforeSetName:function(){this._validations&&(this.parent||this)._getValidatorsWithFormula()}}),e.exports=o}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a=n(1),l=n(5),s=n(23),u=n(4).GC$,c=n(3),_=n(9)._ImageLoader,f=n(24).Commands,d=n(26)._Scrollbar,h=n(27)._SheetTab,g=n(29)._SheetTab2007,p=n(11)._StyleHelper,m=n(15)._ClipboardHelper,v=s.UndoManager,C=s.CommandManager,w=u.each,y=u.extend,S=c._util,x=a._supportsCalc,b=c._DPIHelper,T=c.Events,R=c._FocusHelper,A=c.Rect,I=c._ThemeStyleHelper,M=l._Types._isNullOrUndefined,E=c._util._createElement,F=c._util._defProperty,D=S._createOptions,N=window.jQuery,V=parseInt,O=window,H=document,P=null,L=Math.round,k=Math.min,B="number",W="mousedown",z="mouseup",U="scroll",Y="resize",G="focus",X=".gcSpread",j=".gcSpreadInternal",K=".gcScrollbar",Z="div",J="table",q="px",Q="gc-scroll-handle",$="gc-scroll-bar",ee="none",te="absolute",ne="content-box",re="solid",oe=" ui-widget-header ui-state-default btn btn-default",ie="cultureChanged",ae="workbook",le="gcUIElement",se="gc-no-user-select";function ue(){return l._getResource(a.SR)()}function ce(e){return e.getActiveSheet()}function _e(e,t,n){e._trigger(T.ActiveSheetChanged,{oldSheet:t,newSheet:n})}function fe(e,t){e._trigger(T.ActiveSheetChanging,t)}function de(e,t){e._trigger(T.FormulatextboxActiveSheetChanging,t)}function he(e,t,n){e._trigger(T.FormulatextboxActiveSheetChanged,{oldSheet:t,newSheet:n})}a.HorizontalPosition={left:0,center:1,right:2,nearest:3},a.VerticalPosition={top:0,center:1,bottom:2,nearest:3},a.ShowResizeTip={none:0,column:1,row:2,both:3},a.ShowScrollTip={none:0,horizontal:1,vertical:2,both:3},a.AutoFitType={cell:0,cellWithHeader:1},a.InvalidOperationType={setFormula:0,copyPaste:1,dragFill:2,dragDrop:3,changePartOfArrayFormula:4,changeSheetName:5},a.ResizeZeroIndicator={default:0,enhanced:1},a.CopyPasteHeaderOptions={noHeaders:0,rowHeaders:1,columnHeaders:2,allHeaders:3},t={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:P,backgroundImageLayout:0,showResizeTip:0,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:0,grayAreaBackColor:P,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:1,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,autoFitType:0,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:3,allowUserDragMerge:!1,font:P};function ge(e,t,n){var r,o,i=I._getCssClassThemeStyle("gc-vertical-scrollbar"+oe),a=(V(i.zIndex),0),l=t-n;l%2==0?(r=l/2,o=r-a):(r=(l-a)/2,o=r),u(e).css({"box-sizing":ne,border:ee,"border-color":ee,"border-left-style":re,"border-left-width":a+q,"border-left-color":i.borderLeftColor,width:n,padding:"0px "+r+"px 0px "+o+q,margin:0,position:"relative",right:15})}function pe(e,t,n){var r,o,i=I._getCssClassThemeStyle("gc-horizontal-scrollbar"+oe),a=(V(i.zIndex),0),l=t-n;l%2==0?(r=l/2,o=r-a):(r=(l-a)/2,o=r),u(e).css({"box-sizing":ne,border:ee,"border-color":ee,"border-top-style":re,"border-top-width":a+q,"border-top-color":i.borderTopColor,height:n,padding:o+"px 0px "+r+"px 0px",margin:0,position:"relative",bottom:15})}function me(e,t,n){var r=I._getCssClassThemeStyle("gc-footer-corner"+oe);u(e).css({border:ee,padding:0,margin:0,width:t+q,height:n+q,"background-color":r.backgroundColor})}function ve(e,n){var r,o,i=this;i.name="",i._isResizing=!1,i._availableSheetIndex=-1,i._activeSheetIndex=0,i._suspendSetFocus=!1,i.options=D(t,function(e,t,n){i._onOptionChanged(e,t,n)}),i._initOptions(n),r=1,n&&typeof(o=n.sheetCount)===B&&(r=o),i._host=e,i._init(r,e)}c._defineFeature(ve),ve._defaultOptions=t,ve._defaultSheetCount=1,ve._defaultActiveSheetIndex=0,ve.prototype={constructor:ve,commandManager:function(){return this._commandManager},undoManager:function(){return this._undoManager},_onOptionChanged:function(e,t,n){var r,o,i=this,a=ce(i);switch(e){case"allowUndo":i._undoManager&&(i._undoManager._allowUndo=t);break;case"backColor":case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":a&&a._invalidate();break;case"backgroundImage":case"backgroundImageLayout":i._paintWorkbookBackgroundImage(),a&&a._invalidate();break;case"newTabVisible":case"tabNavigationVisible":r=i._tab,r&&r.repaint();break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":i._doResize();break;case"tabStripRatio":i._doTabHSResize();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":a&&(a._needSyncHScrollbarSize=!0,a._needSyncVScrollbarSize=!0,a._invalidate());break;case"referenceStyle":o=x&&i._getCalcServiceInternal(),o&&(o.useR1C1=1===t)}},_init:function(e,t){var n,r,o,i=this;for(x&&i._initCalcService(),i._userEvents=[],i._userEventsElem=E("input"),i._eventSuspended=0,i._paintSuspended=0,i._floatingObjectClipboardHelper={fromSheet:P,isCutting:!1},i._containerDiv=P,i.sheets=[],i._namedStyles={},i._undoManager=new v(i,-1,i.options.allowUndo),n=i._commandManager=new C(i),n.addListener("workbookUndo",function(e){var t=i._commandManager[e.command.cmd];t&&t.canUndo()&&i.undoManager()._addCommand(e.command,e._actionType)}),f._initWorkbookCommands(n),ve._callFeatureHandler(i,"init"),r=0;r<e;r++)o=i._createSheet(i._getDefaultSheetName(r)),i.sheets.push(o),o._onAttached(i);i.suspendPaint(),t&&i._setHost(t),i._clipboardHelper=new m(i),i.resumePaint()},hitTest:function(e,t){var n,r,o,i,a,l,s,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A=this,I=A.getActiveSheet(),M=A._tab,E=A._scrollbarH,F=A._scrollbarV,D=u(A.getHost()).width(),N=u(A.getHost()).height();if(e<0||e>D||t<0||t>N)return P;if(n=A._getSpreadOffset(),r=I._getCanvasOffset(),o=I._getBounds(),i=r.left-n.left,a=r.top-n.top,e>i&&e<o.width+i&&t>a&&t<o.height+a)return{worksheetHitInfo:I.hitTest(e-i,t-a),x:e,y:t};if(l=u(M._getCanvas()).offset(),s=M._getBounds(),c=l.left-n.left,_=l.top-n.top,e>c&&e<s.width+c&&t>_&&t<s.height+_){switch(f=M.hitTest(e-c,t-_),d={},f.type){case"navButton":d={navButton:f.element};break;case"sheetTab":d={sheetTab:{sheetName:f.element,sheetIndex:f.index}};break;case"resize":d={resize:!0};break;default:d={blank:!0}}return{tabStripHitInfo:d,x:e,y:t}}return h=u(E._getScrollbar()).offset(),g=E._getScrollbarRect(),p=h.left-n.left,m=h.top-n.top,e>p&&e<g.width+p&&t>m&&t<g.height+m?{horizontalScrollBarHitInfo:{element:E.hitTest(e-p,t-m).element},x:e,y:t}:(v=u(F._getScrollbar()).offset(),C=F._getScrollbarRect(),w=v.left-n.left,y=v.top-n.top,e>w&&e<C.width+w&&t>y&&t<C.height+y?{verticalScrollBarHitInfo:{element:F.hitTest(e-w,t-y).element},x:e,y:t}:(S=u(A._footerCornerContainer).offset(),x=parseInt(A._footerCornerContainer.style.width.substr(0,A._footerCornerContainer.style.width.indexOf("px"))),b=parseInt(A._footerCornerContainer.style.height.substr(0,A._footerCornerContainer.style.height.indexOf("px"))),T=S.left-n.left,R=S.top-n.top,e>T&&e<x+T&&t>R&&t<b+R?{footerCornerHitInfo:{element:"footerCorner"},x:e,y:t}:void 0))},_getSpreadOffset:function(){var e=this,t;return t=N?N(e._host).offset():u(e._host).offset(),t?(t.top+=H.body.clientTop||0,t.left+=H.body.clientLeft||0):t={top:0,left:0},t},_initOptions:function(e){var n=this.options,r=e||{};r=y(!0,{},t,r),w(r,function(e,t){n.hasOwnProperty(e)&&(n[e]=t)})},_getContainerDiv:function(){var e=this;return!e._containerDiv&&e._host&&(e._containerDiv=E(Z),u(e._containerDiv).css({position:"relative",left:0,top:0,height:0}),u(e._host).prepend(e._containerDiv)),e._containerDiv},_getDefaultSheetName:function(e){var t,n,r,o,i,a,l=this,s=l.getSheetCount();l._availableSheetIndex<s?l._availableSheetIndex=s:l._availableSheetIndex++,(M(e)||e<l._availableSheetIndex)&&(e=l._availableSheetIndex),t=!1,r=l.sheets;do{for(n="Sheet"+(e+1),o=r.length,i=0;i<o;i++)if(i in r){if(a=r[i],a._name.toUpperCase()===n.toUpperCase()){e++,t=!0;break}t&&(t=!1)}}while(t);return n},_createSheet:function(e){return new a.Worksheet(e)},_setHost:function(e){var t,n,r,o,i,a,l,s,c,_,f,h,g,p,m,v,C,w,y=this;if(e){for(y._host=e,N&&N(e).data(ae,y),u(e).data(ae,y).attr(le,"gcSpread").addClass(se),O._gcGlobal._createDummyObjects(),y.cultureChangedHandler=function(){y._onCultureChanged(y)},H.addEventListener(ie,y.cultureChangedHandler),t=E(J),n=t.style,s="100%",t.cellSpacing=0,t.cellPadding=0,t.border=0,n.width=s,n.height=s,n.border=0,n.margin=0,r=0;r<2;r++){for(i=E("tr"),o=0;o<2;o++)a=E("td"),l=a.style,l.padding=0,l.border=0,i.appendChild(a);t.appendChild(i)}for(e.appendChild(t),y._vp=E(Z),y._vp.id=e.id+"vp",u(t.rows[0].cells[0]).append(y._vp),y._scrollbarV=new d(!1),c=y._scrollbarV._getScrollbar(),_=y._scrollbarVContainer=E(Z),u(_).append(c),u(t.rows[0].cells[1]).append(_),u(c).bind(U+K,function(e,t){var n=t.scrollEventType;e.data=y,1===t.scrollOrientation&&(0===n||1===n||2===n||3===n||5===n?Ce._vscrollDelegate(e,t):4===n&&Ce._vScrollStop(e))}).bind(W+K,function(e){e.data=y,Ce._vScrollMouseDown(e)}).bind(z+K,function(e){e.data=y,Ce._scrollMouseUp(e)}),f=E(J),h=f.style,f.cellSpacing=0,f.cellPadding=0,f.border=0,h.border=0,h.margin=0,u(f).css("user-select",ee),i=E("tr"),o=0;o<2;o++)a=E("td"),l=a.style,l.padding=0,l.border=0,i.appendChild(a);f.appendChild(i),u(t.rows[1].cells[0]).append(f),g=y._tabs=E(Z),p=g.style,p.width=""+y._getActualTabStripRatio()*u(e).width()+q,p.height=""+y._getTabStripHeight()+q,p.fontSize="10pt",p.fontFamily="Arial",u(f.rows[0].cells[0]).append(g),y._scrollbarH=new d(!0),m=y._scrollbarH._getScrollbar(),v=y._scrollbarHContainer=E(Z),u(v).append(m),u(f.rows[0].cells[1]).append(v),u(m).bind(U+K,function(e,t){var n=t.scrollEventType;e.data=y,0===t.scrollOrientation&&(0===n||1===n||2===n||3===n||5===n?Ce._hscrollDelegate(e,t):4===n&&Ce._hScrollStop(e))}).bind(W+K,function(e){e.data=y,Ce._hScrollMouseDown(e)}).bind(z+K,function(e){e.data=y,Ce._scrollMouseUp(e)}),y._scrollService=new Ce(this),C=y._windowResizeHandler=function(){y._doWindowResize()},u(O).bind(Y+X,C),w=ce(y),w&&w._setHost(y._vp),y._refreshScrollbarAndTabStrip(),y._doResize(),y._createFocusElementForTab(e),ve._callFeatureHandler(y,"setHost",e)}},_createFocusElementForTab:function(e){var t=this,n="tabindex",r=V(u(e).attr(n),10)||0,o=E(Z);u(o).css({position:te,overflow:"hidden"}).attr(le,"gcSheetFocusElementForTab").attr(n,r).bind(G,function(){t._ignoreFocusEvent||ce(t)._setFocus(),t._ignoreFocusEvent=!1}),e.insertBefore(o,P),t._tabFocusElement=o},_focusTabFocusElement:function(){var e=this,t=e._tabFocusElement;t&&(e._ignoreFocusEvent=!0,t.focus())},_dispose:function(){var e,t,n,r,o,i,a=this,l=a._scrollbarH,s=a._scrollbarV,c=a.sheets;for(b._disposeSpread(a),S._dispose(),a._windowResizeHandler&&u(O).unbind(Y+X,a._windowResizeHandler),a._windowResizeTimer&&clearTimeout(a._windowResizeTimer),l&&l.dispose(),s&&s.dispose(),a._disposeUserEvents(),e=0;e<c.length;e++)c[e]._dispose(!0);c.splice(0,c.length),t=a._clipboardHelper,t&&t._dispose(),n=a._host,o="class",i="unselectable",n&&(r=u(n),H.removeEventListener(ie,a.cultureChangedHandler),r.html("").removeAttr(le).removeClass(se),r.attr(o)||r.removeAttr(o),r.attr(i)||r.removeAttr(i),r.data(ae)&&r.data(ae,P),N&&N(n).data(ae)&&N(n).data(ae,P)),a._scrollbarHContainer=P,a._scrollbarVContainer=P,a._undoManager=P,a._tab&&(a._tab._dispose(),a._tab=P),ve._callFeatureHandler(a,"dispose"),a._tabFocusElement&&(u(a._tabFocusElement).unbind(G),a._tabFocusElement=P),a._calcService&&(a._calcService.dispose(),a._calcService=P,a._spreadSource=P,a._spreadSourceModel=P),a._imageLoader&&(a._imageLoader._dispose(),a._imageLoader=P),p._dispose()},_disposeUserEvents:function(){var e=this,t=e.sheets,n,r;for(u(e._userEventsElem).unbind(X),n=0;n<t.length;n++)r=t[n],r._disposeUserEvents()},_refreshScrollbarAndTabStrip:function(){var e,t,n,r=this,o=V(I._getCssClassThemeStyle("").zIndex),i=o!==r._themeVersion,a=r._host,l=a.getAttribute("id")+"_tabStrip",s=r._tab;i&&(r._themeVersion=o),e=r._getTabStripHeight(),t=r._getScrollbarSize(),n=r._getVScrollbarContainerWidth(),s&&!i?s.repaint():(s&&s._dispose(),s=r._tab=o>2007?new h(l):new g(l),s._setOwner(r),s._setHost(r._tabs)),ge(r._scrollbarVContainer,n,t),pe(r._scrollbarHContainer,e,t),me(r._footerCornerContainer,n,e)},_doWindowResize:function(){var e=this,t=e._windowResizeTimer;t&&clearTimeout(t),e._windowResizeTimer=setTimeout(function(){b._updateDPI(),e._doResize(),e._windowResizeTimer=P},100)},_doResize:function(){var e=this;e._isResizing||(e._isResizing=!0,e._doResizeImp(),e._isResizing=!1)},_doResizeImp:function(){var e,t,n,r,o,i,a,l,s,c,_,f,d,h,g,p,m,v,C=this,w="display",y="block",S=C._getTabStripHeight(),x=C._getScrollbarSize(),b=C._getVScrollbarContainerWidth(),T=C._host;T&&(e=C.options,t=e.showVerticalScrollbar,n=e.showHorizontalScrollbar,r=e.tabStripVisible,o=n||r,i=u(T),a=i.width(),l=i.height(),s=C._footerCornerContainer,c=C._scrollbarH,_=C._scrollbarV,f=C._vp.style,d=C._tabs.style,f.width=""+(a-0)+q,u(C._scrollbarVContainer).css(w,t?y:ee),u(s).css("width",0+q),f.height=""+(l-0)+q,u(C._scrollbarHContainer).css(w,o?y:ee),u(s).css("height",o?0:0+q),n?(u(c._getScrollbar()).show(),e.tabStripRatio=e.tabStripRatio):u(c._getScrollbar()).hide(),h=u(C._vp).width(),g=L(C._getActualTabStripRatio()*h),g===h&&(g=h-1),d.width=""+g+q,d.height=""+S+q,_._width(x),_._height(u(C._vp).height()),p=a-(r?g:0)-(t?b:0),c._width(p>0?p:1),c._height(x),m=ce(C),m&&(0===m._scrollTopRow&&(m._scrollTopRow=m._getFirstPageTopRow()),0===m._scrollLeftCol&&(m._scrollLeftCol=m._getFirstPageLeftColumn()),m._doResize()),C._resizeHScrollBar(),C._resizeVScrollBar(),m&&(m.invalidateLayout(),m.repaint()),r?u(C._tabs).show():u(C._tabs).hide(),C._tab&&C._tab._doResize(),v=i.width(),a===v||C._haveLayoutFixing||(C._haveLayoutFixing=!0,setTimeout(function(){delete C._haveLayoutFixing,C._doResizeImp()},1)))},_resizeHScrollBar:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d=this,h=ce(d),g=d.options;h&&(e=h.frozenColumnCount(),t=h.getColumnCount()-h.frozenTrailingColumnCount()-e,n=e,r=h._getSheetLayout(),o=0===t?n:n+t-1,i=h._scrollLeftCol,l=h._getLeftColWhenLastColShowComplete(r._viewportWidth,n,o),g.scrollbarMaxAlign&&(o=l),g.scrollbarShowMax||(s=h._getLastNonNullRowAndCol(),u=s.lastNonNullCol,c=h._getLeftColWhenLastColShowComplete(r._viewportWidth,n,u),c===n&&++c>o&&(c=o),o=i>c?i<o?i:o:c),i>o&&(h._scrollLeftCol=o),_=h._getScrollableColumn(h._scrollLeftCol),-1!==_&&_!==h._scrollLeftCol&&(h._scrollLeftCol=_),a=h._getPageValueH(),a<1&&(a=1),(f=d._scrollbarH)&&(f._minimum(h._getVisibleColIndex(n)),f._maximum(h._getVisibleColIndex(o)),f._pageValue(a),f._refreshLayout(),f.value(h._getVisibleColIndex(h._scrollLeftCol))))},_resizeVScrollBar:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d=this,h=ce(d),g=d.options;h&&(e=h.frozenRowCount(),t=h.getRowCount()-h.frozenTrailingRowCount()-e,n=e,r=h._getSheetLayout(),o=0===t?n:n+t-1,i=h._scrollTopRow,l=h._getTopRowWhenLastRowShowComplete(r._viewportHeight,n,o),g.scrollbarMaxAlign&&(o=l),g.scrollbarShowMax||(s=h._getLastNonNullRowAndCol(),u=s.lastNonNullRow,c=h._getTopRowWhenLastRowShowComplete(r._viewportHeight,n,u),c===n&&++c>o&&(c=o),o=i>c?i<o?i:o:c),i>o&&(h._scrollTopRow=o),_=h._getScrollableRow(h._scrollTopRow),-1!==_&&_!==h._scrollTopRow&&(h._scrollTopRow=_),a=h._getPageValueV(),a<1&&(a=1),(f=d._scrollbarV)&&(f._minimum(h._getVisibleRowIndex(n)),f._maximum(h._getVisibleRowIndex(o)),f._pageValue(a),f._refreshLayout(),f.value(h._getVisibleRowIndex(h._scrollTopRow))))},_doTabHSResize:function(){var e,t,n,r,o,i,a,l,s,c,_=this,f=_._getTabStripHeight(),d=_._getScrollbarSize(),h=_._getVScrollbarContainerWidth(),g=_._host;g&&(e=_.options,t=e.tabStripVisible,n=u(g),r=n.width(),o=_._scrollbarH,i=_._tabs.style,a=u(_._vp).width(),l=L(_._getActualTabStripRatio()*a),l===a&&(l=a-1),i.width=""+l+q,i.height=""+f+q,s=r-(t?l:0)-(e.showVerticalScrollbar?h:0),o._width(s>0?s:1),o._height(d),c=ce(_),c&&0===c._scrollLeftCol&&(c._scrollLeftCol=c._getFirstPageLeftColumn()),_._resizeHScrollBar(),t?u(_._tabs).show():u(_._tabs).hide(),_._tab&&_._tab._doResize())},suspendPaint:function(){var e,t=this,n=t._tab,r=t.sheets;for(t._paintSuspended++,e=0;e<r.length;e++)r[e].suspendPaint();n&&n._suspendPaint()},resumePaint:function(){var e,t=this,n=t._tab,r=t.sheets;for(t._paintSuspended-=t._paintSuspended>0?1:0,e=0;e<r.length;e++)r[e].resumePaint();n&&n._resumePaint()},isPaintSuspended:function(){return this._paintSuspended>0},_paintWorkbookBackgroundImage:function(){var e,t,n,r,o,i,a=this,l=a.options.backgroundImage,s=a.options.backgroundImageLayout,c=ce(a);if(c&&l&&(e=u(c._getCanvas()),e.css({"background-image":"url('"+l+"')","background-repeat":"no-repeat"}),!M(s))){t=a._imageLoader,t||(t=a._imageLoader=new _(function(){a._imageLoader&&a._paintWorkbookBackgroundImage()}));try{t._getState(l)?(n=t._getImage(l),r=c._getBounds(),o=r.width,i=r.height,S._applyBackgroundImageLayout(c._getCanvas(),o,i,n.width,n.height,s)):t._addImage(l)}catch(e){}}},_changeSheetForFormulaAcrossSheet:function(e,t){void 0===t&&(t=!0);var n=this;n._tab._doSheetTabClickChange(n.getSheetIndex(e.name()),t)},startSheetIndex:function(e){var t=this,n=t._tab;return 0===arguments.length?n?n._firstTab:0:(n&&(n._tabVisible(e)||-1===(e=n._getNextVisibleIndex(e))&&(e=n._getPreVisibleIndex(e)),n._firstTab=e),t._doTabHSResize(),t)},_getActualTabStripRatio:function(){var e,t,n,r,o,i=this,a=i.options;return a.showHorizontalScrollbar?(e=a.tabStripRatio,isNaN(e)?.5:(t=0,n=i._vp,r=i._tab,n&&r&&(o=u(n).width(),t=r._resizeBarWidth/o),e<t?e=t:e>1&&(e=1),e)):1},destroy:function(){this._windowResizeHandler&&u(O).unbind(Y+X,this._windowResizeHandler),this._dispose()},repaint:function(){var e,t=this,n=t._tab;n&&n.repaint(),(e=ce(t))&&e.repaint()},refresh:function(){var e=this;e._host&&(I._clearCache(),e._refreshScrollbarAndTabStrip(),e._doResize(),e.repaint())},getHost:function(){return this._host},invalidateLayout:function(){var e=ce(this);e&&e.invalidateLayout()},addNamedStyle:function(e){this._addNamedStyleImp(e);var t=ce(this);t&&t._invalidate()},
_addNamedStyleImp:function(e){if(e){if(!e.name)throw Error(ue.Exp_EmptyNamedStyle);var t=e.name.toUpperCase();this._namedStyles[t]=e}},getNamedStyle:function(e){return this._getNamedStyleImp(e,!0)},_getNamedStyleImp:function(e,t){var n,r=this._namedStyles;return r&&e?(e=e.toUpperCase(),n=r[e],n&&t&&this._clearStyleCache(),n):P},_clearStyleCache:function(){var e,t=this.sheets;for(e=0;e<t.length;e++)t[e]._clearStyleCache()},removeNamedStyle:function(e){var t,n=this._namedStyles;n&&e&&(e=e.toUpperCase(),n.hasOwnProperty(e)&&(delete n[e],this._clearStyleCache(),(t=ce(this))&&t._invalidate()))},getNamedStyles:function(){var e=[],t=this._namedStyles;return t&&w(t,function(t,n){e.push(n)}),this._clearStyleCache(),e},getActiveSheet:function(){return this.sheets&&this.sheets.length>0?this.sheets[this._activeSheetIndex]:P},setActiveSheet:function(e){this._setActiveSheetInternal(e,2)},_setActiveSheetInternal:function(e,t){var n,r=this.sheets;for(n=0;n<r.length;n++)r[n].name()===e&&this._setActiveSheetIndexImp(n,t)},getActiveSheetIndex:function(){return this._activeSheetIndex},setActiveSheetIndex:function(e){this._setActiveSheetIndexImp(e,2)},_setActiveSheetIndexImp:function(e,t,n,r){var o,i,a,l,s,u,c,_;typeof e===B&&(o=this,e!==o._activeSheetIndex&&(i=o.sheets[e])&&i.visible()&&(a=S._device(),(a.ipad||a.iphone)&&(l=o._lastSetActiveSheetTime)&&(new Date).valueOf()-l<300||(s=ce(o),u={oldSheet:s,newSheet:i,needTriggerSheetChange:!0},de(o,u),c={oldSheet:s,newSheet:i,cancel:!1},_=u.needTriggerSheetChange&&r,_&&fe(o,c),!1===c.cancel&&(o._activeSheetIndex=e,i!==s&&(s&&s._dispose(!1),o._setActiveSheetImp(i,t,!1,n)),o._doResize(),he(o,s,i),_&&_e(o,s,i)),(a.ipad||a.iphone)&&(o._lastSetActiveSheetTime=(new Date).valueOf()))))},_setActiveSheetImp:function(e,t,n,r){var o,i,a;n||e._setHost(this._vp),o=R._getActiveElement(),i=o&&o.parent===this,a=2===t?i:1===t,R._setActiveElement(P),!this._suspendSetFocus&&a&&e._setFocus(r),e._syncHScrollbarPosition(),e._syncVScrollbarPosition()},addSheet:function(e,t){this._addSheetImp(e,2,t)},_addSheetImp:function(e,t,n){var r,o,i,a,l,s,u,c,_=this;if(n||(n=_._createSheet(_._getDefaultSheetName(e))),o=_.sheets,i=o.length,n._name){for(r=0;r<i;r++)if(o[r]._name===n._name)throw ue().Exp_NotSupported}else n._name=_._getDefaultSheetName(e);for(_._copyUserEvents(n),a=ce(_),l=_._activeSheetIndex,s=i-e,u=[],r=0;r<s&&i>0;r++)u.push(o.pop());for(o.push(n),n._onAttached(_);u.length>0;)o.push(u.pop());i=o.length,1===i?(_._vp&&n._setHost(_._vp),_._activeSheetIndex=0):(l<0&&_._tab&&(l=_._tab._getNextVisibleIndex(l)),_._activeSheetIndex=l),c=ce(_),c!==a&&(a&&a._dispose(!1),c&&_._setActiveSheetImp(c,t,1===i),_._doResize()),_._tab&&(_._tab._firstTab<0&&(_._tab._firstTab=_._activeSheetIndex),_._tab.repaint())},removeSheet:function(e){this._removeSheetImp(e,2)},_removeSheetImp:function(e,t){var n,r,o,i,a,l=this,s=l.sheets,u=l._calcService,c=l._tab,_=s.length;if(isNaN(e)||e<0||e>=_)throw Error(ue().Exp_IndexOutOfRange);if(n=e<=l._activeSheetIndex||e===_-1,r=ce(l),e<l._activeSheetIndex&&l._activeSheetIndex--,o=s[e],o._disposeUserEvents(),s.splice(e,1),0===(_=s.length))l._activeSheetIndex=-1;else if(l._activeSheetIndex>=_)l._activeSheetIndex=c._getPreVisibleIndex(_);else{for(i=l._activeSheetIndex;i<_;i++)if(s[i].visible()){l._activeSheetIndex=i;break}i>=_&&(l._activeSheetIndex=-1)}n&&(a=s[l._activeSheetIndex],r!==a&&(r&&r._dispose(!1),a&&l._setActiveSheetImp(a,t,!1))),u&&u.removeSource(o._getSheetSource()),c&&(c._firstTab>=_?l.startSheetIndex(c._getPreVisibleIndex(_)):c._firstTab<0?l.startSheetIndex(c._getNextVisibleIndex(-1)):l._doResize())},clearSheets:function(){var e,t=this,n=t.sheets,r=t._calcService,o=t._tab;for(e=0;e<n.length;e++)n[e]._disposeUserEvents(),n[e]._dispose(!0);n.splice(0,n.length),r&&r.clearSource(),t._activeSheetIndex=-1,o&&(o._firstTab=-1,o.repaint())},getSheet:function(e){var t=this.sheets;return e>=0&&e<t.length?t[e]:P},getSheetFromName:function(e){var t,n=this.sheets;for(t=0;t<n.length;t++)if(n[t].name()===e)return n[t];return P},getSheetIndex:function(e){var t,n=this.sheets;for(t=0;t<n.length;t++)if(n[t].name()===e)return t;return P},getSheetCount:function(){return this.sheets.length},setSheetCount:function(e){this._setSheetCountImp(e,2)},_setSheetCountImp:function(e,t){var n,r,o=this;if(e<0)throw ue().Exp_ArgumentOutOfRange;if(0===e&&o.clearSheets(),n=o.sheets.length,e<n)for(r=n-1;r>=e;r--)o._removeSheetImp(r,t);else if(e>n)for(r=n;r<e;r++)o._addSheetImp(r,t)},bind:function(e,t,n){var r,o,i=this,a=i.sheets;for(i._userEvents.push({type:e,data:t,fn:n}),u(i._userEventsElem).bind(e+X,t,n),r=0;r<a.length;r++)o=a[r],o.bind(e,t,n)},unbind:function(e,t){var n,r,o,i,a=this,l=a.sheets,s=a._userEvents;for(n=0;n<s.length;n++)r=s[n],r.type===e&&s.splice(n,1);for(u(a._userEventsElem).unbind(e+X,t),o=0;o<l.length;o++)i=l[o],i.unbind(e,t)},unbindAll:function(){var e,t,n=this,r=n.sheets;for(n._userEvents.length=0,u(n._userEventsElem).unbind(X),e=0;e<r.length;e++)t=r[e],t.unbindAll()},_bind:function(e,t,n){var r,o,i=this,a=i.sheets;for(i._userEvents.push({type:e,data:t,fn:n}),u(i._userEventsElem).bind(e+j,t,n),r=0;r<a.length;r++)o=a[r],o._bind(e,t,n)},_unbind:function(e,t){var n,r,o,i,a=this,l=a.sheets,s=a._userEvents;for(n=0;n<s.length;n++)r=s[n],r.type===e&&s.splice(n,1);for(u(a._userEventsElem).unbind(e+j,t),o=0;o<l.length;o++)i=l[o],i._unbind(e,t)},_unbindAll:function(){var e,t,n=this,r=n.sheets;for(n._userEvents.length=0,u(n._userEventsElem).unbind(j),e=0;e<r.length;e++)t=r[e],t._unbindAll()},_trigger:function(e,t){0===this._eventSuspended&&u(this._userEventsElem).trigger(e,t)},_triggerButtonClicked:function(e,t,n,r){this._trigger(T.ButtonClicked,{sheet:e,sheetName:e._name,row:t,col:n,sheetArea:r})},_copyUserEvents:function(e){var t,n,r=this._userEvents;for(t=0;t<r.length;t++)n=r[t],e.bind(n.type,n.data,n.fn)},suspendEvent:function(){var e,t,n=this,r=n.sheets;for(n._eventSuspended++,e=0;e<r.length;e++)t=r[e],t.suspendEvent()},resumeEvent:function(){var e,t,n=this,r=n.sheets;for(n._eventSuspended--,n._eventSuspended<0&&(n._eventSuspended=0),e=0;e<r.length;e++)t=r[e],t.resumeEvent()},focus:function(e){if(!1===e)R._setActiveElement(P);else{var t=ce(this);t&&t._setFocus()}},nextControl:F("nextControl",P),previousControl:F("previousControl",P),_getScrollbarSize:function(){return this._themeVersion>2007?15:18},_getVScrollbarContainerWidth:function(){return this._themeVersion>2007?22:this._getScrollbarSize()},_getTabStripHeight:function(){return this._themeVersion>2007?28:this._getScrollbarSize()},_showTooltip:function(e,t,n,r){var o,i="auto",a=this;a._tooltip||(o=E(Z),u(o).addClass("gc-spread-toolTip ui-state-default ui-widget-content btn-default").css({position:te,padding:"0px 3px 0px 3px",font:"normal normal normal 11pt calibri","box-shadow":"1px 2px 5px rgba(0,0,0,0.4)"}).width(i).height(i).appendTo(H.body),a._tooltip=o),a._refreshTooltip(e,t,n,r)},_refreshTooltip:function(e,t,n,r){var o,i,a,l,s=this,c=ce(s);c&&(o=s._tooltip)&&(i=u(o),e?(i.html(e),i.show()):i.hide(),a=c._getCanvasOffset(),r&&(n-=a.top,t-=a.left),l=c._getBounds(),n=k(n,l.y+l.height-i.outerHeight()),t=k(t,l.x+l.width-i.outerWidth()),M(n)||i.css("top",n+a.top),M(t)||i.css("left",t+a.left))},_removeTooltip:function(){var e=this,t=e._tooltip;t&&(u(t).remove(),e._tooltip=P)},_onCultureChanged:function(e){var t,n,r,o,i,a,l,s,u,_=e.sheets;for(c._CacheMgr._clearFormatCache(),e.invalidateLayout(),t=0,n=_.length;t<n;t++)for(r=_[t],o=r.getRowCount(),i=r.getColumnCount(),a=0;a<o;a++)for(l=0;l<i;l++)(s=r.getValue(a,l))instanceof Date&&(u=r.getStyle(a,l))&&u._setActualAutoFormatter(s);e.repaint(),ve._callFeatureHandler(e,"onCultureChanged")},getTab:function(){return this._tab}},a.Workbook=ve,r=100,o=30,i=40;function Ce(e){this._wb=e}y(Ce,{_hscrollDelegate:function(e,t){var n,r,o,i,a,l,s,u,c,_=e.data,f=ce(_);f&&t&&(n=t.newValue,r=t.oldValue,o=t.scrollEventType,i=V(n,10),i=f._getOriginalColIndex(i),r=t.oldValue=M(r)?0:V(r,10),f._needSyncHScrollbarSize=!1,l=_.options.scrollbarShowMax,2===o||0===o?(2===o&&(i=f._getPrevPageLeftColumn()),a=f._getScrollableColumn(i,!0),-1!==a&&a!==i&&(i=a),l||(f._needSyncHScrollbarSize=!0,t.ignoreUpdatePosition=!0)):3!==o&&1!==o||(3===o&&(i=f._getPageRightColumn())===f._scrollLeftCol&&i++,l||(f._needSyncHScrollbarSize=!0,1===o&&n===r&&i++),-1!==(a=f._getScrollableColumn(i))&&a!==i&&(i=a)),s=f._getFirstPageLeftColumn(),u=f._getLastVisualScrollColumn(),i<s&&(i=s),i>u&&(i=u),c=f._getVisibleColIndex(i),n!==c&&(t.newValue=c),r!==c&&_._scrollService._doScroll(i,!0))},_hScrollStop:function(e){var t,n,r,o,i,a=e.data,l=ce(a);l&&(t=a._scrollbarH,n=l._getOriginalColIndex(t.value()),r=l._getFirstPageLeftColumn(),o=l._getLastVisualScrollColumn(),i=l._formulaTextBox,n<r?t.value(l._getVisibleColIndex(r)):n>o&&t.value(l._getVisibleColIndex(o)),a._removeTooltip(),a.options.scrollbarShowMax||(a._scrollService.scrolling?l._needSyncHScrollbarSize=!0:a._resizeHScrollBar()),i&&i.focus())},_hScrollMouseDown:function(e){var t,n,r,o,i,a=e.data;a&&(t=ce(a))&&(n=a._scrollbarH._simulateMouseEvents,n&&n._touchHandled&&(t._isTouchMode=!0),t._setFocus(),1!==(r=a.options.showScrollTip)&&3!==r||(o=u(e.srcElement||e.target),i=o.parent(),(o&&(o.hasClass(Q)||o.hasClass($))||i&&(i.hasClass(Q)||i.hasClass($)))&&a._scrollService._showScrollTooltip(!1,e)))},_vscrollDelegate:function(e,t){var n,r,o,i,a,l,s,u,c,_=e.data,f=ce(_);f&&t&&(n=t.newValue,r=t.oldValue,o=t.scrollEventType,i=V(n,10),i=f._getOriginalRowIndex(i),r=t.oldValue=M(r)?0:V(r,10),f._needSyncVScrollbarSize=!1,l=_.options.scrollbarShowMax,2===o||0===o?(2===o&&(i=f._getPrevPageTopRow()),a=f._getScrollableRow(i,!0),-1!==a&&a!==i&&(i=a),l||(f._needSyncVScrollbarSize=!0,t.ignoreUpdatePosition=!0)):3!==o&&1!==o||(3===o&&(i=f._getPageBottomRow())===f._scrollTopRow&&i++,l||(f._needSyncVScrollbarSize=!0,1===o&&n===r&&i++),-1!==(a=f._getScrollableRow(i))&&a!==i&&(i=a)),s=f._getFirstPageTopRow(),u=f._getLastVisualScrollRow(),i<s&&(i=s),i>u&&(i=u),c=f._getVisibleRowIndex(i),n!==c&&(t.newValue=c),r!==c&&_._scrollService._doScroll(i))},_vScrollStop:function(e){var t,n,r,o,i,a=e.data,l=ce(a);l&&(t=a._scrollbarV,n=l._getOriginalRowIndex(t.value()),r=l._getFirstPageTopRow(),o=l._getLastVisualScrollRow(),i=l._formulaTextBox,n<r?t.value(l._getVisibleRowIndex(r)):n>o&&t.value(l._getVisibleRowIndex(o)),a._removeTooltip(),a.options.scrollbarShowMax||(a._scrollService.scrolling?l._needSyncVScrollbarSize=!0:a._resizeVScrollBar()),i&&i.focus())},_vScrollMouseDown:function(e){var t,n,r,o,i,a=e.data;a&&(t=ce(a))&&(n=a._scrollbarV._simulateMouseEvents,n&&n._touchHandled&&(t._isTouchMode=!0),t._setFocus(),2!==(r=a.options.showScrollTip)&&3!==r||(o=u(e.srcElement||e.target))&&(i=o.parent(),(o.hasClass(Q)||i&&i.hasClass(Q)||o.hasClass($)||i&&i.hasClass($))&&a._scrollService._showScrollTooltip(!0,e)))},_scrollMouseUp:function(e){var t=e.data;t&&t._removeTooltip()}}),Ce.prototype={_doScroll:function(e,t){var n=this,r=ce(n._wb);r&&(n._scrolling=!0,n._newTop=t?r._scrollTopRow:e,n._newLeft=t?e:r._scrollLeftCol,window.setTimeout(function(){n._scrollView()},0))},_scrollView:function(){var e=this;ce(e._wb)&&e._scrolling&&(e._scrolling=!1,e._updateView())},_updateView:function(){var e,t,n,r,o,i=this;i._painting||(i._painting=!0,e=i._wb,t=ce(e),t&&(n=e.options.showScrollTip,r=i._newTop,o=i._newLeft,r!==t._scrollTopRow?(i._vScrollTo(r),2!==n&&3!==n||e._refreshTooltip(i._getScrollTooltipContent(!0))):o!==t._scrollLeftCol&&(i._hScrollTo(o),1!==n&&3!==n||e._refreshTooltip(i._getScrollTooltipContent(!1)))),i._painting=!1)},_vScrollTo:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S=ce(this._wb);if(S){if(t=S._scrollTopRow,e===t)return;if(S._scrollTopRow=e,S._layoutSuspended>0)return void S._trigger(T.TopRowChanged,{sheet:S,sheetName:S._name,oldTopRow:t,newTopRow:e});if(n=!1,r=2,o=S._bounds,i=S._getSheetLayout(),a=i._viewportY,l=i._viewportHeight,f=S._render,d=f._getCtx(),e>t){if(p=S._getRowLayout(1),p&&p.length>0&&(h=p.findRow(e)),h){for(m=p.length-1,g=p[m];g.y+g.height>a+l;)m-=1,g=p[m];g.row>e&&(n=!0,s=o?o.x:i.x,u=h.y,c=i.width,_=g.y+g.height-h.y-r,f._copyScreen(s,u,c,_,s,a),S.invalidateLayout(),f._paintBody(d,new A(s,a+_,c,l-_)),f._paintAdornment(d,new A(s,a-2,c,l+2)))}}else{for(v=0,C=e;C<t&&v<l;C++)v+=S._getZoomRowHeight(C);v<l&&(n=!0,s=o?o.x:i.x,u=a,c=i.width,_=l-v,S.frozenTrailingRowCount()>0&&(_-=1),f._copyScreen(s,u,c,_,s,u+v),S.invalidateLayout(),w=S.rowOutlines&&!S.rowOutlines._isEmpty()?1:0,f._paintBody(d,new A(s,u,c,v+r+w)),f._paintAdornment(d,new A(s,a-2,c,l+2)))}n||(S.invalidateLayout(),S.repaint()),S._trigger(T.TopRowChanged,{sheet:S,sheetName:S._name,oldTopRow:t,newTopRow:e}),y=S._eventHandler,y&&y._updateEditingEditor()}},_hScrollTo:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S=ce(this._wb);if(S){if(t=S._scrollLeftCol,e===t)return;if(S._scrollLeftCol=e,S._layoutSuspended>0)return void S._trigger(T.LeftColumnChanged,{sheet:S,sheetName:S._name,oldLeftCol:t,newLeftCol:e});if(n=!1,r=2,o=S._bounds,i=S._getSheetLayout(),a=i._viewportX,l=i._viewportWidth,f=S._render,d=f._getCtx(),e>t){if(p=S._getColumnLayout(1),p&&p.length>0&&(h=p.findCol(e)),h){for(m=p.length-1,g=p[m];g.x+g.width>a+l;)m-=1,g=p[m];g.col>e&&(n=!0,s=h.x,u=o?o.y:i.y,c=g.x+g.width-h.x-r,_=i.height,f._copyScreen(s,u,c,_,a,u),S.invalidateLayout(),f._paintBody(d,new A(a+c,u,l-c,_)),f._paintAdornment(d,new A(a-2,u,l+2,_)))}}else{for(v=0,C=e;C<t&&v<l;C++)v+=S._getZoomColumnWidth(C);v<l&&(n=!0,s=a,u=o?o.y:i.y,c=l-v,_=i.height,S.frozenTrailingColumnCount()>0&&(c-=1),f._copyScreen(s,u,c,_,s+v,u),S.invalidateLayout(),w=S.columnOutlines&&!S.columnOutlines._isEmpty()?1:0,f._paintBody(d,new A(s,u,v+r+w,_)),f._paintAdornment(d,new A(a-2,u,l+2,_)))}n||(S.invalidateLayout(),S.repaint()),S._trigger(T.LeftColumnChanged,{sheet:S,sheetName:S._name,oldLeftCol:t,newLeftCol:e}),y=S._eventHandler,y&&y._updateEditingEditor()}},_doMouseWheel:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h=this,g=h._wb,p=ce(g),m=!1,v=!1,C=g.options.scrollbarShowMax;if(p){if(e.ctrlKey){if(!g.options.allowUserZoom)return!0;if(r=p._zoomFactor,o=r-.05*t,p.isEditing()&&!p.endEdit())return;p._commandManager().execute({cmd:"zoom",sheetName:p.name(),zoomFactor:o}),o=p._zoomFactor,r!==o&&p._trigger(T.UserZooming,{sheet:p,sheetName:p._name,oldZoomFactor:r,newZoomFactor:o})}else n=n||0,i=p._scrollTopRow,a=h._getNewTopRow(p,t),i!==a?(h._vScrollTo(a),p._syncVScrollbarPosition(),C||p._syncVScrollbarSize()):m=!0,l=p._scrollLeftCol,s=h._getNewLeftCol(p,n),l!==s?(h._hScrollTo(s),p._syncHScrollbarPosition(),C||p._syncHScrollbarSize()):v=!0;u=p._getCanvasOffset(),c=p.hitTest(e.pageX-u.left,e.pageY-u.top),_=p._currentTarget,f=_&&_.cellTypeHitInfo,f&&(f.cellRect=p.getCellRect(_.row,_.col)),d=p._eventHandler,d._updateCanvasCursor(c),d._setHoverCell(c)}return m&&v},_getNewTopRow:function(e,t){var n,r,o,i=e._scrollTopRow,a=e.frozenRowCount();return a>0&&(0===i&&t>0?i=a:t<0&&i===a-t&&(i=0)),n=e._getScrollableRow(i+t,t<0),-1!==n?i=n:i+=t,r=e._getFirstPageTopRow(),o=e._getLastVisualScrollRow(),e.getRowCount()-a-e.frozenTrailingRowCount()<=0||r===P?i=e._scrollTopRow:(i<r?i=r:i>o&&(i=o),i===P&&(i=-1)),i},_getNewLeftCol:function(e,t){var n,r,o,i=e._scrollLeftCol,a=e.frozenColumnCount();return a>0&&(0===i&&t>0?i=a:t<0&&i===a-t&&(i=0)),n=e._getScrollableColumn(i+t,t<0),-1!==n?i=n:i+=t,r=e._getFirstPageLeftColumn(),o=e._getLastVisualScrollColumn(),e.getColumnCount()-a-e.frozenTrailingColumnCount()<=0||r===P?i=e._scrollLeftCol:(i<r?i=r:i>o&&(i=o),i===P&&(i=-1)),i},_showScrollTooltip:function(e,t){var n,a,l=this,s=l._wb;ce(s)&&(e?(n=t.pageY,a=t.pageX-r):(n=t.pageY-i,a=t.pageX-o),s._showTooltip(l._getScrollTooltipContent(e),a,n,!0))},_getScrollTooltipContent:function(e){var t,n=ce(this._wb),r=n._scrollLeftCol+1;return n&&(e?t=ue().Tip_Row+(n._scrollTopRow+1):(1!==n.options.colHeaderAutoText&&(r=n._indexToLetters(r)),t=ue().Tip_Column+r)),t}},e.exports=a}()},function(e,t){e.exports=GC.Spread.Commands},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U,Y,G,X,j,K,Z,J,q,Q,$,ee,te,ne,re,oe,ie,ae,le=n(1),se=n(5),ue=n(6),ce=n(17).Worksheet,_e=n(12).Style,fe=n(3),de=n(4).GC$,he=n(25).staticMembers,ge=se._Types._isNullOrUndefined,pe=se._ArrayHelper._contains,me=se._StringHelper,ve=me._endsWith,Ce=fe.Events,we=Ce.CellChanged,ye=Ce.ColumnWidthChanging,Se=Ce.ColumnWidthChanged,xe=Ce.RowHeightChanging,be=Ce.RowHeightChanged,Te=fe.Range,Re=fe.Rect,Ae=fe._CacheMgr,Ie=fe._util,Me=Ie._browser,Ee=Ie._defProperty,Fe=Ie._isDefined,De=de.extend,Ne=de.inherit,Ve=null,Oe=void 0,He=Math.min,Pe=Math.max,Le=Math.floor,ke=Number.MAX_VALUE,Be=isNaN;le.ClipboardPasteOptions={all:0,values:1,formatting:2,formulas:3},le.CopyToOptions={value:1,formula:2,comment:4,outline:8,sparkline:16,span:32,style:64,tag:128,bindingPath:256,conditionalFormat:512,all:1023};function We(e,t){return e.getRowCount(t)}function ze(e,t){return e.getColumnCount(t)}function Ue(e){return e.rowCount}function Ye(e){return e.colCount}function Ge(e){var t=e.parent;return t&&t.options.allowExtendPasteRange}function Xe(e){var t=e.parent;return t&&t.options.allowCopyPasteExcelStyle}function je(e){var t=e.parent;return t&&t.options.copyPasteHeaderOptions}function Ke(){return se._getResource(le.SR)()}function Ze(e,t,n,r){throw Error(me._format(Ke().Exp_InvalidAndSpace,[e,t,n,r]))}function Je(e){e.suspendPaint()}function qe(e){e.resumePaint()}function Qe(e){e.suspendEvent()}function $e(e){e.resumeEvent()}function et(e,t){e&&le._supportsCalc&&e.suspendCalcService(t)}function tt(e,t){e&&le._supportsCalc&&e.resumeCalcService(t)}function nt(e,t,n,r,o){var i=e.getSpan(t,n,r);if(i&&o&&(i.row!==t||i.col!==n))return!0}function rt(e){var t=this;t._rowHeader=1==(1&e),t._columnHeader=2==(2&e),t._unFormatted=8==(8&e),t._formula=le._supportsCalc&&16==(16&e),t._expandRows=!0,t._expandColumns=!0}function ot(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C;if(ge(e)||""===e)return Ve;for((ge(t)||""===t)&&(t="\r\n"),o="\n",(ge(n)||""===n)&&(n="\t"),(ge(r)||""===r)&&(r='"'),ve(e,t)||(e+=t),i=[],a=[],l="",u=!1,c=r.length,_=t.length,f=o.length,d=n.length,h=e.length,g=0;g<h;g++)l+=e[g],s=l.length,s>=c&&r===l.substr(s-c,c)?u&&h>=g+1+c&&r===e.substr(g+1,c)?g+=c:u?(l=l.substr(0,s-c),u=!1):(p=l,0===p.indexOf(r)&&(l=l.substr(0,s-c),u=!0)):!u&&s>=d&&n===l.substr(s-d,d)?(l=l.substr(0,s-d),a.push(""+l),l=""):!u&&s>=_&&t===l.substr(s-_,_)?(l=l.substr(0,s-_),a.push(""+l),i.push(a),a=[],l=""):!u&&s>=f&&o===l.substr(s-f,f)?(l=l.substr(0,s-f),a.push(""+l),i.push(a),a=[],l=""):u&&h>=g+1+d&&n===e.substr(g+1,d)&&","!==n&&(g+=c);if(u){if(a.length>0){for(m=0;m<i.length&&i[m]!==a;m++);m>=i.length&&i.push(a)}v=""+l,v&&(v=v.replace(RegExp(n,"g"),""),ve(v,t)&&(v=v.substr(0,v.length-_)),0===i.length&&i.push([v]))}return 0===i.length&&(C=e,ve(e,t)&&(C=C.substr(0,C.length-_)),i.push([C])),i}function it(e,t,n,r,o){var i,a,l,s,u,c,_,f=r.length,d=st(r);if(0!==f&&0!==d)for(i=new rt(o),e&&(ze(e,2)<=0&&(i._rowHeader=!1),We(e,1)<=0&&(i._columnHeader=!1)),a=i._rowHeader?ze(e,2):0,l=i._columnHeader?We(e,1):0,s=0,d-=a,d<=0&&(d=0),f-=l,f<=0&&(s=0),f-=s,f<=0&&(f=0),i._expandRows&&t+f>We(e)&&e.setRowCount(t+f),i._expandColumns&&n+d>ze(e)&&e.setColumnCount(n+d),u=0,c=0;u<r.length;u++,c++)_=r[u],_.length<=0||(l>0&&u<l?at(e,_,c,n,d,1,i):f>0&&c<We(e)&&(u===l&&(c=t),at(e,_,c,0,a,2,i),_.splice(0,a),at(e,_,c,n,d,3,i)))}function at(e,t,n,r,o,i,a){for(var l=0,s=r;l<t.length;l++,s++)o>0&&s<ze(e,i)&&lt(e,i,n,s,t[l],a)}function lt(e,t,n,r,o,i){var a,l,s,u,c,_,f,d=o,h=Ve;if(!1===i._unFormatted&&(a={value:Ve},d=Ie._parseText2Value(Ve,o,!i._unFormatted,a),h=a.value),ge(d))e.setValue(n,r,d,t);else if(""!==o)if(i._formula&&"="===o[0]&&o.length>1)try{e.setFormula(n,r,o.substr(1))}catch(i){e.setText(n,r,o,t)}else l=e._getStyleProperty(n,r,"formatter",t),!1===i._unFormatted&&h?l?l&&("string"==typeof l&&ue&&(l=new ue.GeneralFormatter(l)),f=l.parse&&l.parse(o),d=ge(f)?d:f):(h.isAuto=!0,e.getCell(n,r,t)._setStyleProperty("_autoFormatter",h),s=o,u=e.getCellType(n,r,t),c=h.formatString(),u&&"7"===u.typeName&&(_={sheet:e,row:n,col:r,sheetArea:t},s=u.parse(o,c,_),d=ge(s)?o:s)):l&&e.getCell(n,r,t).formatter(Ve),e.setValue(n,r,d,t);else e.setValue(n,r,Ve,t)}function st(e){var t,n,r=0;for(t=0;t<(e&&e.length);t++)n=e[t],r=Pe(n.length,r);return r}function ut(e,t,n,r,o,i,a,l){if(!e)throw Error(Ke().Exp_SheetIsNull);if((t<-1||t>=We(e))&&Ze("row",t,"-1",We(e)-1),(n<-1||n>=ze(e))&&Ze("column",n,"-1",ze(e)-1),!ge(r)&&""!==r){-1===t&&(t=0),-1===n&&(n=0);var s=ot(r,o,i,a);s&&s.length>0&&it(e,t,n,s,l)}}function ct(e,t,n,r,o,i,a,l,s,u,c,_,f){var d,h,g,p,m,v,C,w,y,S,x,b;if(!e)throw Error(Ke().Exp_SheetIsNull);return d=We(e),h=ze(e),(t<-1||t>=d)&&Ze("row",t,"-1",d-1),(n<-1||t+n>d)&&Ze("rowCount",n,"-1",d-t),(r<-1||r>=h)&&Ze("column",r,"-1",h-1),(o<-1||r+o>h)&&Ze("columnCount",o,"-1",h-r),g=-1,p=-1,m=!1,v=!1,-1===t&&-1===r&&-1===n&&-1===o?(t=0,r=0,g=We(e)-1,p=ze(e)-1):(-1===t&&(t=0,2==(2&e.parent.options.copyPasteHeaderOptions)&&(m=!0)),-1===r&&(r=0,1==(1&e.parent.options.copyPasteHeaderOptions)&&(v=!0)),-1===n&&(n=We(e)-t),-1===o&&(o=ze(e)-r),g=t+n-1,p=r+o-1),(ge(i)||""===i)&&(i="\r\n"),(ge(a)||""===a)&&(a="\t"),(ge(l)||""===l)&&(l='"'),C=RegExp(l,"g"),w=null,y=null,S=dt(e,t,g,r,p,3,u,c,i,a,l,C,s,_,f),v&&(x=e.getColumnCount(2),w=dt(e,t,g,0,x-1,2,u,c,i,a,l,C,s,_,f)),m&&(b=e.getRowCount(1),y=dt(e,0,b-1,r,p,1,u,c,i,a,l,C,s,_,f)),_t(S,w,y,i,a)}function _t(e,t,n,r,o){var i,a,l=e,s=0,u=function(e,t){var n,r=[],o=e.length;for(n=0;n<o;n++)r.push(e[n].concat(t[n]));return r};return t&&(s=t[0].length,l=u(t,e)),n&&(i=n.length,a=null,s&&(a=dt(null,0,i-1,0,s-1,null,[],[],r,o,null,null,null,!1,!1),n=u(a,n)),l=n.concat(l)),ft(l,r,o)}function ft(e,t,n){var r,o,i="",a=e.length;for(r=0;r<a;r++){for(o=0;o<e[r].length;o++)0!==o&&(i+=n),i+=e[r][o];i+=t}return i}function dt(e,t,n,r,o,i,a,l,s,u,c,_,f,d,h){var g,p,m,v,C=[];for(g=t;g<=n;g++)if(!a||!pe(a,g)){for(m=[],p=r;p<=o;p++)l&&pe(l,p)||(v="",e&&!nt(e,g,p,i,d)&&(v=e.getText(g,p,i)),v=ht(v,d,_,c,h,f,u,s),m.push(v));C.push(m)}return C}function ht(e,t,n,r,o,i,a,l){var s="";return ge(e)||(s=e,t||(s=s.replace(n,r+r))),o&&!s&&(s=" "),t?s=s.replace(/\n/g,Me.mozilla?"":" "):(i||-1!==s.indexOf(r)||-1!==s.indexOf(a)||-1!==s.indexOf(l)||-1!==s.indexOf("\n"))&&(s=r+s+r),s}function gt(e,t,n,r){var o,i,a,l,s,u=Ve,c=ot(e,t,n,r);if(c){for(o=c.length,i=st(c),a=[],l=0;l<o;l++)for(a[l]=[],s=0;s<i;s++)s<c[l].length?a[l][s]=c[l][s]:a[l][s]=Ve;u=a}return u}De(ce.prototype,{autoFitColumn:function(e){0<=e&&e<ze(this)&&this._commandManager().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:e}],rowHeader:!1})},autoFitRow:function(e){0<=e&&e<We(this)&&this._commandManager().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:e}],columnHeader:!1})},setCsv:function(e,t,n,r,o,i){var a=this;Je(a),Qe(a),ut(a,e,t,n,r,o,'"',i),$e(a),qe(a)},getCsv:function(e,t,n,r,o,i){return ct(this,e,n,t,r,o,i,'"',!0)},copyTo:function(e,t,n,r,o,i,a){this._copyToCore(e,t,n,r,o,i,a)},_copyToCore:function(e,t,n,r,o,i,a,l){var s=this;Je(s),Qe(s),he.copyTo(s,e,t,s,n,r,o,i,a,l,0),$e(s),qe(s)},moveTo:function(e,t,n,r,o,i,a){var l=this;(!(le._supportsCalc&&a&le.CopyToOptions.formula)||l._checkArrayFormula(e,t,o,i,!0)&&l._checkArrayFormula(n,r,o,i,!0))&&(Je(l),Qe(l),he.moveTo(l,e,t,l,n,r,o,i,a),$e(l),qe(l))},_clipboardCopy:function(e,t,n){var r,o,i,a,l,s,u,c,_,f=this,d=f._getCopyRange(e);if(d){r=f._getIgnoredRowsCols(e),o="\t",i="\r\n",a='"',l=f._eventHandler,s=ct(f,d.row,Ue(d),d.col,Ye(d),i,o,a,!1,r.rows,r.cols,!0),u=f._getClipboardHelper(),u._fromSheet=f,u._ranges=e,u._isCutting=t,c=u._getRangeHtml(f,d.row,Ue(d),d.col,Ye(d),Xe(f),r.rows,r.cols),f._clearFloatingObjectClipboardHelper&&f._clearFloatingObjectClipboardHelper();try{if(_={sheet:f,sheetName:f._name,copyData:{text:s,html:c},cancel:!1},f._trigger(Ce.ClipboardChanging,_),_&&!1===_.cancel)return l&&!n&&l._switchFocusForClipboard(Xe(f)?c:s),f._trigger(Ce.ClipboardChanged,{sheet:f,sheetName:f._name,copyData:{text:s,html:c}}),setTimeout(function(){!l||n||f._disposed||l._switchBackFocusAfterClipboard()},100),{copyText:s,copyHtml:c};u._fromSheet=Ve,u._ranges=Ve}catch(e){}}},_checkPastedRange:function(e,t,n,r,o,i){var a,l,s,u=Ke().Exp_PasteSourceCellsLocked;if(i.pastedInternal=!1,i.pastedRange=Ve,!e&&!o)return!1;if(a=this,l=a,s=a._getIgnoredRowsCols(t),a._isPastedInternal(e,a._getCopyRange(t),l,o,s.rows,s.cols)||!o){if(i.pastedInternal=!0,r&&e.options.isProtected&&e._isAnyCellInRangesLocked(t))return a._raiseInvalidOperation(1,u),!1;i.pastedRange=a._getPastedRange(e,t,l,n,r)}else i.pastedRange=a._getPastedRangefromText(n,o);return a._checkPasteRangeImp(e,t,n,r,i)},_checkPasteRangeImp:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p,m,v,C=Ke().Exp_InvalidCopyPasteSize,w=Ke().Exp_PasteDestinationCellsLocked,y=Ke().Exp_PasteChangeMergeCell,S=Ke().Exp_ChangePartOfArray,x=this,b=x,T=o.pastedRange;if(!T)return x._raiseInvalidOperation(1,C),!1;if(!b._canChange(T.row,T.col,Ue(T),Ye(T),w,S))return!1;if(o.pastedInternal){if(1===(i=t.length)){if(a=t[0],r&&!e._canChange(a.row,a.col,Ue(a),Ye(a),w,S))return!1;if(e._hasPartSpans(a.row,a.col,Ue(a),Ye(a)))return x._raiseInvalidOperation(1,y),!1;if(l=T.row<0?We(b):Ue(T),s=T.col<0?ze(b):Ye(T),u=a.row<0?We(e):Ue(a),c=a.col<0?ze(e):Ye(a),l>u||s>c){for(_=n.row,f=n.col,n.row<0&&u<We(b)&&(_=0),n.col<0&&c<ze(b)&&(f=0),l%u==0&&1===s?(s=c,T=o.pastedRange=new Te(_,f,l,s)):1===l&&s%c==0?(l=u,T=o.pastedRange=new Te(_,f,l,s)):l%u==0&&s%c==0||(l=u,s=c,T=o.pastedRange=new Te(_,f,l,s)),d=Le(l/u),h=Le(s/c),g=0;g<d;g++)for(p=0;p<h;p++)if(!x._isSingleCellToSpanCell(a,T)&&b._hasPartSpans(_<0?-1:_+g*u,f<0?-1:f+p*c,_<0?-1:u,f<0?-1:c))return x._raiseInvalidOperation(1,y),!1}else if(!x._isSingleCellToSpanCell(a,T)&&b._hasPartSpans(T.row,T.col,Ue(T),Ye(T)))return x._raiseInvalidOperation(1,y),!1}else if(i>1){for(m=0;m<i;m++)if(v=t[m],e._hasPartSpans(v.row,v.col,Ue(v),Ye(v)))return x._raiseInvalidOperation(1,y),!1;if(b._hasPartSpans(T.row,T.col,Ue(T),Ye(T)))return x._raiseInvalidOperation(1,y),!1}}else{if(b._hasPartSpans(T.row,T.col,Ue(T),Ye(T)))return x._raiseInvalidOperation(1,y),!1;if(!b._isValidPasteRange(T.row,T.col,Ue(T),Ye(T)))return x._raiseInvalidOperation(1,C),!1}return!0},_isSingleCellToSpanCell:function(e,t){if(e&&1===Ue(e)&&1===Ye(e)){var n=this.getSpan(t.row,t.col);if(n&&n.equals(t))return!0}return!1},_isPastedInternal:function(e,t,n,r,o,i){var a,l;return!!(e&&t&&n)&&(a=ct(e,t.row,Ue(t),t.col,Ye(t),"\r\n","\t",'"',!1,o,i,!0,Me.safari),l=a===r,l||(l=a===r+"\r\n",!l&&Me.chrome&&(l=a===r+"\t\r\n"),!l&&Me.safari&&(l=a.replace(/\s/g,"")===r.replace(/\s/g,"")),l||(l=a.replace(/\s+$/,"")===r.replace(/\s+$/,""))),l)},_getPastedRange:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g=this,p=t.length;if(1===p){if(i=t[0],a=i.row<0?0:i.row,l=i.col<0?0:i.col,s=i.row<0?We(e):Ue(i),u=i.col<0?ze(e):Ye(i),c=r.row<0?0:r.row,_=r.col<0?0:r.col,f=r.row<0?We(n):Ue(r),d=r.col<0?ze(n):Ye(r),o?(f=s,d=u):f%s==0&&1===d?d=u:1===f&&d%u==0?f=s:f%s==0&&d%u==0||(f=s,d=u),!g._isValidRange(a,l,s,u,We(e),ze(e)))return Ve;if(!n._isValidPasteRange(c,_,f,d))return Ve;if(h=new Te(c,_,f,d),!o&&e._name===n._name)if(h.contains(a,l,s,u)){if((a-c)%s!=0||(l-_)%u!=0)return Ve}else if(h.intersect(a,l,s,u)&&(f>s||d>u))return Ve;return-1===r.row&&(c=-1,f=-1),-1===r.col&&(_=-1,d=-1),new Te(c,_,f,d)}return p>1?g._getPastedRangeForMultiCopy(t,r):Ve},_getPastedRangeForMultiCopy:function(e,t){var n,r,o,i,a,l;if(e.length>1){if(n=e[0],r=e[1],o=n.rowCount,i=n.colCount,n.row===r.row&&o===r.rowCount)return a=0,e.forEach(function(e){a+=e.colCount}),fe._createRange(t.row,t.col,o,a);if(n.col===r.col&&i===r.colCount)return l=0,e.forEach(function(e){l+=e.rowCount}),fe._createRange(t.row,t.col,l,i)}return Ve},_getPastedRangefromText:function(e,t){var n,r,o,i,a=Ve,l=gt(t,"\r\n","\t",'"');return l&&(n=e.row<0?0:e.row,r=e.col<0?0:e.col,o=l.length,i=st(l),o>0&&i>0&&(a=new Te(n,r,o,i))),a},_clearClipboard:function(){var e=this._getClipboardHelper();e&&(e._fromSheet=Ve,e._ranges=Ve,e._isCutting=!1)},_clipboardPaste:function(e,t,n,r,o,i,a,l,s){var u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b;if(e&&n._name===e._name&&n.parent&&!pe(n.parent.sheets,e))return void e._clearClipboard();g=un._convertPasteOption(l),et(e),et(n);try{if(e&&t){if(0!=(2&g)&&o&&le._supportsCalc&&(e._hasPartArrayFormulas(t.row,t.col,Ue(t),Ye(t))||n._hasPartArrayFormulas(r.row,r.col,Ue(r),Ye(r))))throw Ke().Exp_ChangePartOfArray;if(o)he.moveTo(e,t.row,t.col,n,r.row,r.col,Ue(t),Ye(t),g),e._clearClipboard();else if(p=r.row<0?We(n):Ue(r),m=r.col<0?ze(n):Ye(r),_=t.row<0?We(e):Ue(t),f=t.col<0?ze(e):Ye(t),p>_||m>f)for(u=r.row,c=r.col,r.row<0&&_<We(n)&&(u=0),r.col<0&&f<ze(n)&&(c=0),p%_==0&&1===m?m=f:1===p&&m%f==0?p=_:p%_==0&&m%f==0||(p=_,m=f),v=Le(p/_),C=Le(m/f),d=0;d<v;d++)for(h=0;h<C;h++)he.copyTo(e,t.row,t.col,n,u<0?-1:u+d*_,c<0?-1:c+h*f,u<0?-1:_,c<0?-1:f,g,s,je(e));else he.copyTo(e,t.row,t.col,n,r.row,r.col,Ue(t),Ye(t),g,s,je(e))}else{for(u=r.row,c=r.col,_=Ue(r),f=Ye(r),w=n._getSpanModel(),y=[],w.each(u,c,_,f,function(e){e&&y.push(e)}),S=0,x=y.length;S<x;S++)w.remove(y[S]);if(le._supportsCalc&&(1&g)>0&&n.clearFormula(u,c,_,f,function(e,t){return!e._isRowFilterOut||!e._isRowFilterOut(t)}),i&&""!==i)a&&(b=n._getClipboardHelper())&&b._setRangeHtml(a,n,u,c,g),n.setCsv(u,c,i,"\r\n","\t",16);else for(d=0;d<_;d++)for(h=0;h<f;h++)n.setValue(u+d,c+h,Ve)}}finally{tt(e,!1),tt(n,!1)}},_doCut:function(e){if(!this.isEditing()){var t=this.getSelections();if(t&&1===t.length)return this._clipboardCopy(t,!0,e)}return Ve},_isValidMultiCopyRanges:function(e,t){var n,r,o,i,a,l,s;if(e&&(n=e.length)>1){for(r=0;r<n;r++)for(o=e[r],i=r+1;i<n;i++)if(a=e[i],o.intersect(a.row,a.col,a.rowCount,a.colCount))return!1;for(l=e[0],r=1;r<n&&(s=e[r],l.row===s.row&&l.rowCount===s.rowCount);r++);if(r>=n)return t&&(t.inSameRow=!0),!0;for(r=1;r<n&&(s=e[r],l.col===s.col&&l.colCount===s.colCount);r++);if(r>=n)return t&&(t.inSameCol=!0),!0}return!1},_getCopyRange:function(e){var t,n,r,o,i;if(e){if(1===(t=e.length))return e[0];if(t>1){if(n=e[0],r=e[t-1],n.row===r.row&&n.rowCount===r.rowCount){for(o=0;o<t;o++)i=e[o],i.col<n.col&&(n=i),i.col>r.col&&(r=i);return fe._createRange(n.row,n.col,n.rowCount,r.col+r.colCount-n.col)}if(n.col===r.col&&n.colCount===r.colCount){for(o=0;o<t;o++)i=e[o],i.row<n.row&&(n=i),i.row>r.row&&(r=i);return fe._createRange(n.row,n.col,r.row+r.rowCount-n.row,n.colCount)}}}return Ve},_getIgnoredRowsCols:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d=[],h=[];if(e&&(t=e.length)>1&&(n=e[0],r=e[t-1],o=n.row===r.row&&n.rowCount===r.rowCount,i=n.col===r.col&&n.colCount===r.colCount,o||i))for(e.sort(o?function(e,t){return e.col-t.col}:function(e,t){return e.row-t.row}),a=1;a<t;a++)for(l=e[a-1],s=e[a],u=o?l.col+l.colCount:l.row+l.rowCount,c=o?s.col:s.row,_=o?h:d,f=u;f<c;f++)_.push(f);return{rows:d,cols:h}},_doCopy:function(e){var t,n,r,o,i,a,l=this;if(!l.isEditing()){if((t=l.getSelections())&&1===t.length){if(n=t[0],-1!==n.row&&l._hasRowFilterOut&&l._hasRowFilterOut()){for(r=[],o=-1,i=0;i<n.rowCount;i++)a=n.row+i,l._isRowFilterOut(a)?-1!==o&&(r.push(fe._createRange(o,n.col,a-o,n.colCount)),o=-1):-1===o&&(o=a);-1!==o&&r.push(fe._createRange(o,n.col,n.row+n.rowCount-o,n.colCount)),t=r}return l._clipboardCopy(t,!1,e)}if(l._isValidMultiCopyRanges(t))return l._clipboardCopy(t,!1,e)}return Ve},_doPaste:function(e){var t=this,n=t._eventHandler,r,o,i;t.isEditing()||(e&&(r=e.pasteText,o=e.pasteHtml,i=e.callback),n&&!r&&n._switchFocusForClipboard(""),setTimeout(function(){var e,a,l,s,u;t._disposed||(e=r||"",a=o||"",n&&!r&&(s=t._getClipboardHelper(),s&&(u=s._getClipboardData(),e=u.text,a=u.html,l=u.json),n._switchBackFocusAfterClipboard()),(Me.msie||Me.edge||r||!e&&!a)&&(t._doClipboardPaste(e,a,l),i&&i()))},100))},_doClipboardPaste:function(e,t,n){var r=this,o=r._getPasteInfo(e,n);o&&(o.cmd="clipboardPaste",o.sheetName=r.name(),Xe(r)&&t&&t.length<5e7&&(o.clipboardHtml=t),r._commandManager().execute(o))},_getPasteInfo:function(e,t){var n,r,o,i,a,l,s,u,c,_=this,f=Ke().Exp_InvalidPastedArea,d=_._getClipboardHelper(),h=d._fromSheet,g=d._ranges,p=d._isCutting
;if(p&&h&&g&&h.options.isProtected&&h._isAnyCellInRangesLocked(g)&&(p=!1),n={pastedRange:Ve,pastedInternal:!1},r=[],o=_.getSelections(),o.length>1)for(a=0;a<o.length;a++){if(i=o[a],!_._checkPastedRange(h,[g[0]],i,p,e,n))return;if(i.containsRange(n.pastedRange)&&!i.equals(n.pastedRange))return void _._raiseInvalidOperation(1,f);r.push(n.pastedRange)}else{if(i=o.length>0?o[0]:_._getSpanModel().get(_._activeRowIndex,_._activeColIndex),!_._checkPastedRange(h,g,i,p,e,n))return;r.push(n.pastedRange)}if(l=_._cutCopyIndicatorManager,l&&l._isPastedInternal(n.pastedInternal),s=_.options.clipBoardOptions,!n.pastedInternal)if(t){h=_.parent.sheets[_.parent.getSheetCount()-1],h.reset(),h.setRowCount(1),h.setColumnCount(1);const m=h.options;h.fromJSON(t),h.formulaFromJSON(t),h.options=m,h.getDefaultStyle().locked=!1,h.adjustColumnNames&&h.adjustColumnNames(_,i),g=h.getSelections(),p=!1,s=0,r=[_._getPastedRange(h,g,_,i,p)]}else h=Ve,g=Ve,p=!1;if(p&&(s=0),g&&1===g.length)for(u=0;u<r.length;u++)c=r[u],_._isSingleCellToSpanCell(g[0],c)&&(c.rowCount=1,c.colCount=1);return{fromSheet:h,fromRanges:g,isCutting:p,pasteOption:s,pastedRanges:r,clipboardText:e}},_isValidPasteRange:function(e,t,n,r,o){var i=this,a=We(i),l=ze(i);return Ge(i)?-1<=e&&(o||e<a)&&-1<=t&&(o||t<l):i._isValidRange(e,t,n,r,a,l)},_isAnyCellInRangesLocked:function(e){for(var t=0;t<e.length;t++)if(this._isAnyCellInRangeLocked(e[t]))return!0;return!1},_moveActiveCell:function(e,t,n,r){var o,i,a=this,l={sheet:a,sheetName:a._name,row:a._activeRowIndex,col:a._activeColIndex,cancel:!1};a._trigger(Ce.LeaveCell,l),!0!==l.cancel&&(a.endEdit&&!a.endEdit()||(o=a._activeRowIndex,i=a._activeColIndex,ge(n)&&(n=a._activeRowIndex),ge(r)&&(r=a._activeColIndex),3===e?a._moveActiveCellLeft(n,r,t):4===e?a._moveActiveCellRight(n,r,t):1===e?a._moveActiveCellUp(n,r,t):2===e?a._moveActiveCellDown(n,r,t):5===e?a._moveActiveCellFirst():6===e&&a._moveActiveCellLast(),a._moveActiveCellEnd(e,o,i)))},_moveActiveCellInSelection:function(e){var t,n,r=this,o={sheet:r,sheetName:r._name,row:r._activeRowIndex,col:r._activeColIndex,cancel:!1};r._trigger(Ce.LeaveCell,o),!0!==o.cancel&&r.endEdit()&&(t=r._activeRowIndex,n=r._activeColIndex,3===e?r._moveActiveCellLeftInSelection(r._activeRowIndex,r._activeColIndex):4===e&&r._moveActiveCellRightInSelection(r._activeRowIndex,r._activeColIndex),r._moveActiveCellEnd(e,t,n))},_moveActiveCellEnd:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S=this,x=S._eventHandler,b=S._selectionModel,T=b.toArray(),R=!1;S._isNavigateInSelection||(r=S._getActualRange(S._getActiveSelectedRange()),(b.length>1||Ue(r)>1||Ye(r)>1)&&(R=!0),S._clearSelectionImp()),o=S._activeRowIndex,i=S._activeColIndex,a=S._getSpanModel().get(o,i),S._activeRowCount=Ue(a),S._activeColCount=Ye(a),S._isNavigateInSelection||(l=S._getExtendedRange(o,i),s=S.selectionPolicy(),u=S.selectionUnit(),0===s?b.clear():1===s&&b.clear(),1===u?(l.col=-1,l.colCount=-1):2===u&&(l.row=-1,l.rowCount=-1),S._replaceActiveSelectedRange(l.row,l.col,Ue(l),Ye(l),!1),c=b.toArray(),x._notEqualSelecions(T,c)&&(S._raiseSelectionChanging(T,c),S._raiseSelectionChanged(T))),S._scrollByMoveCell(o,i),t!==o&&(_=S._bindingManager)&&_._doDataItemChanged(),f=S._render,R?(d=S._getSheetLayout(),h=d._headerX,g=d._headerY,p=d.width-h,m=d.height-g,f._copyDoubleBuffer(h,g,p,m),f.repaint(new Re(h,g,p,d._colHeaderHeight)),f.repaint(new Re(h,g,d._rowHeaderWidth,m)),f._paintAdornment(f._getCtx())):(v=S._getSpanModel().get(t,n),C=Ue(v),w=Ye(v),f._repaintSelection(new Te(o,i,S._activeRowCount,S._activeColCount).union(new Te(t,n,C,w)))),y={sheet:S,sheetName:S._name,row:o,col:i},S._trigger(Ce.EnterCell,y),S._trigger(Ce.FormulatextboxEnterCell,y),x._updateValidationUI&&x._updateValidationUI(o,i)},_validationError:function(e,t){var n=this,r=n.getDataValidator&&n.getDataValidator(e,t),o={sheet:n,sheetName:n._name,row:e,col:t,validator:r,validationResult:0};return n._trigger(Ce.ValidationError,o),o.validationResult}});function pt(e,t){return e.sheets?e.getSheetFromName(t.sheetName):e}function mt(e,t,n,r){var o=pt(e,n),i=new t(o,n,r);return r?i.undo(o):i.execute(o)}t=le.Commands={},t._navigateNoWrap=function(e,t){return!!e&&(2!==e._editorStatus&&(e._moveActiveCell(t,!1),!0))},t._navigateNoWrapFrom=function(e,t,n,r){return!!e&&(2!==e._editorStatus&&(e._moveActiveCell(t,!1,n,r),!0))},t._alterSelection=function(e,t,n){return!!e&&(2!==e._editorStatus&&(!(e.endEdit&&!e.endEdit())&&(e._changeActiveSelectedRange(t,n),!0)))};function vt(e){var n=e;return function(e,r){var o=pt(e,r);return t._navigateNoWrap(o,n)}}function Ct(e,n){var r=e,o=n;return function(e,n){var i=pt(e,n);return t._alterSelection(i,r,o)}}function wt(e,t){var n,r,o,i=e.parent;i&&(n=i.getSheetCount(),r=o=i.getActiveSheetIndex(),t?o<n-1&&o++:o>0&&o--,r!==o&&(i._setActiveSheetIndexImp(o,1),i.repaint()))}function yt(e,t){e._isTabNavigation=!0,e._isNavigateInSelection?e._moveActiveCellInSelection(t):e._moveActiveCell(t,!0),e._isTabNavigation=!1}function St(e,t){var n,r,o,i;return!!e.endEdit()&&(n=e._eventHandler,n._clearRepeatKeyDownTimeout(),n._resetMetaKeyState(),fe._FocusHelper._setActiveElement(Ve),r=!1,o=e.parent,o&&(i=t.call(o),i&&i.focus?(i.focus(),r=!0):o._focusTabFocusElement()),{ignoreCancelDefault:!r})}r="navigationLeft",o="navigationRight",i="navigationUp",a="navigationDown",l="navigationHome2",s="navigationEnd2",u="navigationTop",c="navigationBottom",_="navigationHome",f="navigationFirst",d="navigationEnd",h="navigationLast",g="moveToNextCell",p="moveToPreviousCell",m="navigationPageUp",v="navigationPageDown",C="navigationPreviousSheet",w="navigationNextSheet",y="clear",S="clearAndEditing",x="commitInputNavigationDown",b="commitInputNavigationUp",T="cancelInput",R="commitArrayFormula",A="selectionLeft",I="selectionRight",M="selectionUp",E="selectionDown",F="selectionHome",D="selectionEnd",N="selectionPageUp",V="selectionPageDown",O="selectionTop",H="selectionBottom",P="selectionFirst",L="selectionLast",k="copy",B="cut",W="paste",z="undo",U="redo",Y="resizeColumn",G="resizeRow",X="autoFitColumn",j="autoFitRow",K="editCell",Z="renameSheet",J="zoom",q="clearValues",Q="clipboardPaste",$="selectNextControl",ee="selectPreviousControl",te="moveToNextCellThenControl",ne="moveToPreviousCellThenControl",re="changeFormulaReference",t._getWorksheet=pt,t._executeCommand=mt,t._initWorkbookCommands=function(e){var n=Ie._isMacOS(),oe=!n,ie=n;e.register(r,t[r],37,!1,!1,!1,!1),e.register(o,t[o],39,!1,!1,!1,!1),e.register(i,t[i],38,!1,!1,!1,!1),e.register(a,t[a],40,!1,!1,!1,!1),e.register(l,t[l],37,oe,!1,!1,ie),e.register(s,t[s],39,oe,!1,!1,ie),e.register(u,t[u],38,oe,!1,!1,ie),e.register(c,t[c],40,oe,!1,!1,ie),e.register(_,t[_],36,!1,!1,!1,!1),e.register(f,t[f],36,!0,!1,!1,!1),e.register(d,t[d],35,!1,!1,!1,!1),e.register(h,t[h],35,!0,!1,!1,!1),e.register(g,t[g],9,!1,!1,!1,!1),e.register(p,t[p],9,!1,!0,!1,!1),e.register(m,t[m],33,!1,!1,!1,!1),e.register(v,t[v],34,!1,!1,!1,!1),e.register(C,t[C],33,oe,!1,!1,ie),e.register(w,t[w],34,oe,!1,!1,ie),e.register(y,t[y],46,!1,!1,!1,!1),e.register(S,t[S],8,!1,!1,!1,!1),e.register(x,t[x],13,!1,!1,!1,!1),e.register(b,t[b],13,!1,!0,!1,!1),e.register(T,t[T],27,!1,!1,!1,!1),e.register(R,t[R],13,!0,!0,!1,!1),e.register(A,t[A],37,!1,!0,!1,!1),e.register(I,t[I],39,!1,!0,!1,!1),e.register(M,t[M],38,!1,!0,!1,!1),e.register(E,t[E],40,!1,!0,!1,!1),e.register(F,t[F],36,!1,!0,!1,!1),e.register(D,t[D],35,!1,!0,!1,!1),e.register(N,t[N],33,!1,!0,!1,!1),e.register(V,t[V],34,!1,!0,!1,!1),e.register(F,t[F],37,oe,!0,!1,ie),e.register(D,t[D],39,oe,!0,!1,ie),e.register(O,t[O],38,oe,!0,!1,ie),e.register(H,t[H],40,oe,!0,!1,ie),e.register(P,t[P],36,!0,!0,!1,!1),e.register(L,t[L],35,!0,!0,!1,!1),e.register(k,t[k],67,oe,!1,!1,ie),e.register(B,t[B],88,oe,!1,!1,ie),e.register(W,t[W],86,oe,!1,!1,ie),e.register(z,t[z],90,oe,!1,!1,ie),e.register(U,t[U],89,oe,!1,!1,ie),e.register($,t[$]),e.register(ee,t[ee]),e.register(te,t[te]),e.register(ne,t[ne]),e.register(re,t[re]),e.register(Y,t[Y]),e.register(G,t[G]),e.register(X,t[X]),e.register(j,t[j]),e.register(K,t[K]),e.register(Z,t[Z]),e.register(J,t[J]),e.register(q,t[q]),e.register(Q,t[Q])},t[r]={canUndo:!1,execute:vt(3)},t[o]={canUndo:!1,execute:vt(4)},t[i]={canUndo:!1,execute:vt(1)},t[a]={canUndo:!1,execute:vt(2)},t[R]={canUndo:!1,execute:function(e,n){var r=pt(e,n),o=t._FormulatextboxCommands;return o&&(r=o._commitArrayFormula(r)),r._commitArrayFormula&&r._commitArrayFormula(),!0}},t[x]={canUndo:!1,execute:function(e,n){var r=pt(e,n),o=t._FormulatextboxCommands;return o&&(r=o._commitInputNavigationDown(r)),r._moveActiveCell(2,!1),!0}},t[b]={canUndo:!1,execute:function(e,n){var r=pt(e,n),o=t._FormulatextboxCommands;return o&&(r=o._commitInputNavigationUp(r)),r._moveActiveCell(1,!1),!0}},t[_]={canUndo:!1,execute:function(e,n){var r=pt(e,n);return t._navigateNoWrapFrom(r,4,Ve,r.frozenColumnCount()-1)}},t[l]={canUndo:!1,execute:function(e,n){var r=pt(e,n);return t._navigateNoWrapFrom(r,4,Ve,-1)}},t[d]={canUndo:!1,execute:function(e,n){var r=pt(e,n);return t._navigateNoWrapFrom(r,3,Ve,ze(r)-r.frozenTrailingColumnCount())}},t[s]={canUndo:!1,execute:function(e,n){var r=pt(e,n);return t._navigateNoWrapFrom(r,3,Ve,ze(r))}},t[u]={canUndo:!1,execute:function(e,n){var r=pt(e,n);return t._navigateNoWrapFrom(r,2,-1,Ve)}},t[c]={canUndo:!1,execute:function(e,n){var r=pt(e,n);return t._navigateNoWrapFrom(r,1,We(r),Ve)}},t[m]={canUndo:!1,execute:function(e,n){var r,o,i,a,l,s=pt(e,n);if(!s||2===s._editorStatus)return!1;if((r=s._getPrevPageTopRow())===Ve||r===s._scrollTopRow)return!0;if(o=s._getRowLayout(1,3),i=s._getNextVisualRow(s._activeRowIndex-o.length),i<r&&(i=r),a=t._FormulatextboxCommands){if(l=a._navigationPageUp(s,i,r),l.r)return!0;s=l.sheet}return!!s.endEdit()&&(s._canSelect(i,s.getActiveColumnIndex())&&(s._setActiveCellCore(i,Ve),s._leadingCellRow=i,s._moveActiveCell()),s._setTopRow(r),!0)}},t[v]={canUndo:!1,execute:function(e,n){var r,o,i,a,l,s=pt(e,n);if(!s||2===s._editorStatus)return!1;if((r=s._getNextPageTopRow())===Ve||r===s._scrollTopRow)return!0;if(o=s._getRowLayout(1,3),i=s._getPrevVisualRow(s._activeRowIndex+o.length),i<r&&(i=r),a=t._FormulatextboxCommands){if(l=a._navigationPageDown(s,i,r),l.r)return!0;s=l.sheet}return!!s.endEdit()&&(s._canSelect(i,s.getActiveColumnIndex())&&(s._setActiveCellCore(i,Ve),s._leadingCellRow=i,s._moveActiveCell()),s._setTopRow(r),!0)}},t[w]={canUndo:!1,execute:function(e,t){wt(pt(e,t),!0)}},t[C]={canUndo:!1,execute:function(e,t){wt(pt(e,t),!1)}},t[f]={canUndo:!1,execute:function(e,n){var r,o,i=pt(e,n);if(!i||2===i._editorStatus)return!1;if(r=t._FormulatextboxCommands){if(o=r._navigationFirst(i),o.r)return!0;i=o.sheet}return i._moveActiveCell(5,!1,i._activeRowIndex,i._activeColIndex),!0}},t[h]={canUndo:!1,execute:function(e,n){var r,o,i=pt(e,n);if(!i||2===i._editorStatus)return!1;if(r=t._FormulatextboxCommands){if(o=r._navigationLast(i),o.r)return!0;i=o.sheet}return i._moveActiveCell(6,!1,i._activeRowIndex,i._activeColIndex),!0}},t[$]={canUndo:!1,execute:function(e,t){var n=pt(e,t);return!!n.parent&&St(n,n.parent.nextControl)}},t[ee]={canUndo:!1,execute:function(e,t){var n=pt(e,t);return!!n.parent&&St(n,n.parent.previousControl)}},t[g]={canUndo:!1,execute:function(e,n){var r=pt(e,n),o=t._FormulatextboxCommands;return o&&(r=o._moveToNextCell(r)),yt(r,4),!0}},t[p]={canUndo:!1,execute:function(e,n){var r=pt(e,n),o=t._FormulatextboxCommands;return o&&(r=o._moveToPreviousCell(r)),yt(r,3),!0}},t[te]={canUndo:!1,execute:function(e,n){var r,o,i=pt(e,n),a=i._leadingCellRow,l=i.getActiveColumnIndex();return i._isTabNavigation=!0,r=i._getMoveRightCell(i.getActiveRowIndex(),l,!0,a),i._isTabNavigation=!1,o=!r||(r.leadingCellRow<a||r.leadingCellRow===a&&l>r.col),o?t[$].execute(e,n):t[g].execute(e,n)}},t[ne]={canUndo:!1,execute:function(e,n){var r,o,i=pt(e,n),a=i._leadingCellRow,l=i.getActiveColumnIndex();return i._isTabNavigation=!0,r=i._getMoveLeftCell(i.getActiveRowIndex(),l,!0,a),i._isTabNavigation=!1,o=!r||(r.leadingCellRow>a||r.leadingCellRow===a&&l<r.col),o?t[ee].execute(e,n):t[p].execute(e,n)}},t[T]={canUndo:!1,execute:function(e,n){var r,o,i,a,l,s,u=pt(e,n),c=t._FormulatextboxCommands;if(c&&c._cancelInput(u),u.isEditing())return r=u.getValue(u._activeRowIndex,u._activeColIndex,3),!!u.endEdit(!0)&&(u.setValue(u._activeRowIndex,u._activeColIndex,r,3,!0),!0);if(o=u.parent,i=o&&o.sheets)for(a=0,l=i.length;a<l;a++)(s=i[a])&&s._cutCopyIndicatorManager&&s._cutCopyIndicatorManager._cancelIndicator()}},t[y]={canUndo:!1,execute:function(e,t){var n,r=pt(e,t);return!r.isEditing()&&(n=r.getSelections(),r._commandManager().execute({cmd:q,sheetName:r.name(),ranges:n}),!0)}},t[S]={canUndo:!1,execute:function(e,n){var r=pt(e,n);return!r.isEditing()&&(Ie._isMacOS()?(t[y].execute(e,n),!0):(r.startEdit(!0,""),!0))}},t[k]={canUndo:!1,execute:function(e,t){var n=pt(e,t),r=t.copyData=n._doCopy(t.ignoreClipboard);return t.callback&&t.callback(),!r||Oe}},t[B]={canUndo:!1,execute:function(e,t){var n=pt(e,t),r=t.cutData=n._doCut(t.ignoreClipboard);return t.callback&&t.callback(),!r||Oe}},t[W]={canUndo:!1,execute:function(e,t){pt(e,t)._doPaste(t)}},t[A]={canUndo:!1,execute:Ct(37)},t[I]={canUndo:!1,execute:Ct(39)},t[M]={canUndo:!1,execute:Ct(38)},t[E]={canUndo:!1,execute:Ct(40)},t[F]={canUndo:!1,execute:Ct(37,!0)},t[D]={canUndo:!1,execute:Ct(39,!0)},t[N]={canUndo:!1,execute:Ct(33)},t[V]={canUndo:!1,execute:Ct(34)},t[O]={canUndo:!1,execute:Ct(38,!0)},t[H]={canUndo:!1,execute:Ct(40,!0)},t[P]={canUndo:!1,execute:Ct(36,!0)},t[L]={canUndo:!1,execute:Ct(35,!0)},t[re]={canUndo:!1,execute:function(e,t){var n=pt(e,t),r=n&&n._eventHandler;if(r){Je(n);try{r._changeFormulaReference&&r._changeFormulaReference()}finally{qe(n)}}}},t[z]={canUndo:!1,execute:function(e,t){var n,r=e;return r&&(n=r.undoManager())&&n.canUndo()&&n.undo(),!0}},t[U]={canUndo:!1,execute:function(e,t){var n,r=e;return r&&(n=r.undoManager())&&n.canRedo()&&n.redo(),!0}},t[Y]={canUndo:!0,execute:function(e,t,n){return mt(e,Lt,t,n)}},t[G]={canUndo:!0,execute:function(e,t,n){return mt(e,kt,t,n)}},t[X]={canUndo:!0,execute:function(e,t,n){return mt(e,Bt,t,n)}},t[j]={canUndo:!0,execute:function(e,t,n){return mt(e,Wt,t,n)}},t[K]={canUndo:!0,execute:function(e,t,n){return mt(e,zt,t,n)}},t[Z]={canUndo:!0,execute:function(e,t,n){return mt(e,Gt,t,n)}},t[J]={canUndo:!0,execute:function(e,t,n){return mt(e,Xt,t,n)}},t[q]={canUndo:!0,execute:function(e,t,n){return mt(e,Jt,t,n)}},t[Q]={canUndo:!0,execute:function(e,t,n){return mt(e,cn,t,n)}};function xt(e,t,n){var r=this;r.row=e,r.column=t,r.value=n}function bt(e,t,n){var r=this;r._sheet=e,r._range=t,r._dataType=n,r._cellsData=[],r._changedCells=[],r._initCellsData()}oe={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1:"value"},De(bt.prototype,{_initCellsData:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R=this,A=R._range,I=R._sheet;if(I&&A){if(e=R._dataType,t=A.row,n=A.col,r=Ue(A),o=Ye(A),i=R._cellsData,a=!1,-1===t&&(a=!0,t=0,r=We(I)),-1===n&&(a=!0,n=0,o=ze(I)),s=[],(64&e)>0)for(c=0;c<o;c++)s[c]=I._getStyleObject(-1,c)||Ve;for(_=0;_<r;_++)for(f=t+_,(64&e)>0&&(l=I._getStyleObject(f,-1)||Ve),d=0;d<o;d++){if(g=n+d,le._supportsCalc&&(2&e)>0&&I.getFormulaInformation&&(h=I.getFormulaInformation(f,g),h.hasFormula))if(h.isArrayFormula){if(p=h.baseRange,p.row===f&&p.col===g)for(m=p.row,v=p.row+Ue(p);m<v;m++)for(C=p.col,w=p.col+Ye(p);C<w;C++)R._setCellData(i,m-t,C-n,h,2)}else R._setCellData(i,_,d,h.formula,2);!((1&e)>0)||h&&h.hasFormula||R._setCellData(i,_,d,I.getValue(f,g,3),1),(16&e)>0&&I.getSparkline&&(y=I.getSparkline(f,g),S=Ve,y&&(S=y.data()),y&&S&&R._setCellData(i,_,d,y,16)),(64&e)>0&&(a?x=I.getActualStyle(f,g,3):(u=I._getStyleObject(f,g)||Ve,x=I._getCompositeStyle(f,g,3,u,l,s[d])),b=Oe,x&&x.toJSON&&(b=JSON.stringify(x.toJSON(3,!0))),R._setCellData(i,_,d,b,64)),T=I.comments,(4&e)>0&&T&&R._setCellData(i,_,d,T.get(f,g),4),(128&e)>0&&R._setCellData(i,_,d,I.getTag(f,g,3),128),(256&e)>0&&R._setCellData(i,_,d,I.getBindingPath&&I.getBindingPath(f,g,3),256)}}},_getCellsData:function(){return this._cellsData},_setCellData:function(e,t,n,r,o){!ge(r)&&e&&(e[t]===Oe&&(e[t]=[]),e[t][n]===Oe&&(e[t][n]={}),e[t][n][oe[o]]=r)},_mergeCellsHasDiffData:function(e){var t,n,r,o,i,a,l,s,u;if(e)for(t=this,n=t._cellsData,r=0,o=e.length;r<o;r++)if(i=e[r])for(a=0,l=i.length;a<l;a++)(s=i[a])&&(n[r]||(n[r]=[]),u=n[r][a],u?t._isDataEqual(s,u)&&(n[r][a]=Oe):n[r][a]=s)},_isDataEqual:function(e,t){var n,r,o,i=this._dataType,a=[];for(256&i&&a.push(oe[256]),4&i&&a.push(oe[4]),2&i&&a.push(oe[2]),16&i&&a.push(oe[16]),64&i&&a.push(oe[64]),128&i&&a.push(oe[128]),1&i&&a.push(oe[1]),n=0,r=a.length;n<r;n++)if(o=a[n],e[o]!==t[o])return!1;return!0},_getChangedCells:function(){var e,t,n,r,o,i=this,a=i._range.row,l=i._range.col,s=i._cellsData,u=i._changedCells;if(u&&u.length>0)return u;for(u=[],a=-1===a?0:a,l=-1===l?0:l,e=0,t=s.length;e<t;e++)if(n=s[e])for(r=0,o=n.length;r<o;r++)n[r]&&u.push({row:e+a,col:r+l});return i._changedCells=u,u}}),t._ChangedCells=bt;function Tt(){}De(Tt.prototype,{_defaultStyle:Ee("a"),_defaultColumnWidth:Ee("b"),_defaultRowHeight:Ee("c"),_tag:Ee("d"),_columnHeaderDefaultStyle:Ee("e"),_columnHeaderDefaultRowHeight:Ee("f"),_rowHeaderDefaultStyle:Ee("g"),_rowHeaderDefaultColumnWidth:Ee("h")});function Rt(e){var t=e;return function(e,n,r){var o=this;if(0===arguments.length)return o._ps?o._ps[t]:Oe;o._ps||(o._ps={}),o._ps[t]||(o._ps[t]=[]),o._ps[t].push(new xt(e,n,r))}}function At(e){return e&&e.length>0}function It(e,t){var n=this;n._rowCount=e,n._columnCount=t,n._spanSaved=!1}De(It.prototype,{_values:Rt("a"),_formulas:Rt("b"),_arrayFormulas:function(e){var t=this;if(0===arguments.length)return t._afs;t._afs||(t._afs=[]),Fe(e)&&t._afs.push(e)},_sparklines:Rt("c"),_styles:Rt("d"),_comments:Rt("e"),_tags:Rt("f"),_bindingPaths:Rt("g"),_spans:function(e){var t=this;if(0===arguments.length)return t._sps;t._sps||(t._sps=[]),t._sps.push(e)},_isValueOrFormulaSaved:function(){return this._isValueSaved()||this._isFormulaSaved()||this._isArrayFormulaSaved()},_isValueSaved:function(){return At(this._values())},_isFormulaSaved:function(){return At(this._formulas())},_isArrayFormulaSaved:function(){return At(this._arrayFormulas())},_isSparklineSaved:function(){return At(this._sparklines())},_isStyleSaved:function(){return At(this._styles())},_isCommentSaved:function(){return At(this._comments())},_isTagSaved:function(){return At(this._tags())},_isSpanSaved:function(){return this._spanSaved},_isBindingPathSaved:function(){return At(this._bindingPaths())}}),t._CopyMoveCellsInfo=It;function Mt(e,t){var n=t,r=e;return function(e,t){var o,i=this;if(1===arguments.length)return o=i._ps[r]?i._ps[r][e]:Ve,Fe(o)?o:n;Fe(t)&&(i._ps[r]||(i._ps[r]=[]),i._ps[r][e]=t)}}function Et(e){var t=e;return function(){var e=this._ps[t];return e&&e.length>0}}function Ft(e){var t=this;t._columnCount=e,t._levels={},t._collapsed={},t._rangeGroupSaved=!1,t._ps={}}De(Ft.prototype,{_width:Mt("a",0),_visible:Mt("b",!0),_resizable:Mt("c",!0),_tag:Mt("d",Oe),_viewportColumnStyle:Mt("e",Ve),_headerColumnStyle:Mt("f",Ve),_saveRangeGroup:function(e,t,n){var r=this;r._levels[e]!==Ve?r._levels[e]=t<0?Ve:t:t>=0&&(r._levels[e]=t),r._collapsed[e]!==Ve?r._collapsed[e]=n||Ve:n&&(r._collapsed[e]=n),r._rangeGroupSaved=!0},_getRangeGroup:function(e,t){var n=this;t.level=-1,t.collapsed=!1,n._levels[e]!==Ve&&(t.level=n._levels[e]),n._collapsed[e]!==Ve&&(t.collapsed=n._collapsed[e])},_bindingField:Mt("g",Oe),_isWidthSaved:Et("a"),_isVisibleSaved:Et("b"),_isResizableSaved:Et("c"),_isTagSaved:Et("d"),_isViewportColumnStyleSaved:Et("e"),_isHeaderColumnStyleSaved:Et("f"),_isRangeGroupSaved:function(){return this._rangeGroupSaved},_isBindingFieldSaved:Et("g")});function Dt(e){var t=this;t._rowCount=e,t._levels={},t._collapsed={},t._rangeGroupSaved=!1,t._ps={}}De(Dt.prototype,{_height:Mt("a",0),_visible:Mt("b",!0),_resizable:Mt("c",!0),_tag:Mt("d",Oe),_viewportRowStyle:Mt("e",Ve),_headerRowStyle:Mt("f",Ve),_saveRangeGroup:function(e,t,n){var r=this;r._levels[e]!==Ve?r._levels[e]=t<0?Ve:t:t>=0&&(r._levels[e]=t),r._collapsed[e]!==Ve?r._collapsed[e]=n||Ve:n&&(r._collapsed[e]=n),r._rangeGroupSaved=!0},_getRangeGroup:function(e,t){var n=this;t.level=-1,t.collapsed=!1,n._levels[e]!==Ve&&(t.level=n._levels[e]),n._collapsed[e]!==Ve&&(t.collapsed=n._collapsed[e])},_isHeightSaved:Et("a"),_isVisibleSaved:Et("b"),_isResizableSaved:Et("c"),_isTagSaved:Et("d"),_isViewportRowStyleSaved:Et("e"),_isHeaderRowStyleSaved:Et("f"),_isRangeGroupSaved:function(){return this._rangeGroupSaved}}),t._CopyMoveRowsInfo=Dt;function Nt(e,t,n,r,o,i,a,l){var s,u,c,_,f,d,h;for(s=0;s<o;s++)for(u=0;u<i;u++)3===t&&le._supportsCalc&&(2&a)>0&&e.getFormulaInformation&&(c=e.getFormulaInformation(n+s,r+u),c.hasFormula?c.isArrayFormula?c.baseRange.row===n+s&&c.baseRange.col===r+u&&l._arrayFormulas(c):l._formulas(s,u,c.formula):l._formulas(s,u,Ve)),(1&a)>0&&(_=e.getValue(n+s,r+u,t),l._values(s,u,_)),(64&a)>0&&l._styles(s,u,e._getStyleObject(n+s,r+u,t)),(128&a)>0&&l._tags(s,u,e.getTag(n+s,r+u,t)),3===t&&((16&a)>0&&e.getSparkline&&(f=e.getSparkline(n+s,r+u),d=Ve,f&&(d=f.data()),f&&d?l._sparklines(s,u,f.clone()):l._sparklines(s,u,Ve)),h=e.comments,(4&a)>0&&h&&l._comments(s,u,h.get(n+s,r+u)),(256&a)>0&&l._bindingPaths(s,u,e.getBindingPath&&e.getBindingPath(n+s,r+u,t)))}function Vt(){}Vt._saveSheetInfo=function(e,t,n){var r=e.defaults;(64&n)>0&&(t._defaultStyle(e.getDefaultStyle()),t._columnHeaderDefaultStyle(e.getDefaultStyle(1)),t._rowHeaderDefaultStyle(e.getDefaultStyle(2))),(128&n)>0&&t._tag(e.tag()),t._defaultColumnWidth(r.colWidth),t._defaultRowHeight(r.rowHeight),t._columnHeaderDefaultRowHeight(r.colHeaderRowHeight),t._rowHeaderDefaultColumnWidth(r.rowHeaderColWidth)},Vt._saveColumnHeaderInfo=function(e,t,n,r,o){var i,a,l,s=t._rowCount,u=t._columnCount;if(Nt(e,1,0,r,s,u,o,t),(1&o)>0)for(i=0;i<u;i++)(a=e.getDataColumnName&&e.getDataColumnName(r+i))&&n._bindingField(i,a);for((32&o)>0&&(t._spanSaved=!0,e._getSpanModel(1).each(0,r,s,u,function(e){t._spans(e)})),l=e.columnOutlines,u=n._columnCount,i=0;i<u;i++)n._width(i,e._getActualColumnWidth(r+i)),n._visible(i,e.getColumnVisible(r+i)),n._resizable(i,e.getColumnResizable(r+i)),(128&o)>0&&n._tag(i,e.getTag(-1,r+i)),(64&o)>0&&(n._viewportColumnStyle(i,e._getStyleObject(-1,r+i,3)),n._headerColumnStyle(i,e._getStyleObject(-1,r+i,1))),(8&o)>0&&l&&!l._isEmpty()&&n._saveRangeGroup(i,l.getLevel(r+i),l.getCollapsed(r+i))},Vt._saveColumnFooterInfo=function(e,t,n,r,o){var i=t._rowCount,a=t._columnCount;Nt(e,4,0,r,i,a,o,t),(32&o)>0&&(t._spanSaved=!0,e._getSpanModel(1).each(0,r,i,a,function(e){t._spans(e)}))},Vt._saveRowHeaderInfo=function(e,t,n,r,o){var i,a,l,s;if(!((1023&o)<=0))for(i=t._rowCount,a=t._columnCount,Nt(e,2,r,0,i,a,o,t),(32&o)>0&&(t._spanSaved=!0,e._getSpanModel(2).each(r,0,i,a,function(e){t._spans(e)})),l=e.rowOutlines,i=n._rowCount,s=0;s<i;s++)n._height(s,e._getActualRowHeight(r+s)),n._visible(s,e.getRowVisible(r+s)),n._resizable(s,e.getRowResizable(r+s)),(128&o)>0&&n._tag(s,e.getTag(r+s,-1)),(64&o)>0&&(n._viewportRowStyle(s,e._getStyleObject(r+s,-1,3)),n._headerRowStyle(s,e._getStyleObject(r+s,-1,2))),(8&o)>0&&l&&!l._isEmpty()&&n._saveRangeGroup(s,l.getLevel(r+s),l.getCollapsed(r+s))},Vt._saveViewportInfo=function(e,t,n,r,o){var i,a;(1023&o)<=0||(i=t._rowCount,a=t._columnCount,Nt(e,3,n,r,i,a,o,t),(32&o)>0&&(t._spanSaved=!0,e._getSpanModel().each(n,r,i,a,function(e){t._spans(e)})))},Vt._saveTableInfo=function(e,t,n){var r,o,i,a,l;if(e.tables&&(r=e.tables.all()))for(o=0,i=r.length;o<i;o++)a=r[o],n.containsRange(a.range())&&(l=a.clone(),l._copyDataSource(a),t.push(l))},Vt._undoCellsInfo=function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P=t._rowCount,L=t._columnCount,k=e.comments;et(e),Qe(e);try{for(_=0;_<P;_++)for(f=0;f<L;f++)t._isBindingPathSaved()&&e.setBindingPath&&e.setBindingPath(n+_,r+f,Ve,o),t._isFormulaSaved()&&3===o&&e.setFormula(n+_,r+f,Ve),t._isSparklineSaved()&&3===o&&e.removeSparkline(n+_,r+f),t._isValueSaved()&&e.setValue(n+_,r+f,Ve,o),t._isStyleSaved()&&e._setStyleObject(n+_,r+f,Ve,o),t._isCommentSaved()&&k&&k.remove(n+_,r+f),t._isTagSaved()&&e.setTag(n+_,r+f,Ve,o);if(t._isBindingPathSaved()&&e.setBindingPath)for(d=t._bindingPaths(),i=0;i<d.length;i++)h=d[i],e.setBindingPath(n+h.row,r+h.column,h.value,o);if(t._isValueSaved())for(g=t._values(),i=0;i<g.length;i++)p=g[i],e.setValue(n+p.row,r+p.column,p.value,o);if(t._isFormulaSaved()&&3===o)for(m=t._formulas(),i=0;i<m.length;i++)s=m[i],e.setFormula(n+s.row,r+s.column,s.value);if(t._isSparklineSaved()&&3===o)for(v=t._sparklines(),C=0;C<v.length;C++)w=v[C],y=w.value,y?y.dateAxisData()?e.setSparkline(n+w.row,r+w.column,y.data(),y.dataOrientation(),y.sparklineType(),y.setting(),y.dateAxisData(),y.dateAxisOrientation()):e.setSparkline(n+w.row,r+w.column,y.data(),y.dataOrientation(),y.sparklineType(),y.setting()):e.removeSparkline(n+w.row,r+w.column);if(t._isStyleSaved())for(S=t._styles(),i=0;i<S.length;i++)x=S[i],e._setStyleObject(n+x.row,r+x.column,x.value,o);if(t._isCommentSaved()&&k)for(b=t._comments(),i=0;i<b.length;i++)T=b[i],R=T.value,k._addInternal(n+T.row,r+T.column,R);if(t._isTagSaved())for(A=t._tags(),I=A.length,M=0;M<I;M++)E=A[M],e.setTag(n+E.row,r+E.column,E.value,o);if(le._supportsCalc&&t._isArrayFormulaSaved()&&3===o){if((F=e._getsArrayFormulas(n,r,P,L))&&F.length>0)for(u=F.getLength(0),c=0;c<u;c++)l=F[c][0],e.setArrayFormula(l.row,l.col,Ue(l),Ye(l),Ve);if((F=t._arrayFormulas())&&F.length>0)for(u=F.length,c=0;c<u;c++)D=F[c],N=D.baseRange,e.setArrayFormula(N.row,N.col,Ue(N),Ye(N),D.formula)}}finally{tt(e,!1),$e(e)}if(t._isSpanSaved()){if((V=e._getSpanModel(o))&&V.length>0)for(O=[],V.each(n,r,P,L,function(e){e&&O.push(e)}),i=0;i<O.length;i++)a=O[i],V.remove(a);if(V&&(H=t._spans()))for(i=0;i<H.length;i++)a=H[i],V.addSpan(a)}},Vt._undoColumnsInfo=function(e,t,n){var r,o,i,a,l=t._columnCount;if(t._isBindingFieldSaved()&&e.bindColumn)for(r=0;r<l;r++)(o=t._bindingField(r))&&e.bindColumn(n+r,o);for(r=0;r<l;r++)t._isWidthSaved()&&e.setColumnWidth(n+r,t._width(r),3),t._isVisibleSaved()&&e.setColumnVisible(n+r,t._visible(r),3),t._isResizableSaved()&&e.setColumnResizable(n+r,t._resizable(r),3),t._isTagSaved()&&e.setTag(-1,n+r,t._tag(r),3),t._isViewportColumnStyleSaved()&&e._setStyleObject(-1,n+r,t._viewportColumnStyle(r),3),t._isHeaderColumnStyleSaved()&&e._setStyleObject(-1,n+r,t._headerColumnStyle(r),1);if(t._isRangeGroupSaved()&&(i=e.columnOutlines))for(a={level:Ve,collapsed:Ve},r=0;r<l;r++)t._getRangeGroup(r,a),i._setLevel(n+r,a.level),i.setCollapsed(n+r,a.collapsed)},Vt._undoRowsInfo=function(e,t,n){var r,o,i,a=t._rowCount;for(r=0;r<a;r++)t._isHeightSaved()&&e.setRowHeight(n+r,t._height(r),3),t._isVisibleSaved()&&e.setRowVisible(n+r,t._visible(r),3),t._isResizableSaved()&&e.setRowResizable(n+r,t._resizable(r),3),t._isTagSaved()&&e.setTag(n+r,-1,t._tag(r),3),t._isViewportRowStyleSaved()&&e._setStyleObject(n+r,-1,t._viewportRowStyle(r),3),t._isHeaderRowStyleSaved()&&e._setStyleObject(n+r,-1,t._headerRowStyle(r),2);if(t._isRangeGroupSaved()&&(o=e.rowOutlines))for(i={level:Ve,collapsed:Ve},r=0;r<a;r++)t._getRangeGroup(r,i),o._setLevel(n+r,i.level),o.setCollapsed(n+r,i.collapsed)},Vt._undoSheetInfo=function(e,t){var n=t._defaultStyle(),r=e.defaults;Fe(n)&&e.setDefaultStyle(n),n=t._defaultColumnWidth(),Fe(n)&&(r.colWidth=n),n=t._defaultRowHeight(),Fe(n)&&(r.rowHeight=n),n=t._tag(),Fe(n)&&e.tag(n),n=t._columnHeaderDefaultStyle(),Fe(n)&&e.setDefaultStyle(n,1),n=t._columnHeaderDefaultRowHeight(),Fe(n)&&(r.colHeaderRowHeight=n),n=t._rowHeaderDefaultStyle(),Fe(n)&&e.setDefaultStyle(n,2),n=t._rowHeaderDefaultColumnWidth(),Fe(n)&&(r.rowHeaderColWidth=n)},Vt._undoTableInfo=function(e,t,n){var r,o,i,a,l=e.tables;if(l)if((o=t.length)>0)for(r=0;r<o;r++)i=t[r],l._addInternal(i);else if(a=l.all())for(r=a.length-1;r>=0;r--)i=a[r],n.containsRange(i.range())&&l._removeInternal(i)},Vt._getValues=function(e,t,n,r,o){var i,a,l,s;for(t<0&&(t=0,r=We(e)),n<0&&(n=0,o=ze(e)),i=[],a=0;a<r;a++)for(l=0;l<o;l++)(s=e.getValue(t+a,n+l))!==Oe&&s!==Ve&&i.push(new xt(a,l,s));return i},Vt._raiseRangeDataChanged=function(e,t,n,r,o,i,a){e&&(t<0&&(t=0,r=We(e)),n<0&&(n=0,o=ze(e)),e._raiseRangeDataChanged(t,n,r,o,i,a))},Vt._clearFormula=function(e,t,n,r,o){var i=e._getCalcModel();i&&i.clear(t,n,r,o)},t._CopyMoveHelper=Vt;function Ot(e,t){Je(e),t||Qe(e)}function Ht(e,t){t||$e(e),qe(e)}function Pt(){}Pt.prototype={constructor:Pt,execute:function(){},canExecute:function(){return!0},canUndo:function(){return!0},saveState:function(){},undo:function(){return!0},_beforeAction:Ot,_afterAction:Ht},t.ActionBase=Pt,Ne(Lt,Pt);function Lt(e,t){var n=this;Pt.call(n),n._sheet=e,n._command=t,t._oldSizes=t._oldSizes||[],t._oldVisibles=t._oldVisibles||[]}De(Lt.prototype,{_doAction:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x=this,b=!1;if((e?x.canUndo():x.canExecute())&&(t=x._command,n=x._sheet,r=t.columns,o=t.rowHeader,i=r&&r.length,a=ke,n&&i>0)){if(l=x._getColList(r),s={sheet:n,sheetName:n._name,colList:l,header:o,cancel:!1},n._trigger(ye,s),s&&!0===s.cancel)return n._invalidate(),b;t._canUndo=!0,e||x.saveState(),Ot(n);try{for(u=2,c=3,_=o?ze(n,u):ze(n,c),f=n._scrollLeftCol,d=f,h=n.frozenColumnCount(),g=f-1;g>=h&&!(n.getColumnVisible(g)&&n._getZoomColumnWidth(g)>0);g--)n.getColumnResizable(g)&&(d=g);for(p=a,m=t.size,v=0;v<i;v++)for(C=r[v],w=C.firstCol,y=C.lastCol,S=w;S<=y;S++)0<=S&&S<_&&(e&&(m=t._oldSizes[v][S-w]),o&&n.getColumnResizable(S,u)&&m!==n._getActualColumnWidth(S,u)?(n.setColumnWidth(S,m,u),b=!0):!o&&n.getColumnResizable(S,c)&&m!==n._getActualColumnWidth(S,c)&&(n.setColumnWidth(S,m,c),b=!0),p=He(S,p));p!==a&&p<=f&&d!==f&&(n._scrollLeftCol=d)}finally{Ht(n,!1)}n._trigger(Se,{sheet:n,sheetName:n._name,colList:l,header:t.rowHeader}),n._syncHScrollbarPosition()}return b},execute:function(){return this._doAction(!1)},saveState:function(){var e,t,n,r,o,i,a,l,s,u,c,_=this,f=_._command,d=[],h=_._sheet,g=f.columns,p=g&&g.length;if(h&&p>0)for(e=f.rowHeader,t=e?2:3,n=ze(h,t),r=e?h.defaults.rowHeaderColWidth:h.defaults.colWidth,o=0;o<p;o++)for(i=g[o],a=i.firstCol,l=i.lastCol,d[o]=[],c=a;c<=l;c++)s=c-a,0<=c&&c<n?(u=h.getColumnWidth(c,t),u=Be(u)||u===Ve?r:Le(u),d[o][s]=u):d[o][s]=-1;f._oldSizes=d},undo:function(){return this._doAction(!0)},_getColList:function(e){var t,n,r,o,i,a,l=[];for(t=0,n=e.length;t<n;t++)for(r=e[t],o=r.firstCol,i=r.lastCol,a=o;a<=i;a++)l.push(a);return l},canUndo:function(){return this._command._canUndo}}),Ne(kt,Pt);function kt(e,t){var n=this;Pt.call(n),n._sheet=e,n._command=t,t._oldSizes=t._oldSizes||[]}De(kt.prototype,{_doAction:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x=this,b=!1;if((e?x.canUndo():x.canExecute())&&(t=x._sheet,n=x._command,r=n.rows,o=r&&r.length,i=ke,t&&o>0)){if(a=x._getRowList(r),l={sheet:t,sheetName:t._name,rowList:a,header:n.columnHeader,cancel:!1},t._trigger(xe,l),l&&!0===l.cancel)return t._invalidate(),b;n._canUndo=!0,e||x.saveState(),Ot(t);try{for(s=3,u=1,c=n.columnHeader,_=c?We(t,u):We(t,s),f=t._scrollTopRow,d=f,h=t.frozenRowCount(),g=f-1;g>=h&&!(t.getRowVisible(g)&&t._getZoomRowHeight(g)>0);g--)t.getRowResizable(g)&&(d=g);for(p=i,m=n.size,v=0;v<o;v++)for(C=r[v],w=C.firstRow,y=C.lastRow,S=w;S<=y;S++)0<=S&&S<_&&(e&&(m=n._oldSizes[v][S-w]),c&&t.getRowResizable(S,u)&&m!==t._getActualRowHeight(S,u)?(t.setRowHeight(S,m,u),b=!0):!c&&t.getRowResizable(S,s)&&m!==t._getActualRowHeight(S,s)&&(t.setRowHeight(S,m,s),b=!0),p=He(S,p));p!==i&&p<=f&&d!==f&&(t._scrollTopRow=d)}finally{Ht(t,!1)}t._trigger(be,{sheet:t,sheetName:t._name,rowList:a,header:n.columnHeader}),t._syncVScrollbarPosition()}return b},execute:function(){return this._doAction(!1)},saveState:function(){var e,t,n,r,o,i,a,l,s,u,c,_=this,f=_._command,d=[],h=_._sheet,g=f.rows,p=g&&g.length;if(h&&p>0)for(e=f.columnHeader,t=e?1:3,n=We(h,t),r=e?h.defaults.colHeaderRowHeight:h.defaults.rowHeight,o=0;o<p;o++)for(i=g[o],a=i.firstRow,l=i.lastRow,d[o]=[],c=a;c<=l;c++)s=c-a,0<=c&&c<n?(u=h.getRowHeight(c,3),u=Be(u)||u===Ve?r:Le(u),d[o][s]=u):d[o][s]=-1;f._oldSizes=d},undo:function(){return this._doAction(!0)
},_getRowList:function(e){var t,n,r,o,i,a,l=[];for(t=0,n=e.length;t<n;t++)for(r=e[t],o=r.firstRow,i=r.lastRow,a=o;a<=i;a++)l.push(a);return l},canUndo:function(){return this._command._canUndo}}),Ne(Bt,Pt);function Bt(e,t){var n=this,r=e.parent;Pt.call(n),n._sheet=e,n._command=t,n._sheetArea=t.rowHeader?2:3,Fe(t.autoFitType)||(t.autoFitType=r?r.options.autoFitType:0),t._oldSizes=t._oldSizes||[]}De(Bt.prototype,{canExecute:function(){var e=this._command;return this._sheet&&e.columns&&e.columns.length>0},_doAction:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g=this,p=!1;if(e?g.canUndo():g.canExecute()){if(t=g._command,n=g._sheet,r=g._sheetArea,o=g._getColList(t.columns),i=2===r,a={sheet:n,sheetName:n.name(),colList:o,header:i,cancel:!1},n._trigger(ye,a),a&&!0===a.cancel)return n._invalidate(),p;for(t._canUndo=!0,e||g.saveState(),l=ze(n,r),s=l-1,u=0,_=0,f=t.columns.length;_<f;_++)c=t.columns[_].col,s=s>c?c:s,u=u<c?c:u;Ae._startCache(n,0,s,We(n)-1,u),Ot(n);try{for(_=0,f=t.columns.length;_<f;_++)0<=(h=t.columns[_].col)&&h<l&&n.getColumnResizable(h,r)&&(d=e?t._oldSizes[_]:g._getColumnAutoFitValue(h))!==n.getColumnWidth(h,r)&&(n.setColumnWidth(h,d,r),p=!0)}finally{Ae._clearCache(),Ht(n,!1)}n._trigger(Se,{sheet:n,sheetName:n._name,colList:o,header:i})}return p},execute:function(){return this._doAction(!1)},saveState:function(){var e,t,n,r,o=this,i=o._command,a=Ve,l=o._sheet,s=o._sheetArea;if(l&&i.columns&&i.columns.length>0)for(e=ze(l,s),a=[i.columns.length],t=0,n=i.columns.length;t<n;t++)r=i.columns[t],0<=r.col&&r.col<e?a[t]=l.getColumnWidth(r.col,s):a[t]=-1;i._oldSizes=a},undo:function(){return this._doAction(!0)},_getColList:function(e){var t,n,r=[];for(t=0;t<e.length;t++)n=e[t],r.push(n.col);return r},_getColumnAutoFitValue:function(e){return Ie._getColumnAutoFitValue(e,this._sheet,this._sheetArea,this._command.autoFitType)},canUndo:function(){return this._command._canUndo}}),Ne(Wt,Pt);function Wt(e,t){var n=this,r=e.parent;Pt.call(n),n._sheet=e,n._command=t,n._sheetArea=t.columnHeader?1:3,Fe(t.autoFitType)||(t.autoFitType=r?r.options.autoFitType:0),t._oldSizes=t._oldSizes||[]}De(Wt.prototype,{canExecute:function(){var e=this._command;return this._sheet&&e.rows&&e.rows.length>0},_doAction:function(e){var t,n,r,o,i,a,l,s,u,c,_,f=this,d=!1;if(e?f.canUndo():f.canExecute()){if(t=f._command,n=f._sheet,r=f._getRowList(t.rows),o=f._sheetArea,i=1===f._sheetArea,a={sheet:n,sheetName:n._name,rowList:r,header:i,cancel:!1},n._trigger(xe,a),a&&!0===a.cancel)return n._invalidate(),d;t._canUndo=!0,e||f.saveState(),Ot(n);try{for(l=We(n,o),u=0,c=t.rows.length;u<c;u++)0<=(_=t.rows[u].row)&&_<l&&n.getRowResizable(_,o)&&(s=e?t._oldSizes[u]:f._getRowAutoFitValue(_))!==n.getRowHeight(_,o)&&(n.setRowHeight(_,s,o),d=!0)}finally{Ht(n,!1)}n._trigger(be,{sheet:n,sheetName:n._name,rowList:r,header:i})}return d},execute:function(){return this._doAction(!1)},saveState:function(){var e,t,n,r,o=this,i=o._command,a=Ve,l=o._sheet,s=o._sheetArea;if(l&&i.rows&&i.rows.length>0)for(a=[i.rows.length],e=We(l,s),t=0,n=i.rows.length;t<n;t++)r=i.rows[t],0<=r.row&&r.row<e?a[t]=l.getRowHeight(r.row,s):a[t]=-1;i._oldSizes=a},undo:function(){return this._doAction(!0)},_getRowList:function(e){var t,n,r,o=[];for(t=0,n=e.length;t<n;t++)r=e[t],o.push(r.row);return o},_getRowAutoFitValue:function(e){return Ie._getRowAutoFitValue(e,this._sheet,this._sheetArea,this._command.autoFitType)},canUndo:function(){return this._command._canUndo}}),Ne(zt,Pt),ie=".cellEditAction";function zt(e,t){var n,r,o=this;Pt.call(o),o._command=t,t._oldValueCache=t._oldValueCache||{},t._oldValueIsFormulaCache=t._oldValueIsFormulaCache||{},t._oldQuotePrefixCache=t._oldQuotePrefixCache||{},t._oldwordWrapCache=t._oldwordWrapCache||{},t._oldRowHeightCache=t._oldRowHeightCache||{},o._sheet=e,le._supportsCalc&&t.ranges&&1===t.endEditType&&(n=e._getActualRange(t.ranges[0]),t.ranges[0]=n,1===Ue(n)&&1===Ye(n)&&(r=e._getsArrayFormulas(n.row,n.col,1,1))&&r.ranges&&r.ranges.length>0&&(t.ranges=[r.ranges[0]]))}De(zt.prototype,{canExecute:function(){var e,t,n=this,r=n._sheet,o=n._command,i=o.ranges,a=o.row,l=o.col;if(i){for(e=0;e<i.length;e++)if(t=i[e],!r._canChange(t.row,t.col,Ue(t),Ye(t)))return!1}else if(!r._canChange(a,l,1,1))return!1;return!0},saveState:function(){var e=this,t=e._sheet,n=e._command;e._iteration(function(r,o){var i,a,l=le._supportsCalc&&t.getFormulaInformation(r,o),s=e._positionToString(r,o);l&&l.hasFormula?!l.isArrayFormula||l.baseRange.row===r&&l.baseRange.col===o?(n._oldValueCache[s]=l.formula,n._oldValueIsFormulaCache[s]=l):n._oldValueIsFormulaCache[s]=!1:(n._oldValueCache[s]=t.getValue(r,o),i=t.getStyle(r,o),i&&(n._oldQuotePrefixCache[s]=i.quotePrefix,n._oldwordWrapCache[s]=i.wordWrap),a=t._getRowInfos(3).getSize(r),a=null===a?void 0:a,n._oldRowHeightCache[r]=a)})},_iteration:function(e){var t,n,r,o,i=this,a=i._command,l=a.ranges;if(l)for(t=0;t<l.length;t++)for(n=l[t],r=n.row;r<n.row+Ue(n);r++)for(o=n.col;o<n.col+Ye(n);o++)e(r,o);else e(a.row,a.col)},undo:function(){var e,t,n,r,o=this;if(o.canUndo()){e=o._sheet,t=o._command,Ot(e,!0);try{e._bind(we+ie,function(t,n){"value"===n.propertyName&&e._raiseValueChanged(n.row,n.col,n.oldValue,n.newValue)}),o._iteration(function(n,r){var i,a,l,s,u=o._positionToString(n,r),c=!!le._supportsCalc&&t._oldValueIsFormulaCache[u];c?c.isArrayFormula?e.setArrayFormula(n,r,Ue(c.baseRange),Ye(c.baseRange),c.formula):e.setFormula(n,r,t._oldValueCache[u]):(c=le._supportsCalc?e.getFormulaInformation(n,r):Ve,c&&(c.isArrayFormula?e.setArrayFormula(n,r,Ue(c.baseRange),Ye(c.baseRange),Ve):e.setFormula(n,r,Ve)),e.setValue(n,r,t._oldValueCache[u]),i=e.getStyle(n,r),a=t._oldQuotePrefixCache[u],l=t._oldwordWrapCache[u],!i||i.quotePrefix===a&&i.wordWrap===l||(i.quotePrefix!==a&&(i.quotePrefix=a),i.wordWrap!==l&&(i.wordWrap=l),e.setStyle(n,r,i)),s=t._oldRowHeightCache[n],e.getRowHeight(n)!==s&&e.setRowHeight(n,s))})}catch(e){return!1}finally{e._unbind(we+ie),Ht(e,!0)}return n=e._getSheetLayout(),r=new Re(n._frozenX,n._frozenY,n.width-n._frozenX,n.height-n._frozenY),e.repaint(r),!0}return!1},execute:function(){var e,t,n,r=this,o=!1;if(r.canExecute()){r.saveState(),e=r._sheet,Ot(e,!0);try{e._bind(we+ie,function(t,n){"value"===n.propertyName&&e._raiseValueChanged(n.row,n.col,n.oldValue,n.newValue)}),r._command.applyResult=r._applyEditing(),o=!0}finally{e._unbind(we+ie),Ht(e,!0)}t=e._getSheetLayout(),n=new Re(t._frozenX,t._frozenY,t.width-t._frozenX,t.height-t._frozenY),e.repaint(n)}return o},_positionToString:function(e,t){return e+"_"+t},_validateEditingValue:function(e){var t,n,r,o,i,a,l=this,s=0,u=l._sheet,c=l._command,_=c.row,f=c.col,d=c.newValue,h=!c.hasOwnProperty("autoFormat")||c.autoFormat;return le._supportsCalc&&d&&d.length>0&&"="===d[0]?u.getDataValidator&&u.getDataValidator(_,f)&&""!==(t=d.substring(1))&&t!==u.getFormula(_,f)&&(n=u._getCalcServiceInternal())&&(r=n.parse(u._getSheetSource(),t,_>=0?_:0,f>=0?f:0,!0))&&(o=n._evaluateParsedFormula(u._getSheetSource(),r,{row:_,col:f}),u.isValid&&!u.isValid(_,f,o)&&(s=u._validationError(_,f))):(i=l._getValueFromEditing(_,f,d,h,e),(a=!u.isValid||u.isValid(_,f,i))||(s=u._validationError(_,f),u._eventHandler._forceCancelSelectiong=!0)),s},_applyEditing:function(){var e,t,r,o,i,a,l,s,u,c,_,f=this,d=f._sheet,h=f._command,g=h.newValue,p={_isAutoFormatChanged:!1,_isQuotePrefixChanged:!1,_isWordWrapChanged:!1,_storedStyle:Ve},m=f._validateEditingValue(p);if(1===m||2===m)return m;if(t=!h.hasOwnProperty("autoFormat")||h.autoFormat,r=h.row,r=r>=0?r:0,o=h.col,o=o>=0?o:0,i=n(2),a=le._supportsCalc&&i&&i.Parser)if(l=d.parent,s=l&&l.options.allowUserEditFormula,u=d._getCalcServiceInternal(),s&&u&&g&&g.length>0&&"="===g[0])try{if(h.ranges&&1===h.endEditType)return _=h.ranges[0],d.setArrayFormula(_.row,_.col,Ue(_),Ye(_),g.substring(1)),m;c=u.parse(d._getSheetSource(),g.substring(1),r,o,!0)}catch(e){throw d._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}else h.ranges&&1===h.endEditType&&(_=h.ranges[0],d.getRange(_.row,_.col,Ue(_),Ye(_),3).clear(1));return c||(g&&"'"===g[0]?f._setQuotePrefix(r,o,!0,p):f._setQuotePrefix(r,o,Oe,p),g&&(g.indexOf("\r")>=0||g.indexOf("\n")>=0)&&f._setWordWrap(r,o,p),e=f._getValueFromEditing(r,o,g,t,p)),f._iteration(function(t,n){if(c)try{d._setFormulaCore(t,n,u.unparse(d._getSheetSource(),c,t,n),c),d._trigger(Ce.UserFormulaEntered,{sheet:d,sheetName:d._name,row:t,col:n,formula:g.substring(1).toUpperCase()})}catch(e){throw d._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}else{try{d.hasFormula&&d.hasFormula(t,n)&&d.setFormula(t,n,Ve)}catch(e){throw d._raiseInvalidOperation(0,"string"==typeof e?e:e.message),e}try{d._setValueInternal(t,n,e)}catch(e){d.setValue(t,n,g)}}}),(p._isAutoFormatChanged||p._isQuotePrefixChanged||p._isWordWrapChanged)&&d.setStyle(r,o,p._storedStyle),Ut(d,r),m},canUndo:function(){return 0===this._command.applyResult},_getValueFromEditing:function(e,t,n,r,o){var i,a,l,s,u,c,_=this,f=_._sheet,d=_._command,h=f.getActualStyle(e,t),g={};return i=n&&"'"===n[0]?n.substring(1):Ie._parseText2Value(h,n,r,g,d.editingFormatter),a=g.value,r&&a&&(l=Ve,(i!==Ve&&"General"!==a.formatString()||!h._autoFormatter)&&(a.isAuto=!0,l=a),l&&(o._isAutoFormatChanged=!0,s=o._storedStyle||f._getStyleObject(e,t),u="string"==typeof s,s&&!u||(c=new _e,u&&(c.parentName=s),s=c),s._autoFormatter=l,o._storedStyle=s)),i},_setQuotePrefix:function(e,t,n,r){var o,i=this,a=i._sheet,l=r._storedStyle||a._getStyleObject(e,t),s="string"==typeof l;l&&!s||(o=new _e,s&&(o.parentName=l),l=o),l.quotePrefix!==n&&(r._isQuotePrefixChanged=!0,l.quotePrefix=n,r._storedStyle=l)},_setWordWrap:function(e,t,n){var r,o=this,i=o._sheet,a=n._storedStyle||i._getStyleObject(e,t),l="string"==typeof a;a&&!l||(r=new _e,l&&(r.parentName=a),a=r),a.wordWrap||(n._isWordWrapChanged=!0,a.wordWrap=!0,n._storedStyle=a)}});function Ut(e,t){var n=Ie._getRowAutoFitValue(t,e,3,e.parent.options.autoFitType),r=e.getRowHeight(t),o=e.getMinHeight(t)||e.defaults.rowHeight;n=n<o?o:n,r!==n&&e.setAutoHeight(t,n)}function Yt(e,t){e._setNameCore(t);var n=e.parent,r=n&&n._tab;r&&r.repaint()}Ne(Gt,Pt);function Gt(e,t){var n=this;Pt.call(n),n._sheet=e,n._command=t}De(Gt.prototype,{canUndo:function(){return!!this._command._oldName},canExecute:function(){var e=this,t=e._command;return e._sheet&&t.name&&t.name!==t._oldName},execute:function(){var e=this,t=e._sheet,n=e._command,r=n.name,o=!1;return e.canExecute()&&t&&r&&r!==n._oldName&&(e.saveState(),Yt(t,r),o=!0,n.sheetName=r),o},saveState:function(){this._sheet&&(this._command._oldName=this._sheet.name())},undo:function(){var e,t=this;return!(!t.canUndo()||!(e=t._sheet))&&(Yt(e,t._command._oldName),t._command.sheetName=t._command._oldName,!0)}}),Ne(Xt,Pt);function Xt(e,t){var n=this;Pt.call(n),n._sheet=e,n._command=t}function jt(e,t){return!(!0===e.isEditing()&&!e.endEdit())&&(e.suspendPaint(),e.zoom(t),e.resumePaint(),!0)}De(Xt.prototype,{canExecute:function(){var e=this;return e._sheet&&e._sheet.parent.options.allowUserZoom&&e._sheet._zoomFactor!==e._command.zoomFactor},execute:function(){var e=this,t=e._command,n=!1;return e.canExecute()&&(e.saveState(),n=jt(e._sheet,t.zoomFactor)),n},saveState:function(){this._sheet&&(this._command.oldZoomFactor=this._sheet._zoomFactor)},undo:function(){var e=this._sheet;if(this.canUndo())return e&&jt(e,this._command.oldZoomFactor)}});function Kt(e,t){this.value=e,this.formulaInfo=t}Ne(Zt,Pt),ae=".clearRangeAction";function Zt(e,t){var n=this;Pt.call(n),n._sheet=e,n._command=t}De(Zt.prototype,{execute:function(){var e,t,n,r,o,i,a,l,s=this;if(s.canExecute()&&(s.saveState(),(e=s._sheet)&&(t=e._getActualRange(s._command.clearRange),n=t.row,r=t.col,o=Ue(t),i=Ye(t),i>0&&o>0)))try{for(e._bind(we+ae,function(t,n){"value"===n.propertyName&&e._raiseValueChanged(n.row,n.col,n.oldValue,n.newValue)}),Ot(e),e.getRange(n,r,o,i,3).clear(1),a=n;a<n+o;a++)Ut(e,a);Ht(e),l=s._command._changedCells,Vt._raiseRangeDataChanged(e,n,r,o,i,l?l._getChangedCells():[],2)}finally{e._unbind(we+ae)}},canExecute:function(){var e=this._command.clearRange;return this._sheet._canChange(e.row,e.col,Ue(e),Ye(e))},canUndo:function(){return!!this._command._cachedValues},saveState:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m=this,v=m._sheet,C=m._command.clearRange,w=m._command._cachedFilteredColumns=[];if(v){if(e=m._command._cachedTables=[],v.tables&&(t=v.tables.all())&&t.length>0)for(n=0;n<t.length;n++)r=t[n],C.containsRange(r.range())&&e.push(r);if(v.rowFilter&&(o=v.rowFilter())&&o.range&&o.isFiltered()&&(i=o.range.row,l=Ue(o.range),o.filterButtonVisible&&o.filterButtonVisible()&&(i=o.range.row-1,l=Ue(o.range)+1,i<0&&(i=-1,l=-1)),(-1===C.row||C.row<=i&&i+l<=C.row+Ue(C))&&(-1===C.col||C.col<=o.range.col&&o.range.col+Ye(o.range)<=C.col+Ye(C))))for(a=o.range.col<0?0:o.range.col,s=Ye(o.range)<0?ze(v):Ye(o.range),u=0;u<s;u++)o.isFiltered(a+u)&&w.push(a+u);if(c=v._getActualRange(C),Ye(c)>0&&Ue(c)>0)for(_=m._command._cachedValues=[c.row+Ue(c)],f=0;f<Ue(c);f++)for(i=c.row+f,_[i]=[c.col+Ye(c)],d=v._getRowInfos(3).getSize(i),d=null===d?void 0:d,_[i].rowHeight=d,h=0;h<Ye(c);h++)a=c.col+h,g=le._supportsCalc&&v.getFormulaInformation(i,a),g&&g.hasFormula?!g.isArrayFormula||g.baseRange.row===i&&g.baseRange.col===a?_[i][a]=new Kt(g.formula,g):_[i][a]=-1:(p=v.getValue(i,a))!==Oe&&p!==Ve&&(_[i][a]=new Kt(p,Oe));v.isDirtySuspended()||(m._command._changedCells=new bt(v,v._getActualRange(C),3))}},undo:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S=this,x=S._sheet;if(S.canUndo()&&x){if(e=!1,(n=S._command._cachedTables)&&n.length>0)for(r=n,o=r.length,i=x.tables,t=0;t<o;t++)a=r[t],l=a.range(),i._checkCanAddTable(x,a.name(),l.row,l.col,Ue(l),Ye(l))&&i._addInternal(a);if(s=x._getActualRange(S._command.clearRange),(u=S._command._cachedValues)&&Ye(s)>0&&Ue(s)>0){Ot(x);try{for(x._bind(we+ae,function(e,t){"value"===t.propertyName&&x._raiseValueChanged(t.row,t.col,t.oldValue,t.newValue)}),c=Ue(s),_=Ye(s),t=0;t<c;t++)for(f=s.row+t,d=u[f].rowHeight,x.getRowHeight(f)!==d&&x.setAutoHeight(f,d),h=0;h<_;h++)g=s.col+h,-1!==(p=u[f][g])&&(p?p.formulaInfo?(m=p.formulaInfo,m&&m.isArrayFormula?x.setArrayFormula(f,g,Ue(m.baseRange),Ye(m.baseRange),m.formula):x.setFormula(f,g,p.value)):(le._supportsCalc&&x.setFormula(f,g,Ve),x.setValue(f,g,p.value)):(le._supportsCalc&&x.setFormula(f,g,Ve),x.setValue(f,g,Ve)));e=!0}finally{Ht(x),x._unbind(we+ae)}}if(e&&(v=S._command._changedCells,Vt._raiseRangeDataChanged(x,s.row,s.col,Ue(s),Ye(s),v?v._getChangedCells():[],2)),w=S._command._cachedFilteredColumns,x.rowFilter&&(C=x.rowFilter())&&w&&w.length>0)for(t=0;t<w.length;t++)y=w[t],C.filter(y);if(e)return x.repaint(),!0}return!1}}),Ne(Jt,Pt);function Jt(e,t,n){var r,o,i=this;if(Pt.call(i),i._sheet=e,i._command=t,!n&&(t._cachedActions=[],(r=t.ranges)&&r.length>0))for(o=0;o<r.length;o++)t._cachedActions[o]=new Zt(e,{clearRange:r[o]})}De(Jt.prototype,{canExecute:function(){var e,t,n=this._command._cachedActions;if(n){for(e=0;e<n.length;e++)if(t=n[e],!t.canExecute())return!1;return!0}return!1},execute:function(){var e,t,n,r,o=this;if(o.canExecute()&&(e=o._command._cachedActions,t=o._sheet,o.saveState(),e)){for(Ot(t,!0),n=0;n<e.length;n++)r=e[n],r.execute();return Ht(t,!0),!0}return!1},canUndo:function(){var e,t,n=this._command._cachedActions;if(n){for(e=0;e<n.length;e++)if(t=n[e],!t.canUndo())return!1;return!0}return!1},saveState:function(){var e,t,n=this._command._cachedActions;if(n)for(e=0;e<n.length;e++)t=n[e],t.saveState()},undo:function(){var e,t,n,r,o=this,i=o._command._cachedActions;if(o.canUndo()){for(e=o._sheet,t=i.length-1;t>=0;t--)if(n=i[t],Ot(e,!0),r=n.undo(),Ht(e,!0),!r)return!1;return!0}return!1}}),t._ClearValueUndoAction=Jt;function qt(e){Vt._undoTableInfo(e.sheet,e.data,e.range)}function Qt(e){Vt._undoRowsInfo(e.sheet,e.data,e.row)}function $t(e){Vt._undoColumnsInfo(e.sheet,e.data,e.col)}function en(e){Vt._undoCellsInfo(e.sheet,e.data,e.row,e.col,e.sheetArea)}function tn(e,t){return t&&t.undo?(t.undo.call(e,t),1):0}t._performUndo=tn;function nn(e,t,n,r){var o,i=new It(We(e,1),n),a=new Ft(n);return Vt._saveColumnHeaderInfo(e,i,a,t,r),o={},o.headerCells={sheet:e,data:i,row:0,col:t,undo:en,sheetArea:1},o.columns={sheet:e,data:a,col:t,undo:$t},o}t._saveColumnHeaderInfo=nn,t._saveColumnFooterInfo=function(e,t,n,r){var o,i=new It(We(e,4),n),a=new Ft(n);return Vt._saveColumnFooterInfo(e,i,a,t,r),o={},o.footerCells={sheet:e,data:i,row:0,col:t,undo:en,sheetArea:4},o};function rn(e,t,n,r,o,i){var a=new It(r,o);return Vt._saveViewportInfo(e,a,t,n,i),{sheet:e,data:a,row:t,col:n,undo:en,sheetArea:3}}t._saveViewportInfoForDragDrop=rn;function on(e,t,n,r,o){var i=[],a=new Te(t,n,r,o);return Vt._saveTableInfo(e,i,a),{sheet:e,data:i,range:a,undo:qt}}t._saveTableInfo=on;function an(e,n,r,o){var i,a=new It(r,ze(e,2)),l=new t._CopyMoveRowsInfo(r);return Vt._saveRowHeaderInfo(e,a,l,n,o),i={},i.headerCells={sheet:e,data:a,row:n,col:0,undo:en,sheetArea:2},i.rows={sheet:e,data:l,row:n,undo:Qt},i}t._saveRowHeaderInfo=an;function ln(e){var t=e.sheet;t.deleteRows(e.rowCount,We(t)-e.rowCount),t.setColumnCount(e.colCount)}function sn(e){return{sheet:e,rowCount:e.getRowCount(),colCount:e.getColumnCount(),undo:ln}}Ne(un,Pt);function un(e,t){var n=this;Pt.call(n),n._sheet=e,n._command=t}De(un.prototype,{canExecute:function(){var e=this,t=e._sheet,n=e._command.pasteExtent,r=n.targetRange,o=n.sourceRange;return t._canChange(r.row,r.col,Ue(r),Ye(r))&&(!n.isCutting||t._canChange(o.row,o.col,Ue(o),Ye(o)))},saveState:function(){var e,n,r,o,i,a,l,s,u,c,_,f=this,d=f._command.pasteExtent,h=f._command._state={},g=d.isCutting,p=un._convertPasteOption(f._command.pasteOption),m=d.sourceRange,v=d.targetRange,C=f._command.fromSheet,w=f._command.toSheet;C&&m&&g&&(n=m.row<0?0:m.row,r=m.col<0?0:m.col,o=m.row<0?We(C):Ue(m),i=m.col<0?ze(C):Ye(m),m.row<0&&m.col<0&&v.row<0&&v.col<0&&C._name!==w._name&&(a=new Tt,Vt._saveSheetInfo(C,a,p),h._savedFromSheetInfo=a),m.row<0&&(e=nn(C,r,i,p),h._savedFromColumnHeaderCells=e.headerCells,h._savedFromColumns=e.columns,e=t._saveColumnFooterInfo(C,r,i,p),h._savedFromColumnFooterCells=e.footerCells),m.col<0&&(e=an(C,n,o,p),h._savedFromRowHeaderCells=e.headerCells,h._savedFromRows=e.rows),h._savedFromViewportCells=rn(C,n,r,o,i,p),h._savedFromTables=on(f._sheet,n,r,o,i),C.isDirtySuspended()||(h._savedFromBeforePastedChangedCells=new bt(C,m,p))),l=v.row<0?0:v.row,s=v.col<0?0:v.col,u=v.row<0?We(w):Ue(v),c=v.col<0?ze(w):Ye(v),C&&m&&(m.row<0&&m.col<0&&v.row<0&&v.col<0&&C._name!==w._name&&(_=new Tt,Vt._saveSheetInfo(w,_,p),h._savedToSheetInfo=_),m.row<0&&(e=nn(w,s,c,p),h._savedToColumnHeaderCells=e.headerCells,h._savedToColumns=e.columns,e=t._saveColumnFooterInfo(w,s,c,p),h._savedToColumnFooterCells=e.footerCells),m.col<0&&(e=an(w,l,u,p),h._savedToRowHeaderCells=e.headerCells,h._savedToRows=e.rows)),h._savedToViewportCells=rn(w,l,s,u,c,p),h._savedToTables=on(f._sheet,l,s,u,c),w.isDirtySuspended()||(h._savedToBeforePastedChangedCells=new bt(w,v,p)),Ge(w)&&(h._savedToRowCountColCount=sn(w))},_pasteRange:function(){return this._command.pasteExtent.targetRange},execute:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v=this;if(v.canExecute()){if(e=v._command.fromSheet,t=v._command.toSheet,n=v._command.pasteExtent,r=v._command.pasteOption,o=n.sourceRange,i=n.targetRange,e&&o&&!e._isValidRange(o.row,o.col,Ue(o),Ye(o),We(e),ze(e)))return;if(!(t&&i&&t._isValidPasteRange(i.row,i.col,Ue(i),Ye(i),!0)))return;v.saveState(),Je(v._sheet),Qe(t),e&&Qe(e);try{Ge(t)&&(a=-1,l=-1,-1!==i.row?a=i.row+Ue(i):-1===o.row&&(a=We(e)),s=We(t),a>s&&t.addRows(s,a-s),-1!==i.col?l=i.col+Ye(i):-1===o.col&&(l=ze(e)),l>ze(t)&&t.setColumnCount(l)),o&&Ae._startCache(e,o.row,o.col,o.row+Ue(o)-1,o.col+Ye(o)-1),t._clipboardPaste(e,o,t,i,n.isCutting,n.clipboardText,n.clipboardHtml,r,!n.includeFilteredOutRow)}finally{$e(t),e&&$e(e),qe(v._sheet),u=v._command._state,c=v._sheet,c&&(_=u._savedFromViewportCells,f=un._convertPasteOption(r),n.isCutting&&_&&e&&_.data&&_.data._isValueOrFormulaSaved()&&(d=[],e.isDirtySuspended()||(h=new bt(e,o,f),h._mergeCellsHasDiffData(u._savedFromBeforePastedChangedCells._getCellsData()),u._savedFromAfterPastedChangedCells=h,d=h._getChangedCells()),Vt._raiseRangeDataChanged(e,o.row,o.col,Ue(o),Ye(o),d,3)),(g=u._savedToViewportCells)&&t&&g.data&&g.data._isValueOrFormulaSaved()&&(p=[],t.isDirtySuspended()||(m=new bt(t,i,f),m._mergeCellsHasDiffData(u._savedToBeforePastedChangedCells._getCellsData()),u._savedToAfterPastedChangedCells=m,p=m._getChangedCells()),Vt._raiseRangeDataChanged(t,i.row,i.col,Ue(i),Ye(i),p,3))),o&&Ae._clearCache()}}},undo:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w=this,y=0;if(w.canUndo()){if(e=w._command.fromSheet,t=w._command.toSheet,n=w._command.pasteExtent,r=n.sourceRange,o=n.targetRange,!t||!o)return!1;if(!t._isValidRange(o.row,o.col,Ue(o),Ye(o),We(t),ze(t)))return!1;if(e&&r){if(!e._isValidRange(r.row,r.col,Ue(r),Ye(r),We(e),ze(e)))return!1;if(e&&e._name===t._name&&t.parent&&!pe(t.parent.sheets,e))return!1}i=w._command._state,Je(w._sheet);try{a=Ve,l=Ve,s=o.row<0?0:o.row,u=o.col<0?0:o.col,c=o.row<0?We(t):Ue(o),_=o.col<0?ze(t):Ye(o),f=i._savedToViewportCells,f&&f.data&&f.data._isValueOrFormulaSaved()&&(a=Vt._getValues(t,s,u,c,_)),le._supportsCalc&&Vt._clearFormula(t,s,u,c,_),y+=tn(w,i._savedToTables),i._savedToSheetInfo&&(Vt._undoSheetInfo(t,i._savedToSheetInfo),y++),y+=tn(w,i._savedToColumnHeaderCells),y+=tn(w,i._savedToColumns),y+=tn(w,f),y+=tn(w,i._savedToRowHeaderCells),y+=tn(w,i._savedToRows),y+=tn(w,i._savedToColumnFooterCells),Ge(t)&&(y+=tn(w,i._savedToRowCountColCount)),d=0,h=0,g=0,p=0,e&&r&&(d=r.row<0?0:r.row,h=r.col<0?0:r.col,g=r.row<0?We(e):Ue(r),p=r.col<0?ze(e):Ye(r),m=i._savedFromViewportCells,m&&m.data&&m.data._isValueOrFormulaSaved()&&(l=Vt._getValues(e,d,h,g,p)),y+=tn(w,i._savedFromTables),y+=tn(w,i._savedFromColumnHeaderCells),y+=tn(w,i._savedFromColumns),y+=tn(w,m),y+=tn(w,i._savedFromRowHeaderCells),y+=tn(w,i._savedFromRows),y+=tn(w,i._savedFromColumnFooterCells)),y&&w._sheet&&(a&&t&&(v=i._savedToAfterPastedChangedCells,Vt._raiseRangeDataChanged(t,s,u,c,_,v?v._getChangedCells():[],3)),l&&e&&(C=i._savedFromAfterPastedChangedCells,Vt._raiseRangeDataChanged(e,d,h,g,p,C?C._getChangedCells():[],3)))}finally{qe(w._sheet)}}return y>0}}),un._convertPasteOption=function(e){var t=0;return 0!==e&&1!==e||(t|=1),0!==e&&2!==e||(t|=64,t|=32),0!==e&&3!==e||(t|=2),0===e&&(t|=32,t|=16,t|=256,t|=4,t|=512,t|=128),t},t.ClipboardPasteRangeUndoAction=un,Ne(cn,Pt);function cn(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R=this;if(Pt.call(R),R._sheet=e,R._command=t,!n){if(r=e,o=t.fromSheet,!r)throw Error(Ke().Exp_DestSheetIsNull);if(i=t,(a=i.pastedRanges)&&a.length>0)if(t._cachedActions=[],l=i.fromRanges||[i.fromRange],s=l.length,u=i.isCutting,c=i.clipboardText,_=i.clipboardHtml,f=i.pasteOption,d={},h=a[0],!u&&o&&o._isValidMultiCopyRanges(l,d)&&h.equals(o._getPastedRangeForMultiCopy(l,h))){for(g=d.inSameRow,p=d.inSameCol,g?l=l.sort(function(e,t){return e.col-t.col}):p&&(l=l.sort(function(e,t){return e.row-t.row})),m=h.row,v=h.col,C=0;C<s;C++)w=l[C],y=w.rowCount,S=w.colCount,x={sourceRange:w,targetRange:fe._createRange(m,v,y,S),isCutting:u,clipboardText:c,clipboardHtml:_,includeFilteredOutRow:!0},t._cachedActions[C]=new un(e,{fromSheet:o,toSheet:r,pasteExtent:x,pasteOption:f}),g?v+=S:p&&(m+=y);t._isMultiToSingle=!0}else for(b=0;b<a.length;b++)T={sourceRange:l[0],targetRange:a[b],isCutting:u,clipboardText:c,clipboardHtml:_},t._cachedActions[b]=new un(e,{fromSheet:o,toSheet:r,pasteExtent:T,pasteOption:f})}}De(cn.prototype,{execute:function(){var e,t,n,r,o,i=this,a=i._command,l=a._cachedActions,s=!1;if(i.canExecute()&&l){e=i._sheet,Ot(e,!0);try{for(t=0;t<l.length;t++)n=l[t],e?(r=n._command.pasteExtent,o={sheet:e,sheetName:e.name(),cellRange:n._pasteRange(),pasteOption:n._command.pasteOption,pasteData:{text:r.clipboardText,html:r.clipboardHtml},cancel:!1},e._trigger(Ce.ClipboardPasting,o),o.cancel||(s=n.execute(),delete o.cancel,e._trigger(Ce.ClipboardPasted,o))):s=n.execute();i._refreshSelection()}finally{Ht(e,!0)}}return s},_refreshSelection:function(){var e,t,n,r,o,i,a=this,l=a._command,s=l._cachedActions,u=a._sheet;if(u&&s){if(e=u.getSelections(),u._clearSelectionImp(),l._isMultiToSingle)t=l.pastedRanges[0],u.addSelection(t.row,t.col,Ue(t),Ye(t));else if(s.length>1)for(n=0;n<s.length;n++)r=s[n],o=r._pasteRange(),u.addSelection(o.row,o.col,Ue(o),Ye(o));else s.length>0&&(i=s[0]._pasteRange(),u.addSelection(i.row,i.col,Ue(i),Ye(i)),i.contains(u._activeRowIndex,u._activeColIndex)||u._setActiveCellCore(i.row,i.col));u._raiseSelectionChanging(e,u.getSelections())&&u._raiseSelectionChanged(e)}},canExecute:function(){var e,t,n=this._command._cachedActions;if(n){for(e=0;e<n.length;e++)if(t=n[e],!t.canExecute())return!1;return!0}return!1},canUndo:function(){var e,t,n=this._command._cachedActions;if(n){for(e=0;e<n.length;e++)if(t=n[e],!t.canUndo())return!1;return!0}return!1},saveState:function(){var e,t,n=this._command._cachedActions;if(n)for(e=0;e<n.length;e++)t=n[e],t.saveState()},undo:function(){var e,t,n,r,o=this,i=o._command._cachedActions;if(o.canUndo()&&i){e=o._sheet,t=!0,Ot(e,!0);try{for(n=i.length-1;n>=0;n--)r=i[n],t=t&&r.undo()}finally{Ht(e,!0)}return t}return!1}}),le.ClipboardPasteUndoAction=cn,e.exports=le}()},function(e,t,n){!function(){"use strict";var t=n(1),r=n(3),o=n(5),i=n(16)._SheetModel,a=t._supportsCalc&&n(21).Worksheet,l=r._createRange,s=o._Types._isNullOrUndefined,u=null,c=void 0,_=Math.min,f=Math.max;function d(){return o._getResource(t.SR)()}function h(e,t){return e.getRowCount(t)}function g(e,t){return e.getColumnCount(t)}function p(e,t){return e._getSpanModel(t)}function m(e,t,n){return e._getActualColumnWidth(t,n)}function v(e,t,n){return e._getActualRowHeight(t,n)}function C(e,t,n,r){e.setColumnWidth(t,n,r)}function w(e,t,n,r){e.setRowHeight(t,n,r)}function y(e,t,n,r){return e.getActualStyle(t,n,r)}function S(e,t){return e.getDefaultStyle(t)}function x(e,t,n){e.setDefaultStyle(t,n)}function b(e,t,n,r,o){e._setStyleWithoutLocked(t,n,r,o)}function T(e,t,n,r){throw Error(o._StringHelper._format(d().Exp_InvalidAndSpace,[e,t,n,r]))}function R(e,t,n){return t&&n._isRowFilterOut&&n._isRowFilterOut(e)}function A(e,t,n,r,o,i,a,l){var s,u,c,f,p,m,v,C;if(!e)throw Error(d().Exp_SrcIsNull);if(!r)throw Error(d().Exp_DestIsNull);s=h(e),u=g(e),c=h(r),f=g(r),(t<-1||t>=s)&&T("from row index",t,"-1",s-1),(n<-1||n>=u)&&T("from column index",n,"-1",u-1),(o<-1||o>=c)&&T("to row index",o,"-1",c-1),(i<-1||i>=f)&&T("to column index",i,"-1",f-1),p=n,n<0&&(p=0,l=u),m=i<0?0:i,(l<1||p+l>u||m+l>f)&&T("column count",l,"1",_(u-p,f-m)),v=t,t<0&&(v=0,a=s),C=o<0?0:o,(a<1||v+a>s||C+a>c)&&T("row count",a,"1",_(s-v,c-C))}function I(e){if(!e)return e;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e||s(e))return e;if(e.clone)return e.clone();if(e instanceof Date)return new Date(e);var t,n,r;t=e instanceof Object?new e.constructor:new e.constructor(e.valueOf());for(n in e)e.hasOwnProperty(n)&&(r=e[n],e.hasOwnProperty(n)&&t[n]!==r&&(t[n]="object"==typeof r?I(r):r));return t.toString=e.toString,t.valueOf=e.valueOf,t}function M(e,t,n,r,o,i,a,s){var u,c,_,f,d,h,g,p,m,v,C,w=E(e),y=E(r),S=[];if(w)for(u=0;u<w.length;u++)_=w[u],f=_.row,d=_.col,h=_.rowCount,g=_.colCount,-1===t?n<=d&&d+g<=n+s&&S.push(l(f,i+d-n,h,g)):-1===n?t<=f&&f+h<=t+a&&S.push(l(o+f-t,d,h,g)):t<=f&&f<t+a&&n<=d&&d<n+s&&S.push(l(o+f-t,i+d-n,h,g));if(y)for(u=0;u<y.length;u++)if(_=y[u],f=_.row,d=_.col,v=d>=i&&d<i+s,C=f>=o&&f<o+a,m=-1===t?v:-1===n?C:C&&v)for(c=0;c<r.length;c++)if(p=r[c],p.row===f&&p.col===d){r.removeSpan(c,1);break}for(u=0;r&&u<S.length;u++)r.addSpan(S[u])}function E(e){return e&&e.length>0?e.slice(0):u}function F(e,t,n,r,o,i,a,l,s){var u=e.conditionalFormats,c=r.conditionalFormats;u&&c&&(u._copyRules(t,n,c,o,i,a,l),s&&u._onRulesMoved(t,n,a,l))}function D(e,t,n,r,o,i,a,l,s){var u,c;t<0&&(t=0,a=_(h(e),h(r))),o<0&&(o=0),n<0&&(n=0,l=_(g(e),g(r))),i<0&&(i=0),u=!(e===r&&e._name===r._name),u?(c=r._sparklineGroupManager)&&(s?c.count()>0&&c._exMove(e,t,n,o,i,a,l):c._exCopy(e,t,n,o,i,a,l)):(c=e._sparklineGroupManager)&&(s?c.count()>0&&c._move(t,n,o,i,a,l):c._copy(t,n,o,i,a,l))}function N(e,t,n,r,o,i){var a,l,s;t<0&&(t=0,o=_(g(e),g(n))),r<0&&(r=0),a=e.columnOutlines,l=n.columnOutlines,s=!(e===n&&e._name===n._name),s?a&&l&&l._exMoveOrCopy(a,t,r,o,i):a&&a._moveOrCopy(t,r,o,i)}function V(e,t,n,r,o,i){var a,l,s;t<0&&(t=0,o=_(h(e),h(n))),r<0&&(r=0),a=!(e===n&&e._name===n._name),l=e.rowOutlines,s=n.rowOutlines,a?l&&s&&s._exMoveOrCopy(l,t,r,o,i):l&&l._moveOrCopy(t,r,o,i)}function O(e,t,n,r,o,i,a,l,s,u){var c=!(e===r&&e._name===r._name),_=p(e,u);c?(M(_,t,n,p(r,u),o,i,a,l),s&&_&&_.clear(t,n,a,l)):_&&(s?_.move(t,n,o,i,a,l):_.copy(t,n,o,i,a,l))}function H(e,t,n,r,o,i,a,l,s){var u=t,c=n;u<0&&(u=0,a=_(h(e),h(r))),o<0&&(o=0),c<0&&(c=0,l=_(g(e),g(r))),i<0&&(i=0),t<0&&O(e,-1,c,r,-1,i,-1,l,s,1),n<0&&O(e,u,-1,r,o,-1,a,-1,s,2),O(e,u,c,r,o,i,a,l,s)}function P(e,t,n,r,o,i,a){var l,c,f,d,p,y,S,x;for(t<0&&(t=0,o=_(g(e),g(n))),r<0&&(r=0),l=1,c=0;c<o;c++)if((64&i)>0){f=m(e,c+t),s(f)||(a&&C(e,c+t,e.defaults.colWidth),C(n,c+r,f)),d=e.getColumnVisible(c+t),s(d)||(a&&e.setColumnVisible(c+t,!0),n.setColumnVisible(c+r,d)),p=e.getStyle(-1,c+t),p?(b(n,-1,c+r,p.clone()),a&&b(e,-1,c+t,u)):b(n,-1,c+r,u),p=e.getStyle(-1,c+t,l),p?(b(n,-1,c+r,p.clone(),l),a&&b(e,-1,c+t,u,l)):b(n,-1,c+r,u,l);const T=e.getTag(-1,c+t);T&&(n.copyOrMoveTagTo||n.setTag(-1,c+r,Object.assign({},T)))}for(y=_(h(e,l),h(n,l)),S=0;S<y;S++)x=v(e,S,l),s(x)||(a&&w(e,S,e.defaults.colHeaderRowHeight,l),w(n,S,x,l));n.copyOrMoveTagTo&&n.copyOrMoveTagTo(e,t,n,r,o,a)}function L(e,t,n,r,o,i,a,l){var c,f,d,p,y,S,x,T;for(t<0&&(t=0,o=_(h(e),h(n))),r<0&&(r=0),c=2,f=0;f<o;f++)!l&&R(r+f,a,n)||(64&i)>0&&(d=v(e,f+t),s(d)||(l&&w(e,f+t,e.defaults.rowHeight),w(n,f+r,d)),p=e.getRowVisible(f+t),s(p)||(l&&e.setRowVisible(f+t,!0),n.setRowVisible(f+r,p)),y=e.getStyle(f+t,-1),y?(b(n,f+r,-1,y.clone()),l&&b(e,f+t,-1,u)):b(n,f+r,-1,u),y=e.getStyle(f+t,-1,c),y?(b(n,f+r,-1,y.clone(),c),l&&b(e,f+t,-1,u,c)):b(n,f+r,-1,u,c));for(S=_(g(e,c),g(n,c)),x=0;x<S;x++)T=m(e,x,c),s(T)||(l&&C(e,x,e.defaults.rowHeaderColWidth,c),C(n,x,T,c))}function k(e,t,n,r){var o,i,a;e===t&&e._name===t._name||((64&n)>0&&(o=S(e),x(t,r?o:o.clone()),o=S(e,1),x(t,r?o:o.clone(),1),o=S(e,2),x(t,r?o:o.clone(),2),r&&(x(e,u),x(e,u,1),x(e,u,2))),i=t.defaults,a=e.defaults,i.colWidth=a.colWidth,i.rowHeight=a.rowHeight,i.rowHeaderColWidth=a.rowHeaderColWidth,r&&(a.colWidth=62,a.rowHeight=20,a.rowHeaderColWidth=40))}function B(e,t,n,r,o,a,l,c,f,d,p,m){var v,C,w,y,S,x,b,T,A,M,E,F,D,N,V,O,H=!(e===r&&e._name===r._name);if(2==(2&d)&&t<0)if(b=n,T=a,v=_(h(e,1),h(r,1)),C=c,n<0&&(b=0,C=g(e)),a<0&&(T=0),H)for(w=0;w<v;w++)for(y=0;y<C;y++)x=p(e,w,b+y,1),m(r,w,T+y,I(x),1);else{for(S=new i(v,C,u),w=0;w<v;w++)for(y=0;y<C;y++)x=p(e,w,b+y,1),s(x)||S.setValue(w,y,I(x));for(w=0;w<v;w++)for(y=0;y<C;y++)m(r,w,T+y,S.getValue(w,y),1)}if(2==(2&d)&&t<0)if(b=n,T=a,v=_(h(e,4),h(r,4)),C=c,n<0&&(b=0,C=g(e)),a<0&&(T=0),H)for(w=0;w<v;w++)for(y=0;y<C;y++)x=p(e,w,b+y,4),m(r,w,T+y,I(x),4);else{for(S=new i(v,C,u),w=0;w<v;w++)for(y=0;y<C;y++)x=p(e,w,b+y,4),s(x)||S.setValue(w,y,I(x));for(w=0;w<v;w++)for(y=0;y<C;y++)m(r,w,T+y,S.getValue(w,y),4)}if(1==(1&d)&&n<0)if(A=t,M=o,v=l,C=_(g(e,2),g(r,2)),t<0&&(A=0,v=h(e)),o<0&&(M=0),H)for(w=0;w<v;w++)for(y=0;y<C;y++)x=p(e,A+w,y,2),m(r,M+w,y,I(x),2);else{for(S=new i(v,C,u),w=0;w<v;w++)for(y=0;y<C;y++)x=p(e,A+w,y,2),s(x)||S.setValue(w,y,I(x));for(w=0;w<v;w++)for(y=0;y<C;y++)m(r,M+w,y,S.getValue(w,y),2)}if(E=t,F=n,D=o,N=a,V=l,O=c,t<0&&(E=0,V=_(h(e),h(r))),n<0&&(F=0,O=_(g(e),g(r))),o<0&&(D=0),a<0&&(N=0),H){for(w=0;w<V;w++)if(!R(D+w,f,r))for(y=0;y<O;y++)x=p(e,E+w,F+y,3),m(r,D+w,N+y,I(x),3)}else{S=new i(V,O,u);try{for(w=0;w<V;w++)for(y=0;y<O;y++)x=p(e,E+w,F+y,3),s(x)||S.setValue(w,y,I(x));for(w=0;w<V;w++)if(!R(D+w,f,r))for(y=0;y<O;y++)m(r,D+w,N+y,S.getValue(w,y),3)}catch(e){}}}function W(e,t,n,r,o,i,a,l,c,_,f){B(e,t,n,r,o,i,a,l,c,_,function(e,t,n,r){var o,i,a,l,c=3===r;return c?o=e.getValue(t,n,r):(o=e._getModel(r).getValue(t,n),
1===r&&s(o)&&(i=e._bindingManager)&&i._dataSource&&(a=e._getColInfos()._getItem(n),l=e.options.colHeaderAutoTextIndex,a&&(l>=0&&t===l||-1===l&&t===h(e,r)-1)&&(o=a.displayName||a.name))),f&&(c?e._setValueInternal(t,n,u,r,!1):e._getModel(r).setValue(t,n,u)),o},function(e,t,n,r,o){s(r)?e._setValueInternal(t,n,u,o,!1):e._setValueInternal(t,n,r,o,!1)})}function z(e,t,n){var r,o,i,a=e._getActualRange(t),l=a.row,s=a.col,u=a.rowCount,c=a.colCount;for(r=0;r<u;r++)for(o=n[l+r]=n[l+r]||{},i=0;i<c;i++)o[s+i]=!0}function U(e,t,n,r,o,i,a,_,f,d,h){var g,p,m,v,C,w,y={};if(e.tables)for(g=l(t,n,a,_),p=l(o,i,a,_),m=e.tables.all(),C=0,w=m.length;C<w;C++)v=m[C].range(),g.containsRange(v)?z(e,v,y):v.containsRange(g)&&v.containsRange(p)&&z(e,g,y);B(e,t,n,r,o,i,a,_,f,d,function(e,r,o,i){var a,l=(3===i||s(i))&&y[r]&&y[r][o];return a=t<0||n<0?e.getStyle(r,o,i):e._getCompositeStyle(r,o,i,c,c,c,c,l),h&&b(e,r,o,u,i),a},function(e,t,n,r,o){b(e,t,n,r,o)})}function Y(e,t,n,r,o,i,a,l,s,c){B(e,t,n,r,o,i,a,l,s,0,function(e,t,n){var r=e.getDataValidator(t,n,3);return r&&(c&&e.setDataValidator(t,n,u),r._fromCopyMove=!0),r},function(e,t,n,r){e.setDataValidator(t,n,r),r&&delete r._fromCopyMove})}function G(e,t,n,r,o,i,a,l,s,u){B(e,t,n,r,o,i,a,l,s,0,function(e,t,n){var r=e.comments,o=r&&r.get(t,n);return o&&u&&r.remove(t,n),o},function(e,t,n,r){var o=e.comments;o&&o._addInternal(t,n,r)})}function X(e,t,n,r,o,i,a,l,s,u,_){B(e,t,n,r,o,i,a,l,s,u,function(e,t,n,r){var o=e.getTag(t,n,r);return o&&_&&e.setTag(t,n,c),o},function(e,t,n,o,i){r.setTag(t,n,o,i)})}function j(e,t,n,r,o,i,a,l,s,c){var _=[];return B(e,t,n,r,o,i,a,l,s,0,function(r,o,i){var a=r.getBindingPath&&r.getBindingPath(o,i);return a&&_.push({row:o-f(0,t),col:i-f(0,n),value:r.getValue(o,i)}),c&&e.setBindingPath&&e.setBindingPath(o,i,u),a},function(e,t,n,r){e.setBindingPath&&e.setBindingPath(t,n,r)}),_}function K(e,n,r,o,i,s,c,d,p,m,v,C){var w,y,S,x,b,T,I,M,E,O,B,z,K;A(e,n,r,o,i,s,c,d),(64&p)>0&&(U(e,n,r,o,i,s,c,d,m,v,C),e._validations&&Y(e,n,r,o,i,s,c,d,m,C)),(1&p)>0&&(2&p)>0&&(w=e.tables)&&(y=w._onCopyOrMoving(l(f(0,n),f(0,r),n<0?_(h(e),h(o)):c,r<0?_(g(e),g(o)):d),C)),S=t._supportsCalc,S&&(e.suspendCalcService(),o.suspendCalcService()),x=u,(256&p)>0&&(x=j(e,n,r,o,i,s,c,d,m,C));try{if((1&p)>0&&(W(e,n,r,o,i,s,c,d,m,v,C),t._supportsCalc&&0==(2&p)&&o.clearFormula(i,s,c,d,function(e,t){return!m||!e._isRowFilterOut||!e._isRowFilterOut(t)}),(256&p)>0))for(b=x.length,T=i<0?0:i,I=s<0?0:s,M=0;M<b;M++)E=x[M],!C&&R(T+E.row,m,o)||o.setValue(T+E.row,I+E.col,E.value);O=o.tables,(1&p)>0&&(2&p)>0&&O&&O._onCopyOrMoved(y,f(0,n),f(0,r),f(0,i),f(0,s),C),t._supportsCalc&&(C?(a.adjustCustomNameOnMove(e,n,r,o,i,s,c,d),(2&p)>0&&a.moveFormula(e,n,r,o,i,s,c,d)):(2&p)>0&&a.copyFormula(e,n,r,o,i,s,c,d,m),(1&p)>0&&(2&p)>0&&O&&O._syncFormulaInTables(y))}finally{S&&(e.resumeCalcService(!1),o.resumeCalcService(!1))}if((512&p)>0&&F(e,n,r,o,i,s,c,d,C),(4&p)>0&&G(e,n,r,o,i,s,c,d,m,C),(128&p)>0&&X(e,n,r,o,i,s,c,d,m,v,C),(16&p)>0&&D(e,n,r,o,i,s,c,d,C),(8&p)>0&&(n<0&&N(e,r,o,s,d,C),r<0&&V(e,n,o,i,c,C)),(32&p)>0&&(C||1!==c||1!==d)&&H(e,n,r,o,i,s,c,d,C),n<0&&i<=0&&P(e,r,o,s,d,p,C),r<0&&s<=0&&L(e,n,o,i,c,p,m,C),n<0&&i<=0&&r<0&&s<=0&&k(e,o,p,C),C&&n<0)for(B=r,z=d,r<0&&(B=0,z=_(g(e),g(o))),K=0;K<z;K++)e.getDataColumnName&&e.getDataColumnName(B+K)&&e._getColInfos().reset(B+K)}t.staticMembers={copyTo:function(e,t,n,r,o,i,a,l,s,u,c){K(e,t,n,r,o,i,a,l,s,u,c,!1)},moveTo:function(e,t,n,r,o,i,a,l,s){K(e,t,n,r,o,i,a,l,s,c,3,!0)}},e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o=n(1),i=n(4).GC$,a=n(3),l=n(5)._Types._isNullOrUndefined,s=null,u=a._util,c=u._browser,_=u._cancelDefault,f=a._util._createElement,d=a._util._defProperty,h=document,g=Math.round,p=Math.ceil,m="gc-scroll-container",v="gc-scroll-corner-all",C="gc-scroll-arrow",w="gc-scrollbar-wrapper",y="gc-scroll-bar",S="gc-scroll-arrowUp",x="gc-scroll-arrowDown",b="gc-scroll-arrowLeft",T="gc-scroll-arrowRight",R="gc-scrollbar-vertical",A="gc-scrollbar-horizontal",I="gc-no-user-select",M="width",E="height",F="gc-scrollbar-stateActive ui-state-active",D="left",N="right",V="top",O="bottom",H="margin-left",P="position",L="border",k="padding",B="margin",W="overflow",z="display",U="outline",Y="borderWidth",G="boxSizing",X="margin-top",j=".gcScrollbar",K="mousedown"+j,Z="mouseup"+j,J="mousemove"+j,q="mouseover"+j,Q="mouseout"+j,$="mousewheel",ee="DOMMouseScroll",te="scroll"+j;function ne(e){e.preventDefault?e.preventDefault():e.returnValue=!1}t=function(){function e(e,t,n,r,o,i,a){var l=this;l._isMousedownInScrollbar=!1,l._isMousedownInArrowButton=!1,l._scrollTimeOutArrow=s,l._scrollTimeOutContainer=s,l._initialDelay=300,l._trackClickPepeatFreq=70,l._isHorizontalScroll=e,l._width("number"==typeof t?t:0),l._height("number"==typeof n?n:0),l._pageValue("number"==typeof r?r:0),l._maximum("number"==typeof o?o:0),l._minimum("number"==typeof i?i:0),l._scrollType="number"==typeof a?a:1,l._isMouseCapture=!1,l._scrollPosition=0,l._value=l._minimum(),l._refreshLayout()}return a._defineFeature(e),e.prototype={constructor:e,_getScrollbar:function(){return this._scrollContainerDiv},_smallChange:d("smallChange",1),_largeChange:d("largeChange",10),_pageValue:d("pageValue",10,function(e){e<=0&&this._pageValue(1)}),_maximum:d("maximum",100,function(e){e<=0&&this._maximum(0)}),_minimum:d("minimum",0,function(e){e<=0&&this._minimum(0)}),value:function(e){var t,n=this;return 0===arguments.length?n._value:("number"==typeof e&&e<=n._maximum()&&e>=n._minimum()&&(n._value=e,t=(e-n._minimum())*n._scrollUnit,n.scrollTo(t,!0)),n)},_width:d("width",0),_height:d("height",0),_refreshLayout:function(){var e,t,n,r=this,o=r._height(),a=r._width(),l=0,s=0,u=!1,c=2,_="ui-widget ui-corner-all",d=o,h=a-38,p=d,F=D,j=N,K=b,Z=T,J=A,q=H,Q="ui-state-default ui-corner-bl btn btn-default",$="ui-icon ui-icon-triangle-1-w",ee="gc-scroll-handle ui-state-default ui-corner-all ui-draggable btn btn-default",te="ui-icon ui-icon-grip-solid-vertical",ne="ui-state-default ui-corner-br btn btn-default",re="ui-icon ui-icon-triangle-1-e";r._scrollSize=h,r._isHorizontalScroll||(d=a,h=d,p=o-32-a,F=V,j=O,K=S,Z=x,J=R,q=X,Q="ui-state-default ui-corner-tr btn btn-default",$="ui-icon ui-icon-triangle-1-n",ee="gc-scroll-handle ui-state-default ui-corner-all ui-draggable btn btn-default",te="ui-icon ui-icon-grip-solid-horizontal",ne="ui-state-default ui-corner-br btn btn-default",re="ui-icon ui-icon-triangle-1-s",r._scrollSize=p);function oe(){r._scrollContainerDiv=f("div"),r._$scrollContainerDiv=i(r._scrollContainerDiv),r._$scrollContainerDiv.css([P,D,V,W,U,L,k,B],["relative",0,0,"hidden","none","none",0,0]).addClass(m+" "+v+" "+_)}function ie(e){r._$arrowStartDiv=i._createElement("div",[P,z,Y,k,B,G],["absolute","inline-block","1px",0,0,"content-box"],C+" "+Q,e),r._$arrowStartSpan=i._createElement("span",[z,L,k,B],["block","none",0,0],K+" "+$,r._$arrowStartDiv)}function ae(e){r._$scrollbarWrapperDiv=i._createElement("div",[P,z,G,L,k,B],["absolute","inline-block","content-box","none",0,0],w+" "+w,e)}function le(e){r._$scrollbarDiv=i._createElement("div",[P,Y,k,B,G],["absolute","1px",0,0,"content-box"],y+" "+I+" "+ee,e),r._$scrollbarSpan=i._createElement("span",[z,L,k,B],["block","none",0,0],J+" "+te,r._$scrollbarDiv)}function se(e){r._$arrowEndDiv=i._createElement("div",[P,z,Y,k,B,G],["absolute","inline-block","1px",0,0,"content-box"],C+" "+ne,e),r._$arrowEndSpan=i._createElement("span",[z,L,k,B],["block","none",0,0],Z+" "+re,r._$arrowEndDiv)}e=r._scrollSize,t=r._maximum()-r._minimum(),r._scrollbarSize=r._pageValue()*e/(t+r._pageValue()),r._scrollbarSize>e&&(r._scrollbarSize=e),r._scrollbarSize<30&&(r._scrollbarSize=30),n=r._scrollbarSize,r._scrollUnit=0===t?1:(e-n)/t,r._isHorizontalScroll?(l=n,s=d):(l=d,s=n),r._$scrollContainerDiv||(u=!0,oe()),r._$arrowStartDiv||ie(r._$scrollContainerDiv),r._$scrollbarWrapperDiv||ae(r._$scrollContainerDiv),r._$scrollbarDiv||le(r._$scrollbarWrapperDiv),r._$arrowEndDiv||se(r._$scrollContainerDiv),r._$scrollContainerDiv.css([M,E],[a,o]),r._$arrowStartDiv.css([F,M,E],[0,0,0]),r._$arrowStartSpan.css([M,E],["100%","100%"]),r._$scrollbarWrapperDiv.css([F,M,E],[d,h,p]),r._$scrollbarDiv.css([F,M,E],[r._scrollPosition,g(l-c),g(s-c)]),r._$scrollbarSpan.css([M,E,q],[d-c,d-c,Math.floor((r._scrollbarSize-d)/2)]),r._$arrowEndDiv.css([j,M,E],[0,0,0]),r._$arrowEndSpan.css([M,E],["100%","100%"]),u&&r._initEvents()},_initEvents:function(){var t=this;function n(e,n){e.bind(K,function(e){t._arrowMousedown(e,n)}).bind(Z,function(e){t._arrowMouseup(e,n)}).bind(q,function(e){t._arrowMouseover(e,n)}).bind(Q,function(e){t._arrowMouseout(e,n)})}n(t._$arrowStartDiv,!0),n(t._$arrowEndDiv,!1),t._$scrollbarDiv.bind(K,function(e){t._scrollbarMousedown(e)}).bind(J,function(e){t._scrollbarMousemove(e)}).bind(Z,function(e){t._scrollbarMouseup(e)}).bind(q,function(e){t._scrollbarMouseover(e)}).bind(Q,function(e){t._scrollbarMouseout(e)}),t._$scrollbarWrapperDiv.bind(K,function(e){var n,r;c&&c.mozilla&&(n=(new Date).valueOf(),r=t._lastMouseDownTime,t._lastMouseDownTime=n,r&&n-r<100)||t._scrollbarContainerMousedown(e)}).bind(Z,function(e){t._scrollbarContainerMouseup(e)}),t._mousewheelHandler=function(e){t._scrollContainerMousewheel(e)},t._$scrollContainerDiv.bind($,t._mousewheelHandler),t._$scrollContainerDiv.bind(ee,t._mousewheelHandler),e._callFeatureHandler(t,"initEvents",t._scrollContainerDiv)},dispose:function(){var t=this;function n(e){e&&e.unbind(j)}n(t._$arrowEndDiv),n(t._$scrollbarDiv),n(t._$arrowStartDiv),n(t._$scrollbarWrapperDiv),t._$scrollContainerDiv&&(t._mousewheelHandler&&(t._$scrollContainerDiv.unbind($,t._mousewheelHandler),t._$scrollContainerDiv.unbind(ee,t._mousewheelHandler)),e._callFeatureHandler(t,"dispose",t._scrollContainerDiv),t._$scrollContainerDiv.unbind(j).remove())},_handleDocumentMouseMove:function(){var e=this;e._isMouseCapture||(i(h).bind(J,function(t){e._scrollbarMousemove(t)}).bind(Z,function(t){e._scrollbarMouseup(t)}),e._isMouseCapture=!0)},_unhandleDocumentMouseMove:function(){this._isMouseCapture&&(this._isMouseCapture=!1,i(h).unbind(J).unbind(Z))},_arrowMousedown:function(e,t){var n,r=0,o=this,i=!0;o._isMousedownInArrowButton=!0,null===o._scrollTimeOutArrow&&(t?(o._$arrowStartDiv.addClass(F),r=0-o._smallChange(),o._scrollEventType=0):(o._$arrowEndDiv.addClass(F),r=o._smallChange(),o._scrollEventType=1),n=function(){o.scrollTo(o._scrollPosition+r*o._scrollUnit,!1),1===o._scrollType&&(o._scrollTimeOutArrow=setTimeout(n,i?o._initialDelay:o._trackClickPepeatFreq)),i=!1},n(),ne(e))},_arrowMouseup:function(e,t){var n=this;(t?n._$arrowStartDiv:n._$arrowEndDiv).removeClass(F),n._endArrowScroll(),ne(e)},_arrowMouseover:function(e,t){var n=this;(t?n._$arrowStartDiv:n._$arrowEndDiv).addClass("gc-scroll-arrow-hover ui-state-hover"),ne(e)},_arrowMouseout:function(e,t){var n=this;(t?n._$arrowStartDiv:n._$arrowEndDiv).removeClass("gc-scroll-arrow-hover gc-scrollbar-stateActive ui-state-hover ui-state-active"),n._endArrowScroll(),ne(e)},_scrollbarMousedown:function(e){var t,n,r,o,i,a,l=this;0===e.button&&(l._isMousedownInScrollbar=!0,l._oldPosition={x:e.pageX,y:e.pageY},l._handleDocumentMouseMove(),l._$scrollbarDiv.addClass(F),t=l._$scrollbarDiv.offset(),n=l._$scrollbarDiv.outerWidth(!0),r=l._$scrollbarDiv.outerHeight(!0),o=l._$scrollbarWrapperDiv.offset(),i=l._$scrollbarWrapperDiv.outerWidth(!0),a=l._$scrollbarWrapperDiv.outerHeight(!0),l._edgePosition={isBeyondEdge:!1,startEdgePosition:{x:o.left+e.pageX-t.left,y:o.top+e.pageY-t.top},endEdgePosition:{x:o.left+i-(n-e.pageX+t.left),y:o.top+a-(r-e.pageY+t.top)}}),ne(e)},_scrollbarMousemove:function(e){var t=this;t._isMousedownInScrollbar&&(t._currentPosition={x:e.pageX,y:e.pageY},t._scrollbarDrag(),t._oldPosition=t._currentPosition,i(h.body).attr("unselectable","on").addClass(I)),ne(e)},_scrollbarMouseup:function(e){var t,n,r,o=this;o._isMousedownInScrollbar=!1,o._scrollEventType=4,o._edgePosition=null,o._$scrollContainerDiv.trigger(te,{newValue:o._value,oldValue:o._value,scrollOrientation:o._isHorizontalScroll?0:1,scrollEventType:o._scrollEventType}),t=o._value,n=(t-o._minimum())*o._scrollUnit,r="left",o._isHorizontalScroll||(r="top"),o._scrollPosition=n,o._$scrollbarDiv.css(r,n),o._unhandleDocumentMouseMove(),i(h.body).removeClass(I),i(h.body).attr("unselectable")&&i(h.body).removeAttr("unselectable"),o._$scrollbarDiv.removeClass(F),o._scrollEventType=6,o._$scrollContainerDiv.trigger(te,{newValue:o._value,oldValue:o._value,scrollOrientation:o._isHorizontalScroll?0:1,scrollEventType:o._scrollEventType}),ne(e)},_scrollbarMouseover:function(e){this._$scrollbarDiv.addClass("gc-scrollbar-stateHover ui-state-hover"),ne(e)},_scrollbarMouseout:function(e){this._$scrollbarDiv.removeClass("gc-scrollbar-stateHover ui-state-hover"),ne(e)},_scrollContainerMousewheel:function(e){var t,n,r,o=this;l(e.wheelDelta)&&l(e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail),t=e.detail?e.detail:e.wheelDelta/-40,n=t/3*o._smallChange()*o._scrollUnit,o._scrollEventType=n>=0?1:0,o.scrollTo(o._scrollPosition+n,!1),o._scrollEventType=6,r={newValue:o._value,oldValue:o._value,scrollOrientation:o._isHorizontalScroll?0:1,scrollEventType:o._scrollEventType},o._$scrollContainerDiv.trigger(te,r),ne(e)},_scrollbarContainerMousedown:function(e){var t,n=this,r=!0,o=e.pageX,i=e.pageY,a=0,l=n._$scrollbarWrapperDiv.offset(),s=n._largeChange();null===n._scrollTimeOutContainer&&(a=n._isHorizontalScroll?o-l.left-n._scrollPosition:i-l.top-n._scrollPosition,t=function(){var e=0,u=n._scrollPosition;if((e=n._isHorizontalScroll?o-l.left-u:i-l.top-u)*a<0||e>=0&&e<n._scrollbarSize)return void n._endContainerScroll();if(a<0)n._scrollEventType=2,n.scrollTo(u-s*n._scrollUnit,!1);else{if(!(a>0))return void n._endContainerScroll();n._scrollEventType=3,n.scrollTo(u+s*n._scrollUnit,!1)}1===n._scrollType&&(n._scrollTimeOutContainer=setTimeout(t,r?n._initialDelay:n._trackClickPepeatFreq)),r=!1},t(),ne(e))},_scrollbarContainerMouseup:function(e){this._endContainerScroll(),ne(e)},_endContainerScroll:function(){var e,t=this;t._scrollTimeOutContainer&&clearTimeout(t._scrollTimeOutContainer),t._scrollTimeOutContainer=s,t._scrollEventType=6,e={newValue:t._value,oldValue:t._value,scrollOrientation:t._isHorizontalScroll?0:1,scrollEventType:t._scrollEventType},t._$scrollContainerDiv.trigger(te,e)},_endArrowScroll:function(){var e,t=this;t._isMousedownInArrowButton&&(t._isMousedownInArrowButton=!1,t._scrollTimeOutArrow&&clearTimeout(t._scrollTimeOutArrow),t._scrollTimeOutArrow=s,t._scrollEventType=6,e={newValue:t._value,oldValue:t._value,scrollOrientation:t._isHorizontalScroll?0:1,scrollEventType:t._scrollEventType},t._$scrollContainerDiv.trigger(te,e))},_scrollbarDrag:function(){var e,t,n,r,o,i,a,l,s=this,u=s._scrollPosition,c=s._currentPosition,_=s._edgePosition;function f(e){return s._isHorizontalScroll?e.x:e.y}function d(e,t){s._isHorizontalScroll?e.x=t:e.y=t}if(n=f(c),r=f(s._oldPosition),_&&_.isBeyondEdge){if(o=f(_.startEdgePosition),i=f(_.endEdgePosition),e=n<o,t=n>i,e||t)return;r<o&&d(s._oldPosition,o),r>i&&d(s._oldPosition,i)}a=n-r,(l=u+a)!==u&&(s._scrollEventType=5,s.scrollTo(l,!1))},scrollTo:function(e,t){var n,r,o,i,a,l=this,s=V,u=l._scrollSize-l._scrollbarSize;l._isHorizontalScroll&&(s=D),n=!1,e>u&&(e=u,n=!0),e<0&&(e=0,n=!0),l._edgePosition&&(l._edgePosition.isBeyondEdge=n),r=g(e/l._scrollUnit)+l._minimum(),o=l._value,i=!1,t||(a={newValue:r,oldValue:o,scrollOrientation:l._isHorizontalScroll?0:1,scrollEventType:l._scrollEventType},l._$scrollContainerDiv.trigger(te,a),i=a.ignoreUpdatePosition,a.newValue>l._maximum()&&(a.newValue=l._maximum()),r=a.newValue),l._value=r,5!==l._scrollEventType&&(e=(r-l._minimum())*l._scrollUnit),l._scrollPosition=e,i||l._$scrollbarDiv.css(s,e)},hitTest:function(e,t){var n,r,o,a,l=this,s=0,u=0,c=l._$scrollbarDiv.outerWidth(),_=l._$arrowStartDiv.outerWidth(),f=l._$scrollbarWrapperDiv.outerWidth(),d=l._$scrollbarDiv.offset(),h=i(l._getScrollbar()).offset(),g=d.left-h.left-18;return l._isHorizontalScroll?e<s+f+_&&e>s+_?e<s+g+c+_&&e>g?{element:"thumbButton",x:e,y:t}:{element:"trackButton"}:e<=s+_&&e>s?{element:"leftButton",x:e,y:t}:{element:"rightButton",x:e,y:t}:(n=l._$scrollbarDiv.outerHeight(),r=l._$arrowStartDiv.outerHeight(),o=l._$scrollbarWrapperDiv.outerHeight(),a=d.top-h.top-18,t<u+o+r&&t>u+r?t<u+a+n+r&&t>a?{element:"thumbButton",x:e,y:t}:{element:"trackButton"}:t<=u+r&&t>u?{element:"upButton",x:e,y:t}:{element:"downButton",x:e,y:t})},_getScrollbarRect:function(){var e=this;return{x:0,y:0,width:e._width(),height:e._height()}}},e}(),o._Scrollbar=t,r=function(){function e(e,t){var n=this;n._showHorizontalScrollbar=!0,n._showVerticalScrollbar=!0,n._defaultScrollbarSize=18,n._$superPanel=e&&i(e),n._$content=t&&i(t),n._refreshLayout(!0)}return e.prototype={constructor:e,_horizontalSmallChange:d("horizontalSmallChange",10),_verticalSmallChange:d("verticalSmallChange",10),_refreshLayout:function(e){var n,r,o,a,l,u,_,f,d,h,m,v,C,w=this;function y(){return i._createElement("div",[P,D,V,L,k,B],["absolute",0,0,"none",0,0])}function S(e,n){var r,o,a,l=n?w._horizontalScrollbar:w._verticalScrollbar;return l||(r=new t(n),o=i._createElement("div"),n?(w._$horizontalBarContainer=o,w._horizontalScrollbar=r,o.css([P,D,O,L,k,B],["absolute",0,0,"none",0,0])):(w._$verticalBarContainer=o,w._verticalScrollbar=r,o.css([P,N,V,L,k,B],["absolute",0,0,"none",0,0])),a=(n?w._horizontalScrollbar:w._verticalScrollbar)._getScrollbar(),o.append(a),e.append(o),r)}function x(e,t,n,r,o,a){a?(w._$horizontalBarContainer.css([M,E],[t,r]),e._width(t),e._height(r)):(w._$verticalBarContainer.css([M,E],[r,t]),e._width(r),e._height(t)),e._minimum(0),e._maximum(o-t),e._pageValue(t),e._smallChange(a?w._horizontalSmallChange():w._verticalSmallChange()),e._largeChange(t),e._refreshLayout(),i(e._getScrollbar()).bind(te,function(e,t){n.css(a?D:V,0-t.newValue)}),a?w._$horizontalBarContainer.show():w._$verticalBarContainer.show()}function b(e){w._$contentWrapper||(w._$contentWrapper=y(),w._$contentWrapper.css([W,z],["hidden","inline-block"]),e.append(w._$contentWrapper))}function T(e){w._$tempContentWrapper||(w._$tempContentWrapper=i._createElement("div",P,"relative",s,e))}w._$superPanel&&w._$content&&(n=w._defaultScrollbarSize,r=w._$content.width(),o=w._$content.height(),a=w._$superPanel.width(),l=w._$superPanel.height(),u=a-n,_=l-n,f=!1,w._$container||(w._$container=y(),w._$container.css([P,W],["relative","hidden"]),f=!0),w._$container.css([M,E],[a,l]),b(w._$container),T(w._$contentWrapper),e&&w._$tempContentWrapper.append(w._$content).css([V,D],[0,0]),c.chrome&&(r=g(r),o=g(o),a=p(a),l=p(l)),d=w._isNeedScrollbars(r,o,a,l),h=d._isNeedVScroll,m=d._isNeedHScroll,m?(h||(u+=n),v=S(w._$container,!0),x(v,u,w._$tempContentWrapper,n,r,!0)):w._$horizontalBarContainer&&w._$horizontalBarContainer.hide(),h?(m||(_+=n),C=S(w._$container,!1),x(C,_,w._$tempContentWrapper,n,o,!1)):w._$verticalBarContainer&&w._$verticalBarContainer.hide(),m||h||(u+=n,_+=n),w._showHorizontalScrollbar=m,w._showVerticalScrollbar=h,w._pageWidth=u,w._pageHeight=_,w._$contentWrapper.css([M,E],[u,_]),f&&(w._$superPanel.append(w._$container),w._initEvent()))},_scrollChildIntoView:function(e){var t=this,n=t._getScrollOffset(e),r=n._left,o=n._top;!l(r)&&t._horizontalScrollbar&&t._hScrollTo(r),!l(o)&&t._verticalScrollbar&&t._vScrollTo(o)},_hScrollTo:function(e){var t,n,r=this;r._horizontalScrollbar.value(e),t=r._pageWidth,n=r._$content.width(),e>=0&&e<=n-t&&r._$tempContentWrapper.css(D,0-e)},_vScrollTo:function(e){var t,n,r=this;r._verticalScrollbar.value(e),t=r._pageHeight,n=r._$content.height(),e>=0&&e<=n-t&&r._$tempContentWrapper.css(V,0-e)},_isNeedScrollbars:function(e,t,n,r){var o=this._defaultScrollbarSize,i=n-o,a=r-o,l={_isNeedHScroll:!1,_isNeedVScroll:!1};return e>n&&(l._isNeedHScroll=!0,l._isNeedVScroll=t>a),t>r&&(l._isNeedVScroll=!0,l._isNeedHScroll=e>i),l},_getScrollOffset:function(e){var t=i(e),n=this._$contentWrapper,r=this._$tempContentWrapper,o,a,l,u,c,_,f,d={_left:s,_top:s};return e?(o=t.offset(),a=r.offset(),l=n.offset(),o.leftWidth=o.left+t.outerWidth(),o.topHeight=o.top+t.outerHeight(),l.leftWidth=l.left+n.outerWidth(),l.topHeight=l.top+n.outerHeight(),u=o.left-a.left,o.left<l.left?d._left=u:o.leftWidth>l.leftWidth&&(c=o.leftWidth-a.left-n.innerWidth(),d._left=u<c?u:c),_=o.top-a.top,o.top<l.top?d._top=_:o.topHeight>l.topHeight&&(f=o.topHeight-a.top-n.innerHeight(),d._top=_<f?_:f),d):d},_initEvent:function(){var e=this;this._$tempContentWrapper&&(e._mousewheelHandler=function(t){e._contentContainerMousewheel(t)},e._$tempContentWrapper.bind($,e._mousewheelHandler),e._$tempContentWrapper.bind(ee,e._mousewheelHandler))},_contentContainerMousewheel:function(e){var t,n,r,o,i,a,s,u=this;l(e.wheelDelta)&&l(e.detail)&&(e.wheelDelta=e.originalEvent.wheelDelta,e.detail=e.originalEvent.detail),t=e.detail?e.detail:e.wheelDelta/-40,n=t,r=u._verticalScrollbar,o=parseInt(u._$tempContentWrapper.css(V)),i=u._pageHeight,a=u._$content.height(),a<i&&(a=i),isNaN(o)&&(o=0),s=o-n*u._verticalSmallChange(),s>=0&&(s=0),s<0&&0-s>a-i&&(s=0-(a-i)),s!==o&&(u._$tempContentWrapper.css(V,s),u._showVerticalScrollbar&&r.value(0-s)),_(e)}},e}(),o._ScrollablePanel=r,e.exports=o}()},function(e,t,n){!function(){"use strict";var t=n(1),r=n(5)._ColorHelper,o=n(4).GC$,i=n(3),a=n(11)._StyleHelper,l=n(28)._SheetTabBase,s=r._invertColor,u=r._fromString,c=i._ThemeStyleHelper,_=null,f="blank",d="nextButton";o.inherit(h,l);function h(e){l.call(this,e);var t=this;t._tabLeftPadding=13,t._tabRightPadding=12,t._tabSpace=0,t._resizeBarWidth=30,t._itemWidth=28,t._moreTabWidth=28,t._newTabSize=28,t._firstTabSpace=0,t._font="10pt Segoe UI"}o.extend(h.prototype,{_getNavigationButtonWidth:function(){var e=this._workbook;return e&&e.options.tabNavigationVisible?this._itemWidth:0},_getNavigationButtonHeight:function(){var e=this._workbook;return e&&e.options.tabNavigationVisible?e._getTabStripHeight():0},_getFirstMoreTabWidth:function(){return this._moreTabWidth},_getSecondMoreTabWidth:function(){return this._hideNewTabSecondMoreTab?0:this._moreTabWidth},_getNewTabSize:function(){return this._hideNewTabSecondMoreTab?0:this._newTabSize},_getTabEndPosition:function(){var e,t,n=this,r=n._workbook.sheets,o=n._getTabStartPosition(),i=n._tabSizes,a=n._getBounds(),l=a.x+a.width-n._resizeBarWidth-n._getNewTabSize()-n._getSecondMoreTabWidth();for(e=n._firstTab,t=r.length;e<t;e++)if(r[e].visible()&&(o+=i[e]),o>l){o=l;break}return o},_getTabStartPosition:function(){var e=this;return 2*e._getNavigationButtonWidth()+e._getFirstMoreTabWidth()+e._getNavigationMarginLeft()},_getNavigationMarginLeft:function(){var e=this,t=e._workbook;return t&&t.options.tabNavigationVisible?e._resizeBarWidth/2:0},getResizeBarBounds:function(){var e=this,t=e._getBounds();return{x:t.x+t.width-e._resizeBarWidth,y:_,width:e._resizeBarWidth,height:_}},getNavButtonBounds:function(){var e=this;return{x:e._resizeBarWidth/2,y:_,width:e._getNavigationButtonWidth(),height:_,endIndex:3,startIndex:1}},getSheetTabBounds:function(){var e=this,t=e._getBounds(),n=e._getSecondMoreTabWidth();return{x:e._getTabStartPosition(),y:_,height:_,secondMoreTabWidth:e._getSecondMoreTabWidth(),moreTabPos:t.x+t.width-e._resizeBarWidth-e._getNewTabSize()-n}},getPreMoreTabBounds:function(){var e=this;return{x:e._getTabStartPosition()-e._getFirstMoreTabWidth(),width:e._getFirstMoreTabWidth()}},_isCoverSheetTab:function(){var e=this;return e._activePos+e._tabSizes[e._activeIndex]>e._getCoverPosition()},_getCoverPosition:function(){var e=this;return e._getBounds().width-e._resizeBarWidth-e._getNewTabSize()-e._getSecondMoreTabWidth()},_getInputTopPosition:function(){return 6},_getTabIndicatorEdgeElements:function(){return[f,d]},_getBasicWidth:function(){return this._getTabStartPosition()},_paintBackground:function(e,t){e.save(),e.beginPath();var n=c._getVisualStateThemeStyle(0,"gc-tabStripBackground");this._backgroundColor=u(n.backgroundColor),e.fillStyle=n.backgroundColor,e.fillRect(t.x,t.y,t.width,t.height),e.beginPath(),e.strokeStyle=n.borderTopColor,e.moveTo(t.x,t.y+.5),e.lineTo(t.x+t.width,t.y+.5),e.stroke(),e.restore()},_paintNewSheetTab:function(e,t,n,r){var o,i,a=this,l=a._workbook.options.newTabVisible,s=a._itemWidth,u=a._getSecondMoreTabWidth();n+=u,a._newTabSize=l?s:0,o=t.x+t.width-a._resizeBarWidth-a._getNewTabSize(),n>o&&(n=o,i=o-u,i<r&&(i=r,n=i+s),a._drawMoreTab(e,i,0,u,t.height)),l&&a._drawNewSheetTab(e,n,0,s,t.height,-2===a._hoverTab)},_paintTabBeforeFirstTab:function(e,t,n,r){var o=this._getFirstMoreTabWidth();this._drawMoreTab(e,r-o,0,o,t.height)},_paintNavigationButtons:function(e,t,n){var r=this,o=5,i=r._getNavigationButtonWidth(),a=r._getNavigationButtonHeight(),l=r._resizeBarWidth/2+i/2,s=a/2,u=r._hoverNavButton;r._drawNavButton(e,l,s,l+o,s+o,l+o,s-o,!0,_,1===u),l+=i,r._drawNavButton(e,l,s,l-o,s+o,l-o,s-o,!1,_,2===u)},_paintResizeBar:function(e,t){var n,r,o=this,i=o._resizeBarWidth,a=c._getVisualStateThemeStyle(0,"gc-tabStripResizeBarInner");o._workbook.options.showHorizontalScrollbar&&(e.beginPath(),e.rect(t.x+t.width-i,0,i,t.height),e.clip(),n=t.x+t.width-i/2,r=t.y+t.height/2,e.fillStyle=a.color,e.fillRect(n,r,2,2),e.fillRect(n,r-4,2,2),e.fillRect(n,r+4,2,2))},_drawTab:function(e,t,n,r,o,i,l,s,u){var _,f,d,h,g,p,m,v=this,C=0;s&&(C=4),l&&(C=3),_=c._getVisualStateThemeStyle(C,"gc-tab-"+c._getString(C)),f=c._getVisualStateThemeStyle(0,"gc-tab-"+c._getString(0)),e.save(),d=4,h=3,l&&(e.fillStyle="white",e.fillRect(t,n,r,o-d)),g=v._getTabBackColor(e,l,u,_),e.fillStyle=g,e.fillRect(t+h,n+h,r-2*h+1,o-2*h),e.beginPath(),e.lineWidth=1,e.strokeStyle=f&&f.borderLeftColor,l?(e.moveTo(t+.5,n),e.lineTo(t+.5,n+o-d),e.moveTo(t+r+.5,n),e.lineTo(t+r+.5,n+o-d)):(e.moveTo(t+.5,n+d),e.lineTo(t+.5,n+o-d),e.moveTo(t+r+.5,n+d),e.lineTo(t+r+.5,n+o-d)),e.stroke(),l&&(e.beginPath(),e.strokeStyle=_&&_.borderBottomColor,e.lineWidth=2,e.moveTo(t,n+o-d),e.lineTo(t+r+1,n+o-d),e.stroke()),e.textBaseline="top","string"==typeof g&&(p=g),e.fillStyle=v._getTabForeColor(_,p),(s||l)&&(e.font=a._setStringFont(e.font,"bold")),m=v._tabLeftPadding,e.textBaseline="middle",e.fillText(u,t+m,n+o/2-1),e.restore()},_drawNavButton:function(e,t,n,r,o,i,a,l,s,u){var _,f,d,h,g,p;e.save(),_=this,f=1,u&&(f=4),l?(t-=2,r-=2,i-=2,-1===(d=_._getPreVisibleIndex(_._firstTab))&&(f=0)):(t+=2,r+=2,i+=2,-1===(h=_._reCalculateFirstTabIndex(_._getVisibleTabs()))&&(f=0)),g=c._getVisualStateThemeStyle(f,"gc-navButton-"+c._getString(f)),e.strokeStyle=this._getVisibleForeColor(g.borderTopColor),e.beginPath(),p=1,t>r&&(p=-1),e.moveTo(t-.5,n),e.lineTo(t-.5,n+1),e.moveTo(t+p-.5,n-1),e.lineTo(t+p-.5,n+2),e.moveTo(t+2*p-.5,n-2),e.lineTo(t+2*p-.5,n+3),e.moveTo(t+3*p-.5,n-3),e.lineTo(t+3*p-.5,n+4),e.stroke(),e.restore()},_drawNewSheetTab:function(e,t,n,r,o,i){var a,l,s;e.save(),e.beginPath(),a=(o-14)/2,l=1,i&&(l=4),s=c._getVisualStateThemeStyle(l,"gc-tabStripNewTab-"+c._getString(l)),e.lineWidth=1.5,e.strokeStyle=this._getVisibleForeColor(s.borderTopColor),e.arc(t+r/2,n+o/2,a,0,2*Math.PI),e.stroke(),e.beginPath(),e.lineWidth=2,e.moveTo(t+r/2-4,n+o/2),e.lineTo(t+r/2+4,n+o/2),e.moveTo(t+r/2,n+o/2-4),e.lineTo(t+r/2,n+o/2+4),e.stroke(),e.restore()},_drawMoreTab:function(e,t,n,r,o){var i,a,l;e.save(),e.beginPath(),i=1,a=this._hoverNavButton,5!==a&&6!==a||(i=4),l=c._getVisualStateThemeStyle(i,"gc-navMoreButton-"+c._getString(i)),e.fillStyle=this._getVisibleForeColor(l.borderTopColor),e.fillRect(t+r/2,n+o/2,2,2),e.fillRect(t+r/2-4,n+o/2,2,2),e.fillRect(t+r/2+4,n+o/2,2,2),e.restore()},_getVisibleForeColor:function(e){var t=u(e),n=this._backgroundColor;return t.a<=.01?s(n):r._isTwoColorSimilar(n,t)?s(t):e}}),t._SheetTab=h,e.exports=t}()},function(e,t,n){!function(){"use strict";var t=n(1),r=n(5),o=n(4).GC$,i=n(3),a=n(11)._StyleHelper,l=r._ColorHelper,s=i._util,u=s._getLinearGradientColors,c=s._isValidSheetName,_=i._DPIHelper,f=i.Events,d=i._FocusHelper,h=i.Rect,g=i._ThemeStyleHelper,p=r._Types._isNullOrUndefined,m=i._util._createElement,v=t._CanvasHelper,C=document,w=null,y=Math.max,S=Math.min,x=Math.pow,b="px",T="none",R=".gcTab",A="mousedown"+R,I="mousemove"+R,M="mouseup"+R,E="mouseout"+R,F="dblclick"+R,D=".spliter",N="mousemove"+D,V="mouseup"+D,O=".tabNameEditor",H="keydown"+O,P="focus"+O,L="blur"+O,k="canvas",B="2d",W="resize",z="navButton",U="tab",Y="newSheet",G="blank",X="black",j="white",K=4,Z=10,J="navButton",q="sheetTab";function Q(){return r._getResource(t.SR)()}function $(e,t,n){e._trigger(f.SheetTabClick,{sheet:t,sheetName:t?t._name:w,sheetTabIndex:p(n)?-1:n})}function ee(e,t){e._trigger(f.SheetMoving,t)}function te(e,t,n,r){e._trigger(f.SheetMoved,{sheet:t,sheetName:t?t._name:w,oldIndex:n,newIndex:r})}function ne(e){var t=this;t._workbook=w,t._activeIndex=0,t._firstTab=0,t._activePos=70,t._hoverNavButton=-1,t._hoverTab=-1,t._font="",t._tabSizes=[],t._targetTabIndex=-1,t._sourceTabIndex=-1,t._reorderSpeedTimeout=w,t._paintSuspended=0,t._setBounds(new h(0,0,200,28)),t._name=e}i._defineFeature(ne),ne.prototype={_setHost:function(e){var t,n=this;n._canvas&&n._dispose(!0),t=m(k),_._adjustDevicePixel(t,n._workbook),t.setAttribute("id",n._name),n._tabIndicator=n._getTabIndicator(),e.appendChild(n._tabIndicator[0]),e.appendChild(t),n._canvas=t,o(t).bind(A,function(e){return n._doMouseDown(e)}).bind(I,function(e){return n._doMouseMove(e)}).bind(M,function(e){return n._doMouseUp(e)}).bind(E,function(e){return n._doMouseOut(e)}).bind(F,function(e){return n._doMouseDbClick(e)}),n._doResize(),ne._callFeatureHandler(n,"setHost")},_setOwner:function(e){var t=this,n=e.options.font;t._workbook=e,e&&n&&n.length>0&&(t._font=n)},_getBounds:function(){var e=this._bounds;return new h(e.x,e.y,e.width,e.height)},_setBounds:function(e){var t=this._bounds=new h(0,0,0,0);t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height},_getNewTabSize:function(){return this._newTabSize},_getTabEndPosition:function(){var e=this._getBounds();return e.x+e.width-this._resizeBarWidth},_getTabStartPosition:function(){return 0},_doResize:function(){var e,t,n,r,i=this,a=i._getCanvas();a&&a.parentNode&&(e=o(a.parentNode),0!==e.width()&&0!==e.height()&&(t=y(e.width(),0),n=y(e.height(),0),a.style.display=T,a.width=t,a.height=n,a.style.display="",a.style.width=t+b,a.style.height=n+b,t=a.clientWidth||a.width,n=a.clientHeight||a.height,r=i._getBounds(),i._setBounds(new h(r.x,r.y,t,n)),_._setSize(a,t,n),i.repaint()))},_isCoverSheetTab:function(){return!1},_getCoverPosition:function(){return 0},_getInputTopPosition:function(){return 0},_getTabIndicatorEdgeElements:function(){return[]},_getBasicWidth:function(){return 0},_getTabIndicator:function(){var e="transparent";return o(m("div")).css({position:"absolute","border-style":"solid","border-color":X,"border-width":K+b,display:"none",width:0,"border-bottom":0,"border-left-color":e,"border-right-color":e})},_dispose:function(e){var t,n=this,r=n._canvas;r&&(t=r.parentNode,o(r).unbind(A).unbind(I).unbind(M).unbind(F).unbind(E),t&&t.removeChild(r)),o(n._tabIndicator).remove(),ne._callFeatureHandler(n,"dispose"),e||(n._workbook=w)},hitTest:function(e,t){var n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m=this,v=m._workbook,C=m._getBounds(),w=m.getResizeBarBounds();if(v.options.showHorizontalScrollbar&&e>w.x&&e<C.x+C.width)return{type:"resize",element:W};for(n=m.getNavButtonBounds(),r=-1,o=n.startIndex,i=n.x,a=n.endIndex,l=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],s=o;s<a;s++){if(i<e&&e<i+n.width){r=s,z=l[s];break}i+=n.width}if(-1!==r)return{type:J,element:z,index:s};if(u=m.getPreMoreTabBounds(),i=u.x,c=0,-1!==(_=m._getPreVisibleIndex(m._firstTab))){if(i<=e&&e<i+u.width)return z=l[5],{type:J,element:z,index:5,position:i};c=m._firstTabSpace}if(f=m.getSheetTabBounds(),d=v.sheets,h=m._tabSizes,g=m._tabSpace,p=0,i=f.x+c,m._firstTab>-1)for(s=m._firstTab;s<d.length&&s<h.length;s++)if(d[s].visible()){if(p=h[s],i<e&&e<i+p+g){if(U=v.sheets[s].name(),f.moreTabPos>0&&e<f.moreTabPos)return{type:q,element:U,index:s,position:i};if(0===f.moreTabPos)return{type:q,element:U,index:s,position:i}}i+=p+g}if(i>f.moreTabPos&&f.moreTabPos>0&&(i=f.moreTabPos),-1!==m._reCalculateFirstTabIndex(m._getVisibleTabs())){
if(i<e&&e<i+f.secondMoreTabWidth)return z=l[6],{type:J,element:z,index:6,position:i}}else if(i<e&&e<i+f.secondMoreTabWidth)return{element:G,position:i};return i+=f.secondMoreTabWidth,v.options.newTabVisible&&i<e&&e<i+m._getNewTabSize()?{type:q,element:Y,position:i,index:-1}:{element:G}},_doMouseDown:function(e){var t,n,r,i,a,l,s,u,c=this,_={e:e,r:w};return ne._callFeatureHandler(c,"preProcessMouseDown",_),t=_.r,p(t)?(n=o(c._getCanvas()).offset(),r=e.pageX-n.left,i=e.pageY-n.top,a=c._workbook.getActiveSheet(),c._tabNameEditor&&c._endSheetTabEditing(a,!1),l=c.hitTest(r,i),s=l.element,0===e.button&&(s===W?(c._resizeTab=!0,c._activeX=e.pageX,c._handleDocumentMouseMove()):s===z?c._doNavButtonClick(l.index):s===U?(c._doSheetTabClick(l.index,l.position),c._initTabReorder(e,l)):s===Y&&c._doNewTabClick(l.position),a=c._workbook.getActiveSheet(),(u=a&&a._eventHandler)&&!a.isEditing()&&a._setFocus()),c._isMouseDownInTab=!0,!1):t},_doMouseMove:function(e){var t,n,r,i,a,l,s,u,c,_,f,d,h,g,m,v=this,C={e:e,r:w};if(ne._callFeatureHandler(v,"preProcessMouseMove",C),t=C.r,!p(t))return t;if(n=v._canvas.style,r="default",i="w-resize",v._tabStartPos&&!v._reorderSheet&&(a=Math.sqrt(x(v._tabStartPos.x-e.pageX,2)+x(v._tabStartPos.y-e.pageY,2)))>Z&&(v._reorderSheet=!0),v._resizeTab)n.cursor=i,l=e.pageX-v._activeX,s=v._workbook._vp.clientWidth,u=v._workbook,u.options.tabStripRatio=u._getActualTabStripRatio()+l/s,c=v._resizeBarWidth/s,_=1,u._getActualTabStripRatio()<c?(u.options.tabStripRatio=c,v._activeX=v._resizeBarWidth):u._getActualTabStripRatio()>=_?(u.options.tabStripRatio=_,v._activeX=s):v._activeX=e.pageX,u._doTabHSResize();else if(v._reorderSheet)v._showTabTip(e.pageX,e.pageY),v._setTabIndicator(e);else{if(v._hoverNavButton=-1,v._hoverTab=-1,f=o(v._getCanvas()).offset(),d=e.pageX-f.left,h=e.pageY-f.top,g=v.hitTest(d,h),""===(m=g.element))return n.cursor=r,v.repaint(),!1;m===W?n.cursor=i:(n.cursor=r,m===z?v._hoverNavButton=g.index:m===U?v._hoverTab=g.index:m===Y&&(v._hoverTab=-2)),v.repaint()}return!1},_doMouseUp:function(e){var t,n=this,r={e:e,r:w};return ne._callFeatureHandler(n,"preProcessMouseUp",r),t=r.r,p(t)?(n._resizeTab&&(n._resizeTab=!1,n._workbook._doTabHSResize()),n._clearSpeedTimeout(),n._reorderSheet&&(n._reorderSheet=!1,n._tabTip.remove(),n._reorderTab(),n._tabIndicator.hide()),n._tabStartPos=w,n._clearRepeatDown(),n._unhandleDocumentMouseMove(),!n._isMouseDownInTab||(n._isMouseDownInTab=!1,!1)):t},_doMouseOut:function(e){var t,n,r,o=this,i={e:e,r:w};return ne._callFeatureHandler(o,"preProcessMouseOut",i),t=i.r,p(t)?(o._clearRepeatDown(),n=o._hoverNavButton,o._hoverNavButton=-1,r=o._hoverTab,o._hoverTab=-1,o._hoverNavButton===n&&o._hoverTab===r||o.repaint(),!1):t},_handleDocumentMouseMove:function(){var e,t=this;t._isCapture||(o(C).bind(N,function(e){t._doMouseMove(e)}).bind(V,function(e){t._doMouseUp(e)}),e=t._workbook.getActiveSheet(),e&&(e._continueMouseUpBubble=!0),t._isCapture=!0)},_unhandleDocumentMouseMove:function(){if(this._isCapture){this._isCapture=!1,o(C).unbind(N).unbind(V);var e=this._workbook.getActiveSheet();e&&delete e._continueMouseUpBubble}},_doNavButtonClick:function(e,t){var n,r,o=this;o._clearRepeatDown(),n=o._getVisibleTabs(),n.length<=0||(r=200,e%=4,0===e?o._navigateToFirst(n):1===e?(t||(o._repeatDown=setTimeout(function(){o._doNavButtonClick(1)},r)),o._navigateToPrevious(n)):2===e?(t||(o._repeatDown=setTimeout(function(){o._doNavButtonClick(2)},r)),o._navigateToNext(n)):3===e&&o._navigateToLast(n))},_doSheetTabClick:function(e,t){var n,r,o,i=this,a=i._workbook;i._activeIndex=e,i._activePos=t,a.suspendPaint(),n=a.getActiveSheet(),(r=a.getSheet(e))&&r.isEditing()&&r!==n&&(o=n._formulaTextBox&&n._formulaTextBox._isSelectMode,!r._endEditImp(void 0,void 0,o))||($(a,r,e),i._doSheetTabClickChange(e),a.resumePaint(),i.repaint())},_doNewTabClick:function(e){var t,n,r=this,o=r._workbook,i=o.getActiveSheet();if(!r._canCreateNewTab||r._canCreateNewTab(i)){for($(o,w,w),t=o.sheets.length,n=o._createSheet(o._getDefaultSheetName(t)),o._addSheetImp(t,1,n),r._activeIndex=t,r._activePos=e,o._setActiveSheetIndexImp(t,1,!1,!0);r._activeIndex>r._firstTab&&(r._isCoverSheetTab()||r._firstTab<r._getNextVisibleIndex(-1));)r._tabVisible(r._firstTab)&&(r._activePos-=r._tabSizes[r._firstTab]),r._firstTab++;r.repaint()}},_doSheetTabClickChange:function(e,t){var n,r,o,i,a;void 0===t&&(t=!0),n=this,r=n._workbook,o=r.getActiveSheet(),i=!1,o._formulaTextBox&&o._formulaTextBox._isSelectMode&&(i=!0),e!==r._activeSheetIndex&&(r._setActiveSheetIndexImp(e,1,i,!0),a=n._getNextVisibleIndex(n._firstTab),n._activeIndex>n._firstTab&&n._activePos+n._tabSizes[n._activeIndex]>n._getCoverPosition()&&-1!==a&&(n._firstTab=a)),n._activeIndex<n._firstTab&&(n._firstTab=n._getPreVisibleIndex(n._firstTab))},_doMouseDbClickImp:function(e,t){var n,r,i,a,l,s,u,c,_,h=this,g=h._workbook;if(h.hitTest(e,t).element===U){if(n=h._activeIndex,r=g.sheets[n],g._trigger(f.SheetTabDoubleClick,{sheet:r,sheetName:r._name,sheetTabIndex:n}),!g.options.tabEditable)return!1;if((i=d._getActiveElement())&&i.endEdit&&!i.endEdit())return;d._setActiveElement(w),a=h._tabSizes[n],l=o(h._getCanvas()).offset(),s=g._getContainerDiv(),u=o(s).offset(),c=m("input"),_=c.style,c.type="text",c.value=r._name,c.setAttribute("contentEditable","true"),c.setAttribute("autocomplete","off"),_.position="absolute",_.margin=0,_.padding=0,_.margin=0,_.left=l.left-u.left+h._activePos+h._tabLeftPadding+b,_.top=l.top-u.top+h._getInputTopPosition()+b,_.width=a-h._tabLeftPadding-h._tabRightPadding+2+b,_.backgroundColor=j,_.borderWidth="0px",_.outline=T,o(c).appendTo(s),h._tabNameEditor=c,o(c).addClass("gc-sheetTabEditor").bind(H,function(e){return 13===e.keyCode?(h._endSheetTabEditing(r,!1),!1):27===e.keyCode?(h._endSheetTabEditing(r,!0),!1):void 0}).bind(P,function(){c.selectionStart=0,c.selectionEnd=c.value.length}).bind(L,function(){h._endSheetTabEditing(r,!1)}),c.focus()}return!1},_doMouseDbClick:function(e){var t,n,r,i,a=this,l={e:e,r:w};return ne._callFeatureHandler(a,"preProcessMouseDbClick",l),t=l.r,p(t)?(n=o(a._getCanvas()).offset(),r=e.pageX-n.left,i=e.pageY-n.top,a._doMouseDbClickImp(r,i)):t},_endSheetTabEditing:function(e,t){var n,r,i,a,l=this,s=l._tabNameEditor;s&&(o(s).unbind(H).unbind(P).unbind(L),n=s.value,!1===t&&(r=e.name(),n!==r&&(!p(n)&&""!==n&&c(n,l._workbook.sheets,e)?(i={sheet:e,oldValue:r,newValue:n,cancel:!1},e._trigger(f.SheetNameChanging,i),!1===i.cancel&&(e._commandManager().execute({cmd:"renameSheet",sheetName:r,name:n}),a={sheet:e,oldValue:r,newValue:n},e._trigger(f.SheetNameChanged,a))):e._trigger(f.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:5,message:Q().Exp_SheetNameInvalid}))),s.parentNode.removeChild(s),delete l._tabNameEditor)},_allowSheetReorder:function(){return this._workbook.options.allowSheetReorder},_initTabReorder:function(e,t){var n=this;n._allowSheetReorder()?(n._sourceTabIndex=t.index,n._tabTip=n._getTabTip(n._sourceTabIndex),n._tabStartPos=new i.Point(e.pageX,e.pageY),n._handleDocumentMouseMove()):n._reorderSheet=!1},_getTabTip:function(e){var t,n,r=this._workbook.sheets;if(!(e>=r.length||e<0))return t=r[e]._name,t||(t="sheet"),n=o(m("span")).text(t).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"}),n.addClass("ui-widget-header gc-tab-tip-span btn-primary"),n},_clearRepeatDown:function(){var e=this._repeatDown;e&&(clearTimeout(e),this._repeatDown=w)},_showTabTip:function(e,t){var n,r,i=this,a=i._tabTip;a&&0===o(".gc-tab-tip-span").length&&(a.appendTo(C.body),a.hide()),n=a.width(),r=a.height(),a.css({left:e-n/2,top:t-r/2}),a.show()},_setTabIndicator:function(e){var t=this,n=o(t._getCanvas()),r=n.position(),i=n.offset(),a=e.pageX-i.left,l=e.pageY-i.top,s=t.hitTest(a,l),u=s.element,c=t._getBounds(),_=t._getTabStartPosition(),f=t._workbook.sheets.length,d=100,h=c.x+t._getCoverPosition(),g=t._tabIndicator;a>h?t._reorderSpeedTimeout===w&&t._targetTabIndex<f&&(t._reorderSpeedTimeout=setInterval(function(){t._navigateToNext(t._getVisibleTabs()),t._targetTabIndex===f?(t._clearSpeedTimeout(),g.css({left:r.left+t._getLastTabPos()-K,top:r.top-K}),g.show()):(t._targetTabIndex++,g.hide())},d)):a<_?t._reorderSpeedTimeout===w&&t._targetTabIndex>0&&(t._reorderSpeedTimeout=setInterval(function(){t._navigateToPrevious(t._getVisibleTabs()),0===t._targetTabIndex?(t._clearSpeedTimeout(),g.css({left:r.left+_-K,top:r.top-K}),g.show()):(t._targetTabIndex--,g.hide())},d)):(t._clearSpeedTimeout(),u!==U&&-1===t._getTabIndicatorEdgeElements().indexOf(u)||(u!==U||p(s.index)?t._targetTabIndex=t._workbook.sheets.length:t._targetTabIndex=s.index,g.css({left:r.left+s.position-K,top:r.top-K}),g.show()))},_getLastTabPos:function(){var e,t=this,n=t._tabSizes,r=t._getVisibleTabs(),o=t._getVisibleTabIndex(t._firstTab,r),i=0,a=t._getTabStartPosition()+t._firstTabSpace;for(e=o;e<r.length;e++)i=r[e],a+=n[i],a+=t._tabSpace;return a},_clearSpeedTimeout:function(){var e=this._reorderSpeedTimeout;e&&(clearInterval(e),this._reorderSpeedTimeout=w)},_reorderTab:function(){var e,t,n,r,o=this,i=o._workbook,a=o._targetTabIndex,l=o._sourceTabIndex,s=-1,u=i.getActiveSheet(),c=l,_=a;if(l<a-1&&(_=a-1),-1!==a&&-1!==l&&l!==a&&l!==a-1&&o._tabIndicator.isVisible()){if(e={sheet:u,sheetName:u._name,oldIndex:c,newIndex:_,cancel:!1},ee(i,e),e.cancel)return;if(t=i.sheets,r=t[l],l>a){for(n=l;n>a;n--)t[n]=t[n-1];t[a]=r,s=a}else if(l<a-1){for(n=l;n<a-1;n++)t[n]=t[n+1];t[a-1]=r,s=a-1}i._activeSheetIndex=s,o._doResize(),te(i,u,c,_)}},_getVisibleTabs:function(){var e=[],t;for(t=0;t<this._workbook.sheets.length;t++)this._tabVisible(t)&&e.push(t);return e},_navigateToFirst:function(e){e.length>0&&this._firstTab!==e[0]&&this._workbook.startSheetIndex(e[0])},_navigateToPrevious:function(e){var t,n;e.length>0&&(t=this,t._firstTab>e[0]&&-1!==(n=t._getPreVisibleIndex(t._firstTab))&&t._workbook.startSheetIndex(n))},_navigateToNext:function(e){var t,n;e.length>0&&(t=this,t._firstTab<e[e.length-1]&&-1!==(n=t._reCalculateFirstTabIndex(e))&&t._workbook.startSheetIndex(t._getNextVisibleIndex(t._firstTab)))},_navigateToLast:function(e){if(e.length>0&&this._firstTab<e[e.length-1]){var t=this._reCalculateFirstTabIndex(e);-1!==t&&this._workbook.startSheetIndex(t)}},_reCalculateFirstTabIndex:function(e){var t,n,r,o,i,a,l,s,u,c,_;if(e.length>0)for(t=this,n=t._getCoverPosition(),r=0,o=t._tabSizes,l=t._getBasicWidth(),s=t._getVisibleTabIndex(t._firstTab,e),-1===s&&(s=0),i=e.length-1;i>=s;i--)if(a=e[i],u=o[a],r+=u,i!==e.length-1&&(r+=t._tabSpace),c=l+r,0!==i&&(c+=t._firstTabSpace),c>n)return _=i+1<e.length?e[i+1]:e[e.length-1],t._firstTab<_?_:-1;return-1},_getPreVisibleIndex:function(e){var t;for(t=e-1;t>=0;t--)if(this._tabVisible(t))return t;return-1},_getNextVisibleIndex:function(e){var t,n=this._workbook.sheets.length;for(t=e+1;t<n;t++)if(this._tabVisible(t))return t;return-1},_getVisibleTabIndex:function(e,t){var n;for(n=0;n<=t.length-1;n++)if(e===t[n])return n;return-1},_tabVisible:function(e){var t=this._workbook.sheets[e];return t&&t.visible()},_suspendPaint:function(){this._paintSuspended++},_resumePaint:function(){var e=this;--e._paintSuspended<=0&&(e._paintSuspended=0,e.repaint())},repaint:function(e){var t=this._getCanvas();t&&t.getContext&&this._paint(t.getContext(B),e)},_paint:function(e,t){var n,r,o,i,a,l,s,u,c,f,d,g,p,C=this;if(!(C._paintSuspended>0)){if(n=C._getBounds(),r=C._canvas,t){if(t.x>=n.x+n.width)return;if(t.y>=n.y+n.height)return;if(t.x+t.width>n.width&&(t.width=n.width-t.x,t.width<=0))return;if(t.y+t.height>n.height&&(t.height=n.height-t.y,t.height<=0))return;if(t.width<=0||t.height<=0)return}if(i=C.buffer,i&&(!i||i.width===r.width&&i.height===r.height)&&(i||i.width===n.width&&i.height===n.height)||(i&&_._disposeCanvasForSpread(C._workbook,i),C.buffer=i=m(k),_._adjustDevicePixel(i,C._workbook),_._setSize(i,n.width,n.height)),!(n.width<=0||n.height<=0||t&&(t.width<=0||t.height<=0))){o=C.buffer.getContext(B),o.clearRect(0,0,n.width,n.height),v._translate(o,-n.x,-n.y),C._paintTabs(o,t),v._translate(o,n.x,n.y),a=n.x>=0?0:-n.x,l=n.y>=0?0:-n.y,s=a,u=l,t&&(s=n.x+t.x,u=n.y+t.y,n=new h(s,u,t.width,t.height)),a=n.x>=0?n.x:0,l=n.y>=0?n.y:0,d=w,g=_._getScaleX(r),p=_._getScaleY(r),r&&1!==g&&(s*=g,u*=p,n.x*=g,n.y*=p,n.width*=g,n.height*=p);try{r?t?(c=y(n.width-s,0),f=y(n.height-u,0)):(c=S(n.width-s,y(r.width-n.x,3)),f=S(n.height-u,y(r.height-n.y,3))):(s=t.x,u=t.y,c=t.width,f=t.height),r?(v._scaleTo(e,1,1),e.clearRect(a,l,c,f),e.drawImage(C.buffer,s,u,c,f,a,l,c,f),v._scaleTo(e,g,p)):(o=C.buffer.getContext(B),d=o.getImageData(s,u,c,f))}catch(e){return}!r&&d&&n.width>0&&n.height>0&&e.putImageData(d,a,l)}}},_paintTabs:function(e,t){var n,r,o,i,l,s,u,c,_,f=this,d=f._workbook;if(e&&d){for(n=f._getBounds(),e.save(),e.font=f._font,t?e.rect(t.x,t.y,t.width,t.height):e.rect(n.x,n.y,n.width,n.height),e.clip(),e.beginPath(),o=f._getTabStartPosition(),i=o,e.save(),e.font=a._setStringFont(e.font,"bold"),f._tabSizes=[],s=d.sheets,l=0;l<s.length;l++)r=Math.round(e.measureText(s[l]._name).width)+f._tabRightPadding+f._tabLeftPadding,f._tabSizes.push(r);if(e.restore(),u=[],c=f._firstTab,c>0&&f._getPreVisibleIndex(c)>=0&&(i+=f._firstTabSpace),c>=0)for(l=c;l<s.length&&(_=s[l].visible(),r=f._tabSizes[l],!(i>n.x+n.width));l++)u.push({i:l,x:i,w:r,t:s[l]._name,visible:_}),_&&(i+=r+f._tabSpace);f._paintBackground(e,n),f._paintNewSheetTab(e,n,i,o),f._paintTab(e,n,u,c,o),f._workbook&&f._workbook.options.tabNavigationVisible&&f._paintNavigationButtons(e,n,o),f._paintResizeBar(e,n),e.beginPath(),e.restore()}},_paintBackground:function(e,t){},_paintNewSheetTab:function(e,t,n,r){},_paintTab:function(e,t,n,r,o){var i,a,l,s,u,c=this,_=c._workbook,f=_.sheets,d=c._hoverTab;if(c._activeIndex=_.getActiveSheetIndex(),i=c._activeIndex,f.length>0){for(e.save(),e.beginPath(),a=t.x+c._getCoverPosition(),e.rect(o,0,a-o,t.height),e.clip(),l=n.length-1;l>=0;l--)s=n[l],s.i!==i&&s.visible&&c._drawTab(e,s.x,0,s.w,t.height,5,!1,s.i===d,s.t);u=n[i-r],i>=r&&i<f.length&&u&&u.visible&&c._drawTab(e,u.x,0,u.w,t.height,5,!0,!1,u.t),e.restore(),e.save(),e.beginPath(),r>0&&c._getPreVisibleIndex(r)>=0&&c._paintTabBeforeFirstTab(e,t,r,o),e.restore()}},_paintTabBeforeFirstTab:function(e,t,n,r){},_paintNavigationButtons:function(e,t,n){},_paintResizeBar:function(e,t){},_drawNavButton:function(e,t,n,r,o,i,a,l,s,u){},_drawTab:function(e,t,n,r,o,i,a,l,s){},_getCanvas:function(){return this._canvas},_getTabStripBackColor:function(e,t){var n,r,o,i,a=e.createLinearGradient(t.x,t.y,t.width,t.height),l=g._getVisualStateThemeStyle(0,"gc-tabStripBackground"),s=l&&l.backgroundImage,c=l&&l.backgroundColor;if(s&&-1!==s.indexOf("linear-gradient"))for(n=u(s),r=0,o=n.length;r<o;r++)i=n[r],a.addColorStop(i.point,i.color);else c&&(a.addColorStop(0,"#DDDDDD"),a.addColorStop(1,c));return a},_getTabBackColor:function(e,t,n,r){var o,a,l,s,c,_,f,d,h,g=this,p=g._getBounds(),m=e.createLinearGradient(p.x+.7*p.height,p.y+0,.7*p.height,p.height),v=g._workbook.getSheetFromName(n);if(""===n&&g._firstTab>0&&(v=g._workbook.getSheet(g._firstTab-1)),o=v&&v.options.sheetTabColor)a="rgba(0, 0, 0, 0)",e.fillStyle=a,e.fillStyle=i._ThemeContext._getColor(v,o),(l=e.fillStyle)!==a&&(t?(m.addColorStop(0,j),m.addColorStop(.45,"#F1F6FD"),m.addColorStop(.9,l),m.addColorStop(1,j)):m=l);else if(r)if(s=r.backgroundImage,c=r.backgroundColor,s&&-1!==s.indexOf("linear-gradient"))for(_=u(s),f=0,d=_.length;f<d;f++)h=_[f],m.addColorStop(h.point,h.color);else c&&m.addColorStop(0,c);return m},_getTabForeColor:function(e,t){var n=X;return e&&(n=e.color),t&&l._getBrightness(l._fromString(t))<127.5&&(n=j),n}},t._SheetTabBase=ne,e.exports=t}()},function(e,t,n){!function(){"use strict";var t=n(1),r=n(5),o=n(3),i=n(4).GC$,a=n(28)._SheetTabBase,l=o._ThemeStyleHelper,s=o._util._getLinearGradientColors,u=null,c=Math.min,_="#92A5C7",f="newSheet";function d(){return r._getResource(t.SR)()}i.inherit(h,a);function h(e){a.call(this,e);var t=this;t._tabLeftPadding=12,t._tabRightPadding=8,t._tabSpace=3,t._resizeBarWidth=12,t._newTabSize=48,t._firstTabSpace=5,t._font="10pt Arial"}i.extend(h.prototype,{_getNavigationButtonWidth:function(){var e=this._workbook,t=e&&e.options,n=0;return n=t&&t.tabNavigationVisible?e._getScrollbarSize()*(t.useTouchLayout?2:1):0},_getNavigationButtonHeight:function(){var e=this._workbook;return e&&e.options.tabNavigationVisible?e._getScrollbarSize():0},_getTabStartPosition:function(){return 4*this._getNavigationButtonWidth()+this._getTabMarginLeft()},_getTabMarginLeft:function(){var e=this,t=e._workbook;return t&&t.options.tabNavigationVisible?2:0},getResizeBarBounds:function(){var e=this,t=e._getBounds();return{x:t.x+t.width-e._resizeBarWidth,y:u,width:e._resizeBarWidth,height:u}},getNavButtonBounds:function(){return{x:0,y:u,width:this._getNavigationButtonWidth(),height:u,endIndex:4,startIndex:0}},getSheetTabBounds:function(){return{x:this._getTabStartPosition(),y:u,height:u,secondMoreTabWidth:0,moreTabPos:0}},getPreMoreTabBounds:function(){var e=this;return{x:e._getTabStartPosition(),width:e._tabSpace+e._firstTabSpace}},_isCoverSheetTab:function(){var e=this;return e._activePos+e._tabSizes[e._activeIndex]+e._getNewTabSize()>e._getCoverPosition()},_getCoverPosition:function(){return this._getBounds().width-this._resizeBarWidth},_getInputTopPosition:function(){return 1},_getTabIndicatorEdgeElements:function(){return[f]},_getBasicWidth:function(){var e=this,t=e._getBounds().height,n=e._getTabStartPosition()+t;return e._workbook.options.newTabVisible&&(n+=e._getNewTabSize(),n+=e._tabSpace),n},_paintBackground:function(e,t){var n,r,o,i,a,u,c,_;if(e.save(),e.beginPath(),n=e.createLinearGradient(t.x,t.y,t.width,t.height),r=l._getVisualStateThemeStyle(0,"gc-tabStripBackground"),o=r&&r.backgroundImage,i=r&&r.backgroundColor,o&&-1!==o.indexOf("linear-gradient"))for(a=s(o),u=0,c=a.length;u<c;u++)_=a[u],n.addColorStop(_.point,_.color);else i&&(n.addColorStop(0,"#DDDDDD"),n.addColorStop(1,i));e.fillStyle=n,e.fillRect(t.x,t.y,t.width,t.height),e.restore()},_paintNewSheetTab:function(e,t,n,r){var o=this,i=o._workbook,a=d().NewTab;i.options.newTabVisible&&(o._newTabSize=e.measureText(a).width+o._tabLeftPadding,o._drawTab(e,n,0,o._getNewTabSize(),t.height,5,!1,-2===o._hoverTab,a))},_paintTabBeforeFirstTab:function(e,t,n,r){var o=this,i=n-1,a=o._tabSizes[i];o._drawTab(e,r+o._firstTabSpace-a-o._tabSpace,0,a,t.height,5,o._activeIndex===i,o._hoverTab===i,"")},_paintNavigationButtons:function(e,t,n){var r,o,i,a,l,s,c=this;e.fillStyle=_,e.fillRect(t.x,t.y,n-1,t.height),r=5,o=c._getNavigationButtonWidth(),i=c._getNavigationButtonHeight(),a=o/2,l=i/2,s=c._hoverNavButton,c._drawNavButton(e,a,l,a+r,l+r,a+r,l-r,!0,a-r,0===s),a+=o,c._drawNavButton(e,a,l,a+r,l+r,a+r,l-r,!0,u,1===s),a+=o,c._drawNavButton(e,a,l,a-r,l+r,a-r,l-r,!1,u,2===s),a+=o,c._drawNavButton(e,a,l,a-r,l+r,a-r,l-r,!1,a+4,3===s)},_paintResizeBar:function(e,t){var n,r=this,o=r._workbook,i=r._resizeBarWidth,a=l._getVisualStateThemeStyle,s=a(4,"gc-tabStripResizeBarInner"),u=a(0,"gc-tabStripResizeBarOuter");o.options.showHorizontalScrollbar&&(n=t.x+t.width-i,e.fillStyle=u.backgroundColor,e.fillRect(n,t.y,i,t.height),e.fillStyle=s.backgroundColor,e.fillRect(n+1,t.y+1,i-2,t.height-2),e.fillStyle=s.color,e.fillRect(n+i/2-1,t.y+4,2,t.height-8))},_drawTab:function(e,t,n,r,o,i,a,s,u){var c,f,d,h,g,p;e.save(),e.beginPath(),e.moveTo(t,n),e.lineTo(t,n+o-i),e.arcTo(t,n+o,t+r,n+o,i),e.lineTo(t+r,n+o),e.lineTo(t+r+o,n),a||e.lineTo(t,n),c=this,f=0,(a||s)&&(f=4),d=l._getVisualStateThemeStyle(f,"gc-tab-"+l._getString(f)),h=c._getTabBackColor(e,a||s,u,d),e.fillStyle=h,e.fill(),e.strokeStyle=_,e.stroke(),e.textBaseline="top","string"==typeof h&&(g=h),e.fillStyle=c._getTabForeColor(d,g),p=c._tabLeftPadding,e.textBaseline="middle",e.fillText(u,t+p,n+o/2),e.restore()},_drawNavButton:function(e,t,n,r,o,i,a,_,f,d){var h,g,p,m,v,C,w,y,S,x,b,T,R;if(e.save(),h=this,g=h._getBounds(),p=h._getNavigationButtonWidth(),m=l._getVisualStateThemeStyle,v=m(4,"gc-navButton-hover"),C=m(0,"gc-navButton-normal"),w=C&&C.backgroundColor,d)e.fillStyle=v.backgroundColor,e.fillRect(t-p/2+2,g.y+2,p-4,g.height-4);else{if((y=C&&C.backgroundImage)&&-1!==y.indexOf("linear-gradient")){for(S=e.createLinearGradient(g.x+.7*g.height,g.y+0,.7*g.height,g.height),x=s(y),b=0,T=x.length;b<T;b++)R=x[b],S.addColorStop(R.point,R.color);e.fillStyle=S}else w&&(e.fillStyle=w);e.fillRect(t-p/2,g.y+1,p,g.height-2)}e.fillStyle=d?v.color:C.color,void 0!==f&&f!==u&&e.fillRect(f,c(o,a),1,Math.max(o,a)-c(o,a)),_?(t-=2,r-=2,i-=2):(t+=2,r+=2,i+=2),e.beginPath(),e.moveTo(t,n),e.lineTo(r,o),e.lineTo(i,a),e.lineTo(t,n),e.fill(),e.restore()}}),t._SheetTab2007=h,e.exports=t}()},function(e,t,n){!function(){"use strict";var e=n(4).GC$,t=n(17).Worksheet,r=n(12).Style,o=n(3);e.extend(t.prototype,{getFormatter:function(e,t,n){return this._getStyleProperty(e,t,"formatter",n)},setFormatter:function(e,t,n,o){var i=this._getStyleImp(e,t,o);i||(i=new r),i.formatter=n,this.setStyle(e,t,i,o)}}),t._registerFeature("formatter",{settingText:function(e){var t,r=o._util._isStringNumber(e.value),i=n(6),a=i&&i.GeneralFormatter;a&&r&&(t={},(new a).getPreferredDisplayFormatter(e.value,t),"number"==typeof t.value&&(e.value=t.value))}})}()},function(e,t,n){!function(){"use strict";var t,r,o=n(1),i=n(12).LineBorder,a=n(4).GC$,l=void 0,s=null,u=Math.sqrt,c=Math.pow,_=Math.min,f=a.inherit,d=a.isEmptyObject,h=function(){function e(){}return e.prototype={constructor:e,_adjust:function(e){var t=this;0===e._orientation?(e._offsetEnd&&(t._x2+=e._offsetEnd),e._offsetStart&&(t._x1+=e._offsetStart)):(e._offsetEnd&&(t._y2+=e._offsetEnd),e._offsetStart&&(t._y1+=e._offsetStart))},_paint:function(e){var t=this._color||"#9eb6ce",n=this._lineWidth,r=e.lineWidth,o=e.strokeStyle;e.beginPath(),r===n&&o===t||(r!==n&&(e.lineWidth=n),o!==t&&(e.strokeStyle=t)),this._paintLine(e),e.stroke()},_paintLine:function(e){var t=this;e.moveTo(t._x1,t._y1),e.lineTo(t._x2,t._y2)}},e}(),g=function(e){f(t,e);function t(t,n,r,o,i,a){var l,s;e.call(this),l=a%2,l||(t!==r?(n-=.5,o-=.5):(t-=.5,r-=.5)),s=this,s._x1=t,s._y1=n,s._x2=r,s._y2=o,s._color=i,s._lineWidth=a}return t}(h),p=function(e){f(t,e);function t(t,n,r,o,i,a,l){var s,u;e.call(this),s=a%2,s||(t!==r?(n-=.5,o-=.5):(t-=.5,r-=.5)),u=this,u._x1=t,u._y1=n,u._x2=r,u._y2=o,u._color=i,u._lineWidth=a,u._pattern=l}return t.prototype._paintLine=function(e){var n=this;t._render(e,n._x1,n._y1,n._x2,n._y2,n._pattern)},t._render=function(e,t,n,r,o,i){var a,l,s=u(c(r-t,2)+c(o-n,2)),f={x:(r-t)/s,y:(o-n)/s},d=0,h=0;for(i=i&&i.length?i:[4,4];d<s;)a=_(i[h++%i.length],s-d),l=h%2,d+=a,l&&e.moveTo(t,n),t+=a*f.x,n+=a*f.y,l&&e.lineTo(t,n)},t}(h),m=function(e){f(t,e);function t(t,n,r,o,i,a,l,s){e.call(this),a?(t-=1,r-=1):(n-=1,o-=1);var u=this;u._x1=t,u._y1=n,u._x2=r,u._y2=o,u._color=i,u._horizontal=a,u._lineWidth=1,u._pattern1=l,u._pattern2=s}return t.prototype._paintLine=function(e){var t=this,n=t._horizontal?0:1,r=t._horizontal?1:0;p._render(e,t._x1-n,t._y1-r,t._x2-n,t._y2-r,t._pattern1),p._render(e,t._x1,t._y1,t._x2,t._y2,t._pattern2)},t}(h),v=function(e){f(t,e);function t(t,n,r,o,i,a){var l,s,u;e.call(this),l=a?0:1,s=a?1:0,u=this,u._line1=new g(t-l,n-s,r-l,o-s,i,1),u._line2=new g(t+l,n+s,r+l,o+s,i,1),u._color=i,u._horizontal=a,u._lineWidth=1}return t.prototype._paintLine=function(e){this._line1._paintLine(e),this._line2._paintLine(e)},t.prototype._adjust=function(e){var t=this;e._lineSide?1===e._lineSide?t._line1._adjust(e):2===e._lineSide&&t._line2._adjust(e):(t._line1._adjust(e),t._line2._adjust(e))},t}(h);function C(e,t,n,r,o,i){switch(i!==l&&i!==s||(i=1),i){case 1:return new g(e,t,n,r,o,1);case 2:return new g(e,t,n,r,o,2);case 5:return new g(e,t,n,r,o,3);case 3:return new p(e,t,n,r,o,1,[3,1]);case 9:return new p(e,t,n,r,o,1,[8,2,2,2]);case 4:return new p(e,t,n,r,o,1,[2,2]);case 11:return new p(e,t,n,r,o,1,[9,3,3,3,3,3]);case 13:return new m(e,t,n,r,o,e!==n,[11,1,5,1],[10,2,4,2]);case 10:return new p(e,t,n,r,o,2,[9,3,3,3]);case 12:return new p(e,t,n,r,o,2,[9,3,3,3,3,3]);case 8:return new p(e,t,n,r,o,2,[9,3]);case 7:return new p(e,t,n,r,o,1,[1]);case 6:return new v(e,t,n,r,o,e!==n)}return s}t=function(){function e(){}return e._compareLineStyle=function(t,n){var r,o;return t?n?(r=e._styleWeightCache,o=r[t.style]-r[n.style],0===o?n.level-t.level:o):1:n?-1:0},e._getDrawingThickness=function(e){if(e){if(e.isGridLine)return 1;if(e.style)return i._width(e.style)}return 0},e._isDoubleLine=function(e){return e&&6===e.style},e._isSlantedLine=function(e){return e&&13===e.style},e._getMaxLine=function(t,n){return t?n?e._compareLineStyle(t.style,n.style)>=0?t:n:t:n},e._adjustLine=function(e,t){e&&e.line&&e.line._adjust(t)},e._compareLine=function(t,n){return t===n?0:t?n?t.isGridLine?n.isGridLine?0:-1:n.isGridLine?1:e._compareLineStyle(t.style,n.style):1:-1},e._isDoubleLineItem=function(e){return e&&e.style&&6===e.style.style},e._isAllowExtend=function(e,t,n,r){if(e.style&&6===e.style.style)return!0;var o=0;return o+=t&&t.style&&6===t.style.style?1:0,o+=n&&n.style&&6===n.style.style?1:0,(o+=r&&r.style&&6===r.style.style?1:0)<2},e._layout4CrossRoad=function(e,t,n,r,o,i){var a={_orientation:i?1:0,_offsetStart:0,_offsetEnd:0},l=this._compareLine(e,n),s=this._compareLine(e,r);l>=0&&s>=0?0===l&&0===s?-1!==o&&1===o&&(a._offsetEnd-=o):-1===o?a._offsetStart-=o:1===o&&(a._offsetEnd-=2*o):s>=0?(a._lineSide=2,a._offsetStart+=o):l>=0&&(a._lineSide=1,a._offsetStart+=o),this._adjustLine(e,a)},e._layout4TurnRoad=function(t,n,r,o,i,a,l,s,u){var c,_,f,d,h,g,p,m,v,C={_orientation:s?1:0,_lineSide:u?2:1,_offsetStart:0,_offsetEnd:0},w={_orientation:s?1:0,_lineSide:u?1:2,_offsetStart:0,_offsetEnd:0},y=1===a?o:i,S=1===l?r:n;this._isDoubleLineItem(S)?(c=this._compareLine(t,y),0===c?(_=this._compareLine(t,S),0===_?1===l&&(w._offsetEnd-=l):_>0&&(-1===l?w._offsetStart-=2*l:1===l&&(w._offsetEnd-=2*l))):c>0?(f=this._compareLine(t,S),0===f?1===l&&(w._offsetEnd-=l):f>0&&(-1===l?w._offsetStart-=2*l:1===l&&(w._offsetEnd-=2*l))):(d=this._compareLine(t,S),0===d?-1===l?C._offsetStart+=2*l:1===l&&(C._offsetEnd+=2*l):d>0&&(-1===l?C._offsetStart-=3*l:1===l&&(C._offsetEnd-=3*l)))):this._compareLine(t,y)>=0?-1===l?w._offsetStart-=2*l:1===l&&(w._offsetEnd-=2*l):-1===l?C._offsetStart+=2*l:1===l&&(C._offsetEnd+=2*l),h=1===a?2:1,g=1===h?o:i,p=!1,m=0,this._isDoubleLineItem(g)&&this._compareLine(g,t)>0&&(p=!0,v=e._getDrawingThickness(g),this._compareLine(g,y)>0?v>0&&(m=1===l&&this._isDoubleLineItem(r)?v>=2?2:1:-1===l&&this._isDoubleLineItem(n)?v>=3?2:1:3===v?3:2):m=3===v?3:2),p||this._isDoubleLineItem(S)||!(S&&!S.isGridLine||g&&!g.isGridLine)||(p=!0,m=-1===l?2:1),p&&(-1===l?(C._offsetStart+=l*m,w._offsetStart+=l*m):1===l&&(C._offsetEnd+=l*m,w._offsetEnd+=l*m)),(C._offsetStart||C._offsetEnd)&&this._adjustLine(t,C),(w._offsetStart||w._offsetEnd)&&this._adjustLine(t,w)},e._layout4TRoad=function(e,t,n,r,o,i){if(this._compareLine(e,n)>=0&&this._compareLine(e,r)>=0){var a={_orientation:i?1:0,_offsetStart:0,_offsetEnd:0};-1===o?(a._offsetStart-=2*o,this._isDoubleLineItem(e)&&this._compareLine(t,e)>0&&(a._offsetStart-=1)):1===o&&(a._offsetEnd-=2*o,this._isDoubleLineItem(e)&&this._compareLine(t,e)>0&&(a._offsetEnd+=1)),this._adjustLine(e,a)}},e._layout4Connected=function(t,n,r,o,i,a){var l,s,u;this._isDoubleLineItem(t)&&(l=this._getMaxLine(r,o))&&!l.isGridLine&&(s=e._getDrawingThickness(l))>0&&(u={_orientation:a?1:0,_offsetStart:0,_offsetEnd:0},-1===i?u._offsetStart+=s*i:u._offsetEnd+=s*i,(u._offsetStart||u._offsetEnd)&&this._adjustLine(t,u))},e._calcLayoutHorizontal=function(t,n,r,o,i,a,l){var s,u,c,_,f=e;(n||r||o)&&(c=f._getMaxLine(r,o),f._isAllowExtend(t,n,r,o)?(u=f._compareLine(c,t))>0?(s=f._getDrawingThickness(c),f._isDoubleLineItem(t)&&(f._isDoubleLineItem(r)||f._isDoubleLineItem(o)||f._isDoubleLineItem(n))||3===s&&f._adjustLine(t,{_orientation:0,_offsetStart:1})):c&&u<0?(u=f._compareLine(t,n))>0?(s=f._getDrawingThickness(c),3===s||2===s?f._adjustLine(t,{_orientation:0,_offsetStart:-2}):1===s&&f._adjustLine(t,{_orientation:0,_offsetStart:-1})):0!==u&&f._compareLine(n,c)>0&&3===(s=f._getDrawingThickness(c))&&f._adjustLine(t,{_orientation:0,_offsetStart:1}):0===u&&(!n||f._compareLine(t,n)>0)&&(s=f._getDrawingThickness(c),3===s||2===s?f._adjustLine(t,{_orientation:0,_offsetStart:-2}):1===s&&f._adjustLine(t,{_orientation:0,_offsetStart:-1})):f._adjustLine(t,{_orientation:0,_offsetStart:1})),(i||a||l)&&(_=f._getMaxLine(a,l),f._isAllowExtend(t,i,a,l)?(u=f._compareLine(_,t))>0?(s=f._getDrawingThickness(_),f._isDoubleLineItem(t)&&(f._isDoubleLineItem(a)||f._isDoubleLineItem(l)||f._isDoubleLineItem(i))||(3===s?f._adjustLine(t,{_orientation:0,_offsetEnd:-2}):2!==s&&1!==s||f._adjustLine(t,{_orientation:0,_offsetEnd:-1}))):u<=0&&((u=f._compareLine(t,i))>0?3===(s=f._getDrawingThickness(_))&&f._adjustLine(t,{_orientation:0,_offsetEnd:1}):0!==u&&f._adjustLine(t,{_orientation:0,_offsetEnd:-1})):f._adjustLine(t,{_orientation:0,_offsetEnd:-2}))},e._calcLayoutVertical=function(t,n,r,o,i,a,l){var u,c,_,f,d=e;(n||r||o)&&(_=d._getMaxLine(r,o),d._isAllowExtend(t,n,r,o)?(c=d._compareLine(_,t))>0?(u=d._getDrawingThickness(_),d._isDoubleLineItem(t)&&(d._isDoubleLineItem(r)||d._isDoubleLineItem(o)||d._isDoubleLineItem(n))||3===u&&d._adjustLine(t,{_orientation:1,_offsetStart:1})):c<0?(c=d._compareLine(t,n))>0?(u=d._getDrawingThickness(_),3===u||2===u?d._adjustLine(t,{_orientation:1,_offsetStart:-2}):1===u&&d._adjustLine(t,{_orientation:1,_offsetStart:-1})):0!==c&&d._compareLine(n,_)>0&&3===(u=d._getDrawingThickness(_))&&d._adjustLine(t,{_orientation:1,_offsetStart:1}):0===c&&d._compareLine(t,n)>0&&(u=d._getDrawingThickness(_),3===u||2===u?d._adjustLine(t,{_orientation:1,_offsetStart:-2}):1===u&&d._adjustLine(t,{_orientation:1,_offsetStart:-1})):d._adjustLine(t,{_orientation:1,_offsetStart:1})),(i||a||l)&&(f=d._getMaxLine(a,l),d._isAllowExtend(t,i,a,l)?(c=d._compareLine(t,f))<0?(u=d._getDrawingThickness(f),d._isDoubleLineItem(t)&&(d._isDoubleLineItem(a)||d._isDoubleLineItem(l)||d._isDoubleLineItem(i))||(3===u||2===u?d._adjustLine(t,{_orientation:1,_offsetEnd:-2}):1===u&&d._adjustLine(t,{_orientation:1,_offsetEnd:-1}))):f!==s&&c>=0&&((c=d._compareLine(t,i))>0?3===(u=d._getDrawingThickness(f))&&d._adjustLine(t,{_orientation:1,_offsetEnd:1}):0!==c&&d._adjustLine(t,{_orientation:1,_offsetEnd:-1})):d._adjustLine(t,{_orientation:1,_offsetEnd:-2}))},e._calcDoubleLayout=function(t,n,r,o,i,a,l,s){var u,c,_,f,d=e;s?this._calcLayoutVertical(t,n,r,o,i,a,l):this._calcLayoutHorizontal(t,n,r,o,i,a,l),u=d._isDoubleLineItem(r),c=d._isDoubleLineItem(o),_=d._isDoubleLineItem(n),u&&c&&_?d._layout4CrossRoad(t,n,r,o,-1,s):u&&!c?d._layout4TurnRoad(t,n,i,r,o,1,-1,s,!0):!u&&c?d._layout4TurnRoad(t,n,i,r,o,2,-1,s,!1):u&&c&&!_?d._layout4TRoad(t,n,r,o,-1,s):_&&d._layout4Connected(t,n,r,o,-1,s),u=d._isDoubleLineItem(a),c=d._isDoubleLineItem(l),f=d._isDoubleLineItem(i),u&&c&&f?d._layout4CrossRoad(t,i,a,l,1,s):u&&!c?d._layout4TurnRoad(t,n,i,a,l,1,1,s,!0):!u&&c?d._layout4TurnRoad(t,n,i,a,l,2,1,s,!1):u&&c&&!f?d._layout4TRoad(t,i,a,l,1,s):f&&d._layout4Connected(t,i,a,l,1,s)},e._styleWeightCache=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],e}(),r=function(){function e(e,t,n,r){var o=this;o._isInitialized=!1,o._isMerged=!1,o._sheet=e,o._sheetArea=r,o._rowViewportIndex=t,o._colViewportIndex=n}return e.prototype={constructor:e,_initialize:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d,h=this;if(h._spanCells=[],h._rowIndecies=[],h._colIndecies=[],h._overflowedCells=[],h._adjustingRanges=[],h._hGridLine={},h._vGridLine={},h._hBorders={},h._vBorders={},e=h._sheet,t=h._sheetArea,n=h._colViewportIndex,r=h._rowViewportIndex,o=e._getRowLayout(r,t),i=e._getColumnLayout(n,t),o&&o.length>0&&i&&i.length>0){for(a=h._rowIndecies,l=o.length,u=0;u<l;u++)s=o[u],s.height>0&&a.push(s.row);for(a.push(a[a.length-1]+1),c=h._colIndecies,_=i.length,d=0;d<_;d++)f=i[d],f.width>0&&c.push(f.col);c.push(c[c.length-1]+1)}h._isInitialized=!0},_addCellOverlfowLayout:function(e,t){if(t){var n={_row:e,_startCol:t.startColumn,_endCol:t.endColumn};this._overflowedCells.push(n)}},_addCellLines:function(e,t,n,r,o,i,a,l,s,u){var c,_,f,d,h,g=this;g._isInitialized||g._initialize(),
l?g._spanCells.push(l):(a&&(c=a.borderLeft,_=a.borderTop,f=a.borderRight,d=a.borderBottom,h=a.backColor),g._addCellLineImp(e,t,n,r,o,i,c,_,f,d,h,!1,!1,s,u))},_addCellLineImp:function(e,t,n,r,o,i,a,l,s,u,c,_,f,d,h){var g,p,m,v,C,w=this,y=!1,S=!1,x=!1,b=!1;l&&(y=w._addCellLineSide(e,t,n,r-.5,n+o,r-.5,l,w._hBorders)),a&&(S=w._addCellLineSide(e,t,n-.5,r,n-.5,r+i,a,w._vBorders)),u&&(x=w._addCellLineSide(e+1,t,n,r+i-.5,n+o,r+i-.5,u,w._hBorders)),s&&(b=w._addCellLineSide(e,t+1,n+o-.5,r,n+o-.5,r+i,s,w._vBorders)),g=w._sheet,p=!x&&!_,m=!b&&!f,v=!y&&!_,C=!S&&!f,(p||m||v||C)&&w._addGridLine(e,t,n,r,o,i,p,m,d,h,c),y&&w._removeLineItem(e-1,t,w._hGridLine),S&&w._removeLineItem(e,t-1,w._vGridLine)},_addCellLineSide:function(e,n,r,o,i,a,l,u){if(l){var c=this._queryLineItem(e,n,u,!0);return c?6!==c.style.style&&(6===l.style||t._compareLineStyle(l,c.style)>0)&&(c.line=C(r,o,i,a,l.color,l.style),c.style=l):(c=this._queryLineItem(e,n,u),c.line=C(r,o,i,a,l.color,l.style),c.style=l),c.line!==s}return!1},getGridLineColor:function(e,t,n){return n},_addGridLine:function(e,t,n,r,o,i,a,l,s,u,c){var _,f,d,h,g,p,m,v,w=this,y=w._sheet,S=y._cachePool,x=3===w._sheetArea,b=w._sheet.options.gridline;x&&b&&(_=b.color,b.showHorizontalGridline&&(a&&(f=e<y.getRowCount()-1&&S._getActualStyle(e+1,t),d=this.getGridLineColor(c,f&&f.backColor,_),h=w._queryLineItem(e,t,w._hGridLine),h.isGridLine=!0,h.line=d===_?C(n,r+i-.5,n+o,r+i-.5,d):C(n-1,r+i-.5,n+o+1,r+i-.5,d)),s&&(g=w._queryLineItem(-1,t,w._hGridLine,!1,!0),g.isGridLine=!0,g.line=C(n,r-.5,n+o,r-.5,_))),b.showVerticalGridline&&(l&&(p=t<y.getColumnCount()-1&&S._getActualStyle(e,t+1),d=this.getGridLineColor(c,p&&p.backColor,_),m=w._queryLineItem(e,t,w._vGridLine),m.isGridLine=!0,m.line=d===_?C(n+o-.5,r,n+o-.5,r+i,d):C(n+o-.5,r-1,n+o-.5,r+i+1,d)),u&&(v=w._queryLineItem(e,-1,w._vGridLine,!1,!0),v.isGridLine=!0,v.line=C(n-.5,r,n-.5,r+i,_))))},_adjustLineItem:function(e,t,n,r){var o,i=this._queryLineItem(e,t,n,!0);i&&(o=i,o.line&&o.line._adjust({_orientation:r?0:1,_offsetEnd:-1}))},_removeLineItem:function(e,t,n){var r,o;e>=0&&t>=0&&(r=n[e])&&(o=r[t])&&delete r[t]},_queryLineItem:function(e,t,n,r,o){var i,a;if(!o&&(-1===e||-1===t))return s;if(!(i=n[e])){if(r)return s;n[e]=i={}}if(!(a=i[t])){if(r)return s;i[t]=a={}}return a},_processOverflowCells:function(){var e,t,n,r,o,i,a,l=this,s=l._overflowedCells,u=s.length,c=l._vBorders,_=l._vGridLine;for(e=0;e<u;e++)for(t=s[e],n=t._row,r=t._startCol,o=t._endCol,a=r;a<o;a++)i=l._queryLineItem(n,a+1,c,!0),i?l._removeLineItem(n,a+1,c):(i=l._queryLineItem(n,a,_,!0))&&l._removeLineItem(n,a,_)},_processSpans:function(){var e,t,n=this._spanCells,r=n.length;if(r>0)for(t=0;t<r;t++)e=n[t],this._processSpanCell(e)},_processSpanCell:function(e){var t,n,r,o,i,a,l,u,c,_,f,d,h,g,p,m=this,v=e.row,C=e.col,w=e.x,y=e.y,S=m._sheet.getActualStyle(v,C,m._sheetArea),x=S?S.backColor:s,b=w,T=y;if(1===e.rowCount)for(a=v,u=m._sheet._getZoomRowHeight(a,m._sheetArea),i=0;i<e.colCount;i++)_=0===i,d=i===e.colCount-1,l=C+i,c=m._sheet._getZoomColumnWidth(l,m._sheetArea),g=m._sheet.getActualStyle(a,l,m._sheetArea),g?(t=g.borderLeft,n=g.borderTop,r=g.borderRight,o=g.borderBottom):t=n=r=o=s,_?m._addCellLineImp(a,l,b,T,c,u,t,n,s,o,x,!1,!0):d?m._addCellLineImp(a,l,b,T,c,u,s,n,r,o,x,!1,!1):m._addCellLineImp(a,l,b,T,c,u,s,n,s,o,x,!1,!0),b+=c;else if(1===e.colCount)for(l=C,c=m._sheet._getZoomColumnWidth(l,m._sheetArea),i=0;i<e.rowCount;i++)f=0===i,h=i===e.rowCount-1,a=v+i,u=m._sheet._getZoomRowHeight(a,m._sheetArea),g=m._sheet.getActualStyle(a,l,m._sheetArea),g?(t=g.borderLeft,n=g.borderTop,r=g.borderRight,o=g.borderBottom):t=n=r=o=s,f?m._addCellLineImp(a,l,b,T,c,u,t,n,r,s,x,!0,!1):h?m._addCellLineImp(a,l,b,T,c,u,t,s,r,o,x,!1,!1):m._addCellLineImp(a,l,b,T,c,u,t,s,r,s,x,!0,!1),T+=u;else for(i=0;i<e.rowCount;i++){for(a=v+i,f=0===i,h=i===e.rowCount-1,u=m._sheet._getZoomRowHeight(a,m._sheetArea),p=0;p<e.colCount;p++)l=C+p,_=0===p,d=p===e.colCount-1,c=m._sheet._getZoomColumnWidth(l,m._sheetArea),g=m._sheet.getActualStyle(a,l,m._sheetArea),g?(t=g.borderLeft,n=g.borderTop,r=g.borderRight,o=g.borderBottom):t=n=r=o=s,f?_?m._addCellLineImp(a,l,b,T,c,u,t,n,s,s,x,!0,!0):d?m._addCellLineImp(a,l,b,T,c,u,s,n,r,s,x,!0,!1):m._addCellLineImp(a,l,b,T,c,u,s,n,s,s,x,!0,!0):h?_?m._addCellLineImp(a,l,b,T,c,u,t,s,s,o,x,!1,!0):d?m._addCellLineImp(a,l,b,T,c,u,s,s,r,o,x,!1,!1):m._addCellLineImp(a,l,b,T,c,u,s,s,s,o,x,!1,!0):_?m._addCellLineImp(a,l,b,T,c,u,t,s,s,s,x,!0,!0):d&&m._addCellLineImp(a,l,b,T,c,u,s,s,r,s,x,!0,!1),b+=c;b=w,T+=u}!x||t||r||n||o||m._adjustingRanges.push({r:v,c:C,rc:e.rowCount,cc:e.colCount})},_adjust:function(){var e=this,t=!1,n=!1;d(e._vBorders)||(t=!0),d(e._hBorders)||(n=!0),(t||n)&&e._adjustBorders(),e._adjustingRanges.length>0&&e._adjustGridlines()},_adjustGridlines:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f=this,d=f._adjustingRanges,h=d.length;for(e=0;e<h;e++){for(t=d[e],n=t.r,r=t.c,o=n,i=n-1,a=r-1,l=r,t.rc>1&&(o+=t.rc-1),t.cc>1&&(l+=t.cc-1),s=!1,u=!1,c=e+1;c<h&&(_=d[c],_.c===l+1&&_.r===n&&(u=!0),_.r===o+1&&_.c===r&&(s=!0),!s||!u)&&!(_.r>n+1&&_.c>r+1);c++);s||f._adjustLineItem(o,a,f._hGridLine,!0),u||f._adjustLineItem(i,l,f._vGridLine,!1)}},_adjustBorders:function(){var e,n,r,o,i,a,l,u,c,_,f,d,h,g,p,m,v,C,w=this,y=w._rowIndecies,S=w._colIndecies,x=y.length,b=S.length,T={},R={};for(e=0;e<x;e++)for(r=y[e],n=0;n<b;n++)o=S[n],p=0,m=0,v=w._queryLineItem(r,o,w._vBorders,!0),v?p++:v=w._queryLineItem(r,o-1,w._vGridLine,!0),C=w._queryLineItem(r,o,w._hBorders,!0),C?m++:C=w._queryLineItem(r-1,o,w._hGridLine,!0),(v||C)&&(i=0===e?s:w._getLineItem(y[e-1],o,!0,R),i&&i.line&&!i.isGridLine&&(p++,m++),a=0===n?s:w._getLineItem(r,S[n-1],!1,T),a&&a.line&&!a.isGridLine&&(p++,m++),v&&(l=w._getLineItem(r,o,!1,T),l&&l.line&&!l.isGridLine&&p++,e!==x-1&&(c=w._getLineItem(y[e+1],o,!0,R))&&c.line&&!c.isGridLine&&p++,0!==n&&e!==x-1&&(_=w._getLineItem(y[e+1],S[n-1],!1,T))&&_.line&&!_.isGridLine&&p++,e!==x-1&&(f=w._getLineItem(y[e+1],o,!1,T))&&f.line&&!f.isGridLine&&p++,p>0&&(t._isDoubleLine(v.style)?t._calcDoubleLayout(v,i,a,l,c,_,f,!0):t._isSlantedLine(v.style)||t._calcLayoutVertical(v,i,a,l,c,_,f))),C&&(u=w._getLineItem(r,o,!0,R),u&&u.line&&!u.isGridLine&&m++,n!==b-1&&(d=w._getLineItem(r,S[n+1],!1,T))&&d.line&&!d.isGridLine&&m++,0!==e&&n!==b-1&&(h=w._getLineItem(y[e-1],S[n+1],!0,R))&&h.line&&!h.isGridLine&&m++,n!==b-1&&(g=w._getLineItem(r,S[n+1],!0,R))&&g.line&&!g.isGridLine&&m++,m>0&&(t._isDoubleLine(C.style)?t._calcDoubleLayout(C,a,i,u,d,h,g,!1):t._isSlantedLine(C.style)||t._calcLayoutHorizontal(C,a,i,u,d,h,g))))},_getLineItem:function(e,t,n,r){var o,i=r[e];return i||(i=r[e]={}),o=i[t],o===l&&(o=i[t]=this._getLineItemImp(e,t,n)),o},_getLineItemImp:function(e,t,n){var r,o,i;if(e===l||e<0||t===l||t<0)return s;if(r=this,o=n?r._vBorders:r._hBorders,i=r._queryLineItem(e,t,o,!0),i)return i;if(o=n?r._vGridLine:r._hGridLine,n){if(--t<0)return s}else if(--e<0)return s;return(i=r._queryLineItem(e,t,o,!0))||s},paint:function(e,t){var n=this;n._isInitialized&&(n._isMerged||(n._processSpans(),n._processOverflowCells(),n._adjust(),n._isMerged=!0),e.save(),e.beginPath(),n._paint(e,t),e.closePath(),e.stroke(),e.restore())},_paint:function(e){this._paintGridLine(e),this._paintBorderLines(e)},_paintGridLine:function(e){var t=this;t._paintLines(e,t._hGridLine),t._paintLines(e,t._vGridLine)},_paintBorderLines:function(e){var t=this;t._paintLines(e,t._hBorders),t._paintLines(e,t._vBorders)},_paintLines:function(e,t){var n,r,o,i;for(n in t)if(t[n]){o=t[n];for(r in o)o[r]&&(i=o[r].line)&&i._paint(e)}}},e}(),o._createLine=C,o._Borders=r,e.exports=o}()},function(e,t,n){!function(){"use strict";var t,r=n(1),o=n(17).Worksheet,i=n(4).GC$,a=n(3),l=n(5),s=a._util,u=s._browser,c=s._device(),_=a.Events,f=l._Types._isNullOrUndefined,d=a._FocusHelper,h=null,g=void 0;r.EditorStatus={ready:0,enter:1,edit:2},t={startEdit:function(e,t){var n=this;n._startEditImp(n._getCanvas(),n._activeRowIndex,n._activeColIndex,h,h,e,t)},editorStatus:function(){return this._editorStatus||0},isEditing:function(){var e=this._editorStatus;return 1===e||2===e},endEdit:function(e){return this._endEditImp(e)},_endEditImp:function(e,t,n){var r=this;if(!r.isEditing())return!0;r.suspendPaint();try{return r._endEditCore(e,t,n)}finally{r.resumePaint()}},_endEditCore:function(e,t,n){var r,a,l,s,c,d,g,p,m,v,C,w,y,S=this,x=S._eventHandler,b=S._editor,T=S._name,R=S._activeRowIndex,A=S._activeColIndex,I=S.getCellType(R,A),M={sheet:S,row:R,col:A,sheetArea:3};if(I.isImeAware(M)||x._changeFocusHolder(),b&&b.parentNode){if(a=I.getEditorValue(b,M),l={sheet:S,sheetName:T,row:R,col:A,editor:b,editingText:a,cancel:!1},S._trigger(_.EditEnd,l),l.cancel)return;if(S._trigger(_.EditEnding,l),l.cancel)return;if(s=S.parent,c=s&&s._attachedFormulaTextBox,document.activeElement===(c&&c._host)&&x._changeFocusHolder(),R>=0&&A>=0&&(d=b._oldValue,I.isEditingValueChanged(d,a,M)||1===t))if(e)I.setEditorValue(b,d,M),I.selectAll(b,M);else if(g=I._autoFormatValue,f(g)&&(g=!0),p={cmd:"editCell",sheetName:T,row:R,col:A,newValue:a,autoFormat:g,editingFormatter:b._editingFormatter},1===t&&(p.ranges=[S._getActiveSelectedRange()],p.endEditType=t),S._commandManager().execute(p),2===(r=p.applyResult))return I.focus(b,M),!1;if(S._dirty=!0,I.deactivateEditor(b,M),I.isImeAware(M))u.msie&&9===parseFloat(u.version)?x._changeFocusHolder():i(b.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(m=S._getHost(),v=b;v;)v.parentNode===m?m.removeChild(v):v=v.parentNode}return S._editingTimeValue=!1,C={sheet:S,sheetName:T,row:R,col:A,editingText:a},w=i.extend({},C),S._trigger(_.EditEnded,C),S._trigger(_.FormulatextboxEditEnded,w),(!0===n||!w.ignore)&&(0!==S._editorStatus&&(y=S._editorStatus,S._editorStatus=0,S._raiseEditorStatusChanged(y,0)),o._callFeatureHandler(S,"endEdit"),S._editor=h,1!==r)},_doStartEdit:function(e,t,n){var r,o,i,a,l,s,u,c,_=this,f=_.hitTest(t,n);!f||f.cellTypeHitInfo&&f.cellTypeHitInfo.outlineColumnHitInfo||(r=f.row,o=f.col,r>=0&&o>=0&&f.rowViewportIndex>=0&&f.colViewportIndex>=0&&!f.resizeInfo&&!f.dragInfo&&r===_._activeRowIndex&&o===_._activeColIndex&&(i=_.isEditing(),_._startEditImp(e,r,o),!i&&_.isEditing()&&(a=f.hitTestType,l=_.getCellType(r,o),l._triggerButtonClicked&&(s=_.getCellRect(r,o,1===a?-1:g,2===a?-1:g),u=_.getActualStyle(r,o,a),(c=l._getHitInfoWrapper(t,n,u,s,{sheet:_,row:r,col:o,sheetArea:a}))&&c.isReservedLocation&&l._triggerButtonClicked(_,r,o,3)))))},_startEditImp:function(e,t,n,i,a,l,s){var u,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F;if(!(t<0||n<0)&&(u=this,g=u._name,p=u.options,!u.isEditing()&&!(!(m=u.getCellRect(t,n))||f(m.width)||f(m.height)||f(m.x)||f(m.y)||m.width<=0||m.height<=0)&&(v=u.getActualStyle(t,n),(!p.isProtected||!1===v.locked)&&(C=u.getCellType(t,n))&&(w=u._eventHandler,w._setFocus(),y={sheet:u,row:t,col:n,sheetArea:3},S=C.isImeAware(y)?w._cellTypeFocusHolder:C._createCellTypeElement(y),S&&S.firstChild&&(x=S.firstChild.firstChild),x)))){if(u._editor=x,b={sheet:u,sheetName:g,row:t,col:n,cancel:!1},u._trigger(_.EditStarting,b),b.cancel)return void(c.ipad&&w._changeFocusHolder());u.showCell(u._activeRowIndex,u._activeColIndex,3,3),T=u.getValue(t,n),R=r._supportsCalc&&u.getFormula(t,n),A=u._editorStatus,u._startEditByKeydown?u._editorStatus=1:f(T)&&f(R)?u._editorStatus=1:u._editorStatus=2,u._raiseEditorStatusChanged(A,u._editorStatus),I=u._getSheetLayout(),m=u.getCellRect(t,n,i,a),C.isImeAware(y)&&w._resetFocusHolder(),C._activateEditorWrapper(S,v,m,y),u._setEditorValue(C,x,t,n,v,s),M=u._getHost(),C.isImeAware(y)||M.insertBefore(S,h),C._updateEditorWrapper(S,v,m,y),C.isImeAware(y)&&l||C.focus(x,y),p.allowCellOverflow&&(E=m.clone(),E.y-=2,E.height+=4,E.x=I._frozenX,E.width=I._viewportWidth,u.repaint(E)),o._callFeatureHandler(u,"startEdit",{element:C.getEditingElement()}),l&&C.selectAll(x,y),d._setActiveElement(u),F={sheet:u,sheetName:g,row:t,col:n},u._trigger(_.EditStarted,F),u._trigger(_.FormulatextboxEditStarted,F)}},_setEditorValue:function(e,t,n,o,i,a){var l,s,u,c,_=this,d=r._supportsCalc&&_.getFormula(n,o,!0);d&&(d="="+d),l=d,s={sheet:_,row:n,col:o,sheetArea:3},d&&0!==d.length||(d=_.getValue(n,o),u=_.parent,c=r._supportsCalc&&u&&u.options.allowUserEditFormula,"string"==typeof d&&i.quotePrefix||d&&d.length>0&&"="===d[0]&&c?(d="'"+d,l=d):(l=d,d=e._formatEditorValue(t,i,d,s))),t._oldValue=d,f(a)||(d=a),e.setEditorValue(t,d,s),t._originalValue=l}},i.extend(o.prototype,t),e.exports=r}()},function(e,t,n){!function(){"use strict";var t,r=n(1),o=n(17).Worksheet,i=n(5),a=n(16)._LayoutModel,l=n(4).GC$,s=n(3),u=s.Range,c=window,_=document,f=l.each,d=s._util,h=d._browser,g=d._device(),p=d._cancelDefault,m=d._createElement,v=i._StringHelper._format,C=s._createRange,w=i._Types._isNullOrUndefined,y=s.Events,S=s._FocusHelper,x=".handler",b="mousedown"+x,T="mouseup"+x,R="mousemove"+x,A="mousewheel"+x,I="DOMMouseScroll"+x,M="mouseout"+x,E="dblclick"+x,F=null,D=void 0,N=isNaN,V=parseInt,O=Math.max,H=Math.min,P=Math.abs,L=Math.ceil,k="function",B="position",W="absolute",z="border",U="overflow",Y="top",G="left",X="width",j="height",K="resize",Z="hidden",J="visible",q="none",Q="tabindex",$="gcUIElement",ee="corner",te="sizeHiddenRow",ne="sizeRow",re="sizeCol",oe="sizeHiddenCol",ie="default",ae=g.iphone||g.ipad||g.android,le=function(){return i._getResource(r.SR)()},se=30;o._registerFeature("eventHandler",{dispose:function(e){var t,n,r,o=this;l(o._getCanvas()).unbind(b).unbind(T).unbind(R).unbind(A).unbind(I).unbind(M).unbind(E),t=o._eventHandler,t&&(t._dispose(),t._disposeFocusHolders()),n=o._editor,n&&l(n).remove(),r=o._fillDialog,r&&r.close(),!1!==e&&(o._mouseDownDelegate=F,o._mouseMoveDelegate=F,o._mouseUpDelegate=F,o._mouseWheelDelegate=F,o._mouseOutDelegate=F,o._dblClickDelegate=F,o._eventHandler=F)},setHost:function(e){function t(e,t){e._startEdit(t)}if(e){var n=this,r=n._eventHandler;n._mouseDownDelegate=function(e){var t={e:e,r:F};if(o._callFeatureHandler(n,"preProcessMouseDown",t),!t.r)return r._doMouseDown(e)},n._mouseMoveDelegate=function(e){var t={e:e,r:F};o._callFeatureHandler(n,"preProcessMouseMove",t),t.r||r._isMouseCapture||r._doMouseMove(e)},n._mouseUpDelegate=function(e){var t={e:e,r:F};if(o._callFeatureHandler(n,"preProcessMouseUp",t),!t.r&&!n._continueMouseUpBubble){if(r._isMouseCapture)return;return r._doMouseUp(e)}},n._mouseWheelDelegate=function(e){var t,r,i,a,l,s,u,_,f;if(e=e||c.event,t={e:e,r:F},o._callFeatureHandler(n,"preProcessMouseWheel",t),!t.r)return r=e.detail?e.detail:e.wheelDelta/-40,i=0,(!d._isMacOS()||(a=(new Date).valueOf(),l=e.wheelDeltaY,s=e.wheelDeltaX,P(l)>=P(s)?s=0:l=0,u=!n._lastMouseWheel||a-n._lastMouseWheel>200,(h.safari||h.chrome)&&(_=h.safari?-4:-40,w(l)||(u?(r=l/_,r=(r>=0?1:-1)*L(P(r)),n._remainedDetailY=0):(r=l/_,n._remainedDetailY+=r,r=(r>=0?1:-1)*Math.floor(P(n._remainedDetailY)),n._remainedDetailY-=r)),w(s)||(u?(i=s/_,i=(i>=0?1:-1)*L(P(i)),n._remainedDetailX=0):(i=s/_,n._remainedDetailX+=i,i=(i>=0?1:-1)*Math.floor(P(n._remainedDetailX)),n._remainedDetailX-=i))),n._lastMouseWheel=a,0!==r||0!==i))&&(!!(f=n.parent._scrollService._doMouseWheel(e,V(r,10)||0,V(i,10)||0))&&void 0)},n._mouseOutDelegate=function(e){var t={e:e,r:F};if(o._callFeatureHandler(n,"preProcessMouseOut",t),!t.r)return r._doMouseOut(e)},n._dblClickDelegate=function(e){var i,a,l={e:e,r:F};o._callFeatureHandler(n,"preProcessMouseDbClick",l);function s(e,t,n,r,o,i){var a={sheet:e,sheetName:t,sheetArea:o,row:n,col:r};return i&&(a.cancel=!1),a}function u(e,t){var n,r,o=e._sheet,i=t.resizeInfo;return!!i&&(i.action===ne||i.action===te?(n=[],o._isRowSelected(i.index)?f(o._selectionModel,function(e,t){var r,i;if(-1===t.col)for(r=o._getActualRange(t),i=0;i<Ie(r);i++)n.push({row:r.row+i})}):n.push({row:i.index}),o._commandManager().execute({cmd:"autoFitRow",sheetName:o.name(),rows:n,columnHeader:1===i.sheetArea})):(r=[],o._isColumnSelected(i.index)?f(o._selectionModel,function(e,t){var n,i;if(-1===t.row)for(n=o._getActualRange(t),i=0;i<Ae(n);i++)r.push({col:n.col+i})}):r.push({col:i.index}),o._commandManager().execute({cmd:"autoFitColumn",sheetName:o.name(),columns:r,rowHeader:2===i.sheetArea})),!0)}l.r||(i=n._currentTarget)&&(a=!1,3===Ce(i)?t(r,e):a=u(r,i),a||n._trigger(y.CellDoubleClick,s(n,n._name,i.row,i.col,Ce(i))))},e.bind(b,function(e){return n._mouseDownDelegate(e)}).bind(T,function(e){return n._mouseUpDelegate(e)}).bind(R,function(e){return n._mouseMoveDelegate(e)}).bind(A,function(e){return n._mouseWheelDelegate(e)}).bind(I,function(e){return n._mouseWheelDelegate(e)}).bind(M,function(e){return n._mouseOutDelegate(e)}).bind(E,function(e){return n._dblClickDelegate(e)})}}});function ue(e,t){var n=3;return me(t)<0&&(n=1),ve(t)<0&&(n=2),!(3===n||!e._isSelected(t.row,t.col,n,!0))}function ce(e,t,n){var r,o,i,a,l,u,c,_=!1,f=e._getSheetLayout();return t&&(r=me(t),o=ve(t),(r<0||o<0)&&(i=e.getCellRect(t.row,t.col,r,o))&&i.width>0&&i.height>0&&(a=f.x,l=f.y,(i.x<f._rowHeaderWidth+a||i.y<f._colHeaderHeight+l||i.y>=f.height-f._footerHeight)&&(u=new s.Rect(i.x-2,i.y-2,i.width+4,i.height+4),c=r<0&&o<0?f._headerCornerRect():-2===r?f._footerRect(o):r<0?f._colHeaderRect(o):f._rowHeaderRect(r),u=u.getIntersectRect(c),n._update(u.x,u.y,u.width,u.height),_=ue(e,t)))),_}function _e(e){return e.isEditing()}function fe(e){return e.endEdit()}function de(e){return e.frozenRowCount()}function he(e){return e.frozenColumnCount()}function ge(e,t){return e.getRowCount(t)}function pe(e,t){return e.getColumnCount(t)}function me(e){return e.rowViewportIndex}function ve(e){return e.colViewportIndex}function Ce(e){return e.hitTestType}function we(e){return e.getActiveRowIndex()}function ye(e){return e.getActiveColumnIndex()}function Se(e){return e.keyCode}function xe(e){return e.ctrlKey}function be(e){return e.shiftKey}function Te(e){return e.altKey}function Re(e){return e.metaKey}function Ae(e){return e.colCount}function Ie(e){return e.rowCount}function Me(e,t,n){return{action:e,index:t,sheetArea:n}}r.ImeMode={auto:1,active:2,inactive:4,disabled:0};function Ee(e,t,n,r,o,i){var a={sheet:e,sheetName:t,sheetArea:o,row:n,col:r};return i&&(a.cancel=!1),a}function Fe(e,t,n,r,o,i){var a=e._sheet,l=Ee(a,a._name,a._activeRowIndex,a._activeColIndex,D,!0);if(a._trigger(y.LeaveCell,l),l&&!0===l.cancel)return!0;a._setActiveCellImp(t,n,r,o,i),a._trigger(y.EnterCell,Ee(a,a._name,t,n)),a._trigger(y.FormulatextboxEnterCell,Ee(a,a._name,t,n)),e._updateValidationUI&&e._updateValidationUI(t,n)}function De(e,t,n,r,o,i,a){var l,s=e._sheet,u=t.call(s,i.sheetArea);return(a&&!s.getRowVisible(i.index)||!a&&!s.getColumnVisible(i.index))&&(i.index=n.call(e,i.index,i.sheetArea)),l=r.call(u,i.index),l||(l=r.call(u,o)),l}function Ne(e,t,n,r){var o,i=r?"movingY":"movingX",a=r?"startY":"startX";e[i]=t,e[i]<e[a]&&(e[i]=e[a]),o=r?n.y+n.height:n.x+n.width,e[i]>o&&(e[i]=o)}function Ve(e,t){var n=e._getSheetLayout();return de(e)>0&&t<n._frozenY+n._frozenHeight?0:e.frozenTrailingRowCount()>0&&t>n._frozenTrailingY?2:1}function Oe(e,t){var n=e._getSheetLayout();return he(e)>0&&t<n._frozenX+n._frozenWidth?0:e.frozenTrailingColumnCount()>0&&t>n._frozenTrailingX?2:1}function He(e,t,n){var r=e._getRowLayout(t);return r?r.findNearY(n):F}function Pe(e,t,n){var r=e._getColumnLayout(t);return r?r.findNearX(n):F}function Le(e){return!e.options.isProtected||e.options.protectionOptions.allowResizeRows}function ke(e){return!e.options.isProtected||e.options.protectionOptions.allowResizeColumns}t=function(){function e(e){var t=this;t._repeatKeyDownTimeoutID=0,t._focusReleased=!1,t._focusSuspended=!1,t._dragRect={},t._sheet=e}return e.prototype={_dispose:function(){var e=this;e._hScrollTimer&&e._hScrollTimer._dispose(),e._vScrollTimer&&e._vScrollTimer._dispose(),e._mousePosition=F},_getHScrollTimer:function(){var e=this;return e._hScrollTimer||(e._hScrollTimer=new Be(e)),e._hScrollTimer},_getVScrollTimer:function(){var e=this;return e._vScrollTimer||(e._vScrollTimer=new Be(e)),e._vScrollTimer},_getCanvasOffset:function(){return this._sheet._getCanvasOffset()},_getCanvasPosition:function(){var e=l(this._sheet._getCanvas()).position();return e||(e={top:0,left:0}),e},_doMouseDown:function(e){var t,n,r,o,i,a,l,s,u;return 2===e.button||(t=this,n=t._sheet,t._handleDocumentMouseMove(),h&&h.msie&&e.offsetX!==D&&e.offsetY!==D&&(r=0,o=0,e.target!==n._canvas&&(i=d._getRelativeOffset(e.target,n._canvas),r=i._left,o=i._top),a=e.pageX-(e.offsetX+r),l=e.pageY-(e.offsetY+o),c._gcGlobal.canvasOffset={top:l,left:a}),s=n._getCanvasOffset(),u=t._doMouseDownImp(e,e.pageX-s.left,e.pageY-s.top),_e(n)||u||t._setFocus(),n._isMouseDownInSheet=!0,!1)},_handleDocumentMouseMove:function(){var e=this;e._isMouseCapture||(l(_).bind("mousemove.gcSheet",function(t){e._doMouseMove(t)}).bind("mouseup.gcSheet",function(t){e._doMouseUp(t)}),e._isMouseCapture=!0)},_unhandleDocumentMouseMove:function(){this._isMouseCapture&&(this._isMouseCapture=!1,l(_).unbind("mousemove.gcSheet").unbind("mouseup.gcSheet"))},_doMouseDownImp:function(e,t,n){var r,i,a,l,s,c,_,f,d,h=this,g=h._sheet,p=g.hitTest(t,n),m=p.row,v=p.col,C=p.dragInfo,S=p.formulaRangeHitInfo,x=p.cellTypeHitInfo,b={hitInfo:p,e:e,r:F};if(o._callFeatureHandler(g,"processMouseDown",b),!b.r&&(r=g._getSheetLayout(),t>=r.x&&n>=r.y))if(g._currentTarget=p,h._isMouseDown=!0,p.resizeInfo){if(!fe(g))return;h._startResizing(p)}else if(p.dragMergeInfo){if(!fe(g))return;h._startDragMerge&&h._startDragMerge(p)}else if(C&&C.side&&C.side!==ee){if(!fe(g))return;h._startDragDropping&&h._startDragDropping(p)}else if(C&&C.side===ee){if(!fe(g))return;h._startDragFill&&h._startDragFill(p)}else if(p.filterButtonHitInfo)fe(g);else if(S)S.inBorder?h._startFormulaRangeMoving(p):(S.inTopLeft||S.inTopRight||S.inBottomLeft||S.inBottomRight)&&h._startFormulaRangeResizing(p);else if(g._canSelect(me(p)<0?-1:m,ve(p)<0?-1:v)){if(h._dealMouseDownInFormulatextbox&&h._dealMouseDownInFormulatextbox(g,p))return;if(i=we(g),a=ye(g),x){if(l=g.getCellType(x.row,x.col,Ce(p)),x.sheet||(x.sheet=g),h._canSetSelectionChange(l,x)&&(s=x.sheetArea,(w(s)||3===s)&&(m!==i||v!==a))){g.suspendPaint();try{if(!fe(g))return;if(c=Ee(g,g._name,i,a,D,!0),g._trigger(y.LeaveCell,c),c&&!0===c.cancel)return;_=g._selectionModel.toArray(),f=g._getSpanModel().get(m,v),d=[new u(f.row,f.col,f.rowCount,f.colCount)],g._raiseSelectionChanging(_,d),g._setActiveCellAndSelection(m,v,D,D,1),g._trigger(y.EnterCell,Ee(g,g._name,m,v)),g._trigger(y.FormulatextboxEnterCell,Ee(g,g._name,m,v)),g._raiseSelectionChanged(_),g._noMoreSelectionChanged=!0,h._updateValidationUI&&h._updateValidationUI(m,v)}finally{g.resumePaint()}}l.processCellAndPaddingMouseDown(x)}if(x&&x.isReservedLocation)return!0;h._setMetaKeyState(e),h._changeSelection(g,p,m,v)}},_changeSelection:function(e,t,n,r){var o,i,a=this;try{if(a._hitTestResult=t,_e(e)&&!fe(e))return}finally{a._hitTestResult=F}w(n)||w(r)||(3===Ce(t)&&a._updateValidationUI&&a._updateValidationUI(n,r),o=e._selectionModel.toArray(),a._startSelecting(t),i=e._selectionModel.toArray(),e._raiseSelectionChanging(o,i))},_canSetSelectionChange:function(e,t){return e&&t&&t.isReservedLocation&&(!e.activeOnClick||e.activeOnClick())},_isInvalidRect:function(e){var t,n=this._sheet;return!n||(t=n._getSheetLayout(),w(e.x)||w(e.y)||w(e.width)||w(e.height)||e.x+e.width>t._viewportX+t._viewportWidth+t._frozenTrailingWidth||e.y+e.height>t._viewportY+t._viewportHeight+t._frozenTrailingHeight)},_commitSelectValue:function(e,t,n,r){var o,i,a,s,u,c,_,f,d=this._sheet;for(i=0,a=e.options,s=a.length;i<s;i++)if(u=a[i],u.selected){o=r[i].value;break}c=!1,d.options.isProtected&&(_=d.getActualStyle(t,n))&&(c=_.locked),w(o)||c||(f={cmd:"editCell",sheetName:d.name(),row:t,col:n,newValue:o,autoFormat:!0},d._commandManager().execute(f)),l(e).hide()},_startScroll:function(){var e,t=this;t._startHitInfo&&(e=t._startHitInfo._hitTestType,3!==e&&2!==e||t._getVScrollTimer()._setAction(t._processVSScrolled),3!==e&&1!==e||t._getHScrollTimer()._setAction(t._processHSScrolled))},_checkContinueScroll:function(){var e=this;e._isSelecting&&e._continueSelecting(),e._isDragMerging&&e._continueDragMerge&&e._continueDragMerge(),e._isDragDropping&&e._continueDragDropping&&e._continueDragDropping(),e._isDraggingFill&&e._continueDragFill&&e._continueDragFill(),e._isFormulaRangeAppending&&e._continueFormulaRangeAppending(),e._isFormulaRangeMoving&&e._continueFormulaRangeMoving(),e._isFormulaRangeResizing&&e._continueFormulaRangeResizing()},_processVSScrolled:function(e){var t,n,r,o,i,a,l,s,u=this;u._adjustScrollRowViewport()||(t=u._startHitInfo,n=u._sheet,r=t._scrollRowViewportIndex,o=n.getViewportTopRow(r),i=n.getViewportBottomRow(r),e?i<ge(n)-n.frozenTrailingRowCount()-1?n._setTopRow(n._getNextVisualRow(o)):(a=n._getRowLayout(r))&&a.length>0&&(l=n._getSheetLayout(),s=a[a.length-1],s.y+s.height>=l._viewportY+l._viewportHeight&&n._setTopRow(n._getNextVisualRow(o))):o>de(n)&&n._setTopRow(n._getPrevVisualRow(o))),u._checkContinueScroll()},_processHSScrolled:function(e){var t,n,r,o,i,a,l,s,u=this;u._adjustScrollColViewport()||(t=u._sheet,n=u._startHitInfo,r=n._scrollColViewportIndex,o=t.getViewportLeftColumn(r),i=t.getViewportRightColumn(r),e?i<pe(t)-t.frozenTrailingColumnCount()-1?t._setLeftColumn(t._getNextVisualColumn(o)):(a=t._getColumnLayout(r))&&a.length>0&&(l=t._getSheetLayout(),s=a[a.length-1],s.x+s.width>=l._viewportX+l._viewportWidth&&t._setLeftColumn(t._getNextVisualColumn(o))):o>he(t)&&t._setLeftColumn(t._getPrevVisualColumn(o))),u._checkContinueScroll()},_adjustScrollRowViewport:function(){var e,t,n,r,o,i,a=this._sheet,l=a._getSheetLayout(),s=de(a),u=a.frozenTrailingRowCount(),c=this._mousePosition,_=this._startHitInfo,f=_._scrollRowViewportIndex;if(0===f){if(c.y>l._viewportY)return a._setTopRow(a._getFirstPageTopRow()),_._scrollRowViewportIndex=1,!0}else if(1===f){if((e=a._getRowLayout(1))&&e.length>0){if(t=e[0],s>0&&c.y<l._viewportY&&t.row<=a._getFirstPageTopRow())return _._scrollRowViewportIndex=0,!0;if(t=e[e.length-1],u>0&&c.y>l._frozenTrailingY&&t.row>=a._getLastVisualRow()&&t.y+t.height<=l._frozenTrailingY)return _._scrollRowViewportIndex=2,!0}}else if(2===f&&(e=a._getRowLayout(1))&&e.length>0&&c.y<l._frozenTrailingY){if(t=e[e.length-1],t.y+t.height>l._frozenTrailingY){for(n=l._viewportHeight,r=ge(a)-u-1,o=0,i=r;i>=s;i--)if((o+=a._getZoomRowHeight(i))>n){r=H(i+1,r);break}a._setTopRow(a._getNextVisualRow(r-1))}return _._scrollRowViewportIndex=1,!0}return!1},_adjustScrollColViewport:function(){var e,t,n,r,o,i,a=this._sheet,l=a.frozenTrailingColumnCount(),s=he(a),u=a._getSheetLayout(),c=this._mousePosition,_=this._startHitInfo,f=_._scrollColViewportIndex;if(0===f){if(c.x>u._viewportX)return a._setLeftColumn(a._getFirstPageLeftColumn()),_._scrollColViewportIndex=1,!0}else if(1===f){if((e=a._getColumnLayout(1))&&e.length>0){if(t=e[0],s>0&&c.x<u._viewportX&&t.col<=a._getFirstPageLeftColumn())return _._scrollColViewportIndex=0,!0;if(t=e[e.length-1],l>0&&c.x>u._frozenTrailingX&&t.col>=a._getLastVisualColumn()&&t.x+t.width<=u._frozenTrailingX)return _._scrollColViewportIndex=2,!0}}else if(2===f&&(e=a._getColumnLayout(1))&&e.length>0&&c.x<u._frozenTrailingX){if(t=e[e.length-1],t.x+t.width>u._frozenTrailingX){for(n=u._viewportWidth,r=pe(a)-l-1,o=0,i=r;i>=s;i--)if((o+=a._getZoomColumnWidth(i))>n){r=H(i+1,r);break}a._setLeftColumn(a._getNextVisualColumn(r-1))}return _._scrollColViewportIndex=1,!0}return!1},_continueScroll:function(){var e,t,n,r,o,i,a,l,s,u=this;(u._isWorking||u._isFloatingObjectWorking||u._isCommentWorking)&&(e=u._sheet,t=e._getSheetLayout(),n=u._startHitInfo,r=n._scrollRowViewportIndex,o=n._scrollColViewportIndex,i=u._mousePosition,a=F,r>=0&&o>=0?a=t._viewportRect(r,o):r>=0?a=t._rowHeaderRect(r):o>=0&&(a=t._colHeaderRect(o)),a&&(l=0,s=0,i.x<=a.x?l=i.x-a.x:i.x>=a.x+a.width&&(l=i.x-(a.x+a.width)),i.y<=a.y?s=i.y-a.y:i.y>=a.y+a.height&&(s=i.y-(a.y+a.height)),u._getHScrollTimer()._setInterval(u._getIntervalFromDistance(l)),u._getVScrollTimer()._setInterval(u._getIntervalFromDistance(s))))},_stopScroll:function(){this._getHScrollTimer()._stop(),this._getVScrollTimer()._stop()},_startResizing:function(e){var t,n,r,o,i,l,s=this,u=a.prototype,c=s._sheet,_=e.resizeInfo;_.action===ne||_.action===te?(t=De(s,c._getAllRowLayout,s._getPreVisualRow,u.findRow,e.row,_,!0),_.startY=t.y):(n=De(s,c._getAllColumnLayout,s._getPreVisualCol,u.findCol,e.col,_,!1),_.startX=n.x),r=c.parent,o=e.x,i=e.y,r&&((1!==(l=r.options.showResizeTip)||_.action!==re&&_.action!==oe)&&(2!==l||_.action!==ne&&_.action!==te)&&3!==l||(i-se<0?i+=se/2:i-=se,r._showTooltip(s._getMouseDownResizeTooltipContent(),o,i))),s.isResizing=!0,s._isWorking=!0},_continueResizing:function(){var e,t,n,r,o=this,i=o._sheet,a=i._currentTarget,l=a.resizeInfo,s=o._mousePosition,u=s.x,c=s.y,_=i._getSheetLayout();l&&o._isWorking&&o.isResizing&&(a.x===u&&a.y===c||(l.action===ne||l.action===te?Ne(l,c,_,!0):Ne(l,u,_,!1),e=i._render,t=e._getCtx(),e._copyDoubleBuffer(_.x,_.y,_.width,_.height),e._paintAdornment(t),(n=i.parent)&&((1!==(r=n.options.showResizeTip)||l.action!==re&&l.action!==oe)&&(2!==r||l.action!==ne&&l.action!==te)&&3!==r||n._refreshTooltip(o._getMouseMoveResizeTooltipContent(l)))))},_stopResizing:function(){var e,t,n,r,o,i,a,s,u,c,_=this;_.isResizing=!1,_._isWorking=!1,e=!0,t=_._sheet,n=t._currentTarget,r=n.resizeInfo,r&&(_._removeTooltip(),r.action===ne||r.action===te?w(r.movingY)?e=!1:(o=O(0,(r.movingY-r.startY)/t._zoomFactor),i=[],t._isRowSelected(r.index)?l.each(t._selectionModel,function(e,n){if(-1===n.col){var r=t._getActualRange(n);i.push({firstRow:r.row,lastRow:r.row+Ie(r)-1})}}):i.push({firstRow:r.index,lastRow:r.index}),a=1===r.sheetArea,t._commandManager().execute({cmd:"resizeRow",sheetName:t.name(),rows:i,size:o,columnHeader:a})):w(r.movingX)?e=!1:(o=O(0,(r.movingX-r.startX)/t._zoomFactor),s=[],t._isColumnSelected(r.index)?l.each(t._selectionModel,function(e,n){if(-1===n.row){var r=t._getActualRange(n);s.push({firstCol:r.col,lastCol:r.col+Ae(r)-1})}}):s.push({firstCol:r.index,lastCol:r.index}),u=2===r.sheetArea,t._commandManager().execute({cmd:"resizeColumn",sheetName:t.name(),columns:s,size:o,rowHeader:u})),c=t.hitTest(_._mousePosition.x,_._mousePosition.y),c&&_._updateCanvasCursor(c),e||t.repaint())},_startSelectingCore:function(e,t){var n,r,o,i,a,l,s,u,c=0,_=0,f=0,d=0,h=this,g=h._sheet,p=g._bindingManager,m=de(g),v=he(g);if(h._oldSelections=h._lastSelections=g._selectionModel.toArray(),h.ctrl||h.shift||g._clearSelectionImp(),0===Ce(e)){if(!h.shift&&(n=m?g._getFirstVisualRow():g._scrollTopRow,i=v?g._getFirstVisualColumn():g._scrollLeftCol,a=Fe(h,n,i,1,1,t)))return;h.ctrl||g._clearSelectionImp(),g._setSelectedRange(-1,-1,ge(g),pe(g),!0)}else if(1===Ce(e)){if(!h.shift&&(n=m?g._getFirstVisualRow():g._scrollTopRow,r=h._getAvailableActiveCell(n,e.col,!1),a=Fe(h,r.row,r.col,1,ve(e),t)))return;h.shift?(c=H(g._activeColIndex,e.col),d=P(g._activeColIndex-e.col)+1,g._replaceActiveSelectedRange(-1,c,ge(g),d,!0)):g._setSelectedRange(-1,g._activeColIndex,ge(g),1,!0)}else if(2===Ce(e)){if(!h.shift){if(l=v?g._getFirstVisualColumn():g._scrollLeftCol,r=h._getAvailableActiveCell(e.row,l,!0),o=g._activeRowIndex!==r.row,a=Fe(h,r.row,r.col,me(e),1,t))return;o&&p&&p._doDataItemChanged()}h.shift?(_=H(g._activeRowIndex,e.row),f=P(g._activeRowIndex-e.row)+1,g._replaceActiveSelectedRange(_,-1,f,pe(g),!0)):g._setSelectedRange(g._activeRowIndex,-1,1,pe(g),!0)}else if(3===Ce(e))if(N(e.row)||N(e.col))_e(g)&&(u=g.getCellRect(g._activeRowIndex,g._activeColIndex,g._activeRowViewportIndex,g._activeColViewportIndex),g._render._update(u.x,u.y,u.width,u.height));else{if(!h.shift&&(g._activeRowIndex!==e.row||g._activeColIndex!==e.col)){if(o=g._activeRowIndex!==e.row,a=Fe(h,e.row,e.col,me(e),ve(e),t))return;o&&p&&p._doDataItemChanged()}h.shift?g._extendSelectedRange(e.row,e.col,!0):(s=g._getSpanModel().get(e.row,e.col),g._setSelectedRange(s.row,s.col,Ie(s),Ae(s),!0))}},_startSelectingScroll:function(e){if(e&&(3!==Ce(e)||!N(e.row)&&!N(e.col))){var t=this;t._isWorking=!0,t._isSelecting=!0,t._startHitInfo={_scrollRowViewportIndex:me(e),_scrollColViewportIndex:ve(e),_hitTestType:Ce(e)},t._startScroll()}},_startSelecting:function(e){this._startSelectingCore(e),
this._startSelectingScroll(e)},_continueSelecting:function(){var e,t=this;t._startHitInfo&&t._isWorking&&!0!==t._forceCancelSelectiong&&(e=t._startHitInfo._hitTestType,3===e?t._continueCellSelecting():2===e?t._continueRowSelecting():1===e&&t._continueColumnSelecting())},_continueCellSelecting:function(){var e,t,n,r,o=this,i=o._sheet,a=o._getHitRowIndex(),l=o._getHitColumnIndex();if(a>=0&&l>=0&&i._canSelect(a,l)){if(e=i._selectionModel.toArray(),1===e.length&&(t=i._getExtendedRange(a,l,i._activeRowIndex,i._activeColIndex),n=e[0],t.equals(n)))return;i._extendSelectedRange(a,l,!0),r=i._selectionModel.toArray(),i._raiseSelectionChanging(e,r),o._continueScroll()}},_continueRowSelecting:function(){var e,t,n,r,o,i,a,l,s=this,u=s._sheet,c=s._getHitRowIndex();if(c>=0&&u._canSelect(c,-1)){if(e=H(u._activeRowIndex,c),t=O(u._activeRowIndex,c)-e+1,n=-1,r=pe(u),0===(o=u.selectionPolicy()))return;i=u.selectionUnit(),2===i&&(e=-1,t=-1),a=u._selectionModel.toArray(),u._replaceActiveSelectedRange(e,n,t,r,!0),l=u._selectionModel.toArray(),u._raiseSelectionChanging(a,l)}s._continueScroll()},_continueColumnSelecting:function(){var e,t,n,r,o,i,a,l,s=this,u=s._sheet,c=s._getHitColumnIndex();if(c>=0&&u._canSelect(-1,c)){if(e=H(u._activeColIndex,c),t=O(u._activeColIndex,c)-e+1,n=-1,r=ge(u),0===(o=u.selectionPolicy()))return;i=u.selectionUnit(),1===i&&(e=-1,t=-1),a=u._selectionModel.toArray(),u._replaceActiveSelectedRange(n,e,r,t,!0),l=u._selectionModel.toArray(),u._raiseSelectionChanging(a,l)}s._continueScroll()},_stopSelecting:function(){var e,t,n,r=this;r._startHitInfo=F,r._stopScroll(),r._forceCancelSelectiong=F,r._isWorking=!1,r._isSelecting=!1,e=r._sheet,e._selectionModel&&(e._noMoreSelectionChanged?delete e._noMoreSelectionChanged:(t=!r._lastSelections,t||(n=e._selectionModel.toArray(),t=r._notEqualSelecions(r._lastSelections,n)),t&&e._raiseSelectionChanged(r._oldSelections)),r._lastSelections=e._selectionModel.toArray())},_getHitRowViewportIndex:function(){var e=this._sheet,t=Ve(e,this._mousePosition.y),n=this._startHitInfo._scrollRowViewportIndex,r=e._getRowLayout(1);return 0===t&&n>0&&r.length>0&&r[0].row>e._getFirstPageTopRow()?t=1:2===t&&n<2&&r.length>0&&r[r.length-1].row<e._getLastVisualRow()&&(t=1),t},_getHitColumnViewportIndex:function(){var e=this._sheet,t=Oe(e,this._mousePosition.x),n=this._startHitInfo._scrollColViewportIndex,r=e._getColumnLayout(1);return 0===t&&n>0&&r.length>0&&r[0].col>e._getFirstPageLeftColumn()?t=1:2===t&&n<2&&r.length>0&&r[r.length-1].col<e._getLastVisualColumn()&&(t=1),t},_getHitRowIndex:function(){var e,t,n=this._sheet,r=this._mousePosition.y,o=this._getHitRowViewportIndex(),i=He(n,o,r);return i?(e=n._getSheetLayout(),t=i.row,1===o&&r<e._viewportY&&t>n._getFirstPageTopRow()?n._getNextVisualRow(t-1)||t:1===o&&r>e._frozenTrailingY&&t>n._getLastFullyVisibleRow()?n._getPrevVisualRow(t)||t:t):-1},_getHitColumnIndex:function(){var e,t,n=this._sheet,r=this._mousePosition.x,o=this._getHitColumnViewportIndex(),i=Pe(n,o,r);return i?(e=n._getSheetLayout(),t=i.col,1===o&&r<e._viewportX&&t>n._getFirstPageLeftColumn()?n._getNextVisualColumn(t-1)||t:1===o&&r>e._frozenTrailingX&&t>n._getLastFullyVisibleColumn()?n._getPrevVisualColumn(t)||t:t):-1},_getIntervalFromDistance:function(e){var t,n=0;return N(e)||0===e||(t=e<0,n=L(500/P(e)),n=O(20,10*n),n>200&&(n=200),t&&(n=-n)),n},_getPreVisualRow:function(e,t){var n=this._sheet,r=n._getPrevVisualRow(e,t);return r!==F?r:e},_getPreVisualCol:function(e,t){var n=this._sheet,r=n._getPrevVisualColumn(e,t);return r!==F?r:e},_getPreVisibleRow:function(e,t,n){for(var r=this._sheet;e>t;)if(e--,r.getRowVisible(e,n))return e;return e},_getPreVisibleCol:function(e,t,n){for(var r=this._sheet;e>t;)if(e--,r.getColumnVisible(e,n))return e;return e},_getResizeRowInfo:function(e,t,n,r,o){var a,l,s,u,c,_,f,d,h,g=F;return Le(e)?(a=this,l=e._getRowLayout(me(t),r),!l||N(t.row)||N(t.col)||(e.getRowVisible(t.row,r)||(t.row=this._getPreVisualRow(t.row,r)),s=l.findRow(t.row),s&&(s.y+s.height-n<=o&&o<=s.y+s.height+n?(g=Me(ne,t.row,r),(u=l[l.length-1].row)>=0&&(c=e._getLastVisualRow(r),g.index===c&&g.index!==u&&s.y+s.height-n/2<=o&&(g=Me(a._getResizeRowAction(e,u,r),u,r)))):s.y-n<=o&&o<=s.y+n&&i._ArrayHelper._indexOf(l,s)>0&&(_=a._getPreVisibleRow(t.row,0,r),g=Me(a._getResizeRowAction(e,_,r),_,r))),!g&&1===me(t)&&l.length>0&&(s=l[0],O(0,s.y-n)<=o&&o<=s.y+n&&(f=t.row-1,d=e._getRowLayout(me(t)-1,r),f>=0&&d&&(h=d[d.length-1],d.findRow(f)&&f!==(h&&h.row)||(g=Me(a._getResizeRowAction(e,f,r),f,r)))))),g&&!e.getRowResizable(g.index,r)&&(g=F),g):g},_getResizeRowAction:function(e,t,n){var r=e.parent;return r&&1===r.options.resizeZeroIndicator&&e.getRowVisible(t)&&0===e._getActualRowHeight(t,n)?te:ne},_getResizeColInfo:function(e,t,n,r,o){var a,l,s,u,c,_,f,d,h,g=F;return ke(e)?(a=this,l=e._getColumnLayout(ve(t),r),!l||N(t.col)||N(t.row)||(e.getColumnVisible(t.col,r)||(t.col=this._getPreVisualCol(t.col,r)),s=l.findCol(t.col),s&&(s.x+s.width-n<=o&&o<=s.x+s.width+n?(g=Me(re,t.col,r),(u=l[l.length-1].col)>=0&&(c=e._getLastVisualColumn(r),g.index===c&&g.index!==u&&s.x+s.width-n/2<=o&&(g=Me(a._getResizeColAction(e,u,r),u,r)))):s.x-n<=o&&o<=s.x+n&&i._ArrayHelper._indexOf(l,s)>0&&(_=a._getPreVisibleCol(t.col,0,r),g=Me(a._getResizeColAction(e,_,r),_,r))),!g&&1===ve(t)&&l.length>0&&(s=l[0],O(0,s.x-n)<=o&&o<=s.x+n&&(f=t.col-1,d=e._getColumnLayout(ve(t)-1,r),f>=0&&d&&(h=d[d.length-1],d.findCol(f)&&f!==(h&&h.col)||(g=Me(a._getResizeColAction(e,f,r),f,r)))))),g&&!e.getColumnResizable(g.index,r)&&(g=F),g):g},_getResizeColAction:function(e,t,n){var r=e.parent;return r&&1===r.options.resizeZeroIndicator&&e.getColumnVisible(t)&&0===e._getActualColumnWidth(t,n)?oe:re},_getResizingRowCol:function(e,t,n,r){var o,i,a,l,s,u=this,c=u._sheet,_=c.parent,f=c.options,d=f.colHeaderVisible,h=f.rowHeaderVisible,g=F;return _&&!_.options.allowUserResize||(a=c._getSheetLayout(),me(e)<0&&ve(e)>=0&&d?(g=u._getResizeColInfo(c,e,r,1,t))||(g=u._getResizeRowInfo(c,e,r,1,n)):me(e)>=0&&ve(e)<0&&h?(g=u._getResizeRowInfo(c,e,r,2,n))||(g=u._getResizeColInfo(c,e,r,2,t)):me(e)<0&&ve(e)<0?c._getLastVisualRow(2)===F&&P(n-a._colHeaderHeight)<=r?(l=c._getRowLayout(1))&&l.length>0&&(o=l[l.length-1].row)>=0&&c.getRowResizable(o,2)&&(g=Me(u._getResizeRowAction(c,o,2),o,2)):c._getLastVisualColumn(1)===F&&P(t-a._rowHeaderWidth)<=r&&(s=c._getColumnLayout(1))&&s.length>0&&(i=s[s.length-1].col)>=0&&c.getColumnResizable(i,1)&&(g=Me(u._getResizeColAction(c,i,1),i,1)):me(e)>=0&&ve(e)>=0&&(o=ge(c,1)-1,i=pe(c,2)-1,o>=0&&0===a._colHeaderHeight&&n<=r&&d?g=Me(u._getResizeRowAction(c,o,1),o,1):i>=0&&0===a._rowHeaderWidth&&t<=r&&h&&(g=Me(u._getResizeColAction(c,i,2),i,2)))),g},_inGrayArea:function(e,t,n,r){var o,i,a,l,s=this._sheet,u=s._getSheetLayout(),c=u._viewportRect(1,1);if(1===t)if((o=s._getColumnLayout(t))&&o.length>0){if(i=o[o.length-1],i.x+i.width<=n&&n<c.x+c.width)return!0}else if(c.contains(n,r))return!0;if(1===e)if((a=s._getRowLayout(e))&&a.length>0){if(l=a[a.length-1],l.y+l.height<=r&&r<c.y+c.height)return!0}else if(c.contains(n,r))return!0;return!1},_doMouseMove:function(e){var t=this._getCanvasOffset();this._doMouseMoveImp(e,e.pageX-t.left,e.pageY-t.top)},_doMouseOut:function(){var e,t,n,r=this._sheet,o=r._currentTarget;o&&(e=o.cellTypeHitInfo)&&(t=r.getCellType(e.row,e.col,Ce(o)),t.processMouseLeave(e)),this._isWorking||(n={x:-1e4,y:-1e4,rowViewportIndex:F,colViewportIndex:F,row:-1,col:-1,resizeInfo:F,hitTestType:F},this._setHoverCell(n))},_doMouseMoveImp:function(e,t,n){var r,o,i=this;if(i._mousePosition={e:e,x:t,y:n},r=i._sheet,i._isMouseDown&&!S._isActiveElement(r)&&S._setActiveElement(r),i._isMouseDown&&i._isWorking)return void(i.isResizing?i._continueResizing():i._isDragMerging?i._continueDragMerge&&i._continueDragMerge():i._isDragDropping?i._continueDragDropping&&i._continueDragDropping():i._isDraggingFill?i._continueDragFill&&i._continueDragFill():i._isFormulaRangeAppending?i._continueFormulaRangeAppending():i._isFormulaRangeMoving?i._continueFormulaRangeMoving():i._isFormulaRangeResizing?i._continueFormulaRangeResizing():i._isSelecting&&i._continueSelecting());(o=r.hitTest(t,n))&&(i._updateCanvasCursor(o),i._setHoverCell(o))},_updateCanvasCursor:function(e){var t,n,r,o,i,a,l,u,c,_,f,d,h,g,p,m=this,v=m._sheet,C=v._getCanvas();C&&(t=v._currentTarget,n=!t||e.row!==t.row||e.col!==t.col||Ce(e)!==Ce(t)||e.resizeInfo&&!t.resizeInfo||!e.resizeInfo&&t.resizeInfo||e.resizeInfo&&e.resizeInfo.action!==t.resizeInfo.action||e.dragInfo&&!t.dragInfo||!e.dragInfo&&t.dragInfo||e.dragInfo&&e.dragInfo.action!==t.dragInfo.action,t&&n&&(r=t.cellTypeHitInfo)&&(o=v.getCellType(r.row,r.col,Ce(t)),o.processMouseLeave(r)),i=e.resizeInfo,a=e.dragMergeInfo,l=e.dragInfo,u=e.formulaRangeHitInfo,c=e.cellTypeHitInfo,_=v._render,i?(f=s.CursorResource,i.action===re?C.style.cursor=f.ResizeCol:i.action===ne?C.style.cursor=f.ResizeRow:i.action===oe?C.style.cursor=f.ResizeHiddenCol:i.action===te?C.style.cursor=f.ResizeHiddenRow:C.style.cursor=ie):a?a.left||a.right?C.style.cursor="w-resize":(a.top||a.bottom)&&(C.style.cursor="n-resize"):l&&"drag"===l.action?l.side===ee?C.style.cursor="crosshair":l.side?C.style.cursor="move":C.style.cursor=ie:u?(u.inBorder?C.style.cursor="move":u.inTopLeft?C.style.cursor="nw-resize":u.inTopRight?C.style.cursor="ne-resize":u.inBottomLeft?C.style.cursor="sw-resize":u.inBottomRight&&(C.style.cursor="se-resize"),d=m.isFormulaRangeHoving,h=m._formulRangeHovingInfo,g=h&&h.paramRange,p=u.paramRange,m.isFormulaRangeHoving=!0,m._formulRangeHovingInfo={paramRange:p},d&&p.index===g.index||_._paintFormulaTextBox()):(c&&(o=v.getCellType(c.row,c.col,Ce(e)),c.sheet=v,n&&o.processMouseEnter(c),o.processMouseMove(c)),!n&&c&&c.isReservedLocation||(C.style.cursor=ie),m.isFormulaRangeHoving&&(m.isFormulaRangeHoving=!1,m._formulRangeHovingInfo=F,_._paintFormulaTextBox())))},_doMouseUp:function(e){var t,n=this,r=n._sheet;return n._unhandleDocumentMouseMove(),t=r._getCanvasOffset(),!r._isMouseDownInSheet||(r._isMouseDownInSheet=!1,n._doMouseUpImp(e,e.pageX-t.left,e.pageY-t.top),!1)},_doMouseUpImp:function(e){var t,n,r,o=this,i=o._sheet,a=S._getActiveElement();o._isMouseDown=!1,a&&a!==i&&a.endEdit&&(a._formulaTextBox&&a._formulaTextBox._isSelectMode||(a.endEdit(),a.repaint())),S._setActiveElement(i),o.isResizing?o._stopResizing():o._isDragMerging?o._stopDragMerge&&o._stopDragMerge():o._isDragDropping?o._stopDragDrop&&o._stopDragDrop():o._isDraggingFill?o._endDragFill&&o._endDragFill():o._isFormulaRangeAppending?o._stopFormulaRangeAppending():o._isFormulaRangeMoving?o._stopFormulaRangeMoving():o._isFormulaRangeResizing?o._stopFormulaRangeResizing():i._currentTarget&&(t=i._currentTarget,n=t.cellTypeHitInfo,!t.filterButtonHitInfo&&!t.resizeInfo&&t.row>=0&&t.col>=0&&(n&&(r=i.getCellType(n.row,n.col,Ce(t)),n.sheet||(n.sheet=i),r.processMouseUp(n)),n&&n.isReservedLocation||i._trigger(y.CellClick,Ee(i,i._name,t.row,t.col,Ce(t))))),o._stopSelecting(),o._setMetaKeyState(e)},_startEdit:function(e){var t,n,r=this._sheet;r.isEditing&&(t=r._getCanvas(),n=r._getCanvasOffset(),be(e)||xe(e)||r._doStartEdit(t,e.pageX-n.left,e.pageY-n.top))},_doKeyDown:function(e){var t,n,r,o,i,a,l,s,u,c=this,_=c._sheet;if(_){if(t=we(_),n=ye(_),r=_.getCellType(t,n),o={isEditing:_e(_),sheet:_,row:t,col:n,sheetArea:3},i={sheet:_,row:t,col:n,sheetArea:3},r&&r.isReservedKey(e,o))return void(_e(_)||r.processKeyDown(e,i));if((a=_._formulaTextBox)&&a._isReservedKey(e))return;if((l=_.parent&&_.parent._attachedFormulaTextBox)&&l._isReservedKey(e,o))return}if(s=!(_e(_)||xe(e)||Re(e)||34!==Se(e)&&33!==Se(e)&&37!==Se(e)&&39!==Se(e)&&9!==Se(e)&&13!==Se(e)&&38!==Se(e)&&40!==Se(e)),_._isTouchMode&&(_._isTouchMode=!1,_._render._refreshTouchSelectionIndicator()),u=c._keyDownImp(e),s&&u&&S._isActiveElement(_)){if(c._lastKeyDownTime=new Date,c._keyPressed)return c._keyPressedCount<25&&c._keyPressedCount++,void p(e);c._keyPressed=!0,c._keyPressedCount=1,c._repeatKeyDown(e,!0)}},_getMouseDownResizeTooltipContent:function(){var e,t,n,r,o=this._sheet,i=o._currentTarget,a=i.resizeInfo;return a.action===ne||a.action===te?(e=o._getAllRowLayout(a.sheetArea),o.getRowVisible(a.index)||(a.index=this._getPreVisualRow(a.index,a.sheetArea)),t=e.findRow(a.index),t||(t=e.findRow(i.row)),v(le().Tip_Height,[t.height.toFixed(0)])):(n=o._getAllColumnLayout(a.sheetArea),o.getColumnVisible(a.index)||(a.index=this._getPreVisualCol(a.index,a.sheetArea)),r=n.findCol(a.index),r||(r=n.findCol(i.col)),v(le().Tip_Width,[r.width.toFixed(0)]))},_getMouseMoveResizeTooltipContent:function(e){return e.action===ne||e.action===te?v(le().Tip_Height,[(e.movingY-e.startY).toFixed(0)]):v(le().Tip_Width,[(e.movingX-e.startX).toFixed(0)])},_repeatKeyDown:function(e,t){var n=this;if(n._keyPressed){if(new Date-n._lastKeyDownTime>100)return void n._clearRepeatKeyDownTimeout();t||n._keyDownImp(e),n._keyPressed&&(n._repeatKeyDownTimeoutID=setTimeout(function(){n._repeatKeyDown(e)},500/n._keyPressedCount))}},_startEditByKeyboard:function(e){var t,n,r=this._sheet,o=r._getCanvas();if(o){r._startEditByKeydown=!0;try{t=_e(r),r._startEditImp&&r._startEditImp(o,r._activeRowIndex,r._activeColIndex,F,F,!0),!t&&_e(r)&&(n=r.getCellType(r._activeRowIndex,r._activeColIndex),!n._triggerButtonClicked||32!==Se(e)||xe(e)||be(e)||Te(e)||n._triggerButtonClicked(r,r._activeRowIndex,r._activeColIndex,3),n._cancelDefaultKeydown&&n._cancelDefaultKeydown(e))}finally{r._startEditByKeydown=!1}}},_keyDownImp:function(e){var t,n,r,i,a,s,u,_,f,d,h,g=this,m=g._sheet;if(g._setMetaKeyState(e),_e(m)||27!==Se(e)||Te(e)||xe(e)||be(e)||!m._validationInputMessage||(l(m._validationInputMessage).remove(),m._validationInputMessage=F),_e(m)||34!==Se(e)&&33!==Se(e)&&35!==Se(e)&&36!==Se(e)&&38!==Se(e)&&40!==Se(e)||p(e),_e(m)||37!==Se(e)&&39!==Se(e)||p(e),_e(m)&&xe(e)&&(89===Se(e)||90===Se(e)))return p(e),!1;if(t=m._commandManager(),n=t.getShortcutKey(Se(e),xe(e),be(e),Te(e),Re(e)),r=t.getCommands(n))for(i=0;i<r.length;i++)if(a=r[i].execute(m.parent,{sheetName:m.name()}))return a.ignoreCancelDefault||p(e),!0;return s={e:e,r:F},o._callFeatureHandler(m,"processKeyDown",s),!!s.r||(u=229===Se(e)||0===Se(e),g._allowEnterEditing(e)&&!u&&(_=m._formulaTextBox,_&&_._isAppending&&_._stopAppending(),(f=_e(m))||(d=c._gcGlobal._getUIElement(e.target),(h=d&&"gcAttachedFormulaTextBox"===d.getAttribute($))||g._startEditByKeyboard(e))),!1)},_clearRepeatKeyDownTimeout:function(){var e=this;e._keyPressed=!1,e._repeatKeyDownTimeoutID>0&&(clearTimeout(e._repeatKeyDownTimeoutID),e._repeatKeyDownTimeoutID=0)},_doKeyUp:function(e){var t,n,r,o,i,a,l,s,u=this;if(u._clearRepeatKeyDownTimeout(),t=u._sheet){if(n=we(t),r=ye(t),o=t.getCellType(n,r),i={isEditing:_e(t),sheet:t,row:n,col:r,sheetArea:3},a={sheet:t,row:n,col:r,sheetArea:3},o&&o.isReservedKey(e,i))return void(_e(t)||o.processKeyUp(e,a));if((l=t._formulaTextBox)&&l._isReservedKey(e))return;if((s=t.parent&&t.parent._attachedFormulaTextBox)&&s._isReservedKey(e))return}u._setMetaKeyState(e)},_doCompositionStart:function(e){this._startEditByKeyboard(e)},_allowEnterEditing:function(e){return!(xe(e)||Te(e)||Re(e))&&(Se(e)>=65&&Se(e)<=90||Se(e)>=48&&Se(e)<=57||Se(e)>=96&&Se(e)<=105||Se(e)>=186&&Se(e)<=192||Se(e)>=220&&Se(e)<=222||219===Se(e)||Se(e)>=106&&Se(e)<=111||32===Se(e)||61===Se(e)||173===Se(e)||229===Se(e)||0===Se(e)||8===Se(e))},_setMetaKeyState:function(e){var t,n,r,o,i=this,a=i._sheet,l=d._isMacOS(),s=l?Re(e):xe(e);i.ctrl=s&&!be(e),i.shift=be(e)&&!s,a._isNavigateInSelection=!1,9===Se(e)&&(a._selectionModel.length>1?a._isNavigateInSelection=!0:(t=a._getActiveSelectedRange())&&a._selectionModel.length>0&&(a._isNavigateInSelection=!(a._activeRowIndex===t.row&&a._activeColIndex===t.col&&a._activeRowCount>=Ie(t)&&a._activeColCount>=Ae(t)))),!0===i._isDragDropping&&(n=a._getActiveSelectedRange(),r=i._isDragInsert,o=i._isDragCopy,-1===n.row||-1===n.col?i._isDragInsert=be(e):i._isDragInsert=!1,i._isDragCopy=xe(e),r===i._isDragInsert&&o===i._isDragCopy||a._render._refreshDragDropIndicator&&a._render._refreshDragDropIndicator()),i._isControlPressed=xe(e)},_resetMetaKeyState:function(){var e=this;e.shift=!1,e.ctrl=!1,e._sheet._isNavigateInSelection=!1,e._isDragDropping=!1,e._isDragInsert=!1,e._isDragCopy=!1,e._isControlPressed=!1},_updateEditingEditor:function(e){var t,n,r,o,i,a,s,u,c,_,f,d;e&&e.sheet?(t=e.sheet,n=e.editor,r=e.canvasOffset):(t=this._sheet,n=t._editor),_e(t)&&(o=t._activeRowIndex,i=t._activeColIndex,a=t.getCellType(o,i),s=t._getSheetLayout(),u=t.getActualStyle(o,i),c=t.getCellRect(o,i),n&&n.parentNode&&(_=n.parentNode.parentNode,c&&c.width>0&&c.height>0&&c.x>=s._frozenX&&c.y>=s._frozenY&&c.x+c.width<=s._frozenTrailingX+s._frozenTrailingWidth&&c.y+c.height<=s._frozenTrailingY+s._frozenTrailingHeight?(f={sheet:t,row:o,col:i,sheetArea:3,canvasOffset:r},a._updateEditorWrapper(_,u,c,f,!0)):l(_).css({top:-1e4,left:-1e4})),(d=t._formulaTextBox)&&d._position())},_getElementById:function(e,t){var n,r;if(!e)return F;for(n=e.firstChild;n;){if(n.id===t||n.name===t)return n;if(r=this._getElementById(n,t))return r;n=n.nextSibling}return F},_notEqualSelecions:function(e,t){var n,r,o,i=!0;if(e.length===t.length)for(n=0;n<e.length;n++){if(r=e[n],o=t[n],r.row!==o.row||r.col!==o.col||Ie(r)!==Ie(o)||Ae(r)!==Ae(o)){i=!0;break}i=!1}return i},_createFocusHolder:function(e,t,n,r){var o,i,a,s,u,c=this,_=c._sheet,f={sheet:_,row:t,col:n,sheetArea:3},d=_._getHost(),g=e.isImeAware(f),p=ae?W:"fixed";return r&&c._destroyFocusHolder(),g&&!c._cellTypeFocusHolder&&(o=e._createCellTypeElement(f),c._focusHolderOldCss||(c._focusHolderOldCss={overflow:J,border:q,position:W}),c._focusHolderOldCss.overflow=o.style.overflow,c._focusHolderOldCss.border=o.style.border,c._focusHolderOldCss.position=o.style.position,l(o).css(B,p).css(U,Z).css(Y,"0px").css(G,"0px").css(X,"0px").css(j,"0px").css(z,q),_._setEditorValue&&o.firstChild&&(i=o.firstChild.firstChild,_._setEditorValue(e,i,t,n,_.getActualStyle(t,n)),a=e.getEditorValue(i,f),h.safari&&(""===a||w(a))&&e.setEditorValue(i," ",f)),d&&d.insertBefore(o,F),c._cellTypeFocusHolder=o),c._originalFocusHolder||(o=m("div"),l(o).css(B,p).css(U,Z).css(Y,"0px").css(G,"0px").css(X,"0px").css(j,"0px"),c._originalFocusHolder=o,s=m("textarea"),l(s).attr($,"gcSheetFocusInput").attr(Q,-1).css(B,W).css(U,Z).css(z,q).css(K,q),s.value=" ",o.insertBefore(s,F),c._focusElem=s,u=m("div"),l(u).css(B,W).css(U,Z).attr($,"gcSheetFocusInput").attr(Q,-1),o.insertBefore(u,F),c._readonlyFocusElem=u,d&&d.insertBefore(o,F)),ae&&(c._cellTypeFocusHolder&&c._setVisibleLocation(_,c._cellTypeFocusHolder),c._setVisibleLocation(_,c._originalFocusHolder)),g?c._cellTypeFocusHolder:c._focusElem},_resetFocusHolder:function(){var e=this;e._cellTypeFocusHolder&&e._focusHolderOldCss&&l(e._cellTypeFocusHolder).css(U,e._focusHolderOldCss.overflow).css(z,e._focusHolderOldCss.border).css(B,e._focusHolderOldCss.position)},_destroyFocusHolder:function(){var e=this;e._cellTypeFocusHolder&&(e._cellTypeFocusHolder.parentElement&&e._cellTypeFocusHolder.parentElement.removeChild(e._cellTypeFocusHolder),e._cellTypeFocusHolder=F)},_setFocus:function(e){S._isActiveElement(this._sheet)||this._setFocusCore(!0,!0,e)},_setFocusToReadonlyFocusElem:function(){var e=this._readonlyFocusElem;e&&e.focus()},_changeFocusHolder:function(){this._setFocusCore(!0,!0)},_clearTouchSetFocusTimeout:function(){this._touchSetFocusTimeout&&(clearTimeout(this._touchSetFocusTimeout),this._touchSetFocusTimeout=F)},_setFocusCore:function(e,t,n){var r,o,i,a,l,s,u,c,f,d,p;0===arguments.length&&(e=!0),r=this,r._focusSuspended||(r._focusReleased=!1,r._clearTouchSetFocusTimeout(),o=r._sheet,i=we(o),a=ye(o),l=o.getCellType(i,a),r._createFocusHolder(l,i,a,t),s={sheet:o,row:i,col:a,sheetArea:3},u=l.isImeAware(s)&&r._cellTypeFocusHolder.firstChild?r._cellTypeFocusHolder.firstChild.firstChild:r._focusElem,c=u,t&&!h.msie&&l.setImeMode(c,o.getActualStyle(i,a).imeMode,s),_.body.focus(),f=function(){var e=function(){try{l.isImeAware(s)?(l.focus(c,s),l.selectAll(c,s)):(u.focus(),u.select())}catch(e){}};t&&h.msie&&l.setImeMode(c,o.getActualStyle(i,a).imeMode,s),e()},d=g,!o._isTouchMode&&!d.ipad||!e&&l.isImeAware(s)?!1===o._enhanceIme||n||f():r._cellTypeFocusHolder&&!_e(o)&&(h.metroMode||d.ipad||d.iphone||d.android)?(p=r._cellTypeFocusHolder.firstChild,t&&p&&p.firstChild&&l.setImeMode(p.firstChild,o.getActualStyle(i,a).imeMode,s)):r._touchSetFocusTimeout=setTimeout(function(){r._clearTouchSetFocusTimeout(),_e(o)||!1===o._enhanceIme||n||f()},200),S._isActiveElement(o)||S._setActiveElement(o),r._updateValidationUI&&r._updateValidationUI(o._activeRowIndex,o._activeColIndex))},_setVisibleLocation:function(e,t){var n,r,o,i,a,s,u,_=we(e),f=ye(e),d=e._activeRowViewportIndex,h=e._activeColViewportIndex,g=e.getCellRect(_,f,d,h),p=this,m=e._getCanvasOffset(),v=p._getCanvasPosition(),C=p._cellTypeFocusHolder,w=0,y=0,S=0,x=0;C&&(o=l(C),w=parseInt(o.css(Y),10),y=parseInt(o.css(G),10),S=parseInt(o.css(j),10),x=parseInt(o.css(X),10)),p._isInvalidRect(g)?(n=w,r=y):(n=g.y+v.top-2,r=g.x+v.left-2),i=c.pageYOffset-m.top+v.top,a=c.innerHeight+i-S,s=c.pageXOffset-m.left+v.left,u=c.innerWidth+s-x,(N(n)||n<i||n>a)&&(n=i),(N(r)||r<s||r>u)&&(r=s),l(t).css(Y,n).css(G,r)},_releaseFocus:function(e){var t,n,r,o,i=this;i._clearTouchSetFocusTimeout(),_e(i._sheet)||i._focusReleased&&_.activeElement===i._readonlyFocusElem||(t=i._sheet,e?(n=e.row,r=e.col):(n=t._activeRowIndex,r=t._activeColIndex),o=t.getCellType(n,r),i._createFocusHolder(o,n,r,!1),i._readonlyFocusElem.focus(),i._focusReleased=!0)},_resumeFocus:function(e,t){var n=this;n._focusReleased&&(n._focusReleased=!1,!t&&n._setFocusCore(e))},_switchFocusForClipboard:function(e){var t=this._sheet,n=t._getClipboardHelper();n&&(n._setClipboardData(e),n._focus(),this._focusSuspended=!0,e&&n._select())},_switchBackFocusAfterClipboard:function(){var e=this,t=e._sheet._getClipboardHelper();t&&t._setClipboardData(""),e._focusSuspended=!1,e._setFocusCore(!0,!1)},_disposeFocusHolders:function(){var e,t=this;t._clearTouchSetFocusTimeout(),e=t._cellTypeFocusHolder,e&&(l(e).remove(),t._cellTypeFocusHolder=D),(e=t._originalFocusHolder)&&(l(e).remove(),t._focusElem=D,t._originalFocusHolder=F,t._readonlyFocusElem=F)},_showTooltip:function(e,t,n,r){var o=this._sheet.parent;o&&o._showTooltip(e,t,n,r)},_refreshTooltip:function(e,t,n,r){var o=this._sheet.parent;o&&o._refreshTooltip(e,t,n,r)},_removeTooltip:function(){var e=this._sheet.parent;e&&e._removeTooltip()},_setHoverCell:function(e){var t,n,r,o=this,i=o._sheet,a=!1,l=i._currentTarget;l||(a=!0),a||e||(a=!0);function s(e,t){var n=!1;return e||t?e&&t&&(n=e.action===t.action&&e.index===t.index&&e.sheetArea===t.sheetArea):n=!0,n}a||(a=e.col!==l.col||e.row!==l.row||ve(e)!==ve(l)||me(e)!==me(l)||Ce(e)!==Ce(l)||!s(e.resizeInfo,l.resizeInfo)),i._currentTarget=e,a&&(i._hoverCell=!0,t=i._render,n=ce(i,l,t),r=ce(i,e,t),n=n||r,i._hoverCell=!1,n&&t._repaintSelection())},_getAvailableActiveCell:function(e,t,n){var r=this._skipSpanCell(e,t,n);return this._skipInvisibleCell(r)},_skipSpanCell:function(e,t,n){var r=this._sheet._getSpanModel().get(e,t),o=Ie(r),i=Ae(r);return 1===o&&1===i?r:n&&1===o||!n&&1===i?r:(n?t++:e++,this._skipSpanCell(e,t,n))},_skipInvisibleCell:function(e){var t,n,r,o=this._sheet,i=e.row,a=ge(o);for(t=i;t<a&&!0!==o.getRowVisible(t);t++);for(t<a&&(i=t),n=e.col,r=pe(o),t=n;t<r&&!0!==o.getColumnVisible(t);t++);return t<r&&(n=t),C(i,n,Ie(e),Ae(e))}},e}(),r._SheetEventHandler=t;function Be(e){var t=this;t._host=e,t._interval=F,t._action=F,t._intervalId=F,t._result=F,t._working=!1,t._needIncrease=!1}Be.prototype={_setAction:function(e){typeof e===k&&(this._action=e)},_setInterval:function(e){var t,n=this;N(e)||0===e?n._stop():(n._needIncrease=e>0,e=P(e),t=n._interval,n._interval=e,t!==e&&n._start())},_start:function(){var e=this;e._clear(),N(e._interval)||(e._intervalId=setInterval(function(){e._run()},e._interval))},_run:function(){var e=this,t=e._action;e._working=!0,typeof t===k&&(e._result=t.call(e._host,e._needIncrease))},_stop:function(){var e=this;e._clear(),e._interval=F,e._intervalId=F,e._result=F,e._working=!1},_clear:function(){var e=this._intervalId;e&&clearInterval(e)},_dispose:function(){this._stop()}},e.exports=r}()},function(e,t,n){!function(){"use strict";var e=n(5),t=n(17).Worksheet,r=n(12).Style,o=n(3),i=n(10),a=n(4).GC$,l=n(11)._StyleHelper,s=e.CultureManager,u=o._createRange,c=n(16),_=c._SheetModel,f=c._AxisModel,d=c._SpanModel,h=t._features,g=o._util._isDefined,p=a.each,m=a.isEmptyObject,v=e._hasOwnProperty,C=e._Types._isNullOrUndefined,w="columns",y="rows",S="rowHeaderColInfos",x="colHeaderRowInfos",b="data",T="rowHeaderData",R="colHeaderData",A="selections",I="theme",M="spans",E="rowHeaderSpan",F="colHeaderSpan",D="string",N=parseInt,V=isNaN,O=void 0;function H(e,t){var n,r;if(e){for(n=[],r=0;r<t;r++)g(e[r])&&(n[r]=e[r]);return n}}function P(e,n,r){var o,i,a=e._dataModel,l=e._colHeaderModel,s=e._rowInfos,u=e._colHeaderRowInfos,c=e._spanModel,h=e._colHeaderSpanModel;for(o=0;o<n;o++)for(a.setNode(o,-1,l.getNode(o,-1)),s._setItem(o,u._getItem(o)),i=r;i<l.colCount;i++)a.setNode(o,i,l.getNode(o,i));h.forEach(function(e){c.addSpan(e)}),e.frozenRowCount(n),e._colHeaderModel=new _(a.rowCount,t._defaultColHeaderRowCount),e._colHeaderRowInfos=new f,e._colHeaderSpanModel=new d}function L(e,n,r){var o,i,a=e._dataModel,l=e._rowHeaderModel,s=e._colInfos,u=e._rowHeaderColInfos,c=e._spanModel,h=e._rowHeaderSpanModel;for(o=0;o<n;o++)for(a.setNode(-1,o,l.getNode(-1,o)),s._setItem(o,u._getItem(o)),i=r;i<a.rowCount;i++)a.setNode(i,o,l.getNode(i,o));h.forEach(function(e){c.addSpan(e)}),e.frozenColumnCount(n),e._rowHeaderModel=new _(a.rowCount,t._defaultRowHeaderColumnCount),e._rowHeaderColInfos=new f,e._rowHeaderSpanModel=new d}function k(e,t,n){var r,o,i,a=e._dataModel,l=e._colHeaderModel,s=e._rowInfos,c=e._colHeaderRowInfos,_=e._spanModel,f=e._colHeaderSpanModel;for(l.setRowCount(t),r=0;r<t;r++)for(l.setNode(r,-1,a.getNode(r,-1)),c._setItem(r,s._getItem(r)),o=n;o<a.colCount;o++)l.setNode(r,o,a.getNode(r,o));i=_.getSpans(u(0,0,t,a.colCount)),i.forEach(function(e){f.addSpan(e)}),e.frozenRowCount(0)}function B(e,t,n){var r,o,i,a=e._dataModel,l=e._rowHeaderModel,s=e._colInfos,c=e._rowHeaderColInfos,_=e._spanModel,f=e._rowHeaderSpanModel;for(l.setColumnCount(t),r=0;r<t;r++)for(l.setNode(-1,r,a.getNode(-1,r)),c._setItem(r,s._getItem(r)),o=n;o<a.rowCount;o++)l.setNode(o,r,a.getNode(o,r));i=_.getSpans(u(0,0,a.rowCount,t)),i.forEach(function(e){f.addSpan(e)}),e.frozenColumnCount(0)}function W(e,n){switch(e){case"defaults":return n.rowHeight===t._defaultRowHeight&&n.colWidth===t._defaultColWidth&&n.rowHeaderColWidth===t._defaultRowHeaderColWidth&&n.colHeaderRowHeight===t._defaultColHeaderRowHeight;case w:case y:case S:case x:return!n||0===n.length;case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===n;case"rowCount":return 200===n;case"columnCount":return 20===n;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===n;case"visible":return!0===n;case b:case T:case R:return m(n);case"tag":return null===n}return!1}function z(e,t,n,r,o){e[t]=n.toJSON(r,o)}function U(e,t,n,r){e[t]=H(n._getItems(),r)}function Y(e,t,n){t&&e._setItems(t,n)}function G(e,t,n,r){t&&e.fromJSON(t,n,r)}function X(e,t){return g(e)?e:t}function j(e,t,n){g(n)&&t.call(e,n,!1)}a.extend(t.prototype,{_setValueToDataTable:function(e,t,n,r){var o,i;e[t]||(e[t]={}),o=e[t],o[n]||(o[n]={}),i=o[n],i.value=r},toJSON:function(e){var n,r,i,a,s,u,c,_,f,d,g,D,N,V,O=this,H=O.getRowCount(1),k=O.getColumnCount(2),B=e&&e.rowHeadersAsFrozenColumns,Y=e&&e.columnHeadersAsFrozenRows,G=e&&e.ignoreStyle;B&&k>0&&O.addColumns(0,k),Y&&H>0&&O.addRows(0,H),B&&k>0&&L(O,k,H),Y&&H>0&&P(O,H,k),n=O.getRowCount(),r=O.getColumnCount(),i=O.getRowCount(1),a=O.getColumnCount(2),s={name:O._name,defaults:O.defaults,rowCount:n,columnCount:r,activeRow:O._activeRowIndex,activeCol:O._activeColIndex,zoomFactor:O._zoomFactor,rowHeaderColCount:a,colHeaderRowCount:i,visible:O.visible(),tag:O._tag},G||(s.frozenRowCount=O.frozenRowCount(),s.frozenColCount=O.frozenColumnCount(),s.frozenTrailingRowCount=O.frozenTrailingRowCount(),s.frozenTrailingColCount=O.frozenTrailingColumnCount(),z(s,M,O._getSpanModel()),z(s,E,O._getSpanModel(2)),z(s,F,O._getSpanModel(1)),z(s,I,O._currentTheme)),z(s,b,O._getModel(),3,e),z(s,T,O._getModel(2),2,e),z(s,R,O._getModel(1),1,e),O._getModel(4)&&z(s,"colFooterData",O._getModel(4),1,e),z(s,A,O._selectionModel),U(s,y,O._getRowInfos(),n),U(s,w,O._getColInfos(),r),U(s,S,O._getColInfos(2),a),U(s,x,O._getRowInfos(1),i),O._getModel(4)&&U(s,"colFooterRowInfos",O._getRowInfos(4),i),h&&p(h,function(t,n){n.toJson&&n.toJson.call(O,s,e)}),u={};for(c in s)v(s,c)&&(_=s[c],C(_)||W(c,_)||(u[c]=_));if(p(O.options,function(e,n){var r,i,a,l=n;"gridline"===e&&(l={},r=n.color,i=n.showHorizontalGridline,a=n.showVerticalGridline,r&&r!==o._ThemeStyleHelper._getCssClassThemeStyle("gc-gridlineColor").borderTopColor&&(l.color=r),!1===i&&(l.showHorizontalGridline=i),!1===a&&(l.showVerticalGridline=a)),"_ps"===e||C(l)||t._defaultOptions[e]===l||"object"==typeof l&&m(l)||(u[e]=l)}),f=[],d=O._namedStyles,d){for(g in d)v(d,g)&&(D=d[g])&&(N=D.toJSON(),V=D.font,m(N)||(V&&(N.font=l._normalizeFont(V)),f.push(N)));f.length>0&&(u.namedStyles=f)}return u},fromJSON:function(e,n,a,l,u){var c,_,f,d,m,C,H,P,L,W,z,U,K,Z,J,q,Q,$,ee,te,ne,re,oe,ie,ae,le,se,ue,ce,_e,fe,de,he,ge,pe,me,ve,Ce;if(a&&(c=a.noSchema,_=a.version),e){f=this,d=l&&l.ignoreStyle,f._initOptions(),t._callFeatureHandler(f,"preFromJson"),f.suspendPaint(),m=s.culture(),s.culture(""),C=X(e.rowCount,t._defaultRowCount),H=X(e.columnCount,t._defaultColCount);try{if(f._name=e.name+"",f.defaults=X(e.defaults,f.defaults),f.setRowCount(C),f.setColumnCount(H),f._namedStyles={},P=e.namedStyles)for(L=0;L<P.length;L++)W=P[L],z=new r,z.fromJSON(W,c),f._addNamedStyleImp(z);U=f.options;for(K in U)if(v(U,K)&&(Z=e[K],"protectionOptions"===K?Z=Z||e.protectionOption:"allowCellOverflow"===K&&(Z=g(e[K])?e[K]:!_||_>=11),g(Z)))if("object"==typeof Z)for(J in Z)v(Z,J)&&(f.options[K][J]=Z[J]);else f.options[K]=Z;if(q=X(e.activeRow,f._activeRowIndex),Q=X(e.activeCol,f._activeColIndex),f._setActiveCellImp(q,Q,O,O,!0),d||(j(f,f.frozenRowCount,e.frozenRowCount),j(f,f.frozenColumnCount,e.frozenColCount),j(f,f.frozenTrailingRowCount,e.frozenTrailingRowCount),j(f,f.frozenTrailingColumnCount,e.frozenTrailingColCount)),$=e.tag,g($)&&(ee=$.typeName,typeof ee===D&&(te=o.getTypeFromString(ee))&&($=new te,$.fromJSON&&$.fromJSON(e.tag)),f.tag($)),!d){if(ne=e.colStyles)for(re in ne)V(re)||f.setStyle(-1,N(re,10),ne[re],3);if(oe=e.rowStyles)for(ie in oe)V(ie)||f.setStyle(N(ie,10),-1,oe[ie],3)}ae=X(e.rowHeaderColCount,t._defaultRowHeaderColumnCount),le=X(e.colHeaderRowCount,t._defaultColHeaderRowCount),f.setColumnCount(ae,2),f.setRowCount(le,1),f._zoomFactor=X(e._zoomFactor||e.zoomFactor,f._zoomFactor),j(f,f.visible,e.visible),d||(G(f._getSpanModel(),e[M],c),G(f._getSpanModel(2),e[E],c),G(f._getSpanModel(1),e[F],c)),se=f._validations,ue={sheet:f,setValidator:function(e,t,n){se&&se._importValidator(e,t,n)},ignoreStyle:d},G(f._getModel(),e[b],c,ue),se&&se._resetCache(!0),G(f._getModel(2),e[T],c,ue),G(f._getModel(1),e[R],c,ue),G(f._getModel(4),e.colFooterData,c,ue),G(f._selectionModel,e[A],c),Y(f._getRowInfos(),e[y],C),Y(f._getColInfos(),e[w],H),Y(f._getColInfos(2),e[S],ae),Y(f._getRowInfos(1),e[x],le),Y(f._getRowInfos(4),e.colFooterRowInfos,le),ce=e[I],ce&&!d&&(_e=ce,typeof _e!==D&&g(_e)&&(fe="_themeColor",de="_name",he=_e.themeColor||_e[fe],ge=new i.ColorScheme(he.name||he[de]),ge.fromJSON(he,c),_e=new i.Theme(_e.name||_e._name,ge,_e.headingFont||_e._headingFont,_e.bodyFont||_e._bodyFont)),f.currentTheme(_e)),h&&p(h,function(t,r){var o=r.fromJson;o&&o.call(f,e,c,l,!g(n)||n)}),pe=l&&l.frozenColumnsAsRowHeaders,me=l&&l.frozenRowsAsColumnHeaders,ve=me?e.frozenRowCount:0,Ce=pe?e.frozenColCount:0,me&&ve>0&&k(f,ve,Ce),pe&&Ce>0&&B(f,Ce,ve),u||(ve>0&&f.deleteRows(0,ve),Ce>0&&f.deleteColumns(0,Ce)),f.clearPendingChanges()}finally{s.culture(m),f.resumePaint()}}}})}()
},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g=n(5)._ArrayHelper,p=n(17).Worksheet,m=n(3),v=n(11),C=n(16),w=n(31),y=function(){return n(14)},S=n(1),x=n(5),b=S._CanvasHelper,T=m._util,R=m._DPIHelper,A=m._CacheMgr,I=m._WordWrapHelper,M=m._FocusHelper,E=m.Rect,F=T._getHAlignByValueType,D=T._getFontHeight,N=m.Events,V=m._ThemeContext,O=m._createRange,H=x._Types._isNullOrUndefined,P=m._ThemeStyleHelper,L=v._DefaultFontSize,k=v._StyleHelper._scaleFont,B=C._CellOverflowLayout,W=C._CellOverflowLayoutModel,z=w._Borders,U=null,Y=Math.min,G=Math.max,X=Math.abs,j=Math.floor,K=Math.ceil,Z="black",J="transparent",q="rowHeader",Q="columnHeader";function $(e){return e.height}function ee(e){return e.width}p._registerFeature("render",{init:function(){var e=this;e._render=new re(e),e._cutCopyIndicatorManager=new ue(e)},dispose:function(e){var t,n=this;!1!==e&&(n._render=U,(t=n._cutCopyIndicatorManager)&&(t._dispose(),n._cutCopyIndicatorManager=U))},onLayoutChanged:function(e){var t,n=this,r=n._cutCopyIndicatorManager;r&&(t=e.changeType,"addRows"===t?r._onRowsAdded():"deleteRows"===t?r._onRowsDeleted():"addColumns"===t?r._onColumnsAdded():"deleteColumns"===t&&r._onColumnsDeleted())}}),t="white";function te(e){var t=e.parent;return M._isActiveElement(e)||t&&!t.options.hideSelection}function ne(e){var n=e.parent;return n&&n.options.backColor||t}function re(e){this._init(e)}re.prototype={constructor:re,_init:function(e){this._sheet=e},_getCtx:function(){var e=this._sheet,t=U,n=e._getCanvas();return n&&n.getContext&&(t=n.getContext("2d")),t},_getBufferCtx:function(){var e,t=this,n=t._sheet,r=n._getBounds(),o=n._canvas,i=ee(o),a=$(o),l=t._buffer;return l&&ee(l)===i&&$(l)===a||(l&&R._disposeCanvasForSheet(n,l),t._buffer=l=m._util._createElement("canvas"),l.getContext&&(t._bufferCtx=l.getContext("2d"),R._adjustDevicePixel(l,U,n),R._setSize(l,ee(r),$(r)))),e=t._bufferCtx,e&&(e.beginPath(),e.font=t._getZoomFont(t._getDefaultFont()),e.name="bufferContext"),e},_getDefaultFont:function(){return this._defaultFont||(this._defaultFont=L+" "+this._sheet.currentTheme().bodyFont()),this._defaultFont},_resetDefaultFont:function(){this._defaultFont=U},_getGrayAreaBackColor:function(e){var t,n=this._sheet,r=n.parent,o=r?r.options.grayAreaBackColor||P._getContentThemeStyle("gc-grayArea").backgroundColor:"gray",i=V._getColor(n,o);return e?(t=r?r.options.backgroundImage:U,t&&(i=J),i):i},_getZoomFont:function(e){var t=this._sheet,n=t._zoomFactor;return 1===n?e:k(e,n).font},_copyDoubleBuffer:function(e,t,n,r,o){var i,a,l,s,u,c=this,_=c._buffer,f=c._getCtx();n<=0||r<=0||!_||!f||(o||(o=c._sheet._getBounds()),i=R._getScaleX(_),a=R._getScaleY(_),1!==i&&(e*=i,t*=a,n*=i,r*=a,o=new E(o.x*i,o.y*a,ee(o)*i,$(o)*a)),(l=o.getIntersect(e,t,n,r))&&(l.round(),e=l.x,t=l.y,n=ee(l),r=$(l),s=ee(_),s&&e+n>s&&(e=s-n)<0&&(n+=e,e=0),u=$(_),u&&t+r>u&&(t=u-r)<0&&(r+=t,t=0),b._scaleTo(f,1,1),f.clearRect(e,t,n,r),f.drawImage(_,e,t,n,r,e,t,n,r),b._scaleTo(f,i,a)))},_copyDoubleBufferRect:function(e,t){e&&this._copyDoubleBuffer(e.x,e.y,ee(e),$(e),t)},_copyScreen:function(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y;if(n>0&&r>0)try{a=this,l=a._sheet,s=a._getCtx(),u=l._getCanvas(),c=a._getBufferCtx(),_=a._buffer,f=n,d=r,h=o,g=i,p=f,m=d,v=R._getScaleX(u),C=R._getScaleY(u),e=j(e*v),t=j(t*C),n=K(n*v),r=K(r*C),h=j(h*v),g=j(g*C),p=K(p*v),m=K(m*C),w=ee(_),y=$(_),w&&e+n>w&&(e=w-n)<0&&(n+=e,e=0),y&&t+r>y&&(t=y-r)<0&&(r+=t,t=0),w&&h+p>w&&(h=w-p)<0&&(p+=h,h=0),y&&g+m>y&&(g=y-m)<0&&(m+=g,g=0),b._scaleTo(s,1,1),b._scaleTo(c,1,1),s.clearRect(h,g,p,m),s.drawImage(_,e,t,n,r,h,g,p,m),c.clearRect(h,g,p,m),c.drawImage(u,h,g,p,m,h,g,p,m),b._scaleTo(s,v,C),b._scaleTo(c,v,C)}catch(e){}},_repaintSelection:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S=this;if(n||(n=S._getCtx()),o=!1,i=S._sheet,a=O(-1,-1,-1,-1),l=i._isNavigateInSelection,e&&(a=i.options.allowCellOverflow?O(e.row,0,e.rowCount,i.getColumnCount()):O(e.row,e.col,e.rowCount,e.colCount),!l)){if(a.col>=0){for(c=a.col,_=a.col+a.colCount-1,f=i.getRowCount(1),s=i._getSpanModel(1),d=0;d<f;d++)u=s.find(d,a.col),u&&(c=Y(u.col,c)),(u=s.find(d,a.col+a.colCount-1))&&(_=G(u.col+u.colCount-1,_));a.col=c,a.colCount=_-c+1}if(a.row>=0){for(h=a.row,g=a.row+a.rowCount-1,p=i.getColumnCount(2),s=i._getSpanModel(2),m=0;m<p;m++)u=s.find(a.row,m),u&&(h=Y(u.row,h)),(u=s.find(a.row+a.rowCount-1,m))&&(g=G(u.row+u.rowCount-1,g));a.row=h,a.rowCount=g-h+1}}if(v=i._getRangeWholeRect(a),C=ee(v),w=$(v),C>=0||w>=0){if(v.x-=9,v.y-=9,v.width+=22,v.height+=34,t&&!(v=v.getIntersectRect(t)))return;y=i._getSheetLayout(),w>0&&!l&&(i._dirty=!0,S._paint(n,new E(y.x,G(y._frozenY,v.y),y._rowHeaderWidth,$(v)),r)),C>0&&!l&&(i._dirty=!0,S._paint(n,new E(G(y._frozenX,v.x),y.y,ee(v),y._colHeaderHeight),r)),-1!==a.row||-1!==a.col||l||(i._dirty=!0,S._paint(n,y._headerCornerRect(),r)),C>0&&w>0&&(i._dirty=!0,S._paint(n,v)),o=!0}return o},_update:function(e,t,n,r,o){var i,a=this,l=a._sheet;l._layoutSuspended<=0&&(i=a._getCtx())&&(o||(l._dirty=!0),a._paint(i,new E(e,t,n,r)))},repaint:function(e){var t,n=this,r=n._sheet;r._layoutSuspended>0||(t=n._getCtx())&&(r._dirty=!0,n._paint(t,e))},_paint:function(e,t,n){var r=this;e&&r._sheet._layoutSuspended<=0&&(n||r._paintBody(e,t),r._paintAdornment(e,t))},_paintBody:function(e,t,n){var r,o,i,a=this,l=a._sheet;e&&l._layoutSuspended<=0&&(r=a._getBufferCtx(),o=r||e,i=l._getBounds(),t||(t=i),t&&t.round(),n&&n.round(),l._dirty&&(l._dirty=!1,r&&(r.clearRect(t.x,t.y,ee(t),$(t)),n&&r.clearRect(n.x,n.y,ee(n),$(n)),b._translate(r,-i.x,-i.y)),a._paintSheet(o,t),n&&a._paintSheet(o,n),r&&b._translate(r,i.x,i.y)),r&&(a._copyDoubleBufferRect(t),n&&a._copyDoubleBufferRect(n)))},_paintAdornment:function(e,t){var n,r,o,i,a,l=this,s=l._sheet,u=s._isTouchMode;if(e&&!(s._layoutSuspended>0)&&(t&&t.round(),n=s._getSheetLayout(),!s._hoverCell)){if(u){for(r=n._headerCornerRect(),l._copyDoubleBufferRect(r),i=0;i<=2;i++)(r=n._rowHeaderRect(i))&&0!==ee(r)&&0!==$(r)&&l._copyDoubleBufferRect(r);for(a=0;a<=2;a++)(r=n._colHeaderRect(a))&&0!==ee(r)&&0!==$(r)&&l._copyDoubleBufferRect(r)}for(i=0;i<=2;i++)for(a=0;a<=2;a++)(r=n._viewportRect(i,a))&&0!==ee(r)&&0!==$(r)&&(o=t,(u&&(1!==i||1!==a)||s.parent&&s.parent.options.allowUserDragMerge)&&(l._copyDoubleBufferRect(r),o=r),o&&!r.intersectRect(o)||l._paintSelection(e,i,a,o));l._paintResizeLine(e),p._callFeatureHandler(s,"paintAdornment",{ctx:e,clipRect:t})}},_paintBackground:function(e,t){var n=this._sheet,r=n.parent,o=r?r.options:{},i=ne(n),a=V._getColor(n,i);o.backgroundImage&&(a=J),e.save(),e.fillStyle=a,e.fillRect(t.x,t.y,ee(t),$(t)),e.restore()},_paintHeadersAndViewport:function(e,t,n,r,o){var i,a,l,s,u,c,_,f=this,d=f._sheet,h=d.options.colHeaderVisible,g=d.options.rowHeaderVisible,p=d._getSheetLayout();for(a=0;a<=2;a++)(s=p._colHeaderRect(a))&&(l=t?s.getIntersectRect(t):s)&&(n&&r&&h&&(l.y-=o,l.height+=o,g||(l.x-=o,l.width+=o)),f._paintColHeader(e,a,l,n));for(i=0;i<=2;i++)for(u=p._rowHeaderRect(i),u&&(l=t?u.getIntersectRect(t):u)&&(n&&r&&g&&(l.x-=o,l.width+=o,h||(l.y-=o,l.height+=o)),f._paintRowHeader(e,i,l,n)),a=0;a<=2;a++)(c=p._viewportRect(i,a))&&(l=t?c.getIntersectRect(t):c)&&(n&&r&&!h&&(l.y-=o,l.height+=o),n&&r&&!g&&(l.x-=o,l.width+=o),f._paintViewport(e,i,a,l,n));(_=p._headerCornerRect())&&(l=t?_.getIntersectRect(t):_)&&f._paintColHeaderCorner(e,l,n)},_paintGrayArea:function(e){var t,n,r,o,i,a=this,l=a._sheet,s=l._getSheetLayout(),u=s._headerX,c=s._headerY,_=s._frozenTrailingX,f=s._frozenTrailingY,d=ee(s),h=$(s),g=s._viewportY,p=s._viewportX,m=l._getRowLayout(1);m.length>0?(t=m[m.length-1],n=t.y+$(t),n<f&&(e.fillStyle=a._getGrayAreaBackColor(!1),e.fillRect(u,n,d,f-n))):0===m.length&&(e.fillStyle=a._getGrayAreaBackColor(!1),e.fillRect(u,g,d,f-g)),r=l._getColumnLayout(1),r.length>0?(o=r[r.length-1],i=o.x+ee(o),i<_&&(e.fillStyle=a._getGrayAreaBackColor(!1),e.fillRect(i,c,_-i,h))):0===r.length&&(e.fillStyle=a._getGrayAreaBackColor(!1),e.fillRect(p,c,_-p,h))},_paintSheetBorder:function(e,t){var n=this,r=n._sheet,o=r.options,i=o.borderWidth;i>0&&(e.strokeStyle=o.borderColor,e.lineWidth=i,e.strokeRect(t.x+i/2,t.y+i/2,G(0,ee(t)-i),G(0,$(t)-i)))},_paintSheet:function(e,t){var n,r=this,o=r._sheet;!e||o._layoutSuspended>0||(A._startCache(o,0,0,o.getRowCount()-1,o.getColumnCount()-1),n=o._getBounds(),e.save(),t?e.rect(t.x,t.y,ee(t),$(t)):e.rect(n.x,n.y,ee(n),$(n)),e.clip(),e.beginPath(),r._paintBackground(e,n),p._callFeatureHandler(o,"paint",{ctx:e,clipRect:t}),r._paintHeadersAndViewport(e,t,!1),r._paintGrayArea(e),r._paintFrozenLine(e),r._paintSheetBorder(e,n),A._clearCache(),e.beginPath(),e.restore())},_paintSheetForPrint:function(e,t,n,r){var o,i,a=this,l=a._sheet;e&&(A._startCache(l,0,0,l.getRowCount()-1,l.getColumnCount()-1),o=l._getBounds(),e.save(),n&&e.translate(r,r),i=t||new E(o.x,o.y,ee(o),$(o)),n&&(i.x-=r,i.y-=r,i.width+=r,i.height+=r),e.rect(i.x,i.y,ee(i),$(i)),e.clip(),e.beginPath(),a._paintBackground(e,o),a._paintHeadersAndViewport(e,i,!0,n,r),A._clearCache(),n&&e.translate(-r,-r),e.beginPath(),e.restore())},_paintResizeLine:function(e){var t,n,r,o,i,a,l,s,u,c=this._sheet,_=c._eventHandler,f=c._currentTarget;if(_&&_.isResizing&&f&&(l=f.resizeInfo)){if(s=c._getSheetLayout(),u=Z,e.save(),e.strokeStyle!==u&&(e.strokeStyle=u),1!==e.lineWidth&&(e.lineWidth=1),e.beginPath(),"sizeRow"===l.action||"sizeHiddenRow"===l.action)for(n=G(0,l.startY-.5),o=l.movingY-.5,i=s.x+ee(s),t=s.x;t<i;t+=2)e.moveTo(t,n),e.lineTo(t+1,n),e.moveTo(t,o),e.lineTo(t+1,o);else for(t=G(0,l.startX-.5),r=l.movingX-.5,a=s.y+$(s),n=s.y;n<a;n+=2)e.moveTo(t,n),e.lineTo(t,n+1),e.moveTo(r,n),e.lineTo(r,n+1);e.stroke(),e.beginPath(),e.restore()}},_paintColHeaderCorner:function(e,t,n){var r,o,i,a,l,s,u,c=this._sheet;e.beginPath(),r=c._getSheetLayout()._headerCornerRect(),o=r.x,i=r.y,a=ee(r),l=$(r),s=c.getActualStyle(-1,-1,0),this._paintCells(e,[{data:U,row:-1,col:-1,x:o,y:i,width:a,height:l,style:s.clone()}],0,n),u=new z(c,0,0,0),u._addCellLines(0,0,o,i,a,l),u.paint(e,t)},_paintFrozenLine:function(e){var t,n,r,o,i,a,l,s,u,c=this._sheet,_=c.frozenRowCount(),f=c.frozenColumnCount(),d=c.frozenTrailingRowCount(),h=c.frozenTrailingColumnCount();(_||f||d||h)&&(t=c._getSheetLayout(),n=t._viewportX,r=t._viewportY,o=t._frozenTrailingX,i=t._frozenTrailingY,a=t.x,l=t.y,s=ee(t),u=$(t),e.save(),e.strokeStyle=V._getColor(c,c.options.frozenlineColor),e.lineWidth=1,e.beginPath(),f&&(e.moveTo(n-.5,l),e.lineTo(n-.5,l+u)),_&&(e.moveTo(a,r-.5),e.lineTo(a+s,r-.5)),h&&(e.moveTo(o-.5,l),e.lineTo(o-.5,l+u)),d&&(e.moveTo(a,i-.5),e.lineTo(a+s,i-.5)),e.stroke(),e.restore())},_paintColHeader:function(e,t,n,r){this._paintViewportImp(e,-1,t,1,n,r)},_paintRowHeader:function(e,t,n,r){this._paintViewportImp(e,t,-1,2,n,r)},_paintViewport:function(e,t,n,r,o){this._paintViewportImp(e,t,n,3,r,o);var i=this._sheet._cutCopyIndicatorManager;i&&i._paintCutCopyIndicator(e,r,t,n)},_paintSelection:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A=this,I=A._sheet;if(te(I)){if(!I.addSelection)return;if(o=I._eventHandler,i=I._selectionModel,a=i.length,!(r=A._getClipRect(t,n,r)))return;if(l=P._getCssClassThemeStyle("gc-selection"),s=parseInt(l.zIndex),s>2007&&A._paintHeaderSelection(e,t,n,r),u=A._getPaintingRects(t,n,i,r),c=u.length,c<=0)return;for(f=!1,d=0;d<c;d++)if(_=u[d],!r.containsRect(_)){f=!0;break}if(e.save(),f&&(e.rect(r.x,r.y,ee(r),$(r)),e.clip()),e.beginPath(),c>0&&(i.length>1||i[0].rowCount>1||i[0].colCount>1))for(h=V._getColor(I,I.getSelectionBackColor()),e.fillStyle!==h&&(e.fillStyle=h),g=0,p=0,s>2007&&(g=1,p=-3),d=0;d<c;d++)_=u[d],A.adjustSelectionRect&&(_=A.adjustSelectionRect(I,_)),e.fillRect(_.x+g,_.y+g,ee(_)+p,$(_)+p);m=I.getCellRect(I._activeRowIndex,I._activeColIndex,t,n),m&&m.intersectRect(r)&&(S=I.getActualStyle(I._activeRowIndex,I._activeColIndex),S.cellType&&S.cellType.getExpandHeight&&(m.height+=S.cellType.getExpandHeight({style:S,sheet:I,row:I._activeRowIndex,col:I._activeColIndex},S,m,I.getText(I._activeRowIndex,I._activeColIndex)),_.height=Math.max(_.height,m.height)),v=m.x,C=m.y,w=ee(m),y=$(m),g=1,p=-2,s>2007&&(g=0,p=0),e.strokeStyle=I.getSelectionBorderColor(),1===I.selectionBorderWidth?(e.lineWidth=1,e.strokeRect(v-.5,C-.5,w-0,y-0)):(e.lineWidth=2,e.strokeRect(v-0,C-0,w-1,y-1))),e.restore(),e.save(),f&&(A._adjustClipRect(r,I,t,n,s),e.rect(r.x,r.y,ee(r),$(r)),e.clip()),e.beginPath(),1===a&&(o&&o._isDraggingFill&&o._isDragClear&&o._isDragClear()&&!o._isDragAroundIndicator&&(x=o._getCurrentFillRange&&o._getCurrentFillRange(),b=I.getRangeRect(t,n,x),T=ee(b),R=$(b),b&&T>0&&R>0&&(e.fillStyle=l&&l.color,e.fillRect(b.x,b.y,T,R))),(!o||!o._startHitInfo||!o._isWorking)&&_&&ee(_)>=0&&$(_)>=0&&A._paintSelectionBorder(e,t,n,_,r)),e.beginPath(),e.restore()}},_adjustClipRect:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p=t.frozenTrailingRowCount(),m=t.frozenTrailingColumnCount(),v=t.getSelections(),C=t._getSheetLayout(),w=t.getRowCount()-p-1,y=t.getColumnCount()-m-1,S=t._getColumnLayout(1,3),x=t._getRowLayout(1,3);1===v.length&&o>2007&&(i=t.frozenRowCount(),a=t.frozenColumnCount(),l=v[0],s=l.row,u=l.col,c=l.rowCount,_=l.colCount,i>0&&(s>=i&&t._getPrevVisualRow(s)<i?(e.y-=2,e.height+=2):s+c<=i&&t._getNextVisualRow(s+c-1)===t._scrollTopRow&&(e.height+=2)),a>0&&(u>=a&&t._getPrevVisualColumn(u)<a?(e.x-=2,e.width+=2):u+_<=a&&t._getNextVisualColumn(u+_-1)===t._scrollLeftCol&&(e.width+=2)),0===s&&0===u&&(e.x-=2,e.y-=2,e.width+=2,e.height+=2),-1===s&&(s=0,c=t.getRowCount()),-1===u&&(u=0,_=t.getColumnCount()),f=!1,d=!1,h=x.findRow(w),g=S.findCol(y),h&&h.y+$(h)<C._viewportY+C._viewportHeight&&(f=!0),g&&g.x+ee(g)<C._viewportX+C._viewportWidth&&(d=!0),f&&s+c-1===w&&(e.height+=2),d&&u+_-1===y&&(e.width+=2))},_paintHeaderSelection:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F=this,D=F._sheet,N=D._selectionModel,V=D._getSheetLayout(),O=V._frozenX,H=V._frozenY,P=N.length;if(!(P<=0)){if(o=N[0],i=o.row,a=o.rowCount,l=o.col,s=o.colCount,-1===i&&(i=0),-1===l&&(l=0),-1===a&&(a=D.getRowCount()),-1===s&&(s=D.getColumnCount()),e.save(),e.beginPath(),e.lineWidth=2,e.strokeStyle=D.getSelectionBorderColor(),u=r.x,c=r.y,_=ee(r),f=$(r),d=D.frozenRowCount(),1!==P||0!==d||D._scrollTopRow<=i||D._scrollTopRow>=i+a)for(h=F._getColumnHeaderSelectionRects(n),g=0,p=h.length;g<p;g++)m=h[g],v=0,C=0,w=m.x,y=m.x+ee(m),m.x<u+_&&u<m.x+ee(m)&&(1===P&&(0===d&&D._scrollTopRow===i||d>0&&0===i)&&(v=-1,C=1),m.x<u&&(v=0,w=u),m.x+ee(m)>u+_&&(C=0,y=u+_),e.moveTo(w+v-1,H-1),e.lineTo(y+C,H-1),e.stroke());if(S=D.frozenColumnCount(),1!==P||0!==S||D._scrollLeftCol<=l||D._scrollLeftCol>=l+s)for(x=F._getRowHeaderSelectionRects(t),b=0,T=x.length;b<T;b++)R=x[b],A=0,I=0,M=R.y,E=R.y+$(R),R.y<c+f&&c<R.y+$(R)&&(1===P&&(0===S&&D._scrollLeftCol===l||S>0&&0===l)&&(A=-1,I=1),R.y<c&&(A=0,M=c),R.y+$(R)>c+f&&(I=0,E=c+f),e.moveTo(O-1,M+A-1),e.lineTo(O-1,E+I),e.stroke());e.beginPath(),e.restore()}},_getColumnHeaderSelectionRects:function(e){var t,n,r,o,i,a,l,s,u,c,_,f=this._sheet,d=f._selectionModel,h=d.length,g=f._getColumnLayout(e),p=[];for(t=0;t<h;t++)(n=d[t])&&(r=n.col,-1===r?(o=f._getColumnLayout(0,3),i=f._getColumnLayout(1,3),a=f._getColumnLayout(2,3),l=-1,s=-1,o.length>0&&(l=o[0].x,s=o[o.length-1].x+o[o.length-1].width-l,p.push(new E(l,-1,s,-1))),i.length>0&&(l=i[0].x,s=i[i.length-1].x+i[i.length-1].width-l,p.push(new E(l,-1,s,-1))),a.length>0&&(l=a[0].x,s=a[a.length-1].x+a[a.length-1].width-l,p.push(new E(l,-1,s,-1)))):g&&(u=g.findCol(r),c=g.findCol(r+n.colCount-1),(u||c)&&(_=new E(-1,-1,-1,-1),_.x=u?u.x:g[0].x,_.width=c?c.x+ee(c)-_.x:g[g.length-1].x+g[g.length-1].width-_.x,p.push(_))));return p},_getRowHeaderSelectionRects:function(e){var t,n,r,o,i,a,l,s,u,c,_,f=this._sheet,d=f._selectionModel,h=d.length,g=f._getRowLayout(e),p=[];for(t=0;t<h;t++)(n=d[t])&&(r=n.row,-1===r?(o=f._getRowLayout(0,3),i=f._getRowLayout(1,3),a=f._getRowLayout(2,3),l=-1,s=-1,o.length>0&&(l=o[0].y,s=o[o.length-1].y+o[o.length-1].height-l,p.push(new E(-1,l,-1,s))),i.length>0&&(l=i[0].y,s=i[i.length-1].y+i[i.length-1].height-l,p.push(new E(-1,l,-1,s))),a.length>0&&(l=a[0].y,s=a[a.length-1].y+a[a.length-1].height-l,p.push(new E(-1,l,-1,s)))):g&&(u=g.findRow(r),c=g.findRow(r+n.rowCount-1),(u||c)&&(_=new E(-1,-1,-1,-1),_.y=u?u.y:g[0].y,_.height=c?c.y+$(c)-_.y:g[g.length-1].y+g[g.length-1].height-_.y,p.push(_))));return p},_paintSelectionBorder:function(e,t,n,r,o){var i,a,l=this,s=l._sheet,u=s.parent,c=s._eventHandler,_=r.x,f=r.y,d=ee(r),h=$(r);d>=0&&h>=0&&(!o||r.intersect(o.x-1,o.y-1,ee(o)+2,$(o)+2))&&(e.save(),o&&!o.containsRect(r)&&(e.rect(o.x,o.y,ee(o),$(o)),e.clip()),e.beginPath(),e.strokeStyle=V._getColor(s,s.getSelectionBorderColor()),e.lineWidth=1,d>0&&h>0?(c&&c._isDraggingFill?(i=c._currentFillDirection,2===i?(e.moveTo(_+.5,f-.5),e.lineTo(_+d-1,f-.5)):3===i?(e.moveTo(_+.5,f+h-.5),e.lineTo(_+d-1,f+h-.5)):0===i?(e.moveTo(_-.5,f+.5),e.lineTo(_-.5,f+h-1)):1===i&&(e.moveTo(_+d-.5,f+.5),e.lineTo(_+d-.5,f+h-1))):(a=u&&u._themeVersion,e.rect(_-.5,f-.5,d,h)),e.stroke(),u&&u.options.allowUserDragFill&&l._paintDragFillIndicator&&l._paintDragFillIndicator(e,t,n,r,o)):0!==d&&0!==h||e.strokeRect(_-1,f-1,d+1,h+1),e.beginPath(),e.restore())},_getClipRect:function(e,t,n){var r,o,i,a,l=this._sheet,s=l._getSheetLayout(),u=s._viewportRect(e,t);return 1===t&&(r=l._getColumnLayout(t),o=r.length>0?r[r.length-1]:U,o&&(u.width=Y(ee(u),o.x+ee(o)-s._viewportX)+4)),1===e&&(i=l._getRowLayout(e),a=i.length>0?i[i.length-1]:U,a&&(u.height=Y($(u),a.y+$(a)-s._viewportY)+4)),n=n?n.getIntersect(u.x,u.y,ee(u),$(u)):u},_getPaintingRects:function(e,t,n,r){var o,i,a,l,s=this._sheet,u=s._getSpanModel(),c=n.length,_=[];for(l=0;l<c;l++)(i=n[l])&&(o=u.find(i.row,i.col),o&&o.containsRange(i)&&(i=o),(a=s.getRangeRect(e,t,i))&&a.x<=r.x+ee(r)&&a.y<=r.y+$(r)&&r.x<=a.x+ee(a)&&r.y<=a.y+$(a)&&_.push(a));return _},_paintDashRect:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d;if(e.save(),r=t.x,o=t.y,i=ee(t),a=$(t),l=[6,6],e.setLineDash)e.beginPath(),e.lineWidth=2,e.strokeStyle=n,e.setLineDash(l),e.rect(r,o,i-1,a-1),e.stroke();else{for(e.beginPath(),e.lineWidth=2,e.strokeStyle=n,s=l[0],u=l[1],c=r,_=o,f=i;f>0;)if(f>=s+u)e.moveTo(c,_),e.lineTo(c+s,_),c=c+s+u,f=f-s-u;else{if(f>=s){e.moveTo(c,_),e.lineTo(c+s,_),f=f-s-u;break}if(f>0){e.moveTo(c,_),e.lineTo(c+f,_),f=f-s-u;break}}for(c=r+i-1,_=o+1,d=a-1,f<0&&(f=X(f),f>u&&(e.moveTo(c,_-2),e.lineTo(c,_+(f-u))),_+=f,d-=f);d>0;)d>=s+u?(e.moveTo(c,_),e.lineTo(c,_+s),_=_+s+u,d=d-s-u):d>=s?(e.moveTo(c,_),e.lineTo(c,_+s),d=d-s-u):d>0&&(e.moveTo(c,_),e.lineTo(c,_+d),d=d-s-u);for(c=r+i-2,_=o+a-1,f=i-1,d<0&&(d=X(d),d>u&&(e.moveTo(c+2,_),e.lineTo(c-(d-u),_)),c-=d,f-=d);f>0;)if(f>=s+u)e.moveTo(c,_),e.lineTo(c-s,_),c=c-s-u,f=f-s-u;else{if(f>=s){e.moveTo(c,_),e.lineTo(c-s,_),f=f-s-u;break}if(f>0){e.moveTo(c,_),e.lineTo(c-f,_),f=f-s-u;break}}for(c=r,_=o+a-2,d=a-1,f<0&&(f=X(f),f>u&&(e.moveTo(c,_+2),e.lineTo(c,_-(f-u))),_-=f,d-=f);d>0;)d>=s+u?(e.moveTo(c,_),e.lineTo(c,_-s),_=_-s-u,d=d-s-u):d>=s?(e.moveTo(c,_),_-s===o?e.lineTo(c,_-s-1):e.lineTo(c,_-s),d=d-s-u):d>0&&(_>o&&(e.moveTo(c,_),e.lineTo(c,_-d)),d=d-s-u);e.stroke()}e.beginPath(),e.restore()},_paintViewportImp:function(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,h,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,P,L,k,B,W,U,Y,G,X,j,K,Z,J,q;if(H(r)&&(r=3),a=this,l=a._sheet,s=l.parent,u=s&&s.options.resizeZeroIndicator,c=l._getRowLayout(t,r),_=l._getColumnLayout(n,r),f=c.length,d=_.length,!(f<0||d<0)){for(h=l._getCellLayout(t,n,r),m=h.length>0,y=l._cachePool,b=0,T=0,R=0,A=0,E=new z(l,t,n,r),F=[],D=[],N=3===r&&l.options.allowCellOverflow,V=[],O=!i&&3===r&&s&&s.options.highlightInvalidData,i&&3===r&&(l.options.colHeaderVisible||(P=l._scrollTopRow,(k=l.frozenRowCount())>0&&(B=l._getFirstVisualRow())<k&&(P=B)),l.options.rowHeaderVisible||(L=l._scrollLeftCol,(W=l.frozenColumnCount())>0&&(U=l._getFirstVisualColumn())<W&&(L=U))),e.save(),e.beginPath(),o&&(e.rect(o.x,o.y,ee(o),$(o)),e.clip()),Y=[],G=-1,X=-1,j=[],K=0;K<f;K++)for(v=c[K],Z=0;Z<d;Z++)C=_[Z],w=m&&h.findCell(v.row,C.col),w?(S=w.row,x=w.col,b=w.x,T=w.y,R=ee(w),A=$(w)):(S=v.row,x=C.col,b=C.x,T=v.y,R=ee(C),A=$(v)),1===u&&(-1===t&&l.getColumnVisible(x)&&0===l._getActualColumnWidth(x)&&((X<0||X!==x-1)&&Y.push({x1:b,y1:T,x2:b,y2:T+A,horizontal:!1}),X=x),-1===n&&l.getRowVisible(S)&&0===l._getActualRowHeight(S)&&((G<0||G!==S-1)&&Y.push({x1:b,y1:T,x2:b+R,y2:T,horizontal:!0}),G=S)),o&&(b+R<=o.x||b>=o.x+ee(o)||T+A<=o.y||T>=o.y+$(o))||0!==R&&0!==A&&(w&&g._contains(F,w)||(I=y._getValue(S,x,r),M=y._getActualStyle(S,x,r),O&&l.isValid&&!l.isValid(S,x,I)&&V.push({x:b,y:T,width:R,height:A}),E._addCellLines(S,x,b,T,R,A,M,w,P===S,L===x),J={sheet:l,data:I,row:S,col:x,x:b,y:T,width:R,height:A,style:M,cellLayout:w},!i&&M.cellType&&M.cellType.needExpand&&M.cellType.needExpand(J)&&j.push(J),D.push(J),w&&F.push(w)));D.length>0&&(N&&(q=y._getCellOverflowBuilder(t,n,function(){return new se(l,t,n)}),a._buildCellOverflowValueLayout(q,D,E)),a._paintCells(e,D,r,i)),p._callFeatureHandler(l,"paintViewport",{ctx:e,rowViewportIndex:t,colViewportIndex:n,sheetArea:r,clipRect:o,isPrinting:i}),E.paint(e,o),Y.length>0&&a._paintDoubleGridLines(e,Y,1,3),V.length>0&&a._paintValidationUI(e,V),j.length>0&&a._paintCells(e,j,r,i),e.restore()}},_paintDoubleGridLines:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C;if(0!==t.length)for(o=0,i=t.length;o<i;o++)a=t[o],l=a.x1,s=a.y1,u=a.x2,c=a.y2,_=a.horizontal,e.beginPath(),e.save(),e.lineWidth=n,e.strokeStyle=this._getHeaderGridLineColor(e,_,l,s,u,c),e.fillStyle=this._getHeaderBackColor(e,_,l,s,u,c),_?(f=-3,d=1,h=-1,g=-2,e.fillRect(l,s+f,u-l-1,r+2*n),b._translate(e,.5,.5),e.moveTo(l+h,s+f),e.lineTo(u+g,c+f),e.moveTo(l+h,s+d),e.lineTo(u+g,c+d)):(p=-3,m=1,v=0,C=-1,e.fillRect(l+p,s+v,r+2*n,c-s-1),b._translate(e,.5,.5),e.moveTo(l+p,s+v),e.lineTo(u+p,c+C),e.moveTo(l+m,s+v),e.lineTo(u+m,c+C)),b._translate(e,-.5,-.5),e.stroke(),e.restore()},_getHeaderBackColor:function(e,t,n,r,o,i){var a,l,s,u,c,_=t?q:Q,f=P._getVisualStateThemeStyle(0,"gc-"+_+"-normal"),d=f&&f.backgroundColor,h=f&&f.backgroundImage;if(!t&&h&&-1!==h.indexOf("linear-gradient"))for(l=T._getLinearGradientColors(h),a=e.createLinearGradient(n,r,o,i),s=0,u=l.length;s<u;s++)c=l[s],a.addColorStop(c.point,c.color);else d&&(a=d);return a},_getHeaderGridLineColor:function(e,t,n,r,o,i){var a=e.createLinearGradient(n,r,o,i),l=t?q:Q,s=P._getVisualStateThemeStyle(0,"gc-"+l+"-normal");return t?(a.addColorStop(0,s.borderTopColor),a.addColorStop(1,s.borderBottomColor)):(a.addColorStop(0,s.borderLeftColor),a.addColorStop(1,s.borderRightColor)),a},_paintValidationUI:function(e,t){var n,r,o,i,a,l,s,u,c,_,f,d,h,g;if(t)for(n=t.length,r=0;r<n;r++)o=t[r],i=o.x-4,a=o.y-4,l=ee(o)+8,s=$(o)+8,u=.5522848,c=l/2*u,_=s/2*u,f=i+l,d=a+s,h=i+l/2,g=a+s/2,e.save(),e.lineWidth=2,e.strokeStyle="red",e.beginPath(),e.moveTo(i,g),e.bezierCurveTo(i,g-_,h-c,a,h,a),e.bezierCurveTo(h+c,a,f,g-_,f,g),e.bezierCurveTo(f,g+_,h+c,d,h,d),e.bezierCurveTo(h-c,d,i,g+_,i,g),e.closePath(),e.stroke(),e.restore()},_paintCells:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,v,C,w,S,x,b,T,R,A,I,M,E,F,N,V,O,H,P,L,B,W,z,Y,X=this,j=X._sheet,K=3===n,J=j._zoomFactor,q=k(X._getDefaultFont(),J),Q=j.getDefaultStyle(n),te=j._getDefaultCellType(n),re=j.conditionalFormats,oe=ne(j),ie=j._getFirstVisualColumn(2),ae=j._getFirstVisualRow(1),le=j._getImageLoader();for(e.save(),e.beginPath(),e.fillStyle=Q&&Q.foreColor||Z,e.font=q.font,e.textAlign=K?"right":"center",i=t.length,b=!!y(),T=[],A={sheet:j,row:-1,col:-1,fontInfo:U,lineHeight:-1,imageLoader:le,conditionalFormats:re,sheetArea:n,parentBackColor:oe},o=0;o<i;o++){if(a=t[o],s=a.data,u=a.row,c=a.col,_=a.x,f=a.y,d=ee(a),h=$(a),g=a.style,v=a.cellOverflowLayout,w=g.font?k(g.font,J):q,(I=!g.wordWrap&&g.shrinkToFit)&&(M=j.getText(u,c,n),E=g.watermark,E&&!M&&(M=E),M))for(F={value:!1},N=0;N<3&&!1===F.value&&(V=j._getStringWidthByCanvas(M,w.font),O=G(0,d-4),1!==g.hAlign&&g.textIndent&&(O=G(0,O-8*g.textIndent)),O<V);N++)w=k(w.font,O/V,F,!0);g.font=w.font,d>0&&h>0&&(l=g.cellType||te,_--,f--,d++,h++,K?(x=b&&j.getSparkline(u,c),A.sparkline=x):(C=r?0:X._getVisualState(u,c,n),A.visualState=C),S=D(w.font),A.lineHeight=S,A.row=u,A.col=c,A.fontInfo=w,A.cellOverflowLayout=v,A.needTopGridline=r&&(1===n&&u===ae||0===n),A.needLeftGridline=r&&(2===n&&c===ie||0===n),l.paint(e,s,_,f,d,h,g,A),v&&!A.showBarIconOnly&&(H=new m.Rect(_,f,d,h),P=l._getContentRectImp?l._getContentRectImp(e,H,g,A):H,T.push({cellType:l,data:s,x:P.x,y:P.y,width:P.width,height:P.height,style:g,options:{sheet:j,row:u,col:c,fontInfo:w,lineHeight:S,cellOverflowLayout:v,parentBackColor:oe}})))}if((i=T.length)>0)for(L=j.isEditing(),B=j._activeRowIndex,W=j._activeColIndex,z=0;z<i;z++)R=T[z],l=R.cellType,s=R.data,_=R.x,f=R.y,d=ee(R),h=$(R),g=R.style,A=R.options,L&&A.row===B&&A.col===W||(Y=y())&&s instanceof Y.SparklineExValue||l.paintValue&&l.paintValue(e,s,_,f,d,h,g,A);for(e.restore(),o=0,i=t.length;o<i;o++)a=t[o],p._callFeatureHandler(j,"paintCell",{ctx:e,sheetArea:n,cell:a,isPrinting:r})},_getVisualState:function(e,t,n){var r=this._sheet,o=0;return te(r)&&(3===n||H(n)?!r.isEditing()&&r._isActiveCell(e,t)?o=3:r._isSelected(e,t,n)&&(o=2):(r._isSelected(e,t,n)&&(o=1,r._isAllSelected(e,t,n)&&(o=2)),r._isHover(e,t,n)&&(o=4))),o},_buildCellOverflowValueLayout:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I=this._sheet,M=I._cachePool,F=t.length,D={},N=[];for(w=0;w<F;w++){if(r=t[w],a=r.row,l=r.col,s=r.x,u=r.y,_=$(r),p=e._getCellOverflowLayoutModel(a),m=p.headingOverflowlayout,v=p.trailingOverflowLayout,!D[a]){for(y={},S=0;S<p.length;S++)y[p[S].column]=!1;m&&(y[m.column]=!1),v&&(y[v.column]=!1),D[a]=y}x=D[a],C=p.find(l),C?(C.column===l?(c=ee(r),f=C.backgroundWidth,d=C.backgroundLeftWidth<0?s:C.backgroundRightWidth<0?s+c-f:s+c/2-C.backgroundLeftWidth,r.cellOverflowLayout=C,x[C.column]&&N.push(w)):x[C.column]||(l=C.column,i=M._getActualStyle(a,l),o=I.getValue(a,l),c=C.columnWidth,f=C.backgroundWidth,b=I.getCellRect(a,C.column),d=C.backgroundLeftWidth<0?b.x:C.backgroundRightWidth<0?b.x+ee(b)-f:b.x+ee(b)/2-C.backgroundLeftWidth,g={data:o,row:a,col:l,x:b.x,y:u,width:c,height:_,style:i,cellOverflowLayout:C},t.push(g)),C.layout=new E(d,u,f,_),n._addCellOverlfowLayout(a,C),x[C.column]=!0):m&&!x[m.column]&&m.contains(l)?(l=m.column,i=M._getActualStyle(a,l),o=I.getValue(a,l),c=m.columnWidth,f=m.backgroundWidth,T=I.getCellRect(a,m.endColumn),d=T.x+ee(T)-f,g={data:o,row:a,col:l,x:d,y:u,width:c,height:_,style:i,cellOverflowLayout:m},t.push(g),m.layout=new E(d,u,f,_),n._addCellOverlfowLayout(a,m),x[m.column]=!0):v&&!x[v.column]&&v.contains(l)&&(l=v.column,i=M._getActualStyle(a,l),o=I.getValue(a,l),c=v.columnWidth,f=v.backgroundWidth,R=I.getCellRect(a,v.startColumn),d=R.x,h=R.x+f-c,g={data:o,row:a,col:l,x:h,y:u,width:c,height:_,style:i,cellOverflowLayout:v},t.push(g),v.layout=new E(d,u,f,_),n._addCellOverlfowLayout(a,v),x[v.column]=!0)}if(N.length>0)for(A=N.length-1;A>=0;A--)t.splice(N[A],1)}},S._SheetRender=re,r=2,o=100;function oe(e,t){var n,r,o=0;return"string"==typeof e&&(n=e.split(" ",4),r=n.length,1===r?o=2*n[0]:2===r||3===r?o=2*n[1]:4===r&&(o=n[1]+n[3])),o*t}function ie(e,t,n,o,i,a){var l,s,u=o._zoomFactor,c=t.font,_=t.textIndent;return c=c?k(c,u).font:n,l=I._measureText(e,c)+ae(o,_,i,a)+r,s=0,t.cellType&&t.cellType.getAdditionalWidth&&(s=t.cellType.getAdditionalWidth({sheet:o,row:i,col:a,style:t,lineHeight:D(t.font)})),l+s+oe(t.cellPadding,u)}function ae(e,t,n,r){if(!H(n)&&!H(r)&&e.outlineColumn){var o=e.outlineColumn._getWidth(n,r);if(o)return o}return t?8*t:0}function le(e,t,n,r,o,i,a,l,s){var u,c,_,f,d,h,g,p=e._cachePool,m=ee(o),v=ee(o),C=o.style,w=o.text,y=C.watermark;if(t.findCell(i,a))return U;if(d=C.cellType||n,!d.allowOverflow||!w&&!y)return U;if(w||(w=y),(_=ie(w,C,r,e,i,a))<=v)return U;for(h=a,g=a,c=a+(s?1:-1);(s?c<=l:c>=l)&&!t.findCell(i,c)&&(u=p._getValue(i,c),H(u))&&(f=p._getActualStyle(i,c),!f.watermark)&&(s?g=c:h=c,v+=p._getZoomColWidth(c),!(_<=v));c+=s?1:-1);return s&&g===a||!s&&h===a?U:new B(a,h,g,_,m,v,s?-1:v,s?v:-1)}function se(e,t,n){var r=this;r._sheet=e,r._colLayoutModel=e._getColumnLayout(n),r._cellLayoutModel=e._getCellLayout(t,n),r._defaultFont=k(e._render._getDefaultFont(),e._zoomFactor).font,r._defaultCellType=e._getDefaultCellType(),r._cachedCellOverflowModels={}}se.prototype={constructor:se,_getCellOverflowLayoutModel:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y=this,S=y._cachedCellOverflowModels[e];if(S)return S;if(t=y._sheet,n=t._cachePool,r=y._colLayoutModel,o=r.length,f=new W,o>0){for(f.headingOverflowlayout=y._buildHeadingCellOverflowLayout(e),h=r[0].col,g=r[o-1].col,p=0;p<o;p++)i=r[p],ee(i)<=0||(a=i.col,s=n._getValue(e,a),l=n._getActualStyle(e,a),H(s)&&!l.watermark||l.shrinkToFit||l.wordWrap||!1===l.overflow||(m=t.conditionalFormats)&&(v=m._getIconSetAndDataBar(t,e,a,s),C=v.dataBar,w=v.iconSet,C&&C.showBarOnly||w&&w.showIconOnly)||(u=n._getZoomColWidth(a),_=A._getFormattedTextByStyle(t,l,s),c=l.hAlign,3===c&&(c=F(c,s,l.formatter)),0===c?(d=y._buildCellOverflowLayoutForLeft({data:s,style:l,width:u,text:_},e,a,g))&&f.push(d):2===c?(d=y._buildCellOverflowLayoutForRight({data:s,style:l,width:u,text:_},e,a,h))&&f.push(d):1===c&&(d=y._buildCellOverflowLayoutForCenter({data:s,style:l,width:u,text:_},e,a,h,g))&&f.push(d)));f.trailingOverflowLayout=y._buildTrailingCellOverflowLayout(e)}return y._cachedCellOverflowModels[e]=f,f},_buildCellOverflowLayoutForLeft:function(e,t,n,r){var o=this;return le(o._sheet,o._cellLayoutModel,o._defaultCellType,o._defaultFont,e,t,n,r,!0)},_buildCellOverflowLayoutForRight:function(e,t,n,r){var o=this;return le(o._sheet,o._cellLayoutModel,o._defaultCellType,o._defaultFont,e,t,n,r)},_buildCellOverflowLayoutForCenter:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h=this,g=h._sheet,p=g._cachePool,m=h._cellLayoutModel,v=ee(e),C=ee(e),w=e.style,y=e.text,S=w.watermark;if(m.findCell(t,n))return U;if(u=w.cellType||h._defaultCellType,!u.allowOverflow||!y&&!S)return U;if(y||(y=S),(l=ie(y,w,h._defaultFont,g,t,n))<=C)return U;for(c=n,_=C/2,a=n-1;a>=r&&!m.findCell(t,a)&&(i=p._getValue(t,a),H(i))&&(s=p._getActualStyle(t,a),!s.watermark)&&(c=a,_+=p._getZoomColWidth(a),!(l/2<=_));a--);for(f=n,d=C/2,a=n+1;a<=o&&!m.findCell(t,a)&&(i=p._getValue(t,a),H(i))&&(f=a,d+=p._getZoomColWidth(a),!(l/2<=d));a++);return c===f?U:new B(n,c,f,l,v,_+d,_,d)},_buildHeadingCellOverflowLayout:function(e){var t,n,r,i,a,l,s,u,c,_=this,f=_._sheet,d=f._cachePool,h=_._colLayoutModel,g=h[0].col,p=h[h.length-1].col,m=f._getSpanModel(),v=o,C=g;for(c=1;c<v;c++){if((a=C-c)<0)return U;if(m.find(e,a))return U;if(n=d._getValue(e,a),(r=d._getZoomColWidth(a))>0&&!H(n))return t=d._getActualStyle(e,a),i=t.hAlign,3===i&&(i=F(i,n)),s=A._getFormattedTextByStyle(f,t,n),u={data:n,style:t,width:r,text:s},0===i?l=_._buildCellOverflowLayoutForLeft(u,e,a,p):1===i&&(l=_._buildCellOverflowLayoutForCenter(u,e,a,g,p)),l&&l.endColumn>=g?l:U}},_buildTrailingCellOverflowLayout:function(e){var t,n,r,i,a,l,s,u,c,_=this,f=_._sheet,d=f._cachePool,h=_._colLayoutModel,g=h[0].col,p=h[h.length-1].col,m=f._getSpanModel(),v=o,C=f.getColumnCount(),w=p;for(c=1;c<v;c++){if((a=w+c)>=C)return U;if(m.find(e,a))return U;if(n=d._getValue(e,a),(r=d._getZoomColWidth(a))>0&&!H(n))return t=d._getActualStyle(e,a),i=t.hAlign,3===i&&(i=F(i,n)),s=A._getFormattedTextByStyle(f,t,n),u={data:n,style:t,width:r,text:s},2===i?l=_._buildCellOverflowLayoutForRight(u,e,a,g):1===i&&(l=_._buildCellOverflowLayoutForCenter(u,e,a,g,p)),l&&l.startColumn<=p?l:U}}},S._CellOverflowLayoutBuilder=se,i=".cutCopyIndicator",a=N.CellChanged,l=N.ClipboardChanged,s=N.ValueChanged,u=N.ColumnChanged,c=N.RowChanged,_=N.RangeChanged,f=N.ClipboardPasting,d=N.ClipboardPasted,h=N.DragMerging;function ue(e){var t=this;t._needPaint=!1,t._pasteInternal=!1,t._sheet=e,t._bindEvents()}ue.prototype={constructor:ue,_isPastedInternal:function(e){var t=this;if(0===arguments.length)return t._pasteInternal;t._pasteInternal=e},_needPaintIndicator:function(e){var t,n=this;if(0===arguments.length)return n._needPaint;(n._needPaint!==e||e)&&(n._needPaint=e,(t=n._sheet)&&t._invalidate())},_bindEvents:function(){var e=this,t=e._sheet,n=!1,r="resizable",o="isVisible";function g(){e._needPaintIndicator(!1)}
t._bind(l+i,function(){e._needPaintIndicator(!0)}),t._bind(s+i,g),t._bind(a+i,g),t._bind(u+i,function(e,t){var n=t.propertyName;n!==r&&"width"!==n&&n!==o&&g()}),t._bind(c+i,function(e,t){var n=t.propertyName;n!==r&&"height"!==n&&n!==o&&g()}),t._bind(_+i,g),t._bind(f+i,function(){n=e._needPaintIndicator()}),t._bind(d+i,function(t,r){var o,i=r.cellRange,a=r.sheet._getClipboardHelper(),l=a._ranges,s=n;if(i&&l&&a._fromSheet){if(e._isPastedInternal()){for(o=0;o<l.length;o++)if(l[o].intersect(i.row,i.col,i.rowCount,i.colCount)){s=!1;break}}else s=!1;e._needPaintIndicator(s)}}),t._bind(h+i,g)},_paintCutCopyIndicator:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p=this;if(p._needPaint&&(o=p._sheet,i=o._render,a=o.parent,l=a?a.options:{},s=o._getClipboardHelper(),u=s._ranges,c=l.cutCopyIndicatorVisible,H(c)&&(c=!0),_=V._getColor(o,l.cutCopyIndicatorBorderColor||"blue"),c&&s._fromSheet===o&&u&&(f=o._getSheetLayout(),d=f._viewportRect(n,r),h=i._getPaintingRects(n,r,u,t),h&&d))){for(e.save(),e.rect(d.x,d.y,ee(d),$(d)),e.clip(),g=0;g<h.length;g++)i._paintDashRect(e,h[g],_);e.beginPath(),e.restore()}},_onRowsAdded:function(){this._needPaintIndicator(!1)},_onRowsDeleted:function(){this._needPaintIndicator(!1)},_onColumnsAdded:function(){this._needPaintIndicator(!1)},_onColumnsDeleted:function(){this._needPaintIndicator(!1)},_cancelIndicator:function(){this._needPaintIndicator(!1)},_dispose:function(){var e=this._sheet;e._unbind(a+i),e._unbind(l+i),e._unbind(s+i),e._unbind(u+i),e._unbind(c+i),e._unbind(_+i),e._unbind(f+i),e._unbind(d+i),e._unbind(h+i)}},S._CutCopyIndicatorManager=ue,e.exports=S}()},function(e,t,n){!function(){"use strict";var t=n(1),r=n(17).Worksheet,o=n(16)._SelectionModel,i=n(3),a=n(5),l=n(4).GC$,s=i._createRange,u=i._ThemeStyleHelper,c=i._FocusHelper,_=a._Types._isNullOrUndefined,f=a._ArrayHelper._getLength,d=null,h=Math.max,g=Math.min,p="gc-selection";function m(e,t){return e.getColumnCount(t)}function v(e,t){return e.getRowCount(t)}function C(e){return e.rowCount}function w(e){return e.colCount}t.SelectionPolicy={single:0,range:1,multiRange:2},t.SelectionUnit={cell:0,row:1,column:2},l.extend(r.prototype,{addSelection:function(e,t,n,r){var o,i,a=this,l=e,u=t,c=n,_=r;-1!==l&&-1!==u&&(o=a._getSpanModel().getSpans())&&f(o)>0&&(i=a._cellRangeInflate(o,s(e,t,n,r)),l=i.row,u=i.col,c=C(i),_=w(i)),a._selectionModel.add(l,u,c,_),a._invalidate()},setSelection:function(e,t,n,r){this._setSelectionImp(e,t,n,r,2)},_setSelectionImp:function(e,t,n,r,o){var i,a,l,s=this,u=v(s),_=m(s);e>=u&&(e=u-1),t>=_&&(t=_-1),i=h(0,e),a=h(0,t),s._clearSelectionImp(),l=2===o?c._isActiveElement(s):1===o,s._setActiveCellImp(i,a,s._getRowViewportIndex(i),s._getColumnViewportIndex(a),!l),s.addSelection(e,t,n,r)},getSelections:function(){return this._selectionModel.toArray()},clearSelection:function(){var e=this;e._clearSelectionImp(),e._setActiveCellImp(0,0),r._callFeatureHandler(e,"clearSelection"),e._invalidate()},_clearSelectionImp:function(){this._selectionModel.clear()},_canSelect:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,p=this,C=p.options,w=C.protectionOptions,y=!1!==w.allowSelectLockedCells,S=!1!==w.allowSelectUnlockedCells;if(!C.isProtected||y&&S)return!0;if(!y&&!S)return!1;if(r=n?n.locked:p._getStyleProperty(e,t,"locked"),o=t<0,i=e<0,y===r&&(i||o)){for(a=i?v(p):1,e=i?0:e,l=o?m(p):1,t=o?0:t,s=p._getModel(),u=s.dataTable,c=e+a-1,_=t+l-1,f=e;f<=c;f++)if(h=u[f])for(d=t;d<=_;d++)if((g=h[d])&&g.style&&y!==g.style.locked)return!1;if(i)for(f=e;f<=c;f++)if((n=s.getStyle(f,-1))&&y!==n.locked)return!1;if(o)for(d=t;d<=_;d++)if((n=s.getStyle(-1,d))&&y!==n.locked)return!1}return y===r},selectionPolicy:function(e){var t=this,n=t._selectionModel;return 0===arguments.length?n._selectionPolicy:(n._selectionPolicy=e,t)},selectionUnit:function(e){var t=this,n=t._selectionModel;return 0===arguments.length?n._selectionUnit:(n._selectionUnit=e,t)},getSelectionBackColor:function(){return this.options.selectionBackColor||u._getCssClassThemeStyle(p).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||u._getCssClassThemeStyle(p).borderTopColor},_saveAndClearSheetSelections:function(){var e=this,t=e._selectionModel;f(t)>0&&(e._selectionModelCache=t.toJSON(),e._clearSelectionImp(),e._render._repaintSelection())},_loadAndSetSheetSelections:function(){var e=this,t=e._selectionModelCache;t&&e._selectionModel.fromJSON(t)},_moveActiveCellUp:function(e,t,n){var r,o,i,a=this,l=a._getMoveUpCell(e,t,n,a._leadingCellCol||0);l&&(r=l.row,o=l.col,i=l.leadingCellCol,a._canMoveCurrentTo(r,o)&&(a._leadingCellRow=r,a._leadingCellCol=i,a._setActiveCellCore(r,o)))},_getMoveUpCell:function(e,t,n,r){var o,i,a=this,l=v(a),s=m(a),u=e;return 0===u&&!n||0===l||0===s?d:(i=a._getPrevRow(u,r),n||a._adjustCell(i),u=i.r,o=i.c,u<0&&n&&(o=a._getPrevVisualColumn(o),(o<0||_(o))&&(o=a._getPrevVisualColumn(s)),r=o,i=a._getPrevRow(l,o),u=i.r,(o=i.c)===t&&u<=e)?d:{row:u,col:o,leadingCellCol:r})},_moveActiveCellDown:function(e,t,n){var r,o,i,a=this,l=a._getMoveDownCell(e,t,n,a._leadingCellCol||0);!l||l.row===e&&l.col===t||(r=l.row,o=l.col,i=l.leadingCellCol,a._canMoveCurrentTo(r,o)&&(a._leadingCellRow=r,a._leadingCellCol=i,a._setActiveCellCore(r,o)))},_getMoveDownCell:function(e,t,n,r){var o,i,a=this,l=v(a),s=m(a),u=e;if((u!==l-1||n)&&0!==l&&0!==s&&(i=a._getNextRow(u,r),n||a._adjustCell(i),u=i.r,o=i.c,!(u===l&&n&&(o=a._getNextVisualColumn(o),(o>=s||_(o))&&(o=a._getNextVisualColumn(-1)),r=o,i=a._getNextRow(-1,o),u=i.r,(o=i.c)===t&&u>=e))))return{row:u,col:o,leadingCellCol:r}},_moveActiveCellLast:function(){var e,t,n=this,r=n._getMoveLastCell();r&&(e=r.row,t=r.col,n._leadingCellRow=e,n._leadingCellCol=t,n._setActiveCellCore(e,t))},_getMoveLastCell:function(){var e,t,n,r,o,i=this,a=i._getLastVisualRow(),l=i._getLastVisualColumn(),s=l;if(!a&&!s)return d;if(e=i.options,t=e.protectionOptions,n=!1!==t.allowSelectLockedCells,r=!1!==t.allowSelectUnlockedCells,!e.isProtected||n&&r)return{row:a,col:s};if(!n&&!r)return d;for(;a!==d&&a>=0;a=i._getPrevVisualRow(a))for(s=l;s!==d&&s>=0;s=i._getPrevVisualColumn(s))if(o=i._getStyleProperty(a,s,"locked"),n===o)return{row:a,col:s};return d},_moveActiveCellFirst:function(){var e,t,n=this,r=n._getMoveFirstCell();r&&(e=r.row,t=r.col,n._leadingCellRow=e,n._leadingCellCol=t,n._setActiveCellCore(e,t))},_getMoveFirstCell:function(){var e,t,n,r,o,i=this,a=i._getNextVisualRow(i.frozenRowCount()-1),l=i._getNextVisualColumn(i.frozenColumnCount()-1),s=l,u=i._getLastVisualRow(),c=i._getLastVisualColumn();if(a===d||s===d)return d;if(e=i.options,t=e.protectionOptions,n=!1!==t.allowSelectLockedCells,r=!1!==t.allowSelectUnlockedCells,!e.isProtected||n&&r)return{row:a,col:s};if(!n&&!r)return d;for(;a!==d&&a<=u;a=i._getNextVisualRow(a))for(s=l;s!==d&&s<=c;s=i._getNextVisualColumn(s))if(o=i._getStyleProperty(a,s,"locked"),n===o)return{row:a,col:s};return d},_moveActiveCellLeft:function(e,t,n){var r,o,i,a=this,l=a._getMoveLeftCell(e,t,n,a._leadingCellRow||0);l&&(r=l.row,o=l.col,i=l.leadingCellRow,a._canMoveCurrentTo(r,o)&&(a._leadingCellRow=i,a._leadingCellCol=o,a._setActiveCellCore(r,o)))},_getMoveLeftCell:function(e,t,n,r){var o,i,a,l=this,s=v(l),u=m(l),c=t;if(0===c&&!n||0===s||0===u)return d;for(i=l._getPrevColumn(r,c),a=r,n||l._adjustCell(i),o=i.r,c=i.c;c<0&&n;){if(o=l._getPrevVisualRow(o,3,!0),(o<0||_(o))&&(o=l._getPrevVisualRow(s,3,!0)),r=o,i=l._getPrevColumn(r,u),o=i.r,c=i.c,o===e&&c<t)return d;if(o===e&&c===t){if(r===a)return d;i=l._getPrevColumn(r,c),o=i.r,c=i.c}}return{row:o,col:c,leadingCellRow:r}},_adjustCell:function(e){var t,n=this,r=!1;e.r<0?e.r=n._getFirstVisualRow():e.r>=v(n)&&(e.r=n._getLastVisualRow(),r=!0),e.c<0?e.c=n._getFirstVisualColumn():e.c>=m(n)&&(e.c=n._getLastVisualColumn(),r=!0),r&&(t=n._getSpanModel().get(e.r,e.c),t.row!==e.r&&(e.r=t.row),t.col!==e.c&&(e.c=t.col))},_moveActiveCellLeftInSelection:function(e,t){for(var n,r,o=this,i=o._selectionModel,a=i._activeSelectedRangeIndex,l=-1,s=o._getActualRange(o._getActiveSelectedRange()),u=s.row,c=s.col,_=s.col+w(s)-1,f=e,d=t;n=o._getPrevColumnInSelection(f,d),f=n.r,!((d=n.c)>=c);){if(l===a&&f===e&&d<=t)return;f--,f>=u?d=_+1:(r=o._getActualRange(o._getActiveSelectedRange(3)),l=i._activeSelectedRangeIndex,u=r.row,c=r.col,_=r.col+w(r)-1,f=r.row+C(r)-1,d=r.col+w(r))}f>=0&&(o._setActiveCellCore(f,d),o._leadingCellRow=f,o._leadingCellCol=d)},_moveActiveCellRightInSelection:function(e,t){for(var n,r,o=this,i=o._selectionModel,a=i._activeSelectedRangeIndex,l=-1,s=o._getActualRange(o._getActiveSelectedRange()),u=s.col,c=s.row+C(s)-1,_=s.col+w(s)-1,f=e,d=t;n=o._getNextColumnInSelection(f,d),f=n.r,!((d=n.c)<=_);){if(l===a&&f===e&&d>=t)return;f++,f<=c?d=u-1:(r=o._getActualRange(o._getActiveSelectedRange(4)),l=i._activeSelectedRangeIndex,u=r.col,c=r.row+C(r)-1,_=r.col+w(r)-1,f=r.row,d=r.col-1)}f>=0&&(o._setActiveCellCore(f,d),o._leadingCellRow=f,o._leadingCellCol=d)},_moveActiveCellRight:function(e,t,n){var r,o,i,a=this,l=a._getMoveRightCell(e,t,n,a._leadingCellRow||0);!l||l.row===e&&l.col===t||(r=l.row,o=l.col,i=l.leadingCellRow,a._canMoveCurrentTo(r,o)&&(a._leadingCellRow=i,a._leadingCellCol=o,a._setActiveCellCore(r,o)))},_getMoveRightCell:function(e,t,n,r){var o,i,a,l=this,s=v(l),u=m(l),c=t;if(c===u-1&&!n||0===s||0===u)return d;for(i=l._getNextColumn(r,c),a=r,n||l._adjustCell(i),o=i.r,c=i.c;c===u&&n;){if(o=l._getNextVisualRow(o,3,!0),(o>=s||_(o))&&(o=l._getNextVisualRow(-1,3,!0)),r=o,i=l._getNextColumn(r,-1),o=i.r,c=i.c,o===e&&c>t)return d;if(o===e&&c===t){if(r===a)return d;i=l._getNextColumn(r,c),o=i.r,c=i.c}}return{row:o,col:c,leadingCellRow:r}},_getPrevColumn:function(e,t){for(var n,r,o,i=this,a=t;a>=0&&(n=e,!(--a<0));)if(r=i.getSpans(s(n,a,1,1)),r&&f(r)>0&&(o=r[0],a>=o.col&&(a=o.col,n=o.row)),i._canMoveCurrentTo(n,a))return{r:n,c:a};return{r:n,c:a}},_getPrevColumnInSelection:function(e,t){for(var n,r,o=this;t>=0&&!(--t<0);){if(n=o._getSpanModel().find(e,t)){if(r=o._getActiveSelectedRange(),!(r.row<=n.row&&n.row+C(n)<=r.row+C(r)&&r.col<=n.col&&n.col+w(n)<=r.col+w(r)))continue;if(n.row!==e||n.col!==t)continue;t>=n.col&&(t=n.col,e=n.row)}if(o._canMoveCurrentTo(e,t))return{r:e,c:t}}return{r:e,c:t}},_getNextColumn:function(e,t){for(var n,r,o,i,a=this,l=m(a),u=t;u<l&&(n=e,r=a._getSpanModel().get(n,u),!((u+=w(r))>=l));)if(o=a.getSpans(s(n,u,1,1)),o&&f(o)>0&&(i=o[0],u>i.col?u=h(u,i.col+w(i)):n=i.row),a._canMoveCurrentTo(n,u))return{r:n,c:u};return{r:n,c:u}},_getNextColumnInSelection:function(e,t){for(var n,r,o,i=this,a=i._getSpanModel(),l=m(i);t<l&&(n=a.get(e,t),!((t=n.col+w(n))>=l));){if(r=a.find(e,t)){if(o=i._getActiveSelectedRange(),!(o.row<=r.row&&r.row+C(r)<=o.row+C(o)&&o.col<=r.col&&r.col+w(r)<=o.col+w(o)))continue;if(r.row!==e||r.col!==t)continue;t>r.col?t=h(t,r.col+w(r)):e=r.row}if(i._canMoveCurrentTo(e,t))return{r:e,c:t}}return{r:e,c:t}},_canMoveCurrentTo:function(e,t){var n,r,o,i=this;return!!i._canSelect(e,t)&&(n=e>=0&&e<v(i)&&t>=0&&t<m(i)&&i.getRowVisible(e)&&i.getColumnVisible(t)&&i._getZoomRowHeight(e)>0&&i._getZoomColumnWidth(t)>0,r=!!i._isTabNavigation,!0===n&&!0===r&&!1===(o=i._getStyleProperty(e,t,"tabStop"))&&(n=!1),n)},_getPrevRow:function(e,t){for(var n,r,o=this;e>=0&&!(--e<0);)if(n=o.getSpans(s(e,t,1,1)),n&&f(n)>0&&(r=n[0],e>=r.row&&(e=r.row,t=r.col)),o._canMoveCurrentTo(e,t))return{r:e,c:t};return{r:e,c:t}},_getNextRow:function(e,t){for(var n,r,o,i=this,a=v(i);e<a&&(n=i._getSpanModel().get(e,t),!((e+=C(n))>=a));)if(r=i.getSpans(s(e,t,1,1)),r&&f(r)>0&&(o=r[0],e>o.row?e=h(e,o.row+C(o)):t=o.col),i._canMoveCurrentTo(e,t))return{r:e,c:t};return{r:e,c:t}},_setSelectedRange:function(e,t,n,r,o){var i=this;i._selectionModel.add(e,t,n,r),o&&i._layoutSuspended<=0&&i._render._repaintSelection()},_extendSelectedRange:function(e,t,n){var r=this,o=r._getExtendedRange(e,t,r._activeRowIndex,r._activeColIndex),i=o.row,a=o.col,l=C(o),s=w(o),u=r.selectionPolicy(),c=r.selectionUnit();0!==u&&(1===u&&r._selectionModel.clear(),1===c?(a=-1,s=-1):2===c&&(i=-1,l=-1),r._replaceActiveSelectedRange(i,a,l,s,n))},_getExtendedRange:function(e,n,r,o,i){var a,l,s,u,c,d=this;return _(r)&&(r=d._activeRowIndex),_(o)&&(o=d._activeColIndex),a=d._getSpanModel(),l=a.get(r,o),s=a.get(e,n),i&&l.equals(s)?new t.Range(l.row,l.col,1,1):(u=l.union(s),c=d.getSpans(),c&&f(c)>0&&(u=d._inflateRangeToCoverSpans(c,u)),u)},_replaceActiveSelectedRange:function(e,t,n,r,o){var i,a,l=this,u=l._selectionModel,c=l._getActiveSelectedRange();if(f(u)>0?u.splice(u._activeSelectedRangeIndex,1,s(e,t,n,r)):u.add(e,t,n,r),o&&l._layoutSuspended<=0){if(i=l._getActiveSelectedRange(),i.row===c.row&&i.col===c.col&&C(i)===C(c)&&w(i)===w(c))return;a=l._render,c.containsRange(i)?a._repaintSelection(c):i.containsRange(c)?a._repaintSelection(i):(a._repaintSelection(c),a._repaintSelection(i))}},_changeActiveSelectedRange:function(e,t){var n,r,o,i,a,l,s,u,c,_,d=this;if(!(f(d._selectionModel)<=0)&&(n=d._getActiveSelectedRange(),r=d._getKeyboardSelectedRange(n,e,t))){if(o=d._selectionModel.toArray(),i=r.row,a=r.col,l=C(r),s=w(r),u=d.selectionPolicy(),c=d.selectionUnit(),0===u)return;1===u&&d._selectionModel.clear(),1===c?(a=-1,s=-1):2===c&&(i=-1,l=-1),d._replaceActiveSelectedRange(i,a,l,s,!0),_=d._selectionModel.toArray(),d._eventHandler._notEqualSelecions(o,_)&&(d._raiseSelectionChanging(o,_),d._raiseSelectionChanged(o))}},_getKeyboardSelectedRange:function(e,t,n,r,o){var i=this,a=i._getActualRange(e),l=d;return 37===t?l=n?i._searchSelectedRangebyLeftCtrl(a,!1,r,o):i._searchSelectedRangebyLeft(a,r,o):39===t?l=n?i._searchSelectedRangebyRightCtrl(a,!1,r,o):i._searchSelectedRangebyRight(a,r,o):38===t?l=n?i._searchSelectedRangebyUpCtrl(a,!1,r,o):i._searchSelectedRangebyUp(a,r,o):40===t?l=n?i._searchSelectedRangebyDownCtrl(a,!1,r,o):i._searchSelectedRangebyDown(a,r,o):36===t?l=n?i._searchSelectedRangebyHomeCtrl(a,r,o):i._searchSelectedRangebyHome(a,r,o):35===t?l=n?i._searchSelectedRangebyEndCtrl(a,r,o):i._searchSelectedRangebyEnd(a,r,o):33===t?l=i._searchSelectedRangebyPageUp(a,r,o):34===t&&(l=i._searchSelectedRangebyPageDown(a,r,o)),l&&(e.row<0&&(l.row=-1,l.rowCount=i.getRowCount()),e.col<0&&(l.col=-1,l.colCount=i.getColumnCount())),l},_searchSelectedRangebyLeft:function(e,t,n){for(var r,o,i,a,l,u,c,_,f,p=this,m=e.row,v=e.col,y=C(e),S=w(e),x=v+S-1,b=0,T=m+y-1;x>b;)if(x--,p._canMoveCurrentTo(T,x)&&(r=p._getExtendedRange(T,x,t,n),o=g(m,r.row),i=g(v,r.col),a=h(m+y-1,r.row+C(r)-1),l=g(v+S-1,r.col+w(r)-1),u=a-o+1,c=l-i+1,o!==m||i!==v||u!==y||c!==S))return _=p._scrollLeftCol,f=p._activeColIndex,v<f?i<=_&&p._setLeftColumn(i):v===f&&l<=_&&p._setLeftColumn(l),s(o,i,u,c);return d},_searchSelectedRangebyLeftCtrl:function(e,t,n,r){var o,i,a,l,u,c,f,d=this,p=e.row,m=e.col,v=d.frozenColumnCount(),y=v?d._getNextVisualColumn(v-1):d._getFirstVisualColumn(),S=t?y:d._getFirstVisualColumn();if(!_(S))return(v<=0||t)&&d._setLeftColumn(S),o=d._getExtendedRange(p,S,n,r),i=g(p,o.row),a=g(m,o.col),l=h(p+C(e)-1,o.row+C(o)-1),u=g(m+w(e)-1,o.col+w(o)-1),c=l-i+1,f=u-a+1,s(i,a,c,f)},_searchSelectedRangebyRight:function(e,t,n){for(var r,o,i,a,l,u,c,_,f,p=this,v=e.row,y=e.col,S=C(e),x=w(e),b=y,T=m(p)-1,R=v+S-1;b<T;)if(b++,p._canMoveCurrentTo(R,b)&&(r=p._getExtendedRange(R,b,t,n),o=g(v,r.row),i=h(y,r.col),a=h(v+S-1,r.row+C(r)-1),l=h(y+x-1,r.col+w(r)-1),u=a-o+1,c=l-i+1,o!==v||i!==y||u!==S||c!==x))return _=p._getPageRightColumn(),f=p._activeColIndex,y<f?i>=_&&p._setLeftColumn(p._getNewLeftColumn(i,2)):y===f&&l>=_&&p._setLeftColumn(p._getNewLeftColumn(l,2)),s(o,i,u,c);return d},_searchSelectedRangebyRightCtrl:function(e,t,n,r){var o,i,a,l,u,c,f,d,p=this,m=e.row,v=e.col,y=p._getLastPageLeftColumn();if(!_(y))return p._setLeftColumn(y),o=p._getLastVisualColumn(),t||(o+=p.frozenTrailingColumnCount()),i=p._getExtendedRange(m,o,n,r),a=g(m,i.row),l=h(v,i.col),u=h(m+C(e)-1,i.row+C(i)-1),c=h(v+w(e)-1,i.col+w(i)-1),f=u-a+1,d=c-l+1,s(a,l,f,d)},_searchSelectedRangebyUp:function(e,t,n){for(var r,o,i,a,l,u,c,_,f,p=this,m=e.row,v=e.col,y=C(e),S=w(e),x=m+y-1,b=0,T=v+S-1;x>b;)if(x--,p._canMoveCurrentTo(x,T)&&(r=p._getExtendedRange(x,T,t,n),o=g(m,r.row),i=g(v,r.col),a=g(m+y-1,r.row+C(r)-1),l=h(v+S-1,r.col+w(r)-1),u=a-o+1,c=l-i+1,o!==m||i!==v||u!==y||c!==S))return _=p._scrollTopRow,f=p._activeRowIndex,m<f?o<=_&&p._setTopRow(o):m===f&&a<=_&&p._setTopRow(a),s(o,i,u,c);return d},_searchSelectedRangebyUpCtrl:function(e,t,n,r){var o,i,a,l,u,c,f,d=this,p=e.row,m=e.col,v=d.frozenRowCount(),y=v?d._getNextVisualRow(v-1):d._getFirstVisualRow(),S=t?y:d._getFirstVisualRow();if(!_(S))return(v<=0||t)&&d._setTopRow(S),o=d._getExtendedRange(S,m,n,r),i=g(p,o.row),a=g(m,o.col),l=g(p+C(e)-1,o.row+C(o)-1),u=h(m+w(e)-1,o.col+w(o)-1),c=l-i+1,f=u-a+1,s(i,a,c,f)},_searchSelectedRangebyDown:function(e,t,n){for(var r,o,i,a,l,u,c,_,f,p=this,m=e.row,y=e.col,S=C(e),x=w(e),b=m,T=v(p)-1,R=y+x-1;b<T;)if(b++,p._canMoveCurrentTo(b,R)&&(r=p._getExtendedRange(b,R,t,n),o=h(m,r.row),i=g(y,r.col),a=h(m+S-1,r.row+C(r)-1),l=h(y+x-1,r.col+w(r)-1),u=a-o+1,c=l-i+1,o!==m||i!==y||u!==S||c!==x))return _=p._getPageBottomRow(),f=p._activeRowIndex,m<f?o>=_&&p._setTopRow(p._getNewTopRow(o,2)):m===f&&a>=_&&p._setTopRow(p._getNewTopRow(a,2)),s(o,i,u,c);return d},_searchSelectedRangebyDownCtrl:function(e,t,n,r){var o,i,a,l,u,c,f,d,p=this,m=e.row,v=e.col,y=p._getLastPageTopRow();if(!_(y))return p._setTopRow(y),o=p._getLastVisualRow(),t||(o+=p.frozenTrailingRowCount()),i=p._getExtendedRange(o,v,n,r),a=h(m,i.row),l=g(v,i.col),u=h(m+C(e)-1,i.row+C(i)-1),c=h(v+w(e)-1,i.col+w(i)-1),f=u-a+1,d=c-l+1,s(a,l,f,d)},_searchSelectedRangebyHome:function(e,t,n){for(var r,o,i,a,l,u,c,_=this,f=e.row,p=e.col,m=C(e),v=w(e),y=_.frozenColumnCount()-1,S=_._activeColIndex,x=f+m-1;y<S;)if(y++,_._canMoveCurrentTo(x,y)){if(p<=y&&p+v-1===_._activeColIndex)break;return r=_._getExtendedRange(x,y,t,n),o=g(f,r.row),i=g(p,r.col),a=h(f+m-1,r.row+C(r)-1),l=g(p+v-1,r.col+w(r)-1),u=a-o+1,c=l-i+1,_._setLeftColumn(_._getFirstVisualColumn()),s(o,i,u,c)}return d},_searchSelectedRangebyHomeCtrl:function(e,t,n){return e=this._searchSelectedRangebyLeftCtrl(e,!0,t,n),e=this._searchSelectedRangebyUpCtrl(e,!0,t,n)},_searchSelectedRangebyEnd:function(e,t,n){for(var r,o,i,a,l,u,c,_=this,f=e.row,p=e.col,v=C(e),y=w(e),S=m(_),x=_._activeColIndex,b=f+v-1;S>x;)if(S--,_._canMoveCurrentTo(b,S)){if(p+y-1>=S&&p===_._activeColIndex)break;return r=_._getExtendedRange(b,S,t,n),o=g(f,r.row),i=h(p,r.col),a=h(f+v-1,r.row+C(r)-1),l=h(p+y-1,r.col+w(r)-1),u=a-o+1,c=l-i+1,_._setLeftColumn(_._getLastPageLeftColumn()),s(o,i,u,c)}return d},_searchSelectedRangebyEndCtrl:function(e,t,n){return e=this._searchSelectedRangebyRightCtrl(e,!0,t,n),e=this._searchSelectedRangebyDownCtrl(e,!0,t,n)},_searchSelectedRangebyPageUp:function(e,t,n){var r,o,i,a,l,u,c,p,m,v,y=this,S=e.row,x=e.col,b=C(e),T=y._getPrevPageTopRow();return _(T)?d:(r=y._getRowLayout(1),o=y._setTopRow(T),i=-1,o?i=y._getNextVisualRow(S+b-1-f(r)):y.frozenRowCount()<=0&&(i=y._getFirstVisualRow()),i<y._scrollTopRow?i=y._scrollTopRow:i>=y._getPageBottomRow()&&(i=y._getPrevVisualRow(y._getPageBottomRow())),a=y._getExtendedRange(i,x,t,n),l=g(S,a.row),u=g(x,a.col),c=g(S+b-1,a.row+C(a)-1),p=h(x+w(e)-1,a.col+w(a)-1),m=c-l+1,v=p-u+1,s(l,u,m,v))},_searchSelectedRangebyPageDown:function(e,t,n){var r,o,i,a,l,u,c,p,m,v=this,y=e.row,S=e.col,x=C(e),b=v._getNextPageTopRow();return _(b)?d:(r=v._getRowLayout(1),v._setTopRow(b),o=v._getPrevVisualRow(y+x-1+f(r)),o<v._scrollTopRow?o=v._scrollTopRow:o>=v._getPageBottomRow()&&(o=v._scrollTopRow>=v._getLastPageTopRow()?v._getPageBottomRow():v._getPrevVisualRow(v._getPageBottomRow())),i=v._getExtendedRange(o,S,t,n),a=h(y,i.row),l=g(S,i.col),u=h(y+x-1,i.row+C(i)-1),c=h(S+w(e)-1,i.col+w(i)-1),p=u-a+1,m=c-l+1,s(a,l,p,m))},_getPrevPageTopRow:function(){var e,t,n,r,o,i=this,a=i._getRowLayout(1);if(!a||f(a)<=0)return d;for(e=i.frozenRowCount(),t=e?i._getNextVisualRow(e-1):i._getFirstVisualRow(),n=0,r=i._scrollTopRow,o=i._getSheetLayout();r>t&&(r--,!((n+=i._getZoomRowHeight(r))>o._viewportHeight)););return r},_getPrevPageLeftColumn:function(){var e,t,n,r,o,i=this,a=i._getColumnLayout(1);if(!a||f(a)<=0)return d;for(e=i.frozenColumnCount(),t=e?i._getNextVisualColumn(e-1):i._getFirstVisualColumn(),n=0,r=i._scrollLeftCol,o=i._getSheetLayout();r>t&&(r--,!((n+=i._getZoomColumnWidth(r))>o._viewportWidth)););return r},_getNextPageTopRow:function(){var e,t,n=this._getRowLayout(1);return n&&(e=f(n))>0?(t=n[e-1].row,this._getLastVisualRow()<=t?this._scrollTopRow:t):d},_getLastPageTopRow:function(){var e,t,n,r,o,i,a=this;if(a._getLastVisualRow()===a._getPageBottomRow()&&(e=a._getSheetLayout(),(t=a._getRowLayout(1))&&(n=f(t))>=1&&(r=t[n-1],r.y+r.height<=e._viewportY+e._viewportHeight)))return a._scrollTopRow;o=a._scrollTopRow;try{return a._scrollTopRow=a._getLastVisualRow(),i=a._getPrevPageTopRow(),i=a._getNextVisualRow(i)}catch(e){}finally{a._scrollTopRow=o}},_getLastPageLeftColumn:function(){var e,t,n,r,o,i,a=this;if(a._getLastVisualColumn()===a._getPageRightColumn()&&(e=a._getSheetLayout(),(t=a._getColumnLayout(1))&&(n=f(t))>=1&&(r=t[n-1],r.x+r.width<=e._viewportX+e.width)))return a._scrollLeftCol;for(e=a._getSheetLayout(),o=0,i=a._getLastVisualColumn();i>0&&!((o+=a._getZoomColumnWidth(i))>e._viewportWidth);)i--;return i>0&&(i=a._getNextVisualColumn(i)),i},_getPageBottomRow:function(){var e=this._getRowLayout(1),t;return e&&(t=f(e))>0?e[t-1].row:d},_getPageRightColumn:function(){var e=this._getColumnLayout(1),t;return e&&(t=f(e))>0?e[t-1].col:d},_getLastFullyVisibleRow:function(){var e,t,n,r=this._getRowLayout(1);return r&&(e=f(r))>0?(t=this._getSheetLayout(),n=e-1,r[n].y+r[n].height<=t._viewportY+t._viewportHeight?r[n].row:r[h(n-1,0)].row):d},_getLastFullyVisibleColumn:function(){var e,t,n,r=this._getColumnLayout(1);return r&&(e=f(r))>0?(t=this._getSheetLayout(),n=e-1,r[n].x+r[n].width<=t._viewportX+t._viewportWidth?r[n].col:r[h(n-1,0)].col):d},_getLastVisualRow:function(e){_(e)&&(e=3);var t=v(this,e);return 3!==e&&2!==e||(t-=this.frozenTrailingRowCount()),this._getPrevVisualRow(t,e)},_getLastVisualColumn:function(e){_(e)&&(e=3);var t=m(this,e);return 3!==e&&1!==e||(t-=this.frozenTrailingColumnCount()),this._getPrevVisualColumn(t,e)},_inflateRangeToCoverSpans:function(e,t){var n,r,o;if(e)for(n=0,r=f(e);n<r;n++)if(o=e[n],t.intersect(o.row,o.col,C(o),w(o)))return e.splice(n--,1),this._inflateRangeToCoverSpans(e,t.union(o));return t},_getActiveSelectedRange:function(e){var t=this,n=t._selectionModel,r=f(n),o=s(-1,-1,0,0);return r<=0?o:(3===e?--n._activeSelectedRangeIndex<0&&(n._activeSelectedRangeIndex=r-1):4===e&&++n._activeSelectedRangeIndex>=r&&(n._activeSelectedRangeIndex=0),n._activeSelectedRangeIndex>=0&&(o=n[n._activeSelectedRangeIndex]),o)}}),r._registerFeature("selection",{init:function(){var e=new o;e.add(0,0,1,1),this._selectionModel=e}}),e.exports=t}()},function(e,t,n){!function(){"use strict";var t=n(1),r=n(5),o=n(4).GC$,i=n(3),a=n(17).Worksheet,l=r._DateTimeHelper._toOADate,s=r._Types._isNullOrUndefined,u="boolean",c="string",_="number";function f(e,t,n){for(var r=e[n-t];r<n;)r=e[r-t];return r}function d(e,t){return e instanceof Date&&t instanceof Date?l(e)===l(t):typeof e===c&&typeof t===c?e.toLowerCase()===t.toLowerCase():e===t}function h(e,t){var n,r,o,i,a;return e instanceof Date&&(e=l(e)),t instanceof Date&&(t=l(t)),n=typeof e,r=typeof t,o=n===c,i=r===c,a=r===_,n===r||n!==_&&!a?!(n!==u||!i)||(!o||r!==u)&&(o&&i?e.toLowerCase()>t.toLowerCase():e>t):a}function g(e,t,n,r,o,i){var a,l,u,c,f,g,p,m,v,C,w,y=0,S=o,x=e,b=t;if(S)for(a=0;a<S.length&&(S[a]&&(l=S[a].ascending,0<=(u=S[a].index)&&(g=r?x:u,p=r?u:x,m=r?b:u,v=r?u:b,i?(c=i[g][p],f=i[m][v]):(c=n.getValue(g,p),f=n.getValue(m,v)),C=s(c)||""===c||typeof c===_&&isNaN(c),w=s(f)||""===f||typeof f===_&&isNaN(f),C||w?C&&w?y=0:C&&!w?y=1:!C&&w&&(y=-1):y=d(c,f)?0:h(c,f)?l?1:-1:l?-1:1)),0===y);a++);return y}function p(e,t,n,r,o){var i,a,l,s,u,c,_,f=e.length;if(f<=1)return e;for(i=Math.floor(f/2),a=e[i],l=[],s=[],u=[],c=0;c<f;c++)_=g(e[c],a,t,n,r,o),_<0?l.push(e[c]):_>0?s.push(e[c]):u.push(e[c]);return p(l,t,n,r,o).concat(u,p(s,t,n,r,o))}function m(e,t,n,r,o,i,a,l){var s,u,c,_,f,d=i?r:o,h=i?t:n,g=[];for(s=0;s<d;s++)g[s]=h+s;if(i)for(c=[],u=g.length-1;u>=0;u--)_=g[u],e._isRowFilterOut&&e._isRowFilterOut(_)&&(g.splice(u,1),c.push({_index:u,_value:_}));if(g=p(g,e,i,a,l),i)for(u=c.length-1;u>=0;u--)f=c[u],g.splice(f._index,0,f._value);return g}function v(e,t,n){var r=e._getCellCalc(t,n,!1);r&&r.hasListeners()&&r._addListenersToAdjust()}function C(e,t,r){var o,i=n(2),a=i.CalcOperatorAdjustor,l=a._copyExpression(e._source,e._source,e._getExpr(t,r),t,r,0,0);e._setExpr(t,r,l),(o=e._getCellCalc(t,r,!!l))&&o._startListening()}function w(e,t,n){e&&(e._rowIndex=t,e._colIndex=n)}o.extend(a.prototype,{sortRange:function(e,n,r,o,l,s){var u,c,_,d,h,g,p,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U,Y,G,X,j=this,K=j.getRowCount(),Z=j.getColumnCount();if(!t._supportsCalc||j._checkArrayFormula(e,0,r,Z,!1)){if((u=j.getSpans(new i.Range(e,n,r,o)))&&u.length>0)return!1;if((c=j.tables)&&(_=c._findByRange(e,n,r,o),d=1===_.length&&_[0].dataRange().equals(i._createRange(e,n,r,o)),!(_.length<=0||d)))return!1;if(h=j._bindingManager,g=h&&h._dataSource||d&&_[0]&&_[0]._getDataSource(),-1===e&&(e=0),-1===r&&(r=K),-1===n&&(n=0),-1===o&&(o=Z),e<0||e>=K||n<0||n>=Z||r<0||e+r>K||o<0||n+o>Z||!s)return!1;j.suspendPaint(),j.suspendEvent(),t._supportsCalc&&j.suspendCalcService();try{if(p=[],g)for(y=[],S=e;S<e+r;S++)for(y[S]=[],x=n;x<n+o;x++)y[S][x]=j.getValue(S,x);if(b=m(j,e,n,r,o,l,s,y)){for(N=j._getModel(),V=t._supportsCalc&&j._getCalcModel(),O=t._supportsCalc&&j._getSheetSource(),H=j.comments,k=l?e:n,B=l?e+r:n+o,z=l?n:e,U=l?n+o:e+r,L=k;L<B;L++)if(P=f(b,k,L),L!==P)for(l?(T=L,A=P):(R=L,I=P),W=z;W<U;W++)l?(R=W,I=W):(T=W,A=W),g&&(M=y[T][R],E=y[A][I]),H&&(F=H.get(T,R),D=H.get(A,I)),V&&O&&(v(V,T,R),v(V,A,I),V._swapNode(T,R,A,I),C(V,T,R),C(V,A,I)),N.swapNode(T,R,A,I),j._validations&&j._swapValidator(T,R,A,I),H&&(w(D,T,R),w(F,A,R)),g&&(y[T][R]=E,y[A][I]=M),p.push({row:T,col:R}),p.push({row:A,col:I});if(g){for(S=e;S<e+r;S++)for(x=n;x<n+o;x++)j.setValue(S,x,y[S][x]);y=null}if(V){for(Y=e;Y<e+r;Y++)for(G=n;G<n+o;G++)(X=V.getExpression(Y,G))&&V._setExpression(Y,G,X,void 0);j.getCalcService().recalcRange(O,e,n,r,o)}return a._callFeatureHandler(j,"sortRangeChanged",{column:n,columnCount:o}),!0}return!1}finally{t._supportsCalc&&j.resumeCalcService(!1),j.resumeEvent(),j.resumePaint(),j._raiseRangeDataChanged(e,n,r,o,p,4)}}},_canDoSort:function(){var e=this.options;return!e.isProtected||e.protectionOptions.allowSort},_swapValidator:function(e,t,n,r){var o=this,i=o.getDataValidator(e,t),a=o.getDataValidator(n,r);o.setDataValidator(e,t,a),o.setDataValidator(n,r,i)}}),e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r=n(1),o=n(17).Worksheet,i=n(12).Style,a=n(4).GC$,l=n(3).Range,s=n(5)._Types._isNullOrUndefined,u=o.prototype;function c(e,t){var n=e,r=t;return function(e){var t,o,i=this,a=i.sheet,l=i.row,s=i.col,u=i.sheetArea;if(0===arguments.length)return n.call(a,l,s,u);if(l>=0&&s>=0)for(t=l;t<l+i.rowCount;t++)for(o=s;o<s+i.colCount;o++)_(a,t,o,u)&&r.call(a,t,o,e,u);return i}}function _(e,t,n,r){var o=e.getRowCount(r),i=e.getColumnCount(r);return n<0&&0<=t&&t<o||t<0&&0<=n&&n<i||0<=t&&t<o&&0<=n&&n<i}function f(e,t,n,r,o,i){var a=this;t<0&&(t=r=-1),n<0&&(n=o=-1),a.sheet=e,a.row=t,a.rowCount=s(r)?1:r,a.col=n,a.colCount=s(o)?1:o,a.sheetArea=s(i)?3:i}function d(e,t,n,r,o,a){if(_(e,t,n,a)){var l=e._getStyleImp(t,n,a);l||(l=new i),l[r]=o,e.setStyle(t,n,l,a)}}t=f.prototype={constructor:f,value:c(u.getValue,u.setValue),text:c(u.getText,u.setText),formula:c(function(e,t){return r._supportsCalc&&this.getFormula(e,t)},function(e,t,n,o){r._supportsCalc&&this.setFormula(e,t,n,o)}),tag:function(e){var t=this,n=t.sheet,r=t.row,o=t.col,i=t.rowCount,a=t.colCount,l=t.sheetArea,s,u;if(0===arguments.length)return n.getTag(r,o,l);if(r>=0&&o>=0)for(s=r;s<r+i;s++)for(u=o;u<o+a;u++)n.setTag(s,u,e,l);else if(r>=0)for(s=r;s<r+i;s++)n.setTag(s,-1,e,l);else if(o>=0)for(u=o;u<o+a;u++)n.setTag(-1,u,e,l);return t},width:function(e){var t,n=this,r=n.sheet,o=n.row,i=n.col,a=n.sheetArea;if(0!==arguments.length){if(o<0)for(t=0;t<n.colCount;t++)r.setColumnWidth(t+i,e,a);return n}if(o<0)return r.getColumnWidth(i,a)},height:function(e){var t,n=this,r=n.sheet,o=n.row,i=n.col,a=n.sheetArea;if(0!==arguments.length){if(i<0)for(t=0;t<n.rowCount;t++)r.setRowHeight(t+o,e,a);return n}if(i<0)return r.getRowHeight(o,a)},visible:function(e){var t,n,r=this,o=r.sheet,i=r.row,a=r.col,l=r.sheetArea;if(0!==arguments.length){if(a<0&&i>=0)for(t=0;t<r.rowCount;t++)o.setRowVisible(t+i,e,l);else if(a>=0&&i<0)for(n=0;n<r.colCount;n++)o.setColumnVisible(n+a,e,l);return r}return a<0&&i>=0?o.getRowVisible(i,l):a>=0&&i<0?o.getColumnVisible(a,l):void 0},resizable:function(e){var t,n,r=this,o=r.sheet,i=r.row,a=r.col,l=r.sheetArea;if(0!==arguments.length){if(a<0&&i>=0)for(t=0;t<r.rowCount;t++)o.setRowResizable(t+i,e,l);else if(a>=0&&i<0)for(n=0;n<r.colCount;n++)o.setColumnResizable(n+a,e,l);return r}return a<0&&i>=0?o.getRowResizable(i,l):a>=0&&i<0?o.getColumnResizable(a,l):void 0},_getStyleProperty:function(e){var t=this;return t.sheet._getStyleProperty(t.row,t.col,e,t.sheetArea)},_setStyleProperty:function(e,t){var n=this,r,o,i=n.sheet,a=n.row,l=n.col,s=n.rowCount,u=n.colCount,c=n.sheetArea;if(a>=0&&l>=0)for(r=a;r<a+s;r++)for(o=l;o<l+u;o++)d(i,r,o,e,t,c);else if(a>=0)for(o=-1,r=a;r<a+s;r++)d(i,r,o,e,t,c);else if(l>=0)for(r=-1,o=l;o<l+u;o++)d(i,r,o,e,t,c);return n},styleName:c(u.getStyleName,u.setStyleName),clear:function(e){var t=this;t.sheet.clear(t.row,t.col,t.rowCount,t.colCount,t.sheetArea,e)},setBorder:function(e,t){var n,r,o,i,a,s,u,c,_,f,d,h=this,g=h.sheet,p=h.sheetArea;g.suspendPaint();try{if(n=new l(h.row,h.col,h.rowCount,h.colCount),r=g._getActualRange(n,p),o=r.row,i=r.col,a=r.rowCount,s=r.colCount,_=t.all,f=t.outline,d=t.inside,t.left||_||f)for(u=0;u<a;u++)g.getCell(o+u,i,p).borderLeft(e);if(t.top||_||f)for(c=0;c<s;c++)g.getCell(o,i+c,p).borderTop(e);if(t.right||_||f)for(u=0;u<a;u++)g.getCell(o+u,i+s-1,p).borderRight(e);if(t.bottom||_||f)for(c=0;c<s;c++)g.getCell(o+a-1,i+c,p).borderBottom(e);if(t.innerHorizontal||_||d)for(u=0;u<a-1;u++)for(c=0;c<s;c++)g.getCell(o+u,i+c,p).borderBottom(e),g.getCell(o+u+1,i+c,p).borderTop(e);if(t.innerVertical||_||d)for(c=0;c<s-1;c++)for(u=0;u<a;u++)g.getCell(o+u,i+c,p).borderRight(e),g.getCell(o+u,i+c+1,p).borderLeft(e)}finally{g.resumePaint()}}},a.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions"],function(e,n){t[n]=function(e){return 0===arguments.length?this._getStyleProperty(n):this._setStyleProperty(n,e)}}),f._defProperty=c,r.CellRange=f,a.extend(u,{getRange:function(e,t,n,r,o){return new f(this,e,t,n,r,o)},getCell:function(e,t,n){return s(t)&&(t=-1),new f(this,e,t,1,1,n)}}),e.exports=r}()},function(e,t,n){!function(){"use strict";var t=n(1),r=n(4).GC$,o=n(3),i=n(2),a=n(21).NameInfo,l=n(22).Workbook,s=n(5),u=s._StringHelper._toUpperCase,c=function(){return s._getResource(t.SR)()},_=void 0,f=null,d={_initCalcService:function(e){var n=this,r=n._calcService;n._calcService=new i.CalcService,e&&r&&n._calcService.cloneFrom(r),n._spreadSource=new t.CalcEngine.SpreadSource(n),n._spreadSourceModel=n._calcService.getGlobalSourceModel(n._spreadSource)},addCustomFunction:function(e){this._addCustomFunctionCore(e)},_addCustomFunctionCore:function(e){if(!(e&&e instanceof i.Functions.Function))throw Error(c.Exp_InvalidCustomFunction);this._functions[u(e.name)]=e},getCustomFunction:function(e){return e?this._functions[u(e)]:_},removeCustomFunction:function(e){e&&(delete this._functions[u(e)],this._recalcAll())},clearCustomFunctions:function(){this._functions={}},addCustomName:function(e,t,n,r,o){this._addCustomNameCore(e,t,n,r,!1,o)},_addCustomNameCore:function(e,t,n,r,o,i){var l,s,_,d,h;if(!e||!t)throw Error(c().Exp_InvalidCustomName);if(l=this,l._calcService){if(s=this.getActiveSheet(),
_=s?s._getSheetSource():f,o)try{d=l._calcService.parse(_,t,n,r,!1,!1,!0)}catch(e){}else d=l._calcService.parse(_,t,n,r);l._nameInfos[u(e)]=new a(e,d,n,r,i),o||(h={},h[e]=e,this._updateCalc(h,!0))}},getCustomName:function(e){return e?this._nameInfos[u(e)]:_},getCustomNames:function(){var e=[];return r.each(this._nameInfos,function(t,n){e.push(n)}),e},removeCustomName:function(e){if(e){delete this._nameInfos[u(e)];var t={};t[e]=e,this._updateCalc(t,!1)}},clearCustomNames:function(){var e=this._nameInfos;this._nameInfos={},this._updateCalc(e,!1)},_updateCalc:function(e,t){var n,r,o;if(e&&0!==e.length){n=this._spreadSourceModel;for(r in e)n&&(o=n._getNameCalc(u(r)))&&(o.updateListening(!0,t),o._addToDirty());this._recalcAll()}},_recalcAll:function(){if(this._calcService&&!this._calcService.IsSuspended()){var e=this.getActiveSheet();e&&(e.suspendPaint(),this._calcService.recalculateAll(),e.resumePaint())}},getCalcService:function(){return this._calcService},_getCalcServiceInternal:function(){return this._calcService},suspendCalcService:function(e){this._calcService&&this._calcService.suspend(e)},resumeCalcService:function(e){this._calcService&&this._calcService.resume(e)}};r.extend(l.prototype,d),l._registerFeature("calc",{priority:1e3,init:function(){this._functions={},this._nameInfos={}},toJson:function(e){var t,n,o,i=this,a=i._functions;r.isEmptyObject(a)||(e.customFunctions=a),t=[],n=i.getCustomNames(),o=i._calcService,n&&o&&(r.each(n,function(e,n){var r=n.getName(),i=n.getRow(),a=n.getColumn(),l=n.getExpression(),s=n.getComment(),u=o.unparse(null,l,i,a,!1,!0),c={name:r,formula:u,row:i,col:a};s&&(c.comment=s),t.push(c)}),t.length>0&&(e.names=t))},fromJson:function(e,t,n){var r,i,a,l,s,u,c,_,f,d,h,g,p,m,v=this,C=v._calcService;if(C&&C.suspend(),v.clearCustomNames(),r=e.names)for(i=0;i<r.length;i++)a=r[i],v._addCustomNameCore(a.name,a.formula,a.row,a.col,!0,a.comment);if(v.clearCustomFunctions(),l=e.customFunctions)for(s in l)l.hasOwnProperty(s)&&(u=l[s],(c=o.getTypeFromString(u.typeName))&&(_=new c,_.fromJSON(u,t),v._addCustomFunctionCore(_)));if(h=e.sheets,g=[],h){f=0;for(p in h)"string"==typeof p&&(m=h[p],d=v.getSheetFromName(m.name||p),g.push(d),d.nameFunctionsFromJSON(m,t,n),f++);for(f=0;f<g.length;f++)g[f].formulaFromJSON(h[g[f]._name],t,n)}C&&(e.noRecalc||n&&n.doNotRecalculateAfterLoad?C.resumeWithoutCalc():C.resume(!0))}}),e.exports=t}()},function(e,t,n){!function(){"use strict";var e=n(1),t=n(22).Workbook,r=n(12).Style,o=n(4).GC$,i=n(3),a=n(5).CultureManager,l=n(23),s=l.UndoManager,u=t._features,c=o.each,_=i._util._isDefined,f=parseFloat;function d(e,t){return e.hasOwnProperty(t)}function h(e){var t,n,r,o;if(!e||"string"!=typeof e)return 1;if(t=e.split("."),(n=t.length)>3)return 3;if(r=f(t[0]),n<=2)return isNaN(r)?1:r;if(o=f(t[1]),r>=10)return r;if(r>=3){if(o>=20143)return 3;if(o>=20142)return 2}return 1}function g(e,t){var n,r,o,i,a=this,l=t&&t.frozenColumnsAsRowHeaders,s=t&&t.frozenRowsAsColumnHeaders,u=0,c=e.sheets;if(s||l)for(r in c)"string"==typeof r&&(o=c[r],i=_(o.index)?o.index:o._index,n=a.sheets[_(i)?i:u],s&&n.deleteRows(0,o.frozenRowCount),l&&n.deleteColumns(0,o.frozenColCount),u++)}o.extend(t.prototype,{toJSON:function(n){var r,a,l,s,_,f,h,g,p,m,v=this,C={version:i.productInfo.productVersion},w=n&&n.rowHeadersAsFrozenColumns,y=n&&n.columnHeadersAsFrozenRows,S=w||y;for(S&&(r=new t,r.fromJSON(v.toJSON({includeBindingSource:!0})),v=r),v._suspendSetFocus=!0,v.suspendPaint(),v.suspendEvent(),e._supportsCalc&&v._calcService.suspend(!0),a=v.startSheetIndex(),a&&(C.startSheetIndex=a),c(v.options,function(e,n){"_ps"!==e&&t._defaultOptions[e]!==n&&(C[e]=n)}),l=v.getSheetCount(),l!==t._defaultSheetCount&&(C.sheetCount=l),s=v.getActiveSheetIndex(),s!==t._defaultActiveSheetIndex&&(C.activeSheetIndex=s),_={},f=0;f<l;f++)h=v.getSheet(f),_[h._name]=h.toJSON(n),_[h._name].index=f;if(o.isEmptyObject(_)||(C.sheets=_),g=[],p=v._namedStyles,p){for(m in p)d(p,m)&&g.push(p[m]);g.length>0&&(C.namedStyles=g)}return u&&c(u,function(e,t){t.toJson&&t.toJson.call(v,C,n)}),v._suspendSetFocus=!1,e._supportsCalc&&v._calcService.resume(!1),v.resumeEvent(),v.resumePaint(),C},fromJSON:function(n,o){var l,f,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U;if(n){l=this,f=h(n.version),p=f<3,m={noSchema:p,version:f},v=i._FocusHelper._getActiveElement(),l._suspendSetFocus=!0,l.suspendPaint(),l.suspendEvent(),C=a.culture(),a.culture("");try{l._initOptions(),l._undoManager=new s(l,-1,l.options.allowUndo),e._supportsCalc&&l._initCalcService(!0),e._supportsCalc&&l._calcService.suspendAdjust(),l._availableSheetIndex=-1,l.clearSheets(),w=l.options,y=n.canUserEditFormula,_(y)&&(w.allowUserEditFormula=y),S=n.allowDragDrop,_(S)&&(w.allowUserDragDrop=S),x=n.allowDragFill,_(x)&&(w.allowUserDragFill=x);for(b in w)d(w,b)&&(T=n[b],_(T)&&(w[b]=T));if(R=n.sheetCount,_(R)||(R=t._defaultSheetCount),l._setSheetCountImp(R,0),l._namedStyles={},A=n.namedStyles)for(I=0;I<A.length;I++)M=A[I],E=new r,E.fromJSON(M,p),l._addNamedStyleImp(E);if(F=0,N=n.sheets,H=!1,P=!0,N)for(L in N)"string"==typeof L&&(k=N[L],B=_(k.index)?k.index:k._index,D=l.sheets[_(B)?B:F],D.fromJSON(k,!1,m,o,!0),F++,O=k.allowUndo,H?P=P&&O===V:(V=O,H=!0));_(V)&&P&&(w.allowUndo=V),W=n.activeSheetIndex,_(W)||(W=t._defaultActiveSheetIndex),l._setActiveSheetIndexImp(W,0),z=n.startSheetIndex,_(z)&&l.startSheetIndex(z),u&&c(u,function(e,t){var r=t.fromJson;r&&r.call(l,n,p,o)}),e._supportsCalc&&l._calcService.resumeAdjust(),g.call(l,n,o)}finally{e._supportsCalc&&l._calcService.resumeAdjust(),a.culture(C),l._suspendSetFocus=!1,U=l.getActiveSheet(),v&&U&&U._setFocus(),l.resumeEvent(),l._doResize(),l.resumePaint()}}}})}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U,Y,G,X,j,K,Z,J,q,Q,$=n(17).Worksheet,ee=n(4).GC$,te=n(3),ne=n(13).CellTypes,re=n(5),oe=n(1);oe.CellTypes||(oe.CellTypes={}),t=oe.CellTypes,r=re._Types._isNullOrUndefined,o=te._WordWrapHelper,i=te.Events.EditChange,a=te._FocusHelper,l=te._util,s=l._createElement,u=l._browser,c=u.msie,_=u.edge,f=u.chrome,d=l._cancelDefault,h=l._getHAlignByValueType,g=l._formatValue2Text,p=l._getPreferredZIndex,m=l._device(),v=l._getFontHeight,C=l._getTextHeight,w=ne.Base,y=ne.Context,S=l._replaceSpaceChar,x="left",b="right",T="center",R="gcUIElement",A="none",I=".gcEditingInput",M="width",E="height",F="text-align",D="hidden",N="word-wrap",V="overflow",O="normal",H="break-word",P="overflow-y",L="scroll",k="word-break",B="float",W=window,z=document,U=.337,Y=m.iphone||m.ipad||m.android,G=null,X=void 0,j=Math.ceil,K=Math.min,Z=Math.max,J=parseInt,q="\xa0",Q="\u200b";function ie(e){return Y||0===e}function ae(e){return ee(ie(e)?s("textarea"):s("div"))}function le(e){return e&&"DIV"===e.tagName&&"true"===e.contentEditable}function se(e){return le(e)?c&&parseFloat(u.version)<10?l._getEditableDivValue(e):e.innerText:e.value}function ue(e,t){le(e)?e.innerText=t:e.value=t}function ce(e){if(le(e)){var t=W.getSelection();t.selectAllChildren(e),t.rangeCount>0&&t.collapseToEnd()}else e.selectionStart=e.selectionEnd=e.value.length}function _e(e){var t,n;return le(e)?(t=W.getSelection(),t.rangeCount>0?(n=t.getRangeAt(0),n.startOffset):0):e.selectionStart}function fe(e){var t,n;return le(e)?(t=W.getSelection(),t.rangeCount>0?(n=t.getRangeAt(0),n.endOffset):0):e.selectionEnd}function de(e){var t=e.keyCode,n=e.shiftKey,r={106:42,107:43,109:45,110:46,111:47,173:45},o={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},i={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},a=t;return t>=96&&t<=105?a=t-48:r[t]?a=r[t]:n&&i[t]?a=i[t]:!n&&o[t]?a=o[t]:!n&&t>=65&&t<=90&&(a=t+32),a}function he(e){return e&&"BR"===e.tagName}function ge(e){return e&&"SPAN"===e.tagName}function pe(e){return e&&"DIV"===e.tagName}function me(e){return e instanceof Text}function ve(e){return e===Q}function Ce(e){if(e&&me(e)){var t=e.textContent;if(1===t.length&&ve(t[0]))return!0}return!1}function we(e){if(e){var t=e.childNodes;return ge(e)&&2===t.length&&he(t[0])&&Ce(t[1])}return!1}function ye(e,t,n,r){return e.substr(0,t)+r+e.substr(n,e.length-n)}function Se(e,t,n,r,o,i){var a,l,s,u,c,_="",f=e.childNodes,d=f.length;for(a=0;a<d;a++)l=f[a],ge(l)?_+=Se(l,t,n,r,o,i):me(l)?(s=t&&t.startContainer,u=t&&t.endContainer,c=l.textContent,l===s||l===u?s!==u?l===s?(_+=ye(c,n,c.length,o),i=!0):(_+=ye(c,0,r,""),i=!1):_+=ye(c,n,r,o):i||(_+=c)):he(l)&&!i&&(_+="\n");return _}function xe(e,t,n,r,o){var i,a,l=String.fromCharCode(de(o));return le(e)?(i=W.getSelection(),i.rangeCount>0&&(a=i.getRangeAt(0),me(a.startContainer))?Se(e,a,n,r,l):a&&a.startOffset===a.endOffset?t+l:l):ye(t,n,r,l)}function be(e,t){for(var n=e&&e.previousSibling;n;){if(t(n))return n;n=n.lastChild}return G}function Te(e,t){var n,r,o,i,a,l=e.childNodes.length;if(!ve(e.textContent[0])||0!==t&&1!==t)if(0===t)r=e,e===e.parentNode.firstChild&&(r=e.parentNode),o=be(r,we),n=o&&o.lastChild;else{if(pe(e))return 1===l&&1===t?n=e.firstChild.firstChild.lastChild:l>1&&t===l&&(n=e.lastChild),Ce(n)?{zeroWidthCharNode:n,previousTextNode:n.previousSibling.previousSibling}:we(n)?{zeroWidthCharNode:n,previousTextNode:be(r,me)}:G;!ge(e)||t!==l&&t!==l-1||(we(e)?n=e:we(e.lastChild)&&(n=e.lastChild))}else n=e;return n?(ge(n)?r=n:me(n)&&(i=n.previousSibling,a=n.parentNode,r=i===a.firstChild?a:i),{zeroWidthCharNode:n,previousTextNode:be(r,me)}):G}function Re(e,t,n){if(1===t&&ge(n.firstChild)&&ge(n.firstChild.firstChild)){var r=n.firstChild.firstChild.lastChild,o;if(e===n)return o=r.textContent,1===o.length&&o[0]!==Q&&he(r.previousSibling);if(r===e||he(r)&&e===r.previousSibling)return o=e.textContent,1===o.length&&o[0]!==Q&&he(e.previousSibling)}return!1}function Ae(e,t){var n,r,o,i,a,l,s,f,h,g,p=W.getSelection();if(!(p.rangeCount<=0)){if(n=p.anchorNode,r=p.anchorOffset,o=e.target,c&&!_&&t&&Re(n,r,o))return i=parseFloat(u.version)<10?Se(o):o.innerText,a=i.slice(0,-1),o.innerHTML=a.replace(/\r/g,"").replace(/\n/g,"<br>\u200b"),p.selectAllChildren(o),p.rangeCount>0&&p.collapseToEnd(),void d(e);if(l=Te(n,r)){if(s=l.zeroWidthCharNode,f=l.previousTextNode,t)if(ge(s))s.parentNode.removeChild(s);else{if(s.parentNode.removeChild(s.previousSibling),he(f))return void d(e);h=p.getRangeAt(0),h.setStart(s,0),h.setEnd(s,1),h.deleteContents()}g=z.createRange(),g.setStartAfter(f),g.setEndAfter(f),g.collapse(!1),p.removeAllRanges(),p.addRange(g),d(e)}}}function Ie(e){for(var t,n=e;n;){if(t=n.parentNode,n!==t.lastChild)return n.nextSibling;n=t}return G}function Me(e){var t,n,r=e.anchorNode;if(e.anchorOffset===r.textContent.length){if(t=Ie(r),ge(t)&&ve(t.textContent[0])){for(;ge(t.firstChild);)t=t.firstChild;n=t.childNodes[1]}else he(t)&&ve(t.nextSibling.textContent[0])&&(n=t.nextSibling);return{node:n,offset:1}}return G}function Ee(e,t){var n,r,o,i,a,l=W.getSelection();l.rangeCount<=0||(n=Me(l))&&(r=n.node,o=n.offset,t?(i=l.getRangeAt(0),i.setStart(r,0),i.setEnd(r,1),i.deleteContents(),r.parentNode.removeChild(r.previousSibling)):(a=z.createRange(),a.setStart(r,o),a.setEnd(r,o),a.collapse(!1),l.removeAllRanges(),l.addRange(a)),d(e))}function Fe(e){var t=Ve(e);return t&&t.indexOf(" ")>=0&&(t=S(t," ",q)),t}function De(e,t){var n,r,o,i,l,s,u,c,_,f,h=e.srcElement||e.target;h&&"gcEditingInput"===h.getAttribute(R)&&13===e.keyCode&&(e.ctrlKey||e.altKey)&&(n=a._getActiveElement(),n instanceof $&&(r=n.getCellType(n._activeRowIndex,n._activeColIndex))&&(le(h)?(o=W.getSelection(),o.rangeCount>0&&(i=o.getRangeAt(0),l=z.createElement("span"),l.innerHTML="<br/>"+Q,i.insertNode(l),s=z.createRange(),s.setStartAfter(l),s.setEndAfter(l),s.collapse(!1),o.removeAllRanges(),o.addRange(s))):(u=h.selectionStart,c=h.value,_=c.substr(0,u),f=c.substr(u,c.length-u),h.value=_+"\n"+f,h.selectionStart=u+1,h.selectionEnd=u+1),r.updateEditor(n._editor,G,G,t)),d(e))}function Ne(e){var t,n=e;return n?n.indexOf(Q)<0&&n.indexOf("\n")<0?n:(t=e.split("\n"),t.forEach(function(e,t,n){ve(e[0])&&(n[t]=e.substr(1))}),t.join("\n")):n}function Ve(e){var t,n=e;return n?(t=n.length,t>0&&"\n"===n[t-1]&&(n+=Q),n):n}function Oe(e){var t,n,r,o,i,a,l=W.getSelection(),s=!1,u=0,c=0;if(l.rangeCount>0)return t=l.getRangeAt(0),n=_e(e),r=fe(e),o=t.startContainer,i=t.endContainer,pe(o)&&(s=!0,u=n),pe(i)&&(c=r),a=He(e,n,r,o,i,s,u,c),a.content}function He(e,t,n,r,o,i,a,l){var s,u,c,_,f,d,h;if(r===o&&!i)return{content:Ne(r.textContent.slice(t,n))};for(s="",u=a,f=e.childNodes,d=l||f.length,u;u<d;u++)if(h=f[u],ge(h)){if(c=He(h,t,n,r,o,i,0,0),s+=c.content,c.startFlag&&(i=!0),c.endFlag){_=!0;break}}else if(me(h)&&h===r)s+=h.textContent.slice(t,h.textContent.length),i=!0;else{if(me(h)&&h===o){s+=h.textContent.slice(0,n),_=!0;break}i&&(he(h)?s+="\n":s+=h.innerText||h.textContent)}return{content:Ne(s),startFlag:i,endFlag:_}}function Pe(e,t){var n,r=e.length,o=[];for(n=0;n<r;n++)o.push(C(e[n],t));return o}function Le(e){var t,n=e.length,r=0;for(t=0;t<n;t++)r+=e[t];return r}function ke(e,t,n,r){var o,i,a=0,l=n;for(o=0;o<e.length;o++)f&&(l=r[o]),e[o]>t?(i=j(e[o]/t),a+=l*i):a+=l;return a}function Be(e,t,n){var r=se(e);return r&&"="===r[0]||""===r&&"="===t[0]||0===n&&"="===t[0]}t.EditorType={textarea:0,editableDiv:1},ee.inherit(We,w);function We(e){w.call(this),this.allowOverflow=!0,this.typeName="1",this.editorType=r(e)?1:e}ee.extend(We.prototype,{getText:function(e,t){return e},paintValue:function(e,t,n,r,o,i,a,l){var s,u,c,_,d,h=this;if(t=h.getText(t,l),s={},l.quotePrefix=a.quotePrefix,u=h.format(t,a.formatter||a._autoFormatter,s,l),c=a.labelOptions,_=a.watermark,d=!c||0!==c.visibility,_&&!u&&d)return void h.paintText(e,_,n,r,o,i,a,l,_,s,U);(u||s.content&&s.content.length)&&(1===a.vAlign&&f&&r--,h.paintText(e,t,n,r,o,i,a,l,u,s))},createEditorElement:function(e,t){var n,r,o=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,i=p(o)+1e3;return ee(t).css("z-index",i),n=ae(this.editorType),n.css({font:"normal 11pt calibri",outline:A,resize:A,border:A,padding:"1px","vertical-align":"top","min-height":"0px","box-sizing":"content-box"}).css(N,O).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(V,D).attr(R,"gcEditingInput"),u.safari&&n.css("-webkit-user-select","auto"),r=le(n[0]),r&&(n.css("display","table-cell"),n.css(k,O)),n[0]},getEditorValue:function(e,t){var n,o;return e&&(n=se(e),!r(n)&&n.length>0)?(o=Ne(n),o=o.replace(/\r\n?/g,"\n"),o.indexOf(q)<0?o:S(o,q," ")):G},setEditorValue:function(e,t,n){var o,i;e&&(o=n&&n.sheet&&n.sheet._startEditByKeydown,i=Fe(t),c?o||ue(e,r(i)?"":i):ue(e,o?"":i))},selectAll:function(e,t){if(e&&e.select)e.select();else{W.getSelection().selectAllChildren(e)}},focus:function(e,t){this.isImeAware()&&e?(e.focus(),ce(e)):e.parentNode.parentNode.focus()},_formatEditorValue:function(e,t,n,r){var o=e&&r&&r.sheet,i={},a=g(t,n,o,i);return e._editingFormatter=i.formatter||X,a},activateEditor:function(e,t,n,o){var a,l,s,u,f=o&&o.sheet;f&&(a=this,(l=e)&&(s=ee(l),u=le(l),a._editingElement=l,s.bind("keydown"+I,function(e){var r,i;try{r=e.keyCode,u&&(8===r?Ae(e,!0):46===r?Ee(e,!0):37===r?Ae(e,!1):39===r&&Ee(e,!1)),i=229===r||0===r,i||a._isImeInputing||a._updateEditorImp(l,t,n,e,o,!0),De(e,o)}catch(e){}}),s.bind("keyup"+I,function(e){var r=e.keyCode,s=e.ctrlKey,c=e.altKey;229===r||0===r||a._isImeInputing||(46!==r&&8!==r&&(90!==r&&89!==r||!s||c)||(u&&"\n"===l.innerText&&ee(l).empty(),a._updateEditorImp(l,t,n,e,o)),(13!==r&&9!==r&&27!==r||s||c)&&f._trigger(i,{sheet:f,sheetName:f._name,row:f._activeRowIndex,col:f._activeColIndex,editingText:a.getEditorValue(l,o)}))}),s.bind("mousedown"+I,function(){1===f._editorStatus&&(f._editorStatus=2,f._raiseEditorStatusChanged(1,2))}),s.bind("compositionstart"+I,function(){a._isImeInputing=!0,a._oldValueBeforeImeInputting=se(l)}),s.bind("compositionupdate"+I,function(e){a._updateEditorImp(l,t,n,e||G,o,!0)}),s.bind("compositionend"+I,function(e){var r,s,u,c;a._updateEditorImp(l,t,n,e||G,o),a._isImeInputing=!1,r=e.keyCode,s=e.ctrlKey,u=e.altKey,c=a.getEditorValue(l,o)||"",a._oldValueBeforeImeInputting!==c&&(r===X||13!==r&&9!==r||s||u)&&f._trigger(i,{sheet:f,sheetName:f._name,row:f._activeRowIndex,col:f._activeColIndex,editingText:c})}),u&&(s.bind("copy"+I,function(e){var t=W.clipboardData,n=e.clipboardData,o=Oe(e.currentTarget);r(o)||(t&&t.setData?(t.setData("text",o),d(e)):n&&n.setData&&(n.setData("text/plain",o),d(e)))}),s.bind("paste"+I,function(e){var r,i,s,f,h,g,p,m=!1;if(u)try{c&&!_&&W.clipboardData&&W.clipboardData.getData?r=W.clipboardData.getData("text"):e.clipboardData&&e.clipboardData.getData&&(r=e.clipboardData.getData("text/plain")),r=r.replace(/\r\n?/g,"\n"),r=Fe(r),i=W.getSelection(),i.rangeCount>0&&(s=i.getRangeAt(0),f=s.startOffset,h=s.endOffset,f!==h&&s.deleteContents(),Be(l,r,f)||(g=z.createElement("span"),g.innerText=r,s.insertNode(g),p=document.createRange(),p.setStartAfter(g),p.setEndAfter(g),p.collapse(!1),i.removeAllRanges(),i.addRange(p),m=!0))}catch(e){}a._pasteInputSizingToken=setTimeout(function(){a._updateEditorImp(l,t,n,e,o),a._pasteInputSizingToken&&(clearTimeout(a._pasteInputSizingToken),delete a._pasteInputSizingToken)},10),m&&d(e)}))))},deactivateEditor:function(e,t){e&&ee(e).unbind(I),this._editingElement=G},getEditingElement:function(){return this._editingElement},_updateEditorImp:function(e,t,n,i,a,l){var s,u,_,d,g,p,m,C,w,S,R,I,W,z,U,Y,X,q,Q,$,te,ne,re,oe,ie,ae,ue,ce,de,he,ge,pe,me,ve,Ce=a&&a.sheet,we=this,ye=e;if(ye&&Ce&&(s=ee(ye),u=Ce._render,Ce.isEditing())){if(_=le(ye),d=G,g=x,m=y._getPositionOffset,C=0,w=0,S=0,R=0,t&&(C=m(t,0),w=m(t,1),S=m(t,2),R=m(t,3),d=h(t.hAlign,e._originalValue),1===d?g=T:2===d&&(g=b),s.css(F,g),t.backColor&&s.css("background-color",t.backColor),t.foreColor&&s.css("color",t.foreColor),p=t.font||u._getDefaultFont(),p&&(Ce._zoomFactor>1&&(p=u._getZoomFont(p)),s.css("font",p)),t.textDecoration&&we._setTextDecoration(s,t.textDecoration)),I=J(s.css("padding-left"),10)+J(s.css("padding-right"),10),W=J(s.css("padding-top"),10)+J(s.css("padding-bottom"),10),n&&(z=Ce._getSheetLayout(),U=n.width,n.x+n.width>z.width&&(U=z.width-n.x),s.css(M,U-I).css(E,n.height-W),r(d)||0===d?ye.maxWidth=z.width-n.x-I-w:1===d?ye.maxWidth=2*Z(0,K(z.width-n.x-n.width-I,n.x-z._rowHeaderWidth-I))+n.width:2===d&&(ye.maxWidth=n.x+n.width-z._rowHeaderWidth-I-w),s.css("max-width",ye.maxWidth+"px"),ye.maxHeight=z.height-n.y-W-S,ye.minWidth=J(ye.style.width,10),ye.minHeight=J(ye.style.height,10)),Y=_e(ye),X=fe(ye),q=se(ye),l=l&&i&&i.keyCode&&Ce._eventHandler._allowEnterEditing(i)&&0===Y&&X===q.length,l=l||Ce._startEditByKeydown,Q=l?"":q,p=ye.style.font,p||(p=u._getZoomFont(u._getDefaultFont())),$=v(p),!l&&i&&(Ce._eventHandler._allowEnterEditing(i)&&8!==i.keyCode&&(Q=xe(ye,Q,Y,X,i)),we._isImeInputing&&(Q=c?q:we._oldValueBeforeImeInputting+i.data)),te=[],te=t&&t.wordWrap?o._getWrapInfo(Q,J(ye.style.width)-I,p):Q.split(/\r\n|\r|\n/),oe=te.length,ye.minWidth=K(ye.minWidth,ye.maxWidth),ye.minHeight=K(ye.minHeight,ye.maxHeight),t&&t.wordWrap||oe>0){if(f?(ae=Pe(te,p),ie=Le(ae)):ie=oe*$,t&&t.wordWrap)s.css(N,H).css(V,D).css("max-width",ye.style.width);else{for(ue=0,ce=[],ne=0;ne<oe;ne++)re=j(Ce._getStringWidth(te[ne],p)),ce.push(re),ue=Z(ue,re);de=s.css(N),he=J(ye.style.width),t||de!==H?ue<=ye.minWidth?(s.css(M,ye.minWidth).css(N,O).css(V,D),_&&s.css(k,O)):ue>ye.minWidth&&ue<=ye.maxWidth?(s.css(M,ue).css(N,O).css(V,D),_&&s.css(k,O)):ue>ye.maxWidth&&(s.css(M,ye.maxWidth-2).css(N,H).css(V,D),ie=ke(ce,ye.maxWidth,$,ae)):ue>he&&(ie=ke(ce,he,$,ae))}ie<=ye.minHeight?s.css(E,ye.minHeight).css(B,A):ie>ye.minHeight&&ie<=ye.maxHeight?s.css(E,ie).css(B,A):ie>ye.maxHeight&&s.css(E,ye.maxHeight-1).css(P,L).css(B,x)}d=s.css(F),ge=s.width()-ye.minWidth,r(d)||d===x||(d===T?s.css(x,ye.originalLeft-ge/2):d===b&&s.css(x,ye.originalLeft-ge)),t&&_&&(pe=t.vAlign,1===pe?s.css("vertical-align","middle"):2===pe&&s.css("vertical-align","bottom")),me=J(ye.style.height)+W+C+S,ve=I+R+w,s.css(P)===L?we.updateEditorContainer(ye,{width:ye.offsetWidth+ve,height:l?0:me},t):we.updateEditorContainer(ye,{width:J(ye.style.width)+ve,height:me},t)}},updateEditor:function(e,t,n,r){if(this._updateEditorImp(e,t,n,G,r),c&&e){var o=ee(e),i=o.width();o.width(i+1).width(i)}},updateImeMode:function(e,t,n){this.isImeAware()&&e&&y._setImeMode(e,t)},isReservedKey:function(e,t){var n=e.srcElement||e.target,r=e.keyCode,o=e.ctrlKey,i=e.altKey,a=e.metaKey;return!!(n&&t&&t.isEditing&&"gcEditingInput"===n.getAttribute(R))&&(13===r&&(o&&!e.shiftKey||i)||90===r&&o&&!i||89===r&&o&&!i||67===r&&(o||a)&&!i||88===r&&(o||a)&&!i)},isImeAware:function(e){return!0},toJSON:function(){var e,t={},n=this;for(e in n)n.hasOwnProperty(e)&&"_editingElement"!==e&&(t[e]=n[e]);return t}}),t.Text=We,t._typeDict[1]=We,e.exports=oe}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c=n(4).GC$.inherit,_=n(3),f=n(11)._StyleHelper,d=n(13).CellTypes,h=n(5),g=n(1);g.CellTypes||(g.CellTypes={}),t=g.CellTypes,r=_._ThemeStyleHelper,o=_._WordWrapHelper,i=_._util._getLinearGradientColors,a=d.Base,l=d.Context,s="none",u=Math.floor;function p(e,t){return e=e||0,r._getVisualStateThemeStyle(e,"gc-"+t+"-"+r._getString(e))}function m(e,t,n,r,o,i){var a=new Image,l=i;l=l.replace('url("',""),l=l.replace('")',""),a.src=l,e.drawImage(a,t,n,r,o)}function v(e,t,n,r,o,a,u,c,_){var f,d,g,p,v,C,w;if(!h._Types._isNullOrUndefined(c)){if(e.save(),e.beginPath(),0===c&&a.backColor)f=a.backColor,e.fillStyle!==f&&(e.fillStyle=f),e.fillRect(t+1,n+1,r-1,o-1);else try{if(d=_&&_.backgroundColor,(g=_&&_.backgroundImage)&&-1!==g.indexOf("linear-gradient")){for(p=i(g),f=e.createLinearGradient(t+r/2,n,t+r/2,n+o),v=0,C=p.length;v<C;v++)w=p[v],f.addColorStop(w.point,w.color);e.fillStyle=f,e.fillRect(t+1,n+1,r-1,o-1)}else d?(e.fillStyle=d,e.fillRect(t+1,n+1,r-1,o-1)):g&&g!==s&&m(e,t+1,n+1,r-1,o-1,g)}catch(e){}l._paintBackgroundImage(e,t,n,r,o,a.backgroundImage,a.backgroundImageLayout,u.imageLoader),e.restore()}}function C(e,t,n,r,o,i,a,s,u,c,f){var d,h,g;t&&(d=u.visualState||0,h=p(d,c),v(t,r,o,i,a,s,u,d,h),l._paintHeaderCellGridline(t,r,o,i,a,s,c,h,f,u.needTopGridline,u.needLeftGridline),g=new _.Rect(r,o,i,a),e._paintLabel&&(e._paintLabel(t,g,s,u),g=e._getContentRect(g,s)),g.width>0&&g.height>0&&e.paintContent(t,n,g.x,g.y,g.width,g.height,s,u))}function w(e,t,n,r,o,i){var a,l={font:t,fillStyle:n},s=r.sheet;return 0!==r.visualState&&parseInt(i.zIndex)>2007&&s._isSelected(r.row,r.col,o)&&(a=s._isAllSelected(r.row,r.col,o)?e(r.visualState,"gc-columnHeader-selected"):e(r.visualState,"gc-columnHeader-highlight"),l.fillStyle=a.color),l}function y(e,t,n,r,i,a,l,s,c,f,d){var h,g,p,m,v,C,y,S,x,b,T,R,A,I,M,E,F,D,N,V,O,H,P,L,k,B,W,z,U,Y,G,X,j={},K=e.format(n,s.formatter,j);if(K){if(t.save(),t.beginPath(),h=c.sheet,g=h.rowFilter&&h.rowFilter(),p=!!(g&&g._isFilterHeader(c.row,c.col,f)&&g.filterButtonVisible(c.col)),p&&(a-=h._getFilterButtonRect(new _.Rect(r,i,a,l),f).width),m={x:r,y:i,width:a,height:l},v=s.foreColor,v||(v=d.color),v&&t.fillStyle!==v&&(t.fillStyle=v),C=w(e.getThemeStyle,s.font||t.font,t.fillStyle,c,f,d),t.font=C.font,t.fillStyle=C.fillStyle,y=0,S=s.textIndent,S>0&&(y=8*S),x=s.hAlign,b=s.vAlign,T="left",R=2,R+=y,1===x?(R=a/2,T="center"):2===x&&(R=a-1,R-=y,T="right"),t.textAlign!==T&&(t.textAlign=T),A=0,I="alphabetic",M=2,E=s.wordWrap,F=c.lineHeight,D=c.fontInfo.fontSize,N=[],V=0,E&&(O=a-3-y,O-=1,N=o._getWrapInfo(K,O,C.font),(V=N.length)>1&&0!==b&&(A=(V-1)*F)),H=D>8?u((D-8)/5+2):1,P=F/2-D/2+H-1,M+=F-P,1===b?M=(l-A)/2+F/2-P:2===b&&(M=l-A-2-P),t.textBaseline!==I&&(t.textBaseline=I),L=s.textDecoration,k=m.x,B=m.y,W=m.width,z=m.height,s.wordWrap)if(t.rect(k,B,W,z),t.clip(),t.beginPath(),U=i+M,V>1)for(Y=0;Y<V;Y++)t.fillText(N[Y],r+R,U),L&&(G=t.measureText(N[Y]).width,e._renderTextDecoration(t,L,r+R,U,G,D,H)),U+=F;else e._renderCellTextNormal(t,K,j,r+R,i+M,x,W,y,L,H,D);else X=t.measureText(K).width,(X>W||F>z)&&(t.rect(k,B,W,z),t.clip(),t.beginPath()),e._renderCellTextNormal(t,K,j,r+R,i+M,x,W,y,L,H,D);t.restore()}}c(S,a);function S(){a.call(this),this.typeName="2"}S.prototype.paint=function(e,t,n,r,o,i,a,l){C(this,e,t,n,r,o,i,a,l,"columnHeader",1)},S.prototype.paintContent=function(e,t,n,r,o,i,a,l){y(this,e,t,n,r,o,i,a,l,1,p(l.visualState,"columnHeader"))},t.ColumnHeader=S,t._typeDict[2]=S,c(x,a);function x(){a.call(this),this.typeName="3"}x.prototype.paint=function(e,t,n,r,o,i,a,l){C(this,e,t,n,r,o,i,a,l,"rowHeader",2)},x.prototype.paintContent=function(e,t,n,r,o,i,a,l){y(this,e,t,n,r,o,i,a,l,2,p(l.visualState,"rowHeader"))},t.RowHeader=x,t._typeDict[3]=x,c(b,a);function b(){a.call(this),this.typeName="4"}b.prototype.paint=function(e,t,n,o,a,l,u,c){var _,f,d,h,g,p,v,C,w,y,S,x,b,T,R,A,I;if(e){e.save(),e.rect(n,o,a,l),e.clip(),e.beginPath(),_=this,f=c.visualState||0;try{d=_.getThemeStyle(c.visualState,"gc-corner-"+r._getString(f)),h=d&&d.backgroundColor,g=d&&d.backgroundImage,h?(e.fillStyle=h,e.fillRect(n,o,a,l)):g&&g!==s&&m(e,n,o,a,l,g)}catch(e){}if(p=_.getThemeStyle(4,"gc-corner-triangle-"+r._getString(f)),v=p&&p.backgroundImage,C=p&&p.backgroundColor,w=e.createLinearGradient(n+a/2,o,n+a/2,o+l),v&&-1!==v.indexOf("linear-gradient")){for(y=i(v),S=0,x=y.length;S<x;S++)b=y[S],w.addColorStop(b.point,b.color);e.fillStyle=w}else C&&(w.addColorStop(.125,"#f6fafb"),w.addColorStop(1,C),e.fillStyle=w);T=e.createLinearGradient(n+a,o+1,n+a,o+l-2),T.addColorStop(0,p.borderLeftColor),T.addColorStop(1,p.borderRightColor),e.beginPath(),e.strokeStyle=T,e.moveTo(n+a-.5,o),e.lineTo(n+a-.5,o+l),e.stroke(),c.needLeftGridline&&(e.beginPath(),e.strokeStyle=p.borderLeftColor,e.moveTo(n+.5,o),e.lineTo(n+.5,o+l),e.stroke()),R=e.createLinearGradient(n,o,n+a-2,o),R.addColorStop(0,p.borderTopColor),R.addColorStop(1,p.borderBottomColor),e.beginPath(),e.strokeStyle=R,e.moveTo(n,o+l-.5),e.lineTo(n+a,o+l-.5),e.stroke(),c.needTopGridline&&(e.beginPath(),e.strokeStyle=p.borderTopColor,e.moveTo(n,o+.5),e.lineTo(n+a,o+.5),e.stroke()),e.beginPath(),A=3,I=l,a<l&&(I=a),e.moveTo(n+a-I+A,o+l-A),e.lineTo(n+a-A,o+l-A),e.lineTo(n+a-A,o+l-I+A),e.fill(),e.restore()}},t.Corner=b,t._typeDict[4]=b,e.exports=g}()},function(e,t){!function(){"use strict";e.exports={Exp_NotSupported:"NotSupportException",Exp_PasteExtentIsNull:"pasteExtent is null",Exp_InvalidPastedArea:"The pasted area should have the same size as the copy or cut area.",Exp_ChangePartOfArray:"Cannot change part of an array.",Exp_InvalidAndSpace:"Invalid {0}: {1} (must be between {2} and {3}).",Exp_SrcIsNull:"The argument 'src' is null",Exp_DestIsNull:"The argument 'dest' is null",Exp_InvalidCustomFunction:"invalid custom function",Exp_InvalidCustomName:"invalid custom name",Exp_IndexOutOfRange:"Index is out of range!",Exp_InvalidRange:"Invalid range",Exp_ArgumentOutOfRange:"ArgumentOutOfRange",Exp_PasteSourceCellsLocked:"Source sheet's cells are locked.",Exp_InvalidCopyPasteSize:"The copy and paste areas are not the same size.",Exp_PasteDestinationCellsLocked:"The cell you are trying to change is protected and therefore read-only.",Exp_PasteChangeMergeCell:"Cannot change part of a merged cell.",Tip_Row:"Row: ",Tip_Column:"Column: ",Tip_Height:"Height: {0} pixels",Tip_Width:"Width: {0} pixels",NewTab:"New...",Exp_EmptyNamedStyle:"The name of named style cannot be empty or null",Exp_SheetNameInvalid:"The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",Exp_ArrayFromulaSpan:"Array formulas are not valid in merged cells.",Exp_DestSheetIsNull:"destSheet is null",Exp_SheetIsNull:"sheet is null.",Exp_OverlappingSpans:"This operation will cause overlapping spans.",NeedCanvasSupport:"You need a browser which full supports HTML5 Canvas to run SpreadJS",lsru:["","6465706c6f796d656e74"],lsde:["","64657369676e6572"],ls1:["","506f776572656420627920477261706543697479205370726561642e5368656574732e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],ls2:["","506f776572656420627920477261706543697479205370726561642e5368656574732e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],ls3:["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561642e5368656574732e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],ls4:["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],ls5:["","506f776572656420627920477261706543697479205370726561642e5368656574732e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],ls6:["","506f776572656420627920477261706543697479205370726561642e536865657473204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"]}}()}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.CellTypes=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";n(1),n(4),n(5),e.exports=n(6)}()},function(e,t,n){!function(){"use strict";var t,r,o,i=n(2),a=n(3),l=i._util._createElement,s=a._Types._isNullOrUndefined,u=i._util,c=u._getFontHeight,_=u._cancelDefault,f=i.CellTypes,d=f.Context,h=f.Base,g=i.GC$,p=g.each,m=null,v=Math.max,C=parseInt,w="position",y="absolute",S="font",x="left",b="right",T="top",R="alphabetic",A=".gcEditingInput",I="background-color",M="white",E="green",F="div";function D(e){delete e._isFirstMouseUp;var t=e._mouseupToken;t&&(clearTimeout(t),delete e._mouseupToken)}f.CheckBoxTextAlign={top:0,bottom:1,left:2,right:3},g.inherit(N,h),t=12,r={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!1};function N(){var e=this;h.call(e),e.typeName="5",p(r,function(t,n){e["_"+t]=n})}function V(e){return 5*e}function O(e,n,r,o,i){var a=V(i),l=n.hAlign,s=r.x-1,u=r.width+1,c=0,_=0;return 0===e||1===e?(_=s+a,1===l?_=s+u/2-t/2:2===l&&(_=s+u-a-t)):2===e?(c=t+o,_=s+a+o,1===l?_=s+u/2-c/2+o:2===l&&(_=s+u-a-c+o)):(c=t+o,_=s+a,1===l?_=s+u/2-c/2:2===l&&(_=s+u-a-c)),_-s}function H(e,n,r,o,i){var a=V(i),l=n.vAlign,s=r.y-1,u=r.height+1,c=0,_=0;return 0===e?(c=t+o,_=s+a+o,1===l?_=s+u/2-c/2+o:2===l&&(_=s+u-a-c+o)):1===e?(c=t+o,_=s+a,1===l?_=s+u/2-c/2:2===l&&(_=s+u-a-c)):(_=s+a,1===l?_=s+u/2-t/2:2===l&&(_=s+u-a-t)),_-s}function P(e,t,n,r,o){var i=t.getValue(n,r,o),a=e._getNextState(i),l={cmd:"editCell",sheetName:t.name(),row:n,col:r,newValue:a,autoFormat:!0};t._commandManager().execute(l),e._triggerButtonClicked(t,n,r,o)}function L(e,t,n,r,o){var i=o&&o.sheet,a=e.getEditorValue(t,o);e.setEditorValue(t,a,o),e.updateEditor(t,n,r,o),e._triggerButtonClicked(i,i._activeRowIndex,i._activeColIndex,o.sheetArea)}o={paintValue:function(e,n,r,o,a,l,u,_){var f,d,h,g,p,m,v,w,y,S,T,A,I,F,D,N,V,P,L,k;e&&(e.save(),e.rect(r,o,a,l),e.clip(),e.beginPath(),f=u.hAlign,d=u.font,h=u.foreColor,g=this,p=g._textAlign,m=g.getText(n,_),v=0,w=0,y=_.sheet,y&&(v=y._getStringWidthByCanvas(m,d),w=c(d),m&&(S=m.split(/\r\n|\r|\n/),w*=S.length)),T=t/2,A=new i.Rect(++r,++o,--a,--l),I=C(""+(r+O(p,u,A,v,y._zoomFactor))),F=C(""+(o+H(p,u,A,w,y._zoomFactor))),D=x,N=I+1,1===f?(D="center",N+=T):2===f&&(D=b,N+=2*T),d&&e.font!==d&&(e.font=d),h&&(e.fillStyle=h),V=u.textDecoration,P=_.fontInfo.fontSize,L=P>8?Math.floor((P-8)/5+2):1,k=w/2-P/2+L-1,e.textBaseline!==R&&(e.textBaseline=R),2===p?(e.textAlign=b,e.fillText(m,I+1-2,F+T+w/2-k),V&&g._renderTextDecoration(e,V,I+1-2,F+T+w/2-k,v,P,L)):0===p&&(e.textAlign=D,e.fillText(m,N,F-2-k),
V&&g._renderTextDecoration(e,V,N,F-2-k,v,w)),e.save(),e.strokeStyle="black",e.strokeRect(I+.5,F+.5,2*T+.05,2*T+.05),e.fillStyle=M,e.fillRect(I+1,F+1,2*T-1,2*T-1),g._isThreeState&&s(n)?(e.beginPath(),e.fillStyle=E,e.rect(I+3,F+3,2*(T-2.5),2*(T-2.5)),e.fill()):!0==!!n&&(e.beginPath(),e.lineWidth=2.5,e.moveTo(I+3,F+T),e.lineTo(I+T,F+2*T-3.5),e.lineTo(I+2*T-1.5,F+3),e.stroke()),e.restore(),h&&(e.fillStyle=h),3===p?(e.textAlign=x,e.fillText(m,I+1+2*T+2,F+T+w/2-k),V&&g._renderTextDecoration(e,V,I+1+2*T+2,F+T+w/2-k,v,P,L)):1===p&&(e.textAlign=D,e.fillText(m,N,F+2*T+2+w-k),V&&g._renderTextDecoration(e,V,N,F+2*T+2+w-k,v,P,L)),e.restore())},getText:function(e,t){return this._getDisplayText(e)},focus:function(e,t){e&&e.parentNode.focus()},createEditorElement:function(e,n){var r,o,i,a,s=e&&e.sheet&&e.sheet.parent&&e.sheet.parent._host,c=u._getPreferredZIndex(s)+1e3;return g(n).css("z-index",c).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),r=g(n.firstChild),r.css("overflow","hidden"),o=g(l("input")),o.attr("type","checkbox"),r.append(o),i=g(l("span")),i.css(w,y).css(S,"normal 11pt calibri").css("cursor","default").css("white-space","nowrap"),r.append(i),a=g(l(F)),a.css(w,y).css(I,E).css("width",2*(t/2-2.5)).css("height",2*(t/2-2.5)),r.append(a),m},_getNextState:function(e){var t;return t=this._isThreeState?!s(e)&&(!0!=!!e||m):!e},setEditorValue:function(e,t,n){var r,o,i,a,l,u,c,_;e&&(r=e.parentNode.children,o=r[0],i=r[1],a=r[2],o&&i&&a&&(l=this,u=n&&n.sheet,c=u&&u._startEditByKeydown,c||(t=l._getNextState(t)),l._isThreeState?s(t)?(_=!1,g(a).show()):(_=!!t,g(a).hide()):_=!!t,o.checked=_,g(i).text(l._getDisplayText(t))))},getEditorValue:function(e,t){if(e){var n=e.parentNode.children,r=n[0],o=n[1],i=n[2];if(r&&o&&i&&(!this._isThreeState||!g(i).isVisible()))return r.checked}return m},_triggerButtonClicked:function(e,t,n,r){var o=e.parent;o&&o._triggerButtonClicked(e,t,n,r)},activateEditor:function(e,t,n,r){var o,i,a=r&&r.sheet;e&&a&&(o=g(e.parentNode.parentNode),i=this,o.bind("mousedown"+A,function(e){_(e)}),o.bind("mouseup"+A,function(){L(i,e,t,n,r)}),o.bind("keydown"+A,function(e){var t=e.keyCode;if(!e.ctrlKey&&!e.shiftKey&&!e.altKey){if(32===t)return i._isKeyDown=!0,_(e),!1;8===t&&_(e)}}),o.bind("keyup"+A,function(o){!i._isKeyDown||32!==o.keyCode||o.ctrlKey||o.shiftKey||o.altKey||(i._isKeyDown=!1,L(i,e,t,n,r))}),g(e).bind("click",function(e){_(e)}))},updateEditor:function(e,n,r,o){var i,a,l,s,u,_,f,d,h,p,m,v,C,w,y,b,R,A,I,M,E,F,D,N,V,P,L,k,B=o&&o.sheet;e&&B&&(i=B._render,a=e.parentNode,l=a.children,s=l[0],u=l[1],_=l[2],s&&u&&_&&(g(a).width(r.width).height(r.height),f=g(u),d=f.text(),h=n.foreColor,p=n.font,m=n.hAlign,v=n.textDecoration,h&&f.css("color",h),C=p||i._getDefaultFont(),B._zoomFactor>1&&(C=i._getZoomFont(C)),f.css(S,C),w=B._getStringWidth(d,C),y=c(C),d&&(b=d.split(/\r\n|\r|\n/),y*=b.length),R=this,A=R._textAlign,I=O(A,n,r,w,B._zoomFactor),M=H(A,n,r,y,B._zoomFactor),g(s).css("margin-left",I).css("margin-top",M),E=s.offsetLeft,F=s.offsetTop,D=s.offsetWidth,N=s.offsetHeight,V=0,P=0,0===A?(V=E,1===m?V=E+t/2-w/2:2===m&&(V=E+t-w),P=F-y):1===A?(V=E,1===m?V=E+t/2-w/2:2===m&&(V=E+t-w),P=F+N):2===A?(V=E-w-2,P=F+t/2-y/2):(V=E+D+2,P=F+t/2-y/2),f.css(x,V).css(T,P),R._isThreeState?(L=E+(D-_.offsetWidth)/2,k=F+(N-_.offsetHeight)/2,g(_).css(x,L).css(T,k).toggle().toggle()):g(_).hide(),v&&R._setTextDecoration(f,v)))},_getDisplayText:function(e){var t=this,n=t._caption;return t._isThreeState&&s(e)?t._textIndeterminate||n:!0==!!e?t._textTrue||n:t._textFalse||n},getHitInfo:function(e,t,n,r,o){if(o){var i=o.sheetArea;if(s(i)||3===i)return{x:e,y:t,row:o.row,col:o.col,cellRect:r,sheetArea:3,isReservedLocation:!0,sheet:o.sheet}}return m},processMouseDown:function(e){if(!e)return!1;e.isReservedLocation&&(this._isMouseDownReservedLocation=!0)},processMouseUp:function(e){var t,n,r,o,i=this,a=e&&e.sheet;if(a&&i._isMouseDownReservedLocation&&e.isReservedLocation){if(i._isMouseDownReservedLocation=!1,t=e.row,n=e.col,r=e.sheetArea,o=a._getModel(r).getNode(t,n,!0),!o._isFirstMouseUp)return P(i,a,t,n,r),o._isFirstMouseUp=!0,o._mouseupToken=setTimeout(function(){D(o)},250),!0;D(o)}return!1},processMouseLeave:function(e){if(!e)return!1;this._isMouseDownReservedLocation=!1},isReservedKey:function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},processKeyUp:function(e,t){return P(this,t.sheet,t.row,t.col,t.sheetArea),!0},getAutoFitWidth:function(e,n,r,o,i){var a=this,l=a._textAlign,s=d._getAutoFitWidth(e,a._getDisplayText(e),r,o,i);return 0===l||1===l?s=v(s,t):s+=t,s+5+2},getAutoFitHeight:function(e,n,r,o,i){var a=this,l=a._textAlign,s=d._getAutoFitHeight(e,a._getDisplayText(e),r,o,i);return 0===l||1===l?s+=t:s=v(s,t),s+5},_cancelDefaultKeydown:function(e){this.isReservedKey(e)&&_(e)},isImeAware:function(e){return!1},_cloneCellType:function(){},toJSON:function(){var e,t=this,n={typeName:t.typeName};return p(r,function(r,o){(e=t["_"+r])!==o&&(n[r]=e)}),n},fromJSON:function(e){var t=this;p(r,function(n){var r=e[n];s(r)||(t["_"+n]=r)})}},p(r,function(e){o[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),g.extend(N.prototype,o),f.CheckBox=N,f._typeDict[5]=N,e.exports=f}()},function(e,t){e.exports=GC.Spread.Sheets},function(e,t){e.exports=GC.Spread.Common},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l=n(2),s=n(3),u=l.Events.SelectionChanged,c=s._Types._isNullOrUndefined,_=l._util,f=_._cancelDefault,d=l.CellTypes,h=d.Context,g=d.Text,p=d.Base,m=l.GC$,v=m.each,C=null;function w(e){delete e._isFirstMouseUp;var t=e._mouseupToken;t&&(clearTimeout(t),delete e._mouseupToken)}m.inherit(y,p),t="#707070",r="#34B4E3",o=".buttonCellType",i={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:C,buttonState:0};function y(){var e=this;p.call(e),e.typeName="6",v(i,function(t,n){e["_"+t]=n})}a={paintValue:function(e,n,o,i,a,l,s,u){var c,_,f,d,h,p,m,v,C,w,y,S,x;e&&(c=this,_=c._marginLeft,f=c._marginTop,d=o+_,h=i+f,p=a-_-c._marginRight,m=l-f-c._marginBottom,v=d+p>o&&d<o+a&&h+m>i&&h<i+l,p-2>0&&m-2>0&&v&&(e.save(),(d<o||d+p>o+a||h<i||h+m>i+l)&&(e.rect(o,i,a,l),e.clip()),e.beginPath(),C=t,C&&e.strokeStyle!==C&&(e.strokeStyle=C),e.strokeRect(d+.5,h+.5,p-1,m-1),y=c._buttonState,S=c._text,2===y?w=r:(w=c._buttonBackColor)||(x=e.createLinearGradient(o+a/2,i,o+a/2,i+l),x.addColorStop(.125,"#F6FAFB"),x.addColorStop(1,"#D2DBEB"),w=x),e.fillStyle!==w&&(e.fillStyle=w),e.fillRect(d+1,h+1,p-2,m-2),e.restore(),S&&g.prototype.paintValue.call(c,e,S,d,h,p,m,s,u)))},getText:function(e,t){return e},_triggerButtonClicked:function(e,t,n,r){var o=e.parent;o&&o._triggerButtonClicked(e,t,n,r)},getHitInfo:function(e,t,n,r,o){var i,a,l,s,u,_,f=this;return o&&(i=o.sheetArea,(c(i)||3===i)&&r)?(a=r.x+f._marginLeft,l=r.x+r.width-f._marginRight,s=r.y+f._marginTop,u=r.y+r.height-f._marginBottom,_={x:e,y:t,row:o.row,col:o.col,cellRect:r,sheetArea:i,sheet:o.sheet},a<=e&&e<=l&&s<=t&&t<=u&&(_.isReservedLocation=!0),_):C},processMouseDown:function(e){var t=this,n=e&&e.sheet;return!(!n||!e.isReservedLocation||t._isMouseDownReservedLocation)&&(t._isMouseDownReservedLocation=!0,t._buttonState=2,n.repaint(e.cellRect),!0)},processMouseUp:function(e){var t,n,r,o,i=this,a=e&&e.sheet;if(i._isMouseDownReservedLocation&&a&&e.isReservedLocation){if(i._buttonState=0,a.repaint(e.cellRect),i._isMouseDownReservedLocation=!1,t=e.row,n=e.col,r=e.sheetArea,o=a._getModel(r).getNode(t,n,!0),!o._isFirstMouseUp)return i._triggerButtonClicked(a,t,n,r),o._isFirstMouseUp=!0,o._mouseupToken=setTimeout(function(){w(o)},250),!0;w(o)}return!1},processMouseLeave:function(e){var t=this,n=e&&e.sheet;n&&t._isMouseDownReservedLocation&&(t._buttonState=0,n.repaint(e.cellRect),t._isMouseDownReservedLocation=!1)},processKeyDown:function(e,t){var n,r=t.sheet,i=this;return!(!r||i._isKeyPressed)&&(n=r.getCellRect(t.row,t.col),i._buttonState=2,r.repaint(n),r._bind(u+o,function(){r._unbind(u+o),i._isKeyPressed=!1,i._buttonState=0,r.repaint(n)}),i._isKeyPressed=!0,!0)},processKeyUp:function(e,t){var n,r,i,a=t.sheet,l=this;return!(!a||!l._isKeyPressed)&&(n=t.row,r=t.col,i=a.getCellRect(n,r),l._buttonState=0,a.repaint(i),a._unbind(u+o),l._triggerButtonClicked(a,n,r,t.sheetArea),l._isKeyPressed=!1,!0)},isReservedKey:function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},getAutoFitWidth:function(e,t,n,r,o){var i=this;return h._getAutoFitWidth(e,i._text,n,r,o)+i._marginLeft+i._marginRight},getAutoFitHeight:function(e,t,n,r,o){var i=this;return h._getAutoFitHeight(e,i._text,n,r,o)+i._marginTop+i._marginBottom},_cancelDefaultKeydown:function(e){this.isReservedKey(e)&&f(e)},isImeAware:function(e){return!1},toJSON:function(){var e,t=this,n={typeName:t.typeName};return v(i,function(r,o){"buttonState"!==r&&(e=t["_"+r])!==o&&(n[r]=e)}),n},fromJSON:function(e){var t=this;v(i,function(n){var r=e[n];c(r)||(t["_"+n]=r)})},_createCellTypeElement:function(e){},_cloneCellType:function(){}},v(i,function(e){a[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),m.extend(y.prototype,a),d.Button=y,d._typeDict[6]=y,e.exports=d}()},function(e,t,n){!function(){"use strict";var t,r,o=n(2),i=n(3),a=o._util._createElement,l=i._Types._isNullOrUndefined,s=o._util,u=s._getFontHeight,c=s._browser,_=c.mozilla,f=o.CellTypes,d=f.Base,h=o.GC$,g=h.each,p=o._WordWrapHelper,m=null,v=Math.max,C=Math.min,w=Math.floor,y=window.open,S="position",x="absolute",b="margin",T="font",R="left",A="top",I="padding",M="border",E="box-sizing",F="background-color",D="content-box",N="default",V="white",O="div";function H(e,t){e.removeChild(t)}f.HyperLinkTargetType={blank:0,self:1,parent:2,top:3},h.inherit(P,d),t={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0};function P(){var e=this;d.call(e),e.typeName="8",e._id=P._getUniqueId(),g(t,function(t,n){e["_"+t]=n}),e._onAction=function(e){var t=e&&e.sheet,n=e.row,r=e.col,o=e.sheetArea,i=t.getValue(n,r,o),a=L(this._target);i&&y(i,a)}}function L(e){return["_blank","_self","_parent","_top"][e]}function k(e,t,n,r,o,i){var a=0,l=0,s=e.width,u=e.height;return a=i=i||0,1===r?a=(s-t)/2:2===r&&(a=s-t-i),1===o?l=(u-n)/2:2===o&&(l=u-n),{x:a,y:l}}function B(e,t,n,r){var o=z(e,n),i=o.width;return i+=!0==(1!==t&&!l(r))?r:0,o.width=i,o}function W(e,t,n,r,o,i){var a=z(e,r),l=k(o,a.width,a.height,t,n,i);return a.x=l.x,a.y=l.y,a}function z(e,t){var n=u(t);return{x:0,y:0,width:Math.max(0,p._measureText(e,t,!0)),height:e.split(/\r\n|\r|\n/).length*n}}function U(e,t,n,r,o,i){var a,s,u,c,_,f,d,h,g,m,v=o.sheet,w=v._render;if(l(n))return!1;if(i||(i=v.getValue(o.row,o.col,o.sheetArea),i=null===i||void 0===i?i:i+""),!i)return!1;for(i=i.replace(/\s+/g," "),a=n&&n.font?n.font:w._getDefaultFont(),v._zoomFactor>1&&(a=w._getZoomFont(a)),s=[i],u=Y(n),n.wordWrap&&(s=p._getWrapInfo(i,r.width-3-u,a),i=s.join("\r\n")),c=W(i,n.hAlign,n.vAlign,a,r,u),_=r.y+c.y,f=0;f<s.length;f++)if(d=W(s[f],n.hAlign,n.vAlign,a,r,u),h=r.x+d.x,g=C(h+d.width,r.x+r.width),m=_,_=C(m+d.height,r.y+r.height),h<=e&&e<g&&m<=t&&t<_)return!0;return!1}function Y(e){return 8*(e.textIndent||0)}function G(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,m,v,C=r&&r.sheet;if(C){if(i=C._render,a=t.font||i._getDefaultFont(),n>1&&(a=i._getZoomFont(a)),l=Y(t),t.wordWrap||o){if(t.wordWrap){if(s=r.row,u=r.col,c=r.sheetArea,_=0,f=C._getSpanModel(c).find(s,u)){if(f.row>=s&&f.rowCount<=1&&f.col>=u&&u===f.col&&(_=C._getZoomColumnWidth(u),f.colCount>1))for(d=u+1;d<u+f.colCount;d++)_+=C._getZoomColumnWidth(d)}else _=C._getZoomColumnWidth(u);if(h=p._getWrapInfo(e,_-3-l,a),o&&e.split(/\r\n|\r|\n/).length>1){for(g=0,m=0;m<h.length;m++)g=Math.max(g,B(h[m],t.hAlign,a,Y(t)).width);return g}o||(e=h.join("\r\n"))}}else e=e.replace(/\s+/g," ");return v=B(e,t.hAlign,a,Y(t)),o?v.width:v.height}return 0}r={_paintLinkText:function(e,t,n,r,o,i,a,l,s,u){var f,d,h,g,p,m,v,C,y,S=1,x=R,b=a.hAlign,T=a.vAlign,A=l.lineHeight,I=s.length;for(S+=t,1===b?(S=o/2,x="center"):2===b&&(S=o-1,S-=t,x="right"),e.textAlign!==x&&(e.textAlign=x),f=1,d="alphabetic",h=l.fontInfo.fontSize,g=h>8?w((h-8)/5+2):1,p=A/2-h/2+g-1,f+=A-p,1===T?A<i&&(f=_?(i-u)/2+1:c.msie?(i-u)/2+.5:(i-u)/2,w(f)!==f&&(f+=.5),f+=A/2-p):2===T&&(f=i-u-2.5-p),e.textBaseline!==d&&(e.textBaseline=d),m=r+f,v=0;v<I;v++)e.fillText(s[v],n+S,m),C=e.measureText(s[v]).width,y=a.textDecoration,y&&this._renderTextDecoration(e,y,n+S,m,C,h,g),m+=A},_paintLinkUnderline:function(e,t,n,r,i,a,l,s,u){var c,_,f,d,h,g=l.hAlign,p=l.vAlign,m=s.lineHeight,C=u.length,y=0,S=0,x=0,b=0;for(2!==g&&(x=1),2===l.vAlign&&(b=-2.5),b-=v(0,Math.round(m/9)-1),e.strokeStyle!==e.fillStyle&&(e.strokeStyle=e.fillStyle),e.lineWidth=1,e.beginPath(),h=0;h<C;h++)c=e.measureText(u[h]).width,d=k(new o.Rect(n,r,i,a),c,m*C,g,p,t),_=x+n+d.x,f=_+c,y=b+r+d.y+m,w(y)===y&&(y+=.5),S=y,e.moveTo(_,y),e.lineTo(f,S),e.stroke(),b+=m},paintValue:function(e,t,n,r,o,i,a,s){var u,c,_,f,d,h,g,m,v,C,w,y,S,x,b,T=this;if(e&&(u=T.getText(t,s),!l(u))){for(u+="",c=u.split(/\r\n|\r|\n/),_=0;_<c.length;)c[_]=c[_].replace(/\s+/g," "),_++;u=c.join("\r\n"),f=!1,d=s.sheet._getModel().getNode(s.row,s.col),h=d&&d.hyperlinkInfo,h&&(T._id===h.id?f=h.visited:delete d.hyperlinkInfo),e.save(),e.beginPath(),g=f?T._visitedLinkColor:T._linkColor,g&&e.fillStyle!==g&&(e.fillStyle=g),m=a.font,m&&e.font!==m&&(e.font=m),v=Y(a),s.sheet.outlineColumn&&s.sheet.outlineColumn._isOutlineColumn(s.col)&&(v=0),C=a.wordWrap,w=[],y=0,S=0,C?(x=o-3-v,x-=1,w=p._getWrapInfo(u,x,m),(y=w.length)>1&&0!==a.vAlign&&(b=s.lineHeight,S=(y-1)*b)):w.push(u),e.rect(n,r,o,i),e.clip(),e.beginPath(),T._paintLinkText(e,v,n,r,o,i,a,s,w,S),T._paintLinkUnderline(e,v,n,r,o,i,a,s,w),e.restore()}},getText:function(e,t){return this._text||e},_triggerButtonClicked:function(e,t,n,r){if(!e._startEditByKeydown){var o=e.parent;o&&o._triggerButtonClicked(e,t,n,r)}},getHitInfo:function(e,t,n,r,o){var i,a=this;return o&&(i=o.sheetArea,(l(i)||3===i)&&n&&r)?{x:e,y:t,row:o.row,col:o.col,cellStyle:n,cellRect:r,sheetArea:i,isFocusAware:!0,sheet:o.sheet,isReservedLocation:U(e,t,n,r,o,a._text)}:m},processMouseDown:function(e){var t=e&&e.sheet,n=this;t&&!t.isEditing()&&e.isReservedLocation&&(n._isMouseDownLink=!0)},processMouseUp:function(e){var t,n=e&&e.sheet;n&&!n.isEditing()&&(t=this,e.isReservedLocation&&t._isMouseDownLink&&t._executeOnClickEvent(e),t._isMouseDownLink=!1)},processMouseMove:function(e){var t,n=e.row,r=e.col,o=e.sheet,i=this;!o||o.isEditing()&&o.getActiveRowIndex()===n&&o.getActiveColumnIndex()===r||(t=o._getCanvas(),e.isReservedLocation?t&&(i._showLinkToolTip(o,e),t.style.cursor="pointer"):(i._hideLinkToolTip(o),t&&(t.style.cursor=N)))},processMouseLeave:function(e){var t,n=e.sheet,r=this;r._isMouseDownLink=!1,r._hideLinkToolTip(n),n&&(t=n._getCanvas())&&(t.style.cursor=N)},_showLinkToolTip:function(e,t){var n,r,o,i,a,l,s=this;s._linkToolTip&&(n=s._getLinkToolTipElement(),r=h(n),r.text(s._linkToolTip),o=e._eventHandler._getCanvasPosition(),i=o.left+t.x,a=o.top+t.y+20,0===r.parent().length&&(l=e&&e._getHost(),l&&l.insertBefore(n,m),r.css(A,a).css(R,i)))},_hideLinkToolTip:function(e){var t,n=this;n._linkToolTipElement&&(t=e&&e._getHost(),t&&n._linkToolTipElement.parentElement===t&&H(t,n._linkToolTipElement),n._linkToolTipElement=m)},_getLinkToolTipElement:function(){var e,t=this;return t._linkToolTipElement||(e=a(O),h(e).css(S,x).css(b,0).css(I,2).css(M,"1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(E,D).css(F,V).css(T,"9pt Arial"),t._linkToolTipElement=e),t._linkToolTipElement},isReservedKey:function(e,t){return 32===e.keyCode&&!e.ctrlKey&&!e.shiftKey&&!e.altKey},processKeyUp:function(e,t){var n=t.sheet,r=this;return!!n&&(r._executeOnClickEvent(t),!0)},getAutoFitWidth:function(e,t,n,r,o){return G(this._text||e,n,r,o,!0)},getAutoFitHeight:function(e,t,n,r,o){return G(this._text||e,n,r,o)},isImeAware:function(e){return!1},_executeOnClickEvent:function(e){var t,n=e&&e.sheet,r=this,o=e.row,i=e.col,a=e.sheetArea;r.onClickAction().call(this,e),t=n._getModel(a).getNode(o,i,!0),t.hyperlinkInfo={id:r._id,visited:!0},n.repaint(n.getCellRect(o,i)),r._triggerButtonClicked(n,o,i,a)},onClickAction:function(e){return 0===arguments.length?this._onAction:(e&&(this._onAction=e),this)},toJSON:function(){var e,n=this,r={typeName:n.typeName};return g(t,function(t,o){(e=n["_"+t])!==o&&(r[t]=e)}),r},fromJSON:function(e){var n=this;g(t,function(t){var r=e[t];l(r)||(n["_"+t]=r)})},_createCellTypeElement:function(e){},_cloneCellType:function(){var e,n=this,r=new P;return g(t,function(t,o){(e=n["_"+t])!==o&&(r["_"+t]=e)}),r._onAction=n._onAction,r}},g(t,function(e){r[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),h.extend(P.prototype,r),P._getUniqueId=function(){var e=this;return l(e._id)&&(e._id=0),"id_"+e._id++},f.HyperLink=P,f._typeDict[8]=P,e.exports=f}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h=n(2),g=n(3),p=h._util._createElement,m=g._Types._isNullOrUndefined,v=h._util,C=v._cancelDefault,w=h.CellTypes,y=w.Base,S=h.GC$,x=S.extend,b=S.each,T=document,R=null,A=void 0,I=Math.max,M=parseInt,E="click",F="keydown",D="mouseover",N="mouseout",V="position",O="absolute",H="font",P="left",L="top",k="gcUIElement",B="tabindex",W="none",z="width",U="height",Y="outline",G="box-sizing",X="color",j="background-color",K="z-index",Z="display",J="content-box",q="white",Q="black",$="title",ee="div",te="span",ne="text",re="value",oe="border";function ie(e,t){e.appendChild(t)}function ae(e,t){e.removeChild(t)}function le(e){return e&&e.parentNode.parentNode.comboBox}w.EditorValueType={text:0,index:1,value:2},t=17,r=20,o=0,i=1,a=1,l=i,s="EndEdit.gcEditingInput",u=18,c="lightgrey",_="#1E90FF",f={editorValueType:0,items:R,itemHeight:22,editable:!1,maxDropDownItems:r},S.inherit(se,y);function se(){var e=this;y.call(e),e.typeName="7",e._autoFormatValue=!1,e._hasInPlaceEditor=!1,b(f,function(t,n){"items"===t&&(n=[]),e["_"+t]=n})}function ue(e,t){return e.hasOwnProperty(t)}d={isReservedKey:function(e,t){return this._hasInPlaceEditor},paintValue:function(e,n,r,o,i,a,l,s){var u=this,c=t,_=I(0,i-c-1);3===l.hAlign&&(l.hAlign=0),l.wordWrap&&(l.wordWrap=!1),_>0&&a>0&&y.prototype.paintValue.call(u,e,u.getText(n,s),r,o,_,a,l,s),e.save(),(c>i||c>a)&&(e.rect(r,o,i,a),e.clip()),e.beginPath(),e.lineWidth=2,e.fillStyle=Q,e.moveTo(r+i-c+3,o+(a-2)/2-2.5),e.lineTo(r+i-c+6,o+(a-2)/2+3.5),e.lineTo(r+i-c+9,o+(a-2)/2-2.5),e.fill(),e.restore()},getText:function(e,t){return e},createEditorElement:function(e,t){var n,r=e&&e.sheet,o=r&&r.parent,i=o&&o._host,a=v._getPreferredZIndex(i)+1e3,l=r.defaults,s=this,u=new ce(t,0,0,l.colWidth,l.rowHeight,a);return u.editorValueType(s._editorValueType),u.items(s._items),u.itemHeight(s._itemHeight),u.itemCountPerPage(s._maxDropDownItems),u.editable(s._editable),n=u.getComboBox(),Object.defineProperty(n,"comboBox",{value:u,writable:!1}),R},getEditorValue:function(e,t){var n=le(e);return n&&(this._autoFormatValue=!n._isEditorValueInItems),n&&n.editorValue()},setEditorValue:function(e,t,n){var r=le(e);r&&r.editorValue(t)},focus:function(e,t){var n=le(e);n&&n.focus()},selectAll:function(e,t){var n=le(e);n&&n.selectAll()},activateEditor:function(e,t,n,r){var o=this,i=r.sheet,a=le(e);a&&(a.editorValueType(o._editorValueType),a.items(o._items),a.itemHeight(o._itemHeight),a.itemCountPerPage(o._maxDropDownItems),a.editable(o._editable),a.bind(s,function(e,t){var n,r,o,l,s,u=t.keyCode;if(u){if(n=i._commandManager(),r=n.getShortcutKey(u,!1,!1,!1,!1),o=n.getCommands(r))for(l=0,s=o.length;l<s;l++)if("navigationLeft"!==o[l].name&&"navigationRight"!==o[l].name||(i._editorStatus=1),o[l].execute(i.parent,{sheetName:i.name()}))return!0}else t.isMouse&&a._isDisplayMode&&i.endEdit()})),o._hasInPlaceEditor=!0},deactivateEditor:function(e,t){if(e){var n=le(e);n&&(n.unbind(s),n.closeDropDownList(),n._isDisplayMode=!1)}this._hasInPlaceEditor=!1},updateEditor:function(e,t,n,r){var o,i,a=e&&r&&r.sheet;a&&(o=le(e),t&&o&&(i=a._render,o.updateStyle(t.backColor,t.foreColor,i._getZoomFont(t.font||i._getDefaultFont()))),n&&o&&o.updateLocationAndSize(n.x,n.y,n.width,n.height))},format:function(e,t,n,r){var o,i,a,l,s,u,c;if(m(e))return"";if(o=this,i=o._editorValueType,a=o._items,a)if(s=a.length,1===i)0<=(u=M(e))&&u<s&&(l=a[u])!==A&&l!==R&&(e=ue(l,ne)?l.text:l);else if(2===i)for(c=0;c<s;c++)if((l=a[c])&&ue(l,re)&&l.value===e){e=l.text;break}return y.prototype.format.call(o,e,t,n)},parse:function(e,t,n){var r,o,i,a=this,l=a._editorValueType,s=a._items,u=y.prototype.parse.call(a,e,t);if(s){if(i=s.length,0===l)return u;if(1===l){for(o=0;o<i;o++)if((r=s[o])&&ue(r,ne)&&r.text===u||r===u)return o}else if(2===l)for(o=0;o<i;o++)if((r=s[o])&&ue(r,ne)&&r.text===u)return r.value}return u},getHitInfo:function(e,n,r,o,i){var a,l,s,u;return i?(a=i.sheetArea,l=i.sheet,(m(a)||3===a)&&o&&(s=o.x+o.width,u={x:e,y:n,row:i.row,col:i.col,cellStyle:r,cellRect:o,sheetArea:a,sheet:l},s-t<=e&&e<s)?(u.isReservedLocation=!0,u):R):R},processMouseDown:function(e){var t,n=e.sheet,r=e.sheetArea;(m(r)||3===r)&&e.isReservedLocation&&n&&(n.startEdit(),(t=le(n._editor))&&(v._browser.mozilla&&(t._showTime=(new Date).valueOf()),t.showDropDownList(),t._isDisplayMode=!0))},getAutoFitWidth:function(e,n,r,o,i){return r&&r.wordWrap&&(r.wordWrap=!1),w.Context._getAutoFitWidth(e,n,r,o,i)+t},getAutoFitHeight:function(e,t,n,r,o){return n&&n.wordWrap&&(n.wordWrap=!1),w.Context._getAutoFitHeight(e,t,n,r,o)},isImeAware:function(e){return!0},_cloneCellType:function(){},toJSON:function(){var e,t=this,n={typeName:t.typeName};return b(f,function(r,o){e=t["_"+r],("items"===r?e&&e.length>0:e!==o)&&(n[r]=e)}),n},fromJSON:function(e){var t=this;b(f,function(n){var r=e[n];m(r)||(t["_"+n]=r)})}},b(f,function(e){d[e]=function(t){return 0===arguments.length?this["_"+e]:(this["_"+e]=t,this)}}),x(se.prototype,d),w.ComboBox=se,w._typeDict[7]=se;function ce(e,n,i,a,l,u){var c,_,f,d,g,v,C,w,y=this;y._DOMObject=e,c=e.firstChild,S(e).bind(F,function(e){y._onKeydown(e)}).css(K,u||0).css(P,n).css(L,i).css(z,a).css(U,l).css("overflow","visible").attr(k,"gcComboBox"),_=I(0,a-t),y._editable=!1,y._divObject=f=p(ee),y._textareaObject=d=p("textarea"),y._EDITOR=f,ie(c,f),_e(f),_e(d),S(d).bind("keyup",function(){var e,t=y._EDITOR.value;y._text=t,e=y._textToValue(t),y.editorValue(e),y._selectByText(t),y._removeTip()}).bind(D,function(){y._updateTip()}).bind(N,function(){y._removeTip()}),S(f).bind(E,function(){y._isDisplayMode?y._trigger(s,{isMouse:!0}):y._toggleDropDownList()}).bind(D,function(){y._updateTip()}).bind(N,function(){y._removeTip()}),y._updateEditor(0,0,_,l),g=y._BUTTON=p(ee),ie(c,g),S(g).css(oe,W).css(V,O).css(j,q).css(G,J).attr(k,"gcDropDownButton").bind(E,function(){var e,t;!m(y._showTime)&&(e=y._showTime,y._showTime=A,(t=(new Date).valueOf())-e<100)||(y._isDisplayMode?y._trigger(s,{isMouse:!0}):y._toggleDropDownList())}),v=p("canvas"),y._canvas=v,y._updateButton(_,0,a-_,l),ie(g,v),C=y._LIST=p(ee),ie(c,C),y._isShown=!1,S(C).css(V,O).css(oe,"1px solid").css(j,q).css(K,u||0).css(Y,W).css(Z,W).css("cursor","default").css(G,J).attr(k,"gcDropDownWindow").attr(B,-1).css(z,a-2*o).css(U,l),y._updateList(0,l-2*o),y._itemCount=0,w=y._divList=p(ee),ie(C,w),y._scrollablePanel=new h._ScrollablePanel(C,w),y._itemHeight=22,y._itemCountPerPage=r,y._selectedIndex=-1,y._editorValueType=0,y._items=[]}function _e(e){S(e).css("margin",0).css("overflow","hidden").css("resize",W).css(V,O).css("padding",a+"px 0px 0px "+i+"px").css(Y,W).css(j,q).css("white-space","nowrap").css(G,J).css(oe,W).attr(k,"gcComboBoxEditor").attr(B,-1)}x(ce.prototype,{getComboBox:function(){return this._DOMObject},updateLocationAndSize:function(e,n,r,i){var a=this,l=I(0,r-t);a._updateEditor(0,0,l,i),a._updateButton(l,0,r-l,i),a._updateList(0,i-2*o),a.listWidth(r-2*o),a._updateItemWidth()},updateStyle:function(e,t,n){var r=this;S(r._EDITOR).css(j,e).css(X,t).css(H,n),S(r._BUTTON).css(j,e).css(X,t).css(H,n),S(r._LIST).css(j,e).css(X,t).css(H,n),S(r._DOMObject).css(j,"transparent")},editorValueType:function(e){return 0===arguments.length?this._editorValueType:(this._editorValueType=e,this)},editorValue:function(e){var t,n=this;return 0===arguments.length?n._editorValue:(e!==n._editorValue&&(n._editorValue=e,t=n._valueToText(e),n.text(t),n._selectByText(t,!0)),n)},_valueToText:function(e){var t,n,r,o,i=this,a=i._items,l=a.length,s=i._editorValueType;if(i._isEditorValueInItems=!0,1===s)n=a[e],(t=n&&ue(n,ne)?n.text:n)===A&&(t=e,i._isEditorValueInItems=!1);else if(0===s){for(t=e,r=0;r<l&&!((n=a[r])&&ue(n,ne)&&n.text===e||n===e);r++);r>=l&&(i._isEditorValueInItems=!1)}else if(2===s){for(o=0;o<l;o++)if((n=a[o])&&ue(n,re)&&n.value===e){t=n.text;break}o>=l&&(t=e,i._isEditorValueInItems=!1)}return m(e)&&(t=""),t},_textToValue:function(e){var t,n,r,o=this,i=o._items,a=i.length,l=o._editorValueType,s=e;if(1===l)for(n=0;n<a;n++)((t=i[n])&&ue(t,ne)&&t.text===e||t===e)&&(s=n);else if(2===l)for(r=0;r<a;r++)t=i[r],t&&ue(t,ne)&&t.text===e?s=t.value:t===e&&(s=A);return s},_selectByText:function(e,t){var n,r,o,i;if(e){for(r=this._items,o=r.length,n=0;n<o&&(i=r[n],ue(i,ne)&&(i=i.text),(t?i:(""+i).substr(0,e.length))!==e);n++);n>=o&&(n=-1)}else n=-1;this._setSelectedIndexInternal(n)},_removeTip:function(){S(this._EDITOR).removeAttr($)},_updateTip:function(){var e=this,t=e._measureText(e._text),n=S(e._EDITOR);t>n.width()+i?n.attr($,e._text):n.removeAttr($)},_updateEditor:function(e,t,n,r){n-=o,r-=2*o,S(this._EDITOR).css(P,e).css(L,t).css(z,n-i).css(U,r-a)},updateImeMode:function(e,t){if(this.isImeAware()){var n=le(e);n&&n._EDITOR&&S(n._EDITOR).css("ime-mode",t)}},editable:function(e){var t,n,r,o,i,a=this;return 0===arguments.length?a._editable:a._editable!==e?(a._editable=e,t=a._DOMObject.firstChild,n=a._EDITOR,r=S(n),o={left:M(r.css(P)),top:M(r.css(L)),width:M(r.css(z)),height:M(r.css(U))},i={backColor:r.css(j),foreColor:r.css(X),font:n.style.font},ae(t,n),a._EDITOR=e?a._textareaObject:a._divObject,ie(t,a._EDITOR),S(a._EDITOR).css(j,i.backColor).css(X,i.foreColor).css(H,i.font),a._updateEditor(o.left,o.top,o.width,o.height),a):void 0},text:function(e){var t=this,n=t._EDITOR;if(0===arguments.length)return t._text;e!==t._text&&(t._text=e,t._editable?n.value=e:n.textContent=e)},focus:function(){var e=this,t=e._EDITOR;t.focus(),e._editable&&(t.selectionStart=t.value.length)},selectAll:function(){var e=this;e._editable&&e._EDITOR.select()},_updateButton:function(e,n,r,i){var a,l,s,u,c;r-=o,i-=2*o,a=this,l=a._canvas,S(a._BUTTON).css(P,e).css(L,n).css(z,r).css(U,i),S(l).attr(z,r).attr(U,i),s=l.width,u=l.height,c=l.getContext("2d"),c.beginPath(),c.lineWidth=2,c.fillStyle=Q,c.moveTo(s-t+4,(u-2)/2-2.5),c.lineTo(s-t+7,(u-2)/2+3.5),c.lineTo(s-t+10,(u-2)/2-2.5),c.fill()},showDropDownList:function(){var e=this,t=e._scrollablePanel;e._isShown=!0,S(e._LIST).bind(F,function(t){e._onKeydown(t)}).show(),e._isNeedVScrollbar=!1,e._updateItemHeight(),e._updateItemWidth(),e._isNeedVScrollbar&&(t._verticalSmallChange(S(e._divList.children).height()),t._refreshLayout(!1)),e._setSelectedItemBackColor(_),e._scrollToIndex(e._selectedIndex),e.focus()},closeDropDownList:function(){var e=this;e._isShown=!1,S(e._LIST).unbind(F).hide(),e._setSelectedItemBackColor(""),e.focus()},_toggleDropDownList:function(){this._isShown?this.closeDropDownList():this.showDropDownList()},listWidth:function(e){var t=this,n=S(t._LIST);if(0===arguments.length)return n.width();e>0&&(n.width(e),t._scrollablePanel._refreshLayout(!1))},listHeight:function(e){var t=this,n=S(t._LIST);if(0===arguments.length)return n.height();e>0&&(n.height(e),t._scrollablePanel._refreshLayout(!1))},_updateList:function(e,t){S(this._LIST).css(P,e).css(L,t)},items:function(e){var t,n,r,o,i,a=this;if(0===arguments.length)return a._items;if(e){for(a._items=e,t=a._divList;n=t.firstChild;)ae(t,n);for(a._itemCount=0,r=0,o=e.length;r<o;r++)i=e[r],a._addItem(ue(i,ne)?i.text:i);return a}},_addItem:function(e){var t=this,n=p(ee),r=p(te);r.textContent=""+e,r.style.paddingLeft=l+"px",ie(n,r),ie(t._divList,n),t._itemCount++,S(n).bind(E,function(){var e=S(n).index();t.selectedIndex(e),t.closeDropDownList(),t._trigger(s,{isMouse:!0})}).bind(D,function(){var e=S(n);n.oldBackColor=e.css(j),e.css(j,c)}).bind(N,function(){S(n).css(j,n.oldBackColor||"")})},_addMeasureSpan:function(){var e=this;e._measureSpan=p(te),S(e._measureSpan).css(Z,W).css(H,e._LIST.style.font).appendTo(T.body)},_removeMeasureSpan:function(){ae(T.body,this._measureSpan)},_measureTextWidth:function(e){return this._measureSpan.textContent=e,S(this._measureSpan).width()+2+l},_setSelectedItemBackColor:function(e){var t=this,n=t._selectedIndex;0<=n&&n<t._itemCount&&S(t._divList.children[n]).css(j,e)},_onKeydown:function(e){var t,n,r,o,i,a;e.ctrlKey||e.shiftKey||e.altKey||e.metaKey||(t=this,n=t._itemCount,r=t._selectedIndex,o=e.keyCode,i=e.which,a=0,38===i||40===i?(r>=0&&r<n&&(a=r+(38===i?-1:1)),a>=0&&a<n&&t.selectedIndex(a),t._isShown&&t._scrollToIndex(a),C(e)):13===i||37===i||39===i||9===i?(t.selectedIndex(t._selectedIndex),t.closeDropDownList(),t._trigger(s,{keyCode:o}),C(e)):27===i&&(t.closeDropDownList(),t._trigger(s,{keyCode:o}),C(e)))},getSelectedValue:function(e,t,n){var r,o=t[e];return m(o)||(1===n?r=e:0===n?r=ue(o,ne)?o.text:o:2===n&&ue(o,re)&&(r=o.value)),r},_setSelectedIndexInternal:function(e){var t=this;t._setSelectedItemBackColor(""),t._selectedIndex=e,t._setSelectedItemBackColor(_),t._scrollToIndex(e)},selectedIndex:function(e){var t,n=this;if(0===arguments.length)return n._selectedIndex;0<=e&&e<n._itemCount&&(n._setSelectedIndexInternal(e),t=n.getSelectedValue(n._selectedIndex,n._items,n._editorValueType),m(t)||n.editorValue(t))},itemCountPerPage:function(e){if(0===arguments.length)return this._itemCountPerPage;e>0&&(this._itemCountPerPage=e)},_measureText:function(e){this._addMeasureSpan();var t=this._measureTextWidth(e);return this._removeMeasureSpan(),t},itemHeight:function(e){if(0===arguments.length)return this._itemHeight;e>0&&(this._itemHeight=e)},_updateItemHeight:function(){var e,t,n,r,o,i=this;i._addMeasureSpan(),e=i._items[0],t=I(i._itemHeight,S(i._measureSpan).text(m(e)?"":e).height()),S(i._divList.children).css(U,t),r=i._itemCount,o=i._itemCountPerPage,r<=o?n=r*t:(n=o*t,i._isNeedVScrollbar=!0),i.listHeight(n),i._removeMeasureSpan()},_updateItemWidth:function(){var e,t,n,r,o,i,a=this;if(a._addMeasureSpan(),e=0,n=a._items)for(r=0,o=n.length;r<o;r++)i=n[r],t=a._measureTextWidth(ue(i,ne)?i.text:i),e<t&&(e=t);a._removeMeasureSpan(),a.listWidth()<e+u&&a.listWidth(e+u)},_scrollToIndex:function(e){if(e>=0&&e<this._itemCount){var t=this._divList.children[e];this._scrollablePanel._scrollChildIntoView(t)}},bind:function(e,t,n){S(this._DOMObject).bind(e,t,n)},unbind:function(e,t){S(this._DOMObject).unbind(e,t)},_trigger:function(e,t){S(this._DOMObject).trigger(e,t)}}),e.exports=w}()}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Fill=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";n(1),n(6),n(7);var t=n(4);t.SR={},t.SR.en=n(9),e.exports=t}()},function(e,t,n){!function(){"use strict";var e,r,o,i=n(2),a=n(3),l=n(4),s=a._Types._isNullOrUndefined,u=null,c=i._createRange,_=i.GC$,f=Math.max,d=Math.floor,h=i.Commands,g=h.ActionBase,p=h._ChangedCells,m=h._CopyMoveHelper,v=m._saveViewportInfo,C=m._raiseRangeDataChanged,w=h._CopyMoveCellsInfo,y=i.Events,S=1023,x="startRange",b="fillRange",T="autoFillType",R="fillDirection",A="cancel",I="fill",M="dragDrop",E=h._performUndo,F=h._saveColumnHeaderInfo,D=h._saveViewportInfoForDragDrop,N=h._saveTableInfo,V=h._saveRowHeaderInfo,O=function(){return a._getResource(l.SR)()};function H(e){return e.rowCount}function P(e){return e.colCount}function L(e,t){return e.getRowCount(t)}function k(e,t){return e.getColumnCount(t)}function B(e,t,n,r){
return!!(e&&t&&t.containsRange(e))&&(!s(n)&&(1===n&&e.row===t.row&&H(e)===H(t)||0===n&&e.col===t.col&&P(e)===P(t))||!(s(r)||(2!==r&&3!==r||e.col!==t.col||P(e)!==P(t))&&(0!==r&&1!==r||e.row!==t.row||H(e)!==H(t))))}e={fillAuto:function(e,t,n){if(!t)throw Error(O().Exp_RangeIsNull);var r=this,o=n.fillType,i=n.series,c=n.direction,_=n.step,f=n.stop,d=new l._FillImp(r);B(e,t,c?u:i,c)&&(e&&(r._eventHandler._dragFillStartRange=e),4===o?d._fillAuto(t,i,!1,n.withTag):0===o?d._fillAutoByDirection(t,c):1===o||2===o?d._fillLinearOrGrowth(1===o,t,i,_,f):3===o&&d._seriesFillRange(t,i,3,_,s(f)?u:a._DateTimeHelper._toOADate(f),n.unit),r._invalidate())}},_.extend(i.Worksheet.prototype,e),i.Worksheet._registerFeature(I,{setHost:function(e){if(e){var t=this._commandManager();t[I]||t.register(I,h[I]),t[M]||t.register(M,h[M])}}}),i.Workbook._registerFeature(I,{init:function(){this.options.allowUserDragFill=!0}}),r=function(e){_.inherit(t,e);function t(t,n){var r=this,o=n[R],i=0===o,a=i||1===o,l=n[b],s=n[x],u=s.row,_=s.col,f=H(s),d=P(s);e.call(r),r._sheet=t,r._dragFillExtent=n,4===n[T]?r._clearValueUndoAction=new h._ClearValueUndoAction(t,{ranges:[n[b]]}):r._wholeFillRange=a?c(u,i?l.col:_,f,d+P(l)):c(2===o?l.row:u,_,f+H(l),d),r._fillSeries=a?1:0}var n={canExecute:function(){var e=this,t=e._sheet,n=e._dragFillExtent,r=n[x],o=n[b];return!!t._canChange(o.row,o.col,H(o),P(o))&&(4===n[T]||!o.intersect(r.row,r.col,H(r),P(r)))},execute:function(){var e,t,n,r,o=this;if(o.canExecute()){e=o._dragFillExtent,t=e[b],n=o._sheet,o._beforeAction(n);try{i._supportsCalc&&n.suspendCalcService(),o.saveState(),4===e[T]?o._executeDragFillClear(n):o._executeDragFill(n)}finally{o._afterAction(n),i._supportsCalc&&n.resumeCalcService(!1),n._updateTableSlicer&&n._updateTableSlicer(t.row,t.col,H(t),P(t)),r=[],n.isDirtySuspended()||(o._savedAfterFilledChangedCells=new p(n,t,S),o._savedAfterFilledChangedCells._mergeCellsHasDiffData(o._savedBeforeFillChangedCells._getCellsData()),r=o._savedAfterFilledChangedCells._getChangedCells()),C(n,t.row,t.col,H(t),P(t),r,1)}}},_executeDragFillClear:function(e){var t,n,r,o,i,a,l,s,u,_=this;_._clearValueUndoAction.execute(e),t=_._dragFillExtent,n=t[x],r=t[b],o=0===_._fillSeries,a=H(n),l=P(n),s=o?f(1,a-H(r)):a,u=o?l:f(1,l-P(r)),n.equals(r)||(i=c(n.row,n.col,s,u),e._setActiveCellImp(f(e._getFirstVisualRow(),i.row),f(e._getFirstVisualColumn(),i.col),e._activeRowViewportIndex,e._activeColViewportIndex),e._clearSelectionImp(),e.addSelection(i.row,i.col,H(i),P(i)))},_executeDragFill:function(e){var t,n,r,o,a,l,s,c,_,h,g,p,m=this,v=m._sheet,C=m._dragFillExtent[x],w=m._dragFillExtent[b],y=m._dragFillExtent[T],R=m._wholeFillRange,A={fillType:4,series:m._fillSeries,withTag:!0};if(1===y){if(v.fillAuto(C,R,A),v._getSpanModel().hasSpans(C.row,C.col,C.rowCount,C.colCount))for(t=0;t<w.rowCount;t++)for(n=0;n<w.colCount;n++)r=v._getStyleObject(C.row+d(t%C.rowCount),C.col+d(n%C.colCount)),r&&r.clone&&(r=r.clone()),v._setStyleObject(w.row+t,w.col+n,r)}else if(0===y)o=4^S,m._copyCells(C,w,o);else if(2===y)m._copyCells(C,w,192);else if(3===y)if(a=!(1!==H(C)||1!==P(C)||-1===C.row&&-1!==C.col||-1===C.col&&-1!==C.row))l=187,m._copyCells(C,w,l);else{for(s=v._getActualRange(R),c=s.row,_=s.col,h=H(s),g=P(s),p=new i._SheetModel(H(s),P(s),u),t=0;t<h;t++)for(n=0;n<g;n++)p.setStyle(t,n,v._getStyleObject(c+t,_+n));for(v.fillAuto(C,R,A),t=0;t<h;t++)for(n=0;n<g;n++)v._setStyleObject(c+t,_+n,p.getStyle(t,n))}v._setActiveCellImp(f(e._getFirstVisualRow(),R.row),f(e._getFirstVisualColumn(),R.col),e._activeRowViewportIndex,e._activeColViewportIndex),e._selectionModel&&e._clearSelectionImp(),v.addSelection(R.row,R.col,H(R),P(R))},_copyCells:function(e,t,n){var r=this,o=r._sheet,i=o._getActualRange(e),a=o._getActualRange(t),l=i.row,s=i.col,u=H(i),c=P(i),_=a.row,f=a.col,h=H(a),g=P(a),p=r._dragFillExtent[R],m=3===p,v=1===p,C=d(h/u),w=h%u,y=d(g/c),S=g%c,x,b,T,A,I;if(0===r._fillSeries){for(x=0;x<C;x++)A=m?_+x*u:_+h-(x+1)*u,o._copyToCore(l,s,A,f,u,c,n,!0);0!==w&&(b=m?l:l+(C+1)*u-h,A=m?_+u*C:_+h-C*u-w,o._copyToCore(b,s,A,f,w,c,n,!0))}else{for(x=0;x<y;x++)I=v?f+x*c:f+g-(x+1)*c,o._copyToCore(l,s,_,I,u,c,n,!0);0!==S&&(T=v?s:s+(y+1)*c-g,I=v?f+c*y:f+g-y*c-S,o._copyToCore(l,T,_,I,u,S,n,!0))}},saveState:function(){var e=this,t=e._dragFillExtent;4===t[T]?e._clearValueUndoAction.saveState():e._savedStartViewportCells=e._saveRangeStates(t[x]),e._sheet.isDirtySuspended()||(e._savedBeforeFillChangedCells=new p(e._sheet,t[b],S)),e._savedFilledViewportCells=e._saveRangeStates(t[b])},_saveRangeStates:function(e){var t=this._sheet,n=t._getActualRange(e),r=new w(H(n),P(n));return v(t,r,n.row,n.col,S),r},undo:function(){var e,t,n,r,o=this,a=o._sheet,l=!1;if(o.canUndo()){o._beforeAction(a,!0);try{i._supportsCalc&&a.suspendCalcService(),e=a.getSelections(),t=o._dragFillExtent,n=a._fillDialog,r=t[b],l=4===t[T]?o._undoDragClear(a):o._undoDragFill(a),!a._skipCloseDragFillSmartTag&&n&&n.close(),C(a,r.row,r.col,H(r),P(r),o._savedAfterFilledChangedCells?o._savedAfterFilledChangedCells._getChangedCells():[],1),a._raiseSelectionChanging(e,a.getSelections())&&a._raiseSelectionChanged(e)}finally{o._afterAction(a,!0),i._supportsCalc&&a.resumeCalcService(!1)}}return l},_undoDragClear:function(e){var t=this,n=t._dragFillExtent[x],r=n.row,o=n.col,i=t._clearValueUndoAction.undo(e);return e._setActiveCellImp(f(e._getFirstVisualRow(),r),f(e._getFirstVisualColumn(),o),e._activeRowViewportIndex,e._activeColViewportIndex),e._clearSelectionImp(),e.addSelection(r,o,H(n),P(n)),i},_undoDragFill:function(e){var t=this,n=t._dragFillExtent,r=n[x],o=r.row,a=r.col;i._supportsCalc&&e.suspendCalcService();try{t._undoRangeStates(t._savedFilledViewportCells,n[b]),t._undoRangeStates(t._savedStartViewportCells,r),e._setActiveCellImp(f(e._getFirstVisualRow(),o),f(e._getFirstVisualColumn(),a),e._activeRowViewportIndex,e._activeColViewportIndex),e._clearSelectionImp(),e.addSelection(o,a,H(r),P(r))}finally{i._supportsCalc&&e.resumeCalcService(!1)}return e.invalidateLayout(),!0},_undoRangeStates:function(e,t){var n=this._sheet,r=n._getActualRange(t);m._undoCellsInfo(n,e,r.row,r.col,3)}};return _.extend(t.prototype,n),t}(g),o=function(e){_.inherit(t,e);function t(t,n){var r=this;e.call(r),r._sheet=t,r._fillExtent=n,r._startRange=n[x],r._fillRange=n[b],r._autoFillType=n[T],r._fillDirection=n[R]}var n={execute:function(){var e,t,n,r,o,i,a=this,l=!1;if(a.canExecute()){e=a._sheet,t=a._fillRange,a.saveState(),a._beforeAction(e,!0);try{n=e._getActualRange(t),r=new w(H(n),P(n)),v(e,r,n.row,n.col,S),a._savedFilledViewportCells=r,o=e._eventHandler,i={sheet:e,sheetName:e._name},i[A]=!1,i[b]=t,i[T]=a._autoFillType,i[R]=a._fillDirection,e._trigger(y.DragFillBlock,i),o._currentDragFillType=i[T],o._isCancelDragFill=i[A],a._executeDragFillAction(i),delete i[A],e._trigger(y.DragFillBlockCompleted,i),l=!0}finally{a._applyDataChanged(!0,e,t)}}return l},_executeDragFillAction:function(e){var t,n,o=this,i=o._sheet,a=i._eventHandler,l=o._fillRange,s=o._autoFillType,u=i._getActualRange(l);a._currentDragFillType=s,a._preFillCellsInfo=new w(H(u),P(u)),v(i,a._preFillCellsInfo,u.row,u.col,S),a._isCancelDragFill||(t={},t[x]=o._startRange,t[b]=l,t[T]=5===e[T]?s:e[T],t[R]=o._fillDirection,n=new r(i,t),i.suspendEvent(),n.execute(),i.resumeEvent(),o._fillExtent._dragFillUndoAction=n)},saveState:function(){var e=this;e._sheet.isDirtySuspended()||(e._savedBeforeFillChangedCells=new p(e._sheet,e._fillRange,S))},undo:function(){var e,t,n=this,r=!1;if(n.canUndo()){e=n._sheet,t=n._fillRange,n.saveState(),n._beforeAction(e);try{r=n._fillExtent._dragFillUndoAction.undo()}finally{n._applyDataChanged(!1,e,t)}}return r},_applyDataChanged:function(e,t,n){var r,o=this;o._afterAction(t,e),r=[],t.isDirtySuspended()||(o._savedAfterFilledChangedCells=new p(t,n,S),o._savedAfterFilledChangedCells._mergeCellsHasDiffData(o._savedBeforeFillChangedCells._getCellsData()),r=o._savedAfterFilledChangedCells._getChangedCells()),C(t,n.row,n.col,H(n),P(n),r,1)}};return _.extend(t.prototype,n),t}(g);function W(e,t,n,r,o){var i,a,l=e.getSelections();e._clearSelectionImp(),e.addSelection(t,n,r,o),e._raiseSelectionChanged(l),i=t>0?t:e._getFirstVisualRow(),a=n>0?n:e._getFirstVisualColumn(),e._setActiveCellImp(i,a,e._activeRowViewportIndex,e._activeColViewportIndex)}_.inherit(z,g);function z(e,t){var n=this;g.call(n),n._sheet=e,n._command=t}_.extend(z.prototype,{canExecute:function(){var e=this,t=e._sheet,n=e._command,r=n.fromRow,o=n.fromColumn,i=H(n),a=n.columnCount,l=n.toRow,s=n.toColumn;return!!t._isValidRange(r,o,i,a,L(t),k(t))&&(!(!n.insert&&!t._isValidRange(l,s,i,a,L(t),k(t)))&&(t._canChange(l,s,i,a)&&t._canChange(r,o,i,a)))},execute:function(){var e,t,n,r,o,i,a,l,s,u,c,_,f,d,h,g=this,p=!1;if(g.canExecute()){e=g._sheet,t=g._command,g.saveState(),i=t.fromRow,a=t.fromColumn,l=t.toRow,s=t.toColumn,u=H(t),c=t.columnCount,_=t.option,g._beforeAction(e,!0);try{t.insert?a>=0&&i<0?(n=a,r=s,o=c,f=s,e.addColumns(r,o),t.copy?e.copyTo(-1,r<=n?n+o:n,-1,r,-1,o,_):(e.moveTo(-1,r<=n?n+o:n,-1,r,-1,o,_),e.deleteColumns(r<=n?n+o:n,o),n<r&&(f=r-o)),W(e,-1,f,L(e),o)):i>=0&&a<0&&(n=i,r=l,o=u,d=l,e.addRows(r,o),t.copy?e.copyTo(r<=n?n+o:n,-1,r,-1,o,-1,_):(e.moveTo(r<=n?n+o:n,-1,r,-1,o,-1,_),e.deleteRows(r<=n?n+o:n,o),n<r&&(d=r-o)),W(e,d,-1,o,k(e))):(t.copy?e.copyTo(i,a,l,s,u,c,_):e.moveTo(i,a,l,s,u,c,_),e&&(W(e,l,s,u,c),h=t._state,t.copy||e.isDirtySuspended()||(h._savedFromAfterPastedChangedCells=g._mergeCellsData(e,h._savedFromViewportCells.data,h._savedFromBeforePastedChangedCells,i,a,u,c)),e.isDirtySuspended()||(h._savedToAfterPastedChangedCells=g._mergeCellsData(e,h._savedToViewportCells.data,h._savedToBeforePastedChangedCells,l,s,u,c)))),p=!0}finally{e._eventHandler._dragRect={},g._afterAction(e,!0)}}return p},_mergeCellsData:function(e,t,n,r,o,i,a){if(t&&t._isValueOrFormulaSaved()){var l=new p(e,c(r,o,i,a),this._command.option);return l._mergeCellsHasDiffData(n._getCellsData()),m._raiseRangeDataChanged(e,r,o,i,a,l._getChangedCells(),0),l}},saveState:function(){var e,t,n=this,r=n._sheet,o=n._command,i=o._state={},a=o.fromRow,l=o.fromColumn,s=o.toRow,u=o.toColumn,_=o.option,f=a<0?0:a,d=l<0?0:l,h=s<0?0:s,g=u<0?0:u,m=a<0?L(r):H(o),v=l<0?k(r):o.columnCount;o.insert?l<0&&a>=0&&(t=r.tables,!o.copy&&t&&t._has(h,-1,1,-1)&&(e=V(r,f,m,_),i._savedFromRowHeaderCells=e.headerCells,i._savedFromRows=e.rows,i._savedFromViewportCells=D(r,f,d,m,v,_))):(a<0&&(e=F(r,g,v,_),i._savedToColumnHeaderCells=e.headerCells,i._savedToColumns=e.columns,o.copy||(e=F(r,d,v,_),i._savedFromColumnHeaderCells=e.headerCells,i._savedFromColumns=e.columns)),l<0&&(e=V(r,h,m,_),i._savedToRowHeaderCells=e.headerCells,i._savedToRows=e.rows,o.copy||(e=V(r,f,m,_),i._savedFromRowHeaderCells=e.headerCells,i._savedFromRows=e.rows)),i._savedToTables=N(r,h,g,m,v),i._savedToViewportCells=D(r,h,g,m,v,_),o.copy||(i._savedFromTables=N(r,f,d,m,v),i._savedFromViewportCells=D(r,f,d,m,v,_),r.isDirtySuspended()||(i._savedFromBeforePastedChangedCells=new p(r,c(f,d,m,v),_))),r.isDirtySuspended()||(i._savedToBeforePastedChangedCells=new p(r,c(h,g,m,v),_))),i._savedAcitveRowViewportIndex=r._activeRowViewportIndex,i._savedAcitveColumnViewportIndex=r._activeColViewportIndex,i._savedActiveRow=r._activeRowIndex,i._savedActiveColumn=r._activeColIndex},undo:function(){var e,n,r,o,i,a,l,s,c,_,f,d,h,g,p,v,C,w,y,S,x,b,T,R,A,I=this,M=0;if(I.canUndo()){if(e=I._sheet,n=I._command,r=n.fromRow,o=n.fromColumn,i=n.toRow,a=n.toColumn,l=H(n),s=n.columnCount,!e._isValidRange(r,o,l,s,L(e),k(e)))return!1;if(!n.insert&&!e._isValidRange(i,a,l,s,L(e),k(e)))return!1;d=n._state,I._beforeAction(e,!0);try{n.insert?o>=0&&r>=0||(o>=0?(h=o,c=s,n.copy?e.deleteColumns(a,c):(_=a,f=o,o<a?_=a-c:f=o+c,e.addColumns(f,c),e.copyTo(-1,f<=_?_+c:_,-1,f,-1,c,n.option),e.deleteColumns(f<=_?_+c:_,c),_<f&&(h=f-c)),e&&W(e,-1,h,L(e),c),M++):r>=0&&(c=l,g=r,n.copy?e.deleteRows(i,c):(_=i,f=r,r<i?_=i-c:f=r+c,e.addRows(f,c),M+=E(I,d._savedFromViewportCells),M+=E(I,d._savedFromRowHeaderCells),M+=E(I,d._savedFromRows),M||e.copyTo(f<=_?_+c:_,-1,f,-1,c,-1,n.option),e.deleteRows(f<=_?_+c:_,c),_<f&&(g=f-c)),e&&W(e,g,-1,c,k(e)),M++)):(p=r<0?0:r,v=o<0?0:o,C=i<0?0:i,w=a<0?0:a,y=r<0?L(e):l,S=o<0?k(e):s,t._supportsCalc&&m._clearFormula(e,C,w,y,S),x=u,b=u,T=d._savedFromViewportCells,!n.copy&&T&&T.data&&T.data._isValueOrFormulaSaved()&&(b=m._getValues(e,p,v,y,S)),R=d._savedToViewportCells,R&&R.data&&R.data._isValueOrFormulaSaved()&&(x=m._getValues(e,C,w,y,S)),M+=E(I,d._savedToTables),M+=E(I,d._savedToColumnHeaderCells),M+=E(I,d._savedToColumns),M+=E(I,R),M+=E(I,d._savedToRowHeaderCells),M+=E(I,d._savedToRows),M+=E(I,d._savedFromTables),M+=E(I,d._savedFromColumnHeaderCells),M+=E(I,d._savedFromColumns),M+=E(I,T),M+=E(I,d._savedFromRowHeaderCells),(M+=E(I,d._savedFromRows))&&e&&(W(e,r,o,l,s),x&&m._raiseRangeDataChanged(e,C,w,y,S,d._savedToAfterPastedChangedCells?d._savedToAfterPastedChangedCells._getChangedCells():[],0),b&&m._raiseRangeDataChanged(e,p,v,y,S,d._savedFromAfterPastedChangedCells?d._savedFromAfterPastedChangedCells._getChangedCells():[],0))),M&&e&&(-1!==d._savedActiveRow&&-1!==d._savedActiveColumn&&(A=e.getSelections()[0],A.contains(d._savedActiveRow,d._savedActiveColumn)?e._setActiveCellCore(d._savedActiveRow,d._savedActiveColumn):e._setActiveCellCore(A.row,A.col)),-2!==d._savedAcitveRowViewportIndex&&-2!==d._savedAcitveColumnViewportIndex&&-1!==d._savedActiveRow&&-1!==d._savedActiveColumn&&e.showCell(d._savedActiveRow,d._savedActiveColumn,3,3))}finally{I._afterAction(e,!0)}}return M>0}}),h[I]={canUndo:!0,execute:function(e,t,n){return h._executeCommand(e,o,t,n)}},h[M]={canUndo:!0,execute:function(e,t,n){return h._executeCommand(e,z,t,n)}}}()},function(e,t){e.exports=GC.Spread.Sheets},function(e,t){e.exports=GC.Spread.Common},function(e,t,n){!function(){"use strict";var t=n(2),r=n(3),o=n(5),i=n(6),a=r._Types,l=null,s=void 0,u=Math.floor,c=t._createRange,_=a._isNullOrUndefined,f=a._toDouble,d=r._ArrayHelper,h=d._insert,g=d._getLength,p=r._DateTimeHelper,m=p._toOADate,v=p._fromOADate,C="number",w="date",y=function(){return r._getResource(i.SR)()};function S(e){return"string"!=typeof e&&a._isNumber(e)}i.AutoFillType={copyCells:0,fillSeries:1,fillFormattingOnly:2,fillWithoutFormatting:3,clearValues:4,auto:5},i.FillDirection={left:0,right:1,up:2,down:3},i.FillSeries={column:0,row:1},i.FillType={direction:0,linear:1,growth:2,date:3,auto:4},i.FillDateUnit={day:0,weekday:1,month:2,year:3};function x(e){var t=[e];return t.rowCount=1,t.colCount=g(e),t}function b(e){return e}function T(e,t,n,o){var i=x(t),a=x(n),s=x([o]),u=e?r._trend(i,a,s,!0,b,l,l,l):r._growth(i,a,s,!0,l,l,l),c=u&&u[0][0];return typeof c===C?r._NumberHelper._fixNumber(c,13):c}function R(e){var t=this;t._indexes=[],t._innerValues=[],t._type=l,t._startIndex=_(e)?-1:e}R.prototype={_dataCount:function(){return g(this._innerValues)},_values:function(){var e=this,t=[],n=e._innerValues,r,o;for(r=0;r<g(n);r++)o=n[r],t.push("object"===e._type?e._toDateTime(o):o);return t},_indexes2:function(){var e,t,n,r=this,o=r._indexes;if(g(o)>0){for(e=r._startIndex,t=[],-1===e&&(e=o[0]),n=0;n<g(o);n++)t[n]=o[n]-e+1;return t}return l},_values2:function(){var e=this._innerValues;return g(e)?e:l},_insert:function(e,t,n){if(!S(n))throw Error(y().Exp_NumberOnly);var r=this;_(r._type)&&(r._type=n instanceof Date?w:C),h(r._indexes,e,t),h(r._innerValues,e,f(n))},_add:function(e,t){var n=this;_(n._type)&&(t instanceof Date?n._type=w:n._type=C),n._indexes.push(e),n._innerValues.push(f(t))},_toActualValue:function(e){return this._type===w?this._toDateTime(e):e},_toDateTime:function(e){var t=l;if(e instanceof Date)t=e;else if(o)try{t=o.Convert._toDateTime(e)}catch(n){t=e}return t}};function A(e){this._sheet=e}A.prototype={_fillLinearOrGrowth:function(e,t,n,r,o){var i=this,a=e?1:2;_(r)&&_(o)?i._seriesFillRange(t,n,a):i._seriesFillRange(t,n,a,r,o,l)},_seriesFillRange:function(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,h,p,m,v,C,w,S,x,b,T,R=this,A=R._sheet,I=A._getActualRange(e),M=I.row,E=I.col,F=I.rowCount,D=I.colCount;if(A._getSpanModel().hasSpans(M,E,F,D))throw Error(y().Exp_RangeContainsMergedCell);for(_=arguments.length>3,f=0,d=1===t,h=d?D:F,p=d?M:E,m=d?M+F:E+D,v=_?1:h,C=this._sheet._eventHandler._dragFillStartRange,w=C.row===M&&C.rowCount===F&&C.col>E||C.col===E&&C.colCount===D&&C.row>M,a=p;a<m;a++)if(S=w&&_?E+D-1:E,x=w&&_?M+F-1:M,(b=d?R._getSeriesSource(a,S,1,v,t):R._getSeriesSource(x,a,v,1,t))&&b._dataCount())for(u=b._indexes[0],_?(c=w?b._innerValues[g(b._innerValues)-1]:b._innerValues[0],l=R._calcSeriesData(w,c,h,n,r,o,i),w&&(f=h-g(l),u=b._indexes[g(b._indexes)-1])):l=R._calcSeriesTrendData(b,h,n),s=0;s<g(l);s++)T=b._toActualValue(l[s]),d?R._copyCell(A,a,u,a,E+f+s,T,n):R._copyCell(A,u,a,M+f+s,a,T,n)},_getSeriesSource:function(e,t,n,r,o){for(var i=l,a=this._sheet,s,u=1===o,c=u?t+r-1:e+n-1,_=u?t:e;c>=_;)s=u?a.getValue(e,c):a.getValue(c,t),S(s)&&(i||(i=new R(_)),i._insert(0,c,s)),c--;return i},_calcSeriesData:function(e,t,n,r,o,i,a){var l,s,u,c=[],f=t,d=o>=0,h=_(i);for(l=0;l<n;l++)s=f>=i,u=f<=i,e&&(h||d&&s||!d&&u)?(c.unshift(f),1===r?f-=o:2===r?f/=o:3!==r||_(a)||(f=this._getNextDateValue(!0,a,t,f,o,l+1))):!e&&(h||d&&u||!d&&s)&&(c.push(f),1===r?f+=o:2===r?f*=o:3!==r||_(a)||(f=this._getNextDateValue(!1,a,t,f,o,l+1)));return c},_calcSeriesTrendData:function(e,t,n){var r=[],o,i=1===n;if(i||2===n){for(1===e._dataCount()&&e._add(e._indexes[0]+1,i?e._toActualValue(e._innerValues[0]+1):e._values()[0]),o=0;o<t;o++)r.push(T(!!i,e._values2(),e._indexes2(),o+1));return r}return l},_fillAuto:function(e,t,n,r){var o=this,i=o._sheet,a=i._getSpanModel(),l=i._getActualRange(e),s=l.row,u=l.col,c=l.rowCount,_=l.colCount,f=i._getActualRange(i._eventHandler._dragFillStartRange),d=f.row,h=f.col;if(a.hasPartSpans(d,h,f.rowCount,f.colCount)||a.hasPartSpans(s,u,c,_))throw Error(y().Exp_ChangeMergedCell);return o._autoFillRange(f,c,_,t,n,!(s<d||u<h),r)},_autoFillRange:function(e,t,n,r,o,i,a){var _=this,f=i?1:-1,d,h,g,p,m=e.row,v=e.col,C=e.rowCount,w=e.colCount;if(1===r){if(d=u(n/w),h=n%w,!o)for(p=1;p<d;p++)g=c(m,v+p*f*w,C,w),_._copyRange(e,g,r,4,o,s,s,s,s,a);if(o&&d>1&&0===h&&(d-=1,h=w),d>0&&h>0)return g=i?c(m,v+d*w,C,h):c(m,v-d*w+w-h,C,h),_._copyRange(e,g,r,4,o,i,l,i?0:w-h,s,a)}else{if(d=u(t/C),h=t%C,!o)for(p=1;p<d;p++)g=c(m+p*f*C,v,C,w),_._copyRange(e,g,r,4,o,l,l,l,!0,a);if(o&&d>1&&0===h&&(d-=1,h=C),d>0&&h>0)return g=i?c(m+d*C,v,h,w):c(m-d*C+C-h,v,h,w),_._copyRange(e,g,r,4,o,i,i?0:C-h,l,!0,a)}},_copyRange:function(e,t,n,r,o,i,a,s,u,c){var _,f,d,h,g,p,m,v,y,x,b,T,A,I,M,E,F,D,N,V,O,H=this,P=H._sheet,L=1===n,k=L?e.row:e.col,B=L?e.col:e.row,W=L?t.row:t.col,z=L?t.col:t.row,U=L?e.rowCount:e.colCount,Y=L?e.colCount:e.rowCount,G=L?t.colCount:t.rowCount;for(h=0;h<U;h++){for(p=l,m=l,v=0,y=k+h,x=W+h,b=y,T=x,A=(L?s:a)||0,I=L?0:A,M=L?l:u;v<Y;)if(E=B+v,F=z+v-A,D=l,N=E,V=F,L||(y=E,E=b,x=F,F=T),d=P._getSpanModel().find(y,E),_=P.getFormula&&P.getFormula(y,E),_&&""!==_||(D=P.getValue(y,E)),4===r&&S(D)&&(p||(p=new R),f=D instanceof Date?w:C,m||(m=f),m===f))p._add(N,D),d?v+=L?d.colCount:d.rowCount:v++;else if(D&&p&&p._dataCount()){if(g=H._autoFillTrendValues(L,e,t,b,T,p,o,i,I,M,c),o&&g)return g;p=l,m=l}else{if(!d||d&&(L?d.row:d.col)===b)if(O=V===z+G-1,o){if(d&&O||!d&&(O&&i||!i&&V===z))return D}else V<z+G&&V>=z&&(L||!L&&!(u&&P._isRowFilterOut&&P._isRowFilterOut(V)))&&H._copyCell(P,y,E,x,F,D,r,c);d?v+=L?d.colCount:d.rowCount:v++}if(p&&p._dataCount()&&(g=H._autoFillTrendValues(L,e,t,b,T,p,o,i,I,M,c),o&&g))return g}return l},_copyCell:function(e,n,r,i,a,s,u,c){var _,f,d,h=e._getSpanModel();t._supportsCalc&&(e.hasFormula(n,r)||e.hasFormula(i,a))&&(e.setFormula(i,a,l),0!==u&&4!==u||(_=e._getCalcModel(),e.getFormula(n,r)&&o.CalcOperatorAdjustor.copyFormula(_,n,r,_,i,a,1,1))),e.setValue(i,a,s),d=64,c&&(d|=128),e.copyTo(n,r,i,a,1,1,d),h.isEmpty()||(e.removeSpan(i,a,3),(f=h.find(n,r))&&n===f.row&&r===f.col&&e._addSpanImp(i,a,f.rowCount,f.colCount,3))},_autoFillTrendValues:function(e,t,n,r,o,i,a,s,u,c,_){var f,d,h,g,p,m,v,C,w,y,S,x=this,b=x._sheet,R=e?n.col:n.row,A=e?t.col:t.row,I=e?n.colCount:n.rowCount,M=e?t.colCount:t.rowCount;if(u=u||0,p=i._dataCount(),m=(R-A-u)/M,v=x._isArithmeticProgression(i._indexes,i._innerValues),v){for(h=[],d=0;d<p;d++)h[d]=d+1;f=p}else g=i._indexes[0],f=i._indexes[p-1]-g+1,1===p&&i._add(i._indexes[0]+1,i._toActualValue(i._innerValues[0]+1)),h=i._indexes2();for(d=0;d<f;d++)if(C=T(!0,i._values2(),h,f*m+d+1),w=R+I-1,y=v?i._indexes[d]:g+d,S=y+m*M,a){if(v&&(s&&S===w||!s&&S===R)||!v&&S+u===w)return i._toActualValue(C)}else S<R+I&&S>=R&&(e?x._copyCell(b,r,y,o,S,i._toActualValue(C),4,_):c&&b._isRowFilterOut&&b._isRowFilterOut(S)||x._copyCell(b,y,r,S,o,i._toActualValue(C),4,_));return l},_isArithmeticProgression:function(e,t){var n,r,o,i=g(t);if(i<=1||g(e)!==i)return!1;for(n=e[1]-e[0],r=t[1]-t[0],o=2;o<i;o++)if(e[o]-e[o-1]!==n||t[o]-t[o-1]!==r)return!1;return!0},_fillAutoByDirection:function(e,t){var n=this,r=this._sheet,o=r.getSpans(),i=r._getActualRange(e),a=i.row,l=i.col,s=i.rowCount,u=i.colCount,_;_=0===t?c(a,l+u-1,s,1):1===t?c(a,l,s,1):2===t?c(a+s-1,l,1,u):c(a,l,1,u),(_=r._cellRangeInflate(o,_))&&n._directionFillRange(_,a,l,s,u,t)},_directionFillRange:function(e,t,n,r,o,i){var a=this,l=e.row,s=e.col,_=e.rowCount,f=e.colCount,d,h,g,p,m,v,C,w=a._sheet._getSpanModel(),S;if(0===i?(S=w.hasSpans(t,n,r,o-f),v=0,C=-1*f,g=o,p=f,m=1):1===i?(S=w.hasSpans(t,n+f,r,o-f),v=0,C=f,g=o,p=f,m=1):2===i?(S=w.hasSpans(t,n,r-_,o),v=-1*_,C=0,g=r,p=_,m=0):(S=w.hasSpans(t+_,n,r-_,o),v=_,C=0,g=r,p=_,m=0),S)throw Error(y().Exp_TargetContainsMergedCells);if(g%p!=0)throw Error(y().Exp_MergedCellsIdentical);for(d=u(g/p),h=1;h<d;h++)a._copyRange(e,c(l+h*v,s+h*C,_,f),m,0)},_getNextDateValue:function(e,t,n,r,o,i){var a=e?-1:1,l=u(i*o),s=Math.abs(o),c=v(t>1?n:r);if(0===t)c.setDate(c.getDate()+a*o);else if(1===t)for(;s>0;)c.setDate(c.getDate()+a*(o>0?1:-1)),6!==c.getDay()&&0!==c.getDay()&&s--;else 2===t?c.setMonth(c.getMonth()+a*l):c.setFullYear(c.getFullYear()+a*l);return m(c)}},i._FillImp=A,e.exports=i}()},function(e,t){e.exports=GC.Spread.CalcEngine},function(e,t,n){!function(){"use strict";var t,r,o=n(2),i=n(3),a=o._BaseDialog,l={},s=o.GC$,u=o._util._createElement,c=o._util,_=c._getPreferredZIndex,f=s(document),d=" btn btn-default",h="ui-state-hover ",g="gc-fill-type-item",p="gc-fill-menu-container",m=h+"gc-smartMenu-item-hover",v=h+"gc-smart-tag-hover",C="ui-icon ui-icon-check gc-check-image",w="gc-menu-item-input",y="ui-state-active gc-smart-tag-active",S="gc-tag-container",x="float",b="left",T="top",R="display",A="width",I="height",M="margin",E="change",F="input[type=radio]",D="mouseover",N="mouseout",V="click",O="fillTypeChanged",H="keydown.ui-fill",P=function(){return i._getResource(l.SR)()};function L(e,t,n,r,o,i){var a=e._isTouchMode,l=a?"160px":"150px",c=a?"25px":"20px",_=s(u("div")).css([R,A,I,"padding",M],["block",l,c,0,0]).addClass("gc-smartMenu-item-default "+n+" ui-state-default"+d),f=s(u("div")).addClass(w).appendTo(_),h=s(u("div")).addClass("gc-menu-item-text").appendTo(_),g=s(u("input")).attr({id:t,value:o,type:"radio",name:"fill-group",style:"display:none"}).appendTo(f);return s(u("span")).text(r).appendTo(h),i?(f.addClass(C),g.prop("checked","checked")):g.prop("checked",""),_}t=function(e){s.inherit(t,e);function t(t,n){var r=this,o;e.call(r,t,_(n.parent._host)),r._sheet=n,r._smartTagContainer=s("."+S),o=r._menuContainer=r._getContainer(),o.addClass(p),L(n,"smartMenuCopyCells",g,P().CopyCells,"0",!0).appendTo(o),L(n,"smartMenuFillSeries",g,P().FillSeries,"1").appendTo(o),L(n,"smartMenuFillFormattingOnly",g,P().FillFormattingOnly,"2").appendTo(o),L(n,"smartMenuFillWithoutFormatting",g,P().FillWithoutFormatting,"3").appendTo(o)}var n={_show:function(){e.prototype._show.call(this)},_attachEvent:function(){var e,t=this;s("."+g).bind(D,function(){s(this).addClass(m)}).bind(N,function(){s(this).removeClass(m)}).bind(V,function(){var e,n=s(this),r=t._smartTagContainer,o=n.find(F),i=o[0];i.checked=!0,o.trigger(E),r.trigger(V),r.trigger(N),n.removeClass(m),e=parseInt(s(i).attr("value")),t._changeFill(e)}),e=t._menuContainer.find(F),e.bind(E,function(){s("."+w).removeClass(C),s(this).parent().addClass(C)})},_dettachEvent:function(){s("."+g).unbind(D).unbind(N).unbind(V),this._menuContainer.find(F).unbind(E)},_changeFill:function(e){var t=this,n=t._sheet,r=n._eventHandler;if(t._fillType!==e){t._fillType=e,n._skipCloseDragFillSmartTag=!0,n.suspendEvent();try{o.Commands.undo.execute(n.parent,{sheetName:n.name()})}finally{n.resumeEvent()}n._skipCloseDragFillSmartTag=!1,n._commandManager().execute({cmd:"fill",sheetName:n.name(),startRange:r._dragFillStartRange,fillRange:r._currentFillRange,autoFillType:e,fillDirection:r._currentFillDirection}),t._smartTagContainer.trigger(O,e)}},_isOpen:function(){return!!s("."+p).length}};return s.extend(t.prototype,n),t}(a);function k(e){var t="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA",n="AAAASCAYAAA",r="AAAACXBIWXMAAA7",o="lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN"
;return e?t+"AcAAAASCAYAAACXScT7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTW"+o+"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":t+"BIAAAASCAYAAABWzo5XAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAKT2"+o+"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"}r=function(e){s.inherit(n,e);function n(t,n,r){var o=this,i;e.call(o,t,_(n.parent._host)),o._sheet=n,o._fillInfo=r,i=o._tagContainer=o._getContainer().addClass("gc-smart-tag-default "+S+" gc-no-user-select ui-widget-header"+d),o._smartTag=s(u("img")).attr("src",k(0)).css(x,b).appendTo(i),o._smartTagDown=s(u("img")).attr("src",k(1)).css([x,R],[b,"none"]).appendTo(i)}var r={_doMouseEvent:function(e,t,n){var r=this,o=r._sheet._isTouchMode,i=s(t),a=r._menuDialog,l=r._smartTagDown,u=o?"38px":"32px",c=o?"24px":"18px";a&&a._isOpen()||(e?i.addClass(v):i.removeClass(v),i.css([A,I],[e?u:c,c]),n||(e?l.show():l.hide()))},_registerEvent:function(){var e=this,t=e._tagContainer,n=c._device(),r=c._browser.safari&&(n.ipad||n.iphone);t.bind(D,function(){e._doMouseEvent(!0,this,r)}).bind(N,function(){e._doMouseEvent(!1,this,r)}),t.bind(V,function(){var t,n,o=s(this),i=e._menuDialog,a=e._smartTagDown;i&&i._isOpen()?(r&&a.hide(),o.removeClass(y),e._closeMenu()):(r&&a.show(),o.addClass(y),e._openMenu(),t=e._menuContainer,n=t&&t.find(F)[e._fillInfo.fillType],n&&!n.checked&&(n.checked=!0,s(n).trigger(E)))}),f.bind(H,function(t){27===t.keyCode&&(e._menuDialog&&e._menuDialog._isOpen()?e._closeMenu():e.close(),c._cancelDefault(t))})},_open:function(){var e=this,t=e._tagContainer,n=e._fillInfo,r=e._sheet._isTouchMode,o=r?"3px":"0px",i=r?"24px":"18px";t&&(t.css([b,T],[n.x,n.y]),e._show(),e._registerEvent(),e._smartTag.css(M,o),e._smartTagDown.css(I,i),e._reset())},_openMenu:function(){var e,n,r,o,i,a,l=this,s=l._sheet;l._menuDialog||(l._menuDialog=new t(s.parent._getContainerDiv(),s),l._menuContainer=l._menuDialog._getContainer()),e=l._tagContainer,n=e.css(b),r=e.css(T),o=parseFloat(r),i=l._menuDialog,a=l._fillInfo,i._fillType=a.fillType,isNaN(o)||(r=o+e.height()+2),l._menuContainer.css([b,T],[n,r]),i._show(),i._attachEvent(),i._smartTagContainer.unbind(O).bind(O,function(e,t){a.fillType=t})},_closeMenu:function(){var e=this._menuDialog;e&&(e._dettachEvent(),e.close())},_reset:function(){var e=this,t=e._menuDialog,n=e._tagContainer;t&&(t._isOpen()&&n.trigger(V),n.trigger(N))},close:function(){var t=this,n=t._sheet;t._reset(),f.unbind(H),e.prototype.close.call(t),n&&n._setFocus()}};return s.extend(n.prototype,r),n}(a),l._FillDialog=r,e.exports=l}()},function(e,t,n){!function(){"use strict";var e=n(2),t=n(3),r=n(5),o=n(4),i=e.GC$,a=e._createRange,l=e._supportsCalc,s=e.Events,u=t._Types._isNullOrUndefined,c=e.Rect,_=e._createLine,f=null,d=void 0,h=Math.min,g=Math.abs,p=Math.max,m=5,v=3,C="drag",w="corner",y="black",S=function(){return t._getResource(o.SR)()};function x(e){return e.rowViewportIndex}function b(e){return e.colViewportIndex}function T(e){return e.frozenRowCount()}function R(e){return e.frozenColumnCount()}function A(e){return e.hitTestType}function I(e,t){return e.getRowCount(t)}function M(e,t){return e.getColumnCount(t)}function E(e){return e.colCount}function F(e){return e.rowCount}function D(e){return e.height}function N(e){return e.width}function V(e,t,n,r,o){e.save();var i,a,l;t===r?(e.rect(t-2,n,7,g(o-n)),e.clip(),e.beginPath(),n<o?(n-=3,o+=3):(n+=3,o-=3),i=_(t-1,n-1,r-1,o+1,y,7),a=_(t,n,r,o,y,3),l=_(t+1,n-1,r+1,o+1,y,7)):n===o&&(e.rect(t,n-2,g(r-t),7),e.clip(),e.beginPath(),t<r?(t-=3,r+=3):(t+=3,r-=3),i=_(t-1,n-1,r+1,o-1,y,7),a=_(t,n,r,o,y,3),l=_(t-1,n+1,r+1,o+1,y,7)),a&&a._paintLine(e),e.stroke(),e.beginPath(),e.restore()}function O(e,t,n,r,o,i,a,l,u,c,_){var f=t?s.DragDropBlock:s.DragDropBlockCompleted,d={sheet:e,sheetName:e._name,fromRow:n,fromCol:r,toRow:o,toCol:i,rowCount:a,colCount:l,copy:u,insert:c,copyOption:_};return t&&(d.cancel=!1),e._trigger(f,d),d.cancel}function H(e,t,n,r,o){var i,a,l;for(i=0;i<n.rowCount;i++){for(a=0;a<n.colCount;a++){if(!(l=e.getSpan(n.row+i,n.col+a))||l.rowCount!==t.rowCount||l.colCount!==t.colCount)return!1;r&&(a+=t.colCount)}o&&(i+=t.rowCount)}return!0}function P(e,t,n){var r,o,i=t.row,a=t.rowCount,l=t.col,s=t.colCount,u=n.row,c=n.rowCount,_=n.col,f=n.colCount,d=i===u&&a===c,h=l===_&&s===f;return!(!d&&!h)&&(!(!(r=e.getSpan(i,l))||!H(e,r,t,d,h))&&(o=e._getSpanModel(),!o.hasPartSpans(u,_,c,f)&&H(e,r,n,d,h)))}i.extend(e._SheetEventHandler.prototype,{_startDragDropping:function(e){var t,n,r,o,i,a,l,s=this;s._isDragDropping||(t=s._sheet,n=f,1===t._selectionModel.length?n=t._selectionModel[0]:t._selectionModel.length<1&&(n=t._getSpanModel().get(t._activeRowIndex,t._activeColIndex)),n&&(s._isDragDropping=!0,s._isWorking=!0,s._dragDropFromRange=n,r=t.getRangeRect(x(e),b(e),n),o=s._dragRect,o.x=r.x,o.y=r.y,o.width=r.width-1,o.height=r.height-1,o.row=n.row,o.col=n.col,o.rowCount=F(n),o.colCount=E(n),i=t._getActualRange(n),a=e.row,l=e.col,a<i.row&&(a=i.row),a>=i.row+F(i)&&(a=i.row+F(i)-1),l<i.col&&(l=i.col),l>=i.col+E(i)&&(l=i.col+E(i)-1),o.hitRow=a,o.hitCol=l,o.rowOffset=a-i.row,o.colOffset=l-i.col,s._startHitInfo={_scrollRowViewportIndex:x(e),_scrollColViewportIndex:b(e),_hitTestType:A(e)},s._startScroll()))},_continueDragDropping:function(){var e,t,n,r,o,i,a,l,s,u=this;u._startHitInfo&&u._isWorking&&u._isDragDropping&&u._dragDropFromRange&&(e=u._mousePosition,t=u._dragRect,n=t.width/2,r=t.x+n,o=t.height/2,i=t.y+o,t.hitTarget={x:e.x,y:e.y},a=u._getHitRowIndex(),l=u._getHitColumnIndex(),s=!1,(g(r-e.x)>n+5||g(i-e.y)>o+5)&&(s=!0),a>=0&&l>=0&&s&&u._updateDragDropRect(a,l),u._continueScroll())},_updateDragDropRect:function(e,t){var n,r,o,i,a,l,s,u,c=this;c._isDragDropping&&c._dragDropFromRange&&(n=c._sheet,r=c._dragRect,o=n._getActiveSelectedRange(),-1===o.row&&-1!==o.col?(r.row=-1,r.col=p(0,h(M(n)-E(r),t-r.colOffset))):-1!==o.row&&-1===o.col?(r.row=p(0,h(I(n)-F(r),e-r.rowOffset)),r.col=-1):(r.row=r.row<0?-1:p(0,h(I(n)-F(r),e-r.rowOffset)),r.col=r.col<0?-1:p(0,h(M(n)-E(r),t-r.colOffset))),r.hitRow=e,r.hitCol=t,i=n._getActualRange(r),(a=c._oldDragRange)&&i.row===a.row&&i.col===a.col&&F(i)===F(a)&&E(i)===E(a)&&i.row>n._getFirstVisualRow()&&i.col>n._getFirstVisualColumn()&&i.row+F(i)-1<n._getLastVisualRow()&&i.col+E(i)-1<n._getLastVisualColumn()||(c._actualDragRange=i,n._render._refreshDragDropIndicator(),c._oldDragRange=i,(l=n.parent)&&l.options.showDragDropTip&&(s=r.x+r.width+m,u=r.y+r.height+m,l._showTooltip(c._getDragDropRectString(i),s,u))))},_getDragDropRectString:function(e){var t,n,o,i,a,s,u,c,_;return e&&l?(t=this._sheet,n=t._getActiveSelectedRange(),o=t.getActiveRowIndex(),i=t.getActiveColumnIndex(),o=o<0?0:o,i=i<0?0:i,1===F(n)&&1===E(n)?a=r._createCellExpression(f,f,e.row-o,e.col-i,!0,!0):(-1===n.row&&n.col>=0?(s=c=r.BAND_INDEX_CONST,u=e.col-i,_=e.col-i+E(n)-1):-1===n.col&&n.row>=0?(u=_=r.BAND_INDEX_CONST,s=e.row-o,c=e.row-o+F(n)-1):n.row>=0&&n.col>=0&&(s=e.row-o,c=e.row-o+F(n)-1,u=e.col-i,_=e.col-i+E(n)-1),a=r._createRangeExpression(f,f,s,u,c,_,!0,!0,!0,!0)),t._getCalcServiceInternal().unparse(t._getSheetSource(),a,o,i)):d},_stopDragDrop:function(){var e,t,n,r,o,i,u,c,_,d,h=this,g=!1,p="",m=!1,v=h._sheet;h._startHitInfo=f,h._stopScroll(),t=v._getActiveSelectedRange(),e=t&&(F(t)>0||E(t)>0)?{r:t.row,c:t.col,rc:F(t),cc:E(t)}:{r:v._activeRowIndex,c:v._activeColIndex,rc:1,cc:1},!0===h._isDragDropping&&!0===h._isWorking&&(n=e.r,r=e.c,o=e.rc,i=e.cc,u=h._dragRect.row,c=h._dragRect.col,d={fromRow:n,fromColumn:r,rowCount:o,columnCount:i,toRow:u,toColumn:c,isDragInsert:h._isDragInsert,isDragCopy:h._isDragCopy},v._trigger(s.BeforeDragDrop,d),(p=d.invalidMessage)&&0!==p.length||(!h._isDragInsert||-1!==n&&-1!==r?u===n&&c===r||((v._hasPartSpans(n,r,o,i)||v._hasPartSpans(u,c,o,i))&&(g=!0,p=S().Exp_ChangeMergedCell),g||l&&(v._hasPartArrayFormulas(n,r,o,i)||v._hasPartArrayFormulas(u,c,o,i))&&(g=!0,p=S().Exp_ChangePartOfArray),!g&&v.options.isProtected&&(!h._isDragCopy&&v._isAnyCellInRangeLocked(a(n,r,o,i))||v._isAnyCellInRangeLocked(a(u,c,o,i)))&&(g=!0,p=S().Exp_CellReadOnly),g||(_=O(v,!0,n,r,u,c,o,i,h._isDragCopy,!1,1023))||(m=v._commandManager().execute({cmd:"dragDrop",sheetName:v.name(),fromRow:n,fromColumn:r,toRow:u,toColumn:c,rowCount:o,columnCount:i,copy:h._isDragCopy,insert:!1,option:1023}),O(v,!1,n,r,u,c,o,i,h._isDragCopy,!1,1023))):r>=0?(h._isDragCopy&&(c<=r||c>=r+i)||!h._isDragCopy&&(c<r||c>r+i))&&((v._hasPartSpans(-1,r,-1,i)||v._hasPartSpans(-1,c,-1,0))&&(g=!0,p=S().Exp_ChangeMergedCell),!g&&v.options.isProtected&&(g=!0,p=S().Exp_ColumnReadOnly),g||(_=O(v,!0,-1,r,-1,c,-1,i,h._isDragCopy,!0,1023))||(m=v._commandManager().execute({cmd:"dragDrop",sheetName:v.name(),fromRow:-1,fromColumn:r,toRow:-1,toColumn:c,rowCount:-1,columnCount:i,copy:h._isDragCopy,insert:!0,option:1023}),O(v,!1,-1,r,-1,c,-1,i,h._isDragCopy,!0,1023))):n>=0&&r<0&&(h._isDragCopy&&(u<=n||u>=n+o)||!h._isDragCopy&&(u<n||u>n+o))&&((v._hasPartSpans(n,-1,o,-1)||v._hasPartSpans(u,-1,0,-1))&&(g=!0,p=S().Exp_ChangeMergedCell),g||l&&(v._hasPartArrayFormulas(n,-1,o,-1)||v._hasPartArrayFormulas(u,-1,0,-1))&&(g=!0,p=S().Exp_ChangePartOfArray),!g&&v.options.isProtected&&(g=!0,p=S().Exp_RowReadOnly),g||(_=O(v,!0,n,-1,u,-1,o,-1,h._isDragCopy,!0,1023))||(m=v._commandManager().execute({cmd:"dragDrop",sheetName:v.name(),fromRow:n,fromColumn:-1,toRow:u,toColumn:-1,rowCount:o,columnCount:-1,copy:h._isDragCopy,insert:!0,option:1023}),O(v,!1,n,-1,u,-1,o,-1,h._isDragCopy,!0,1023))))),h._isWorking=!1,h._isDragDropping=!1,h._dragDropFromRange=f,h._isDragInsert=!1,h._isDragCopy=!1,h._oldDragRange=f,h._removeTooltip(),m||(h._dragRect={},v.repaint()),g&&v._raiseInvalidOperation(3,p)},_startDragFill:function(e){var t=this;!0!==t._isDraggingFill&&!0!==t._isWorking&&(t._updateDragFillStartRange(),t._dragFillStartRange&&(t._isWorking=!0,t._isDraggingFill=!0,t._isDragAroundIndicator=!0,t._dragStartRowViewport=e,t._dragStartColumnViewport=b(e),t._dragToRowViewport=x(e),t._dragToColumnViewport=b(e),t._updateDragStartRangeViewports(),t._startHitInfo={_scrollRowViewportIndex:x(e),_scrollColViewportIndex:b(e),_hitTestType:A(e)},t._startScroll()))},_updateDragStartRangeViewports:function(){var e,t=this,n=T(t._sheet),r=R(t._sheet),o=t._dragFillStartTopRow();o>=0&&o<n?t._dragFillStartTopRowViewport=0:o>=n&&o<=I(t._sheet)&&(t._dragFillStartTopRowViewport=1),t._isDragFillWholeColumns()?t._dragFillStartBottomRowViewport=1:t._dragFillStartBottomRowViewport=t._dragStartRowViewport,e=t._dragFillStartLeftColumn(),e>=0&&e<r?t._dragFillStartLeftColumnViewport=0:e>=r&&e<=M(t._sheet)&&(t._dragFillStartLeftColumnViewport=1),t._isDragFillWholeRows()?t._dragFillStartRightColumnViewport=1:t._dragFillStartRightColumnViewport=t._dragStartColumnViewport},_continueDragFill:function(){var e,t,n,r=this;r._startHitInfo&&r._isDraggingFill&&r._isWorking&&r._dragFillStartRange&&(r._dragToRowViewport=r._getHitRowViewportIndex(),r._dragToColumnViewport=r._getHitColumnViewportIndex(),r._dragToRow=r._getHitRowIndex(),r._dragToColumn=r._getHitColumnIndex(),r._dragToRow>=0&&r._dragToColumn>=0&&(r._updateCurrentFillSettings(),r._updateCurrentFillRange(),e=r._sheet.parent,t=!1,n=r._getDragFillFrameRange(),n&&(t=r._validateFillRange(r._dragFillStartRange,r._currentFillRange,!0)),e&&e.options.showDragFillTip&&t&&r._showDragFillTooltip(),r._refreshDragFill()),r._continueScroll())},_getDragFillTooltipContent:function(){var e,r,i,a,l,s,u,c,_,d,h,g,p,m,v=this,C=v._sheet,w=v._dragFillStartRange,y=v._currentFillRange,S=C.parent.options.defaultDragFillType,x=v._getDragAutoFillType(3===S?5:S),b=v._getCurrentFillDirection(),T=v._getDragFillFrameRange();return 1===x?(e=0===b||1===b?1:0,r=new o._FillImp(C),i=r._fillAuto(T,e,!0),a=v._getAvailableRange(b,y,w),l=C.getActualStyle(a.row,a.col),s=l.cellType||C._getDefaultCellType(),u=l.formatter?l.formatter:l._autoFormatter,c=n(8),_=c&&c.GeneralFormatter,i instanceof Date&&_&&(u=new _(t.CultureManager._getCultureInfo().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@",0)),d=v._startHitInfo,h=3,d&&(h=d._hitTestType),g={sheet:C,row:a.row,col:a.col,sheetArea:h,quotePrefix:l.quotePrefix},p={},s.format(i,u,p,g)):0===x?(a=v._getAvailableRange(b,y,w),m=C.getFormula(a.row,a.col),m?f:C.getText(a.row,a.col)):f},_getAvailableRange:function(e,t,n){var r,o=n.row,i=n.col,l=F(n),s=E(n),u=a(o,i,1,1);return 3===e?(r=F(t)%l,r=0===r?o+l-1:o+r-1,u.row=r,u.col=i):1===e?(r=E(t)%s,r=0===r?i+s-1:i+r-1,u.row=o,u.col=r):0===e?(r=E(t)%s,r=0===r?i:i+s-r,u.row=o,u.col=r):2===e&&(r=F(t)%l,r=0===r?o:o+l-r,u.row=r,u.col=i),u},_showDragFillTooltip:function(){var e,t,n,r,o,i,a=this,l=a._sheet;if(4===a._getDragAutoFillType()||a._isDragFillWholeRows()||a._isDragFillWholeColumns())return a._removeTooltip(),f;r=a._getCurrentFillDirection(),o=a._getDragFillFrameRange(),i=l._getRangeWholeRect(o),n=a._getDragFillTooltipContent(),3===r||1===r?(e=i.x+i.width+v,t=i.y+i.height+v):0===r?(e=i.x+v,t=i.y+i.height+v):2===r&&(e=i.x+i.width+v,t=i.y+v),a._showTooltip(n,e,t)},_refreshDragFill:function(){var e=this;e._clearDragFill(),e._refreshSelectionBorder(),e._paintDragFill(),e._oldDragFillFrameRange=e._getDragFillFrameRange()},_clearDragFill:function(){var e,t=this._sheet;this._oldDragFillFrameRange&&(e=t._getRangeWholeRect(this._oldDragFillFrameRange),e.x-=2,e.y-=2,e.width+=4,e.height+=4,t._render._copyDoubleBufferRect(e))},_refreshSelectionBorder:function(e){this._sheet._render._repaintSelection(this._dragFillStartRange,f,e)},_paintDragFill:function(){var e,t,n=this._sheet,r=n._render,o=this._getDragFillFrameRange();o&&(e=r._getCtx(),t=n._getRangeWholeRect(o),e.save(),e.beginPath(),r._paintDragRectangle(e,t),e.restore())},_updateCurrentFillRange:function(){this._currentFillRange=this._getCurrentFillRange()},_isDragFillWholeRows:function(){return-1===this._dragFillStartRange.col&&-1!==this._dragFillStartRange.row},_isDragFillWholeColumns:function(){return-1===this._dragFillStartRange.row&&-1!==this._dragFillStartRange.col},_isDragClear:function(){return 4===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillRange:function(){var e=this,t=-1,n=-1,r=-1,o=-1;switch(e._currentFillDirection){case 0:e._isDragFillWholeColumns()?(t=-1,r=-1):(t=e._dragFillStartTopRow(),r=F(e._dragFillStartRange)),n=e._dragToColumn,o=e._dragFillStartLeftColumn()-n;break;case 1:e._isDragFillWholeColumns()?(t=-1,r=-1):(t=e._dragFillStartTopRow(),r=F(e._dragFillStartRange)),n=e._dragFillStartRightColumn()+1,o=e._dragToColumn-n+1;break;case 2:t=e._dragToRow,r=e._dragFillStartTopRow()-t,e._isDragFillWholeRows()?(n=-1,o=-1):(n=e._dragFillStartLeftColumn(),o=E(e._dragFillStartRange));break;case 3:t=e._dragFillStartBottomRow()+1,r=e._dragToRow-t+1,e._isDragFillWholeRows()?(n=-1,o=-1):(n=e._dragFillStartLeftColumn(),o=E(e._dragFillStartRange));break;case 5:t=e._dragToRow,r=e._dragFillStartBottomRow()-t+1,e._isDragFillWholeRows()?(n=-1,o=-1):(n=e._dragFillStartLeftColumn(),o=E(e._dragFillStartRange));break;case 4:e._isDragFillWholeColumns()?(t=-1,r=-1):(t=e._dragFillStartRange.row,r=F(e._dragFillStartRange)),n=e._dragToColumn,o=e._dragFillStartRightColumn()-n+1}return a(t,n,r,o)},_dragFillStartBottomRowLayout:function(){var e=this._dragFillStartBottomRow();return-1!==e?this._sheet._getRowLayout(this._dragFillStartBottomRowViewport).findRow(e):f},_dragFillToViewportBottomRowLayout:function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this._dragFillToViewportBottomRow())},_dragFillToViewportBottomRow:function(){return this._sheet.getViewportBottomRow(this._dragToRowViewport)},_dragFillStartRightColumnLayout:function(){var e=this._dragFillStartRightColumn();return-1!==e?this._sheet._getColumnLayout(this._dragFillStartRightColumnViewport).findCol(e):f},_dragFillToViewportRightColumnLayout:function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this._dragFillToViewportRightColumn())},_dragFillToViewportRightColumn:function(){return this._sheet.getViewportRightColumn(this._dragToColumnViewport)},_updateCurrentFillSettings:function(){var e,t,n,r,o,a,l,s,u,c,_,f,d,p,m,v,C,w,y,S,x=this,b=x._isDragFillWholeRows(),T=x._isDragFillWholeColumns(),R=i(x._sheet._getCanvas()).offset(),A=x._mousePosition.e,I=x._mousePosition.x,M=x._mousePosition.y,E=A.pageX-R.left,F=A.pageY-R.top,D=!1;b||T?T?x._dragToColumn>=x._dragFillStartLeftColumn()&&x._dragToColumn<=x._dragFillStartRightColumn()?x._currentFillDirection=4:x._dragToColumn<x._dragFillStartLeftColumn()?x._currentFillDirection=0:x._dragToColumn>x._dragFillStartRightColumn()&&(x._currentFillDirection=1):b&&(x._dragToRow>=x._dragFillStartTopRow()&&x._dragToRow<=x._dragFillStartBottomRow()?x._currentFillDirection=5:x._dragToRow<x._dragFillStartTopRow()?x._currentFillDirection=2:x._dragToRow>x._dragFillStartBottomRow()&&(x._currentFillDirection=3)):x._dragToRow>=x._dragFillStartTopRow()&&x._dragToRow<=x._dragFillStartBottomRow()?x._dragToColumn>=x._dragFillStartLeftColumn()&&x._dragToColumn<=x._dragFillStartRightColumn()?(e=g(x._dragToColumn-x._dragFillStartRightColumn()),t=g(x._dragToRow-x._dragFillStartBottomRow()),t>e?x._currentFillDirection=5:t<e?x._currentFillDirection=4:(n=x._dragFillStartBottomRowLayout(),n||(n=x._dragFillToViewportBottomRowLayout()),M>n.y+n.height?x._currentFillDirection=3:(r=x._dragFillStartRightColumnLayout(),r||(r=x._dragFillToViewportRightColumnLayout()),o=r.x+r.width-I,a=n.y+n.height-M,E>=r.x&&E<=r.x+r.width&&F>=n.y&&F<=n.y+n.height?x._currentFillDirection=o>=a?4:5:D=!0))):x._dragToColumn<x._dragFillStartLeftColumn()?x._currentFillDirection=0:x._dragToColumn>x._dragFillStartRightColumn()&&(x._currentFillDirection=1):x._dragToRow<x._dragFillStartTopRow()?x._dragToColumn>=x._dragFillStartLeftColumn()&&x._dragToColumn<=x._dragFillStartRightColumn()?x._currentFillDirection=2:x._dragToColumn<x._dragFillStartLeftColumn()?(e=g(x._dragToColumn-x._dragFillStartLeftColumn()),t=g(x._dragToRow-x._dragFillStartTopRow()),x._currentFillDirection=t>=e?2:0):x._dragToColumn>x._dragFillStartRightColumn()&&(e=g(x._dragToColumn-x._dragFillStartRightColumn()),t=g(x._dragToRow-x._dragFillStartTopRow()),x._currentFillDirection=t>=e?2:1):x._dragToRow>x._dragFillStartBottomRow()&&(x._dragToColumn>=x._dragFillStartLeftColumn()&&x._dragToColumn<=x._dragFillStartRightColumn()?x._currentFillDirection=3:x._dragToColumn<x._dragFillStartLeftColumn()?(e=g(x._dragToColumn-x._dragFillStartLeftColumn()),t=g(x._dragToRow-x._dragFillStartBottomRow()),x._currentFillDirection=t>=e?3:0):x._dragToColumn>x._dragFillStartRightColumn()&&(e=g(x._dragToColumn-x._dragFillStartRightColumn()),t=g(x._dragToRow-x._dragFillStartBottomRow()),x._currentFillDirection=t>=e?3:1)),(l=x._sheet._render._dragFillIndicatorRect)&&(s=x._dragFillStartBottomRow(),u=x._dragFillStartRightColumn(),c=s+1,_=u+1,f=x._sheet.getRowHeight(s,3),d=x._sheet.getColumnWidth(u,3),p=x._sheet.getRowHeight(c,3),m=x._sheet.getColumnWidth(_,3),v=l.x+l.width/2-h(10,d/2),C=l.x+l.width/2+h(10,m/2),w=l.y+l.height/2-h(10,f/2),y=l.y+l.height/2+h(10,p/2),S=!1,S=b||T?T?v<=E&&E<=C:w<=F&&F<=y:v<=E&&E<=C&&w<=F&&F<=y,S||D?(x._isDragAroundIndicator=!0,x._currentFillDirection=4):x._isDragAroundIndicator=!1)},_dragFillStartTopRow:function(){return this._dragFillStartRange?-1===this._dragFillStartRange.row?0:this._dragFillStartRange.row:-1},_dragFillStartBottomRow:function(){var e=this;return e._dragFillStartRange?-1===e._dragFillStartRange.row?I(e._sheet)-1:e._dragFillStartRange.row+F(e._dragFillStartRange)-1:-1},_dragFillStartLeftColumn:function(){return this._dragFillStartRange?-1===this._dragFillStartRange.col?0:this._dragFillStartRange.col:-1},_dragFillStartRightColumn:function(){var e=this;return e._dragFillStartRange?-1===e._dragFillStartRange.col?M(e._sheet)-1:e._dragFillStartRange.col+E(e._dragFillStartRange)-1:-1},_fixFillRange:function(e,t){var n,r,o,i,l,s,u=a(t.row,t.col,t.rowCount,t.colCount),c=this._sheet;return c._getSpanModel().find(e.row,e.col)&&(n=e.rowCount,r=u.rowCount,0!==Math.floor(r%n)&&(o=Math.ceil(r/n)*n,u.row+o<=c.getRowCount()&&(u.rowCount=o)),i=e.colCount,l=u.colCount,0!==Math.floor(l%i)&&(s=Math.ceil(l/i)*i,u.col+s<=c.getColumnCount()&&(u.colCount=s))),u},_endDragFill:function(){var e,t,n,r,o,i,a=this,l=a._sheet;if(a._startHitInfo=f,a._stopScroll(),a._removeTooltip(),!a._isDraggingFill||!a._isWorking)return void a._resetDragFill();a._isDraggingFill=!1,a._isWorking=!1,(e=a._getDragFillFrameRange())&&(t=a._validateFillRange(a._dragFillStartRange,a._currentFillRange),!t||a._isDragAroundIndicator?(a._resetDragFill(),a._refreshSelection(e)):(n=l._eventHandler._dragFillStartRange,r=a._fixFillRange(n,a._currentFillRange),o=a._getDragAutoFillType(),l._commandManager().execute({cmd:"fill",sheetName:l.name(),startRange:n,fillRange:r,autoFillType:o,fillDirection:l._eventHandler._getCurrentFillDirection()}),i=a._isCancelDragFill,!i&&a._isDragFill()&&l.parent.options.showDragFillSmartTag&&4!==a._currentDragFillType?a._showDragFillSmartTag(a._currentDragFillType):a._refreshSelection(e),a._resetDragFill()))},_showDragFillSmartTag:function(e){var t=this._sheet,n=t._render._dragFillIndicatorRect,r={x:n.x+n.width,y:n.y+n.height,fillType:e};t._fillDialog=new o._FillDialog(t.parent._getContainerDiv(),t,r),t._fillDialog._open()},_updateDragFillStartRange:function(){var e=this._sheet;1===e._selectionModel.length?this._dragFillStartRange=e._selectionModel[0]:e._activeRowIndex>=0&&e._activeColIndex>=0&&(this._dragFillStartRange=a(e._activeRowIndex,e._activeColIndex,1,1))},_resetDragFill:function(){this._isWorking=!1,this._isDraggingFill=!1},_refreshSelection:function(e){this._sheet._render._repaintSelection(e)},_getDragAutoFillType:function(e){var t,n=this,r=n._sheet,o=e!==d?e:r.parent.options.defaultDragFillType;return n._isDragClear()?4:5!==o?o:(t=1===F(n._dragFillStartRange)&&1===E(n._dragFillStartRange)&&!n._isDragFillWholeColumns()&&!n._isDragFillWholeRows(),t?n._isControlPressed?1:0:n._isControlPressed?0:1)},_getDragFillFrameRange:function(){var e,t,n,r,o=this;return o._dragFillStartRange?o._isDragClear()?o._dragFillStartRange:o._currentFillRange?(e=0,t=0,n=0,r=0,o._isVerticalDragFill()?(e=2===o._currentFillDirection?o._currentFillRange.row:o._dragFillStartRange.row,t=F(o._dragFillStartRange)+F(o._currentFillRange),n=o._dragFillStartRange.col,r=E(o._dragFillStartRange)):(e=o._dragFillStartRange.row,t=F(o._dragFillStartRange),n=0===o._currentFillDirection?o._currentFillRange.col:o._dragFillStartRange.col,r=E(o._dragFillStartRange)+E(o._currentFillRange)),a(e,n,t,r)):f:f},_validateFillRange:function(e,t,n){var r=this._sheet,o=!0,i="";return r._getSpanModel().hasSpans(t.row,t.col,F(t),E(t))&&!P(r,e,t)&&(o=!1,i=S().Exp_FillRangeContainsMergedCell),o&&r.options.isProtected&&r._isAnyCellInRangeLocked(t)&&(o=!1,i=S().Exp_FillCellsReadOnly),o||n||r._raiseInvalidOperation(2,i),o},_isDragFill:function(){return this._isIncreaseFill()||this._isDecreaseFill()},_isIncreaseFill:function(){return 3===this._currentFillDirection||1===this._currentFillDirection},_isDecreaseFill:function(){return 0===this._currentFillDirection||2===this._currentFillDirection},_isVerticalDragFill:function(){return 2===this._currentFillDirection||3===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillDirection:function(){var e=this._currentFillDirection;return e>=0&&e<=3?e:4===e?0:5===e?2:3},_getDragInfo:function(e,t,n){var r,o,i,a,l,s=this,c=f,_=x(e),d=b(e);if(u(_)||u(d))return c;if(r=s._sheet,o=r.parent,i=r._getActiveSelectedRange(),-1===i.row&&-1===i.col)return c;if(_>=0&&d>=0&&1===r._selectionModel.length){if(s._inGrayArea(_,d,t,n))return c;a=r.getRangeRect(_,d,i),a.x-4<t&&t<a.x+4&&a.y<=n&&n<a.y+a.height&&(c={action:C,side:"left"}),c||(l=s._sheet._render._dragFillIndicatorRect)&&l.x<=t&&t<=l.x+l.width&&l.y<=n&&n<=l.y+l.height&&(c={action:C,side:w}),c||a.x+a.width-4<t&&t<a.x+a.width+4&&a.y<=n&&n<a.y+a.height&&(c={action:C,side:"right"}),c||a.y-4<n&&n<a.y+4&&a.x<=t&&t<a.x+a.width&&(c={action:C,side:"top"}),c||a.y+a.height-4<n&&n<a.y+a.height+4&&a.x<=t&&t<a.x+a.width&&(c={action:C,side:"bottom"}),c&&(t<a.x||t>a.x+a.width||n<a.y||n>a.y+a.height)&&(c.outside=!0)}return o&&o.options.allowUserDragDrop||c&&c.side!==w&&(c.side=f),o&&o.options.allowUserDragFill||c&&c.side===w&&(c.side=f),c}}),i.extend(e._SheetRender.prototype,{_getDragFillIndicatorRect:function(e,t){var n,r=this._sheet,o=e.x,i=e.y,a=N(e),l=D(e),s=r._getActiveSelectedRange(),u=r._getSheetLayout(),_=4,f=-2.5;return t>2007&&(_=5,f=-3),n=new c(-4,-4,_,_),-1===s.col?(n.x=u._frozenX,
n.y=i+l+f):-1===s.row?(n.x=o+a+f,n.y=u._frozenY):(n.x=o+a+f,n.y=i+l+f),n},_paintDragFillIndicator:function(t,n,r,o,i){var a,l,s=this,u=s._sheet,_=u._getSheetLayout(),f=u.parent,d=f&&f._themeVersion,h=s._getDragFillIndicatorRect(o,d),g=h.x,m=h.y,v=N(h),C=D(h),w=_._viewportRect(n,r);i&&!h.intersectRect(i)||h.intersectRect(w)&&(a=-1.5,d>2007&&(a=-1),l=new c(g+a,m+a,v+2,C+2),l.x=p(l.x,w.x),l.y=p(l.y,w.y),t.save(),i&&!i.containsRect(h)&&(t.rect(i.x,i.y,N(i),D(i)),t.clip()),t.beginPath(),t.strokeStyle=e._ThemeContext._getColor(u,u.getSelectionBorderColor()),t.strokeRect(l.x,l.y,l.width,l.height),t.fillStyle="#FFFFFF",t.fillRect(l.x+.5,l.y+.5,l.width-1,l.height-1),s._dragFillIndicatorRect=new c(h.x,h.y,4,4),t.beginPath(),t.restore())},_paintDragRectangle:function(e,t){var n=t.x,r=t.y,o=n+N(t),i=r+D(t);e.strokeStyle=this._sheet.getSelectionBorderColor(),V(e,n,r,o,r),V(e,n,i,o,i),V(e,n,r,n,i),V(e,o,r,o,i)},_paintDragDropIndicator:function(e,t){var n,r,o,i,a,l,s,u,_,f,d,h=this,g=h._sheet,p=g._eventHandler._dragRect,m=p.hitTarget;p&&m&&(n=p.hitCol,r=p.hitRow,o=g._eventHandler._isDragInsert,i=g._dragOldRect,e.save(),!0!==o||-1!==p.row&&-1!==p.col?(i&&(a=new c(i.x-2,i.y-2,N(i)+4,D(i)+4),h._copyDoubleBufferRect(a,t),h._repaintSelection(g._getActiveSelectedRange(),t)),e.rect(t.x,t.y,N(t),D(t)),e.clip(),e.beginPath(),h._paintDragRectangle(e,p)):-1===p.row&&-1!==p.col?(l=g._getColumnLayout(0).findCol(n),l||(l=g._getColumnLayout(1).findCol(n)),l||(l=g._getColumnLayout(2).findCol(n)),l&&(s=l.x,u=N(l),p.col=n,m.x>s+u/2&&(p.col<g._getLastFullyVisibleColumn()||p.col===g._getLastVisualColumn())&&(s=l.x+N(l),p.col++),i&&0===N(i)||(i=g._eventHandler._dragRect),i&&(a=new c(i.x-2,i.y-2,N(i)+4,D(i)+4),h._copyDoubleBufferRect(a,t),h._repaintSelection(g._getActiveSelectedRange(),t)),g._insertDragRect=new c(s,p.y,0,D(p)),e.rect(t.x,t.y,N(t),D(t)),e.clip(),e.beginPath(),e.strokeStyle=this._sheet.getSelectionBorderColor(),V(e,s,p.y,s,p.y+D(p)))):-1!==p.row&&-1===p.col&&(_=g._getRowLayout(0).findRow(r),_||(_=g._getRowLayout(1).findRow(r)),_||(_=g._getRowLayout(2).findRow(r)),_&&(f=_.y,d=D(_),p.row=r,m.y>f+d/2&&(p.row<g._getLastFullyVisibleRow()||p.row===g._getLastVisualRow())&&(f=_.y+D(_),p.row++),i&&0===D(i)||(i=g._eventHandler._dragRect),i&&(a=new c(i.x-2,i.y-2,N(i)+4,D(i)+4),h._copyDoubleBufferRect(a,t),h._repaintSelection(g._getActiveSelectedRange(),t)),g._insertDragRect=new c(p.x,f,N(p),0),e.rect(t.x,t.y,N(t),D(t)),e.clip(),e.beginPath(),e.strokeStyle=this._sheet.getSelectionBorderColor(),V(e,p.x,f,p.x+N(p),f))),e.beginPath(),e.restore())},_refreshDragDropIndicator:function(){var e,t,n,r,o,i,a,l,s,u,_,f,d=this,h=d._sheet,g=h._currentTarget;g&&g.dragInfo&&(e=d._getCtx(),t=h._getSheetLayout(),n=h._eventHandler._actualDragRange,r=h._eventHandler._dragRect,o=h._getRangeWholeRect(n),i=h.frozenTrailingColumnCount(),a=h.frozenTrailingRowCount(),l=h.getColumnCount()-i,s=h.getRowCount()-a,u=t._viewportRect(1,1),i>0&&n.col+n.colCount<=l&&o.x+N(o)>u.x+N(u)&&o.intersectRect(u)&&(o=o.getIntersectRect(u)),a>0&&n.row+n.rowCount<=s&&o.y+D(o)>u.y+D(u)&&o.intersectRect(u)&&(o=o.getIntersectRect(u)),_=new c(t._frozenX,t._frozenY,t._frozenTrailingX+t._frozenTrailingWidth,t._frozenTrailingY+t._frozenTrailingHeight),N(o)>0&&D(o)>0?(r.x=o.x,r.y=o.y,r.width=N(o)-1,r.height=D(o)-1,d._paintDragDropIndicator(e,_)):0!==N(o)&&0!==D(o)||(r.x=o.x,r.y=o.y,r.width=N(o),r.height=D(o),d._paintDragDropIndicator(e,_)),f=h._eventHandler._isDragInsert,h._dragOldRect=!0===f?h._insertDragRect:new c(r.x,r.y,N(r),D(r)))}})}()},function(e,t){e.exports=GC.Spread.Formatter},function(e,t){!function(){"use strict";e.exports={CopyCells:"Copy Cells",FillSeries:"Fill Series",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",Exp_NumberOnly:"Only works for Numbers",Exp_RangeContainsMergedCell:"Range should not have merged cells.",Exp_TargetContainsMergedCells:"Target range should not have merged cells.",Exp_MergedCellsIdentical:"This operation requires the merged cells to be identically sized.",Exp_FillRangeContainsMergedCell:"Cannot fill range that contains a merged cell.",Exp_FillCellsReadOnly:"The cells you are trying to fill are protected and therefore read-only.",Exp_ChangeMergedCell:"Cannot change part of merged cell.",Exp_ColumnReadOnly:"The column you are trying to change is protected and therefore read-only.",Exp_RowReadOnly:"The row you are trying to change is protected and therefore read-only.",Exp_CellReadOnly:"The cell you are trying to change is protected and therefore read-only.",Exp_RangeIsNull:"range is null",Exp_ChangePartOfArray:"Cannot change part of an array."}}()}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Search=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";e.exports=n(1)}()},function(e,t,n){!function(){"use strict";var t=n(2),r=n(3)._RegexHelper,o=null,i=Math.max,a="string",l={};function s(e,t,n){if(!e)return!1;if(e=""+e,t=""+t,0===n)return e.indexOf(t)>-1;var o=(2&n)>0,i=(1&n)>0,a=(4&n)>0,l;return a?(l=o?r._getWildcardCriteriaFullMatch(t,!1,!0):r._getWildcardCriteria(t),t=l||t,l=i?r._getRegIgnoreCase(t):r._getReg(t),l.test(e)):(i&&(t=t.toLowerCase(),e=e.toLowerCase()),o?t===e:e.indexOf(t)>=0)}function u(e,t,n,r,i,a,l,s){var u=o,c=e+1,_=t+1;return 0===n?_>=0&&_<=s?u={r:e,c:_}:c>=0&&c<=a&&(u={r:c,c:r?l:0}):c<=a?u={r:c,c:t}:_<=s&&(u={r:r?i:0,c:_}),u}t.Worksheet.prototype.search=function(e){var n,r,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A;if(!e)return o;if(n=this,r=e.sheetArea,c=e.searchString,_=e.searchTarget,f=e.searchFlags,d=n.getRowCount(r),h=n.getColumnCount(r),g=new l.SearchResult,!c||0===_||d<=0&&h<=0)return g;for(p=i(0,e.rowStart),m=i(0,e.columnStart),v=e.rowEnd,C=e.columnEnd,w=(8&f)>0,(v<0||!w)&&(v=d-1),(C<0||!w)&&(C=h-1),y=e.findBeginRow,S=e.findBeginColumn,x=y<0?p:y,b=S<0?m:S;x>=0&&b>=0;){if(T=n.getCell(x,b,r),(1&_)>0&&""!==(R=T.text())&&s(R,c,f)&&(g.searchFoundFlag|=1,g.foundString=R),t._supportsCalc&&(8&_)>0&&typeof(R=T.formula())===a&&""!==R&&s(R,c,f)&&(g.searchFoundFlag|=8,g.foundString=R),(4&_)>0&&typeof(R=T.tag())===a&&""!==R&&s(R,c,f)&&(g.searchFoundFlag|=4,g.foundString=R),0!==g.searchFoundFlag)return g.foundRowIndex=x,g.foundColumnIndex=b,g;if(!(A=u(x,b,e.searchOrder,w,p,v,m,C)))break;x=A.r,b=A.c}return g},t.Workbook.prototype.search=function(e){var t,n,r,i,a,s,u,c,_;if(!e)return o;if(t=this,n=0,r=t.getSheetCount(),i=new l.SearchResult,!e.searchString||e.searchTarget===n||r<=0)return i;if(-1===e.startSheetIndex&&(e.startSheetIndex=0),-1===e.endSheetIndex&&(e.endSheetIndex=r-1),c=e.startSheetIndex,_=e.endSheetIndex,_>=c&&0<=c&&c<r&&0<=_&&_<r)for(a=c;a<=_;a++)if(s=t.getSheet(a),(u=s.search(e))&&u.searchFoundFlag!==n)return u.foundSheetIndex=a,u;return i},l.SearchCondition=function(){return{startSheetIndex:-1,endSheetIndex:-1,searchString:o,searchFlags:0,searchOrder:0,searchTarget:1,sheetArea:3,rowStart:-1,columnStart:-1,rowEnd:-1,columnEnd:-1,findBeginRow:-1,findBeginColumn:-1}},l.SearchResult=function(){return{searchFoundFlag:0,foundSheetIndex:-1,foundRowIndex:-1,foundColumnIndex:-1,foundString:o}},l.SearchFlags={none:0,ignoreCase:1,exactMatch:2,useWildCards:4,blockRange:8},l.SearchOrder={zOrder:0,nOrder:1},l.SearchFoundFlags={none:0,cellText:1,cellTag:4,cellFormula:8},e.exports=l}()},function(e,t){e.exports=GC.Spread.Sheets},function(e,t){e.exports=GC.Spread.Common}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.ContextMenu=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";var t=n(1);t.MenuView=n(5),t.SR={},t.SR.en=n(6),e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o=n(2),i=n(3),a=n(4),l=n(5),s=o.GC$,u=i._Types._isNullOrUndefined,c=i._Types._isEmptyObject,_=o._util._cancelDefault,f="gc.spread.contextMenu.",d="gc.spread.",h="gc-spread-",g="viewport",p="colHeader",m="rowHeader",v="slicer",C="sheetTab",w="corner",y="removeSlicer",S="toggleComment",x="deleteComment",b="editComment",T="unhideSheet",R="hideSheet",A="unhideRows",I="unhideColumns",M="hideRows",E="hideColumns",F="sortAscend",D="sortDescend",N="sort",V="filter",O="insertComment",H="deleteSheet",P="insertSheet",L="insertRows",k="insertColumns",B="deleteRows",W="deleteColumns",z="clearContents",U="paste",Y="pasteOptions",G="pasteFormatting",X="pasteValues",j="pasteFormula",K="pasteAll",Z="cut",J="copy",q="separator",Q="groupHeader",$="slicerSortAscend",ee="slicerSortDescend",te="row",ne="col",re={},oe=function(){return i._getResource(re.SR)()},ie={sheetTab:function(e,t,n){return RegExp("sheetTab","i").test(n.workArea)&&e.tabStripHitInfo&&e.tabStripHitInfo.sheetTab&&"newSheet"!==e.tabStripHitInfo.sheetTab.sheetName},outline:function(e,t,n){return RegExp("outline","i").test(n.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.outlineHitInfo},viewport:function(e,t,n){if(RegExp("viewport","i").test(n.workArea)&&e.worksheetHitInfo&&3===e.worksheetHitInfo.hitTestType&&!e.worksheetHitInfo.floatingObjectHitInfo&&!e.worksheetHitInfo.commentHitInfo)return pe(t,n)&&ve(t,n)},rowHeader:function(e,t,n){return RegExp("rowHeader","i").test(n.workArea)&&e.worksheetHitInfo&&2===e.worksheetHitInfo.hitTestType},colHeader:function(e,t,n){return RegExp("colHeader","i").test(n.workArea)&&e.worksheetHitInfo&&1===e.worksheetHitInfo.hitTestType},corner:function(e,t,n){if(RegExp("corner","i").test(n.workArea)&&e.worksheetHitInfo&&0===e.worksheetHitInfo.hitTestType)return pe(t,n)&&ve(t,n)},slicer:function(e,t,n){return RegExp("slicer","i").test(n.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"Slicer"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},chart:function(e,t,n){return RegExp("chart","i").test(n.workArea)&&e.worksheetHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo&&e.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===e.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName}},ae=[];function le(e){var t,n;if(e.slicers){if(!(t=e.slicers.all())||c(t))return null;for(n in t)if(t[n].isSelected())return!0;return!1}}function se(e){var t,n,r,o=e.getActiveSheet(),i=o.getSelections();for(t=0;t<i.length-1;t++)for(n=t+1;n<i.length;n++)i[t].row<i[n].row&&(r=i[t],i[t]=i[n],i[n]=r);return i}function ue(e){var t,n,r,o=e.getActiveSheet(),i=o.getSelections();for(t=0;t<i.length-1;t++)for(n=t+1;n<i.length;n++)i[t].col<i[n].col&&(r=i[t],i[t]=i[n],i[n]=r);return i}function ce(e,t,n,r){var o=e.getSpans(void 0,3);t>=0?(fe(e,o,t,r,3),fe(e,e.getSpans(void 0,2),t,r,2)):n>=0&&(_e(e,o,n,r,3),_e(e,e.getSpans(void 0,1),n,r,1))}function _e(e,t,n,r,o){var i,a,l,s,u,c;for(i=0,a=t.length;i<a;i++)if(l=t[i],n>l.col&&n<l.col+l.colCount)for(s=e.getStyle(l.row,l.col,o),u=n;u<n+r;u++)for(c=l.row;c<l.row+l.rowCount;c++)e.setStyle(c,u,s,o)}function fe(e,t,n,r,o){var i,a,l,s,u,c;for(i=0,a=t.length;i<a;i++){if(l=t[i],n<l.row||n>l.row+l.rowCount)return;for(s=e.getStyle(l.row,l.col,o),u=n;u<n+r;u++)for(c=l.col;c<l.col+l.colCount;c++)e.setStyle(u,c,s,o)}}function de(e,t,n){var r,o,i,a,l=e.getSelections(),s=t===te?"rowCount":"colCount";for(r=0;r<l.length;r++)for(o=l[r],i=-1===o[t]?0:o[t],a=0;a<o[s];a++)n(i+a)}function he(e,t){var n,r,o,i;if(1===t.colCount&&-1===t.row){if((n=t.col)===e._getFirstVisualColumn()&&(r=n-1)>=0&&!e.getColumnVisible(r))return!0}else if(1===t.rowCount&&-1===t.col&&(o=t.row)===e._getFirstVisualRow()&&(i=o-1)>=0&&!e.getRowVisible(i))return!0}function ge(e){var t,n,r;if(e.slicers){if(!(t=e.slicers.all())||c(t))return null;n=[];for(r in t)t[r].isSelected()&&n.push(t[r]);return n}}function pe(e,t){var n,r,o,i,a,l,s,u=[d+O,d+b,d+S,d+x],c=t.name;if(u.indexOf(c)<0)return!0;if(n=e.getActiveSheet(),r=n.getActiveRowIndex(),o=n.getActiveColumnIndex(),n.comments){if(i=n.comments.get(r,o))return c!==d+O;if(c===d+b||c===d+S)return!1;if(c===d+O)return!0;for(a=n.getSelections(),l=0;l<a.length;l++)if(s=a[l],me(s,n))return!0;return!1}}function me(e,t){var n,r,o,i;if(t.comments)for(n=t.comments.all(),i=0;i<n.length;i++)if(o=n[i]._rowIndex,r=n[i]._colIndex,o>=e.row&&o<e.row+e.rowCount&&r>=e.col&&r<e.col+e.colCount)return!0;return!1}function ve(e,t){var n,r,o,i,a;return[d+N,d+V].indexOf(t.name)<0||(n=e.getActiveSheet(),!(!(r=n.getSelections())||1!==r.length)&&(o=r[0],!((i=Ce(n,o))&&(a=i.range(),o.row<a.row||o.col<a.col||o.row+o.rowCount>a.row+a.rowCount||o.col+o.colCount>a.col+a.colCount))))}function Ce(e,t){var n,r,o;for(n=t.row;n<t.row+t.rowCount;n++)for(r=t.col;r<t.col+t.colCount;r++)if(e.tables&&(o=e.tables.find(n,r)))return o;return null}t=function(){function e(){var e=this;e.menuView=new l,e.menuData=[{text:oe().copy,name:d+J,command:f+J,iconClass:h+J,workArea:g+p+m+v+w},{text:oe().cut,name:d+Z,command:f+Z,iconClass:h+Z,workArea:g+p+m+v+w},{text:oe().pasteOptions,name:d+Y,iconClass:h+Y,type:Q,workArea:g+p+m+v+w},{command:f+K,name:d+K,iconClass:h+K,group:d+Y,text:oe().pasteAll,workArea:g+p+m+v+w},{command:f+j,name:d+j,iconClass:h+j,group:d+Y,text:oe().pasteFormula,workArea:g+p+m+w},{command:f+X,name:d+X,iconClass:h+X,group:d+Y,text:oe().pasteValues,workArea:g+p+m+w},{command:f+G,name:d+G,iconClass:h+G,group:d+Y,text:oe().pasteFormatting,workArea:g+p+m+w},{type:q},{text:oe().clearContents,command:f+z,name:d+z,workArea:g+p+m+w},{type:q},{text:oe().insertRows,name:d+L,command:f+L,workArea:m},{text:oe().insertColumns,name:d+k,command:f+k,workArea:p},{text:oe().deleteRows,name:d+B,command:f+B,workArea:m},{text:oe().deleteColumns,name:d+W,command:f+W,workArea:p},{text:oe().insertSheet,name:d+P,command:f+P,workArea:C},{text:oe().deleteSheet,name:d+H,command:f+H,workArea:C},{type:q},{text:oe().filter,name:d+V,command:f+V,workArea:g+w},{text:oe().sort,name:d+N,subMenu:[{text:oe().sortAscend,name:d+F,command:f+F,iconClass:h+F},{text:oe().sortDescend,name:d+D,command:f+D,iconClass:h+D}],workArea:g+w},{text:oe().slicerSortAscend,name:d+$,command:f+$,iconClass:h+F,workArea:v},{text:oe().slicerSortDescend,name:d+ee,command:f+ee,iconClass:h+D,workArea:v},{type:q},{text:oe().insertComment,name:d+O,command:f+O,iconClass:h+O,workArea:g+w},{text:oe().editComment,name:d+b,command:f+b,iconClass:h+b,workArea:g+w},{text:oe().deleteComment,name:d+x,command:f+x,iconClass:h+x,workArea:g+w},{text:oe().toggleComment,name:d+S,command:f+S,workArea:g+w},{type:q},{text:oe().hideRows,name:d+M,command:f+M,workArea:m},{text:oe().unhideRows,name:d+A,command:f+A,workArea:m},{text:oe().hideColumns,name:d+E,command:f+E,workArea:p},{text:oe().unhideColumns,name:d+I,command:f+I,workArea:p},{type:q},{text:oe().hideSheet,name:d+R,command:f+R,workArea:C},{text:oe().unhideSheet,name:d+T,command:f+T,workArea:C},{type:q},{text:oe().removeSlicer,name:d+y,command:f+y,workArea:v}]}var t={_init:function(e){var t=this;t._initialized||(t._commandManager=e.commandManager(),u(t._contextMenuDialog)&&(t._contextMenuDialog=new a(e._getContainerDiv(),s(e._userEventsElem))),t._registerCommand(e),t._featureRelatedMenuData={filter:{menuDataDict:[d+V],checkFunction:function(e){if(e.rowFilter)return!0}},comments:{menuDataDict:[d+O,d+b,d+x,d+S],checkFunction:function(e){if(e.comments)return!0}},slicer:{menuDataDict:[d+$,d+ee,d+y],checkFunction:function(e){if(e.slicers)return!0}}},t._initialized=!0)},_doContextMenu:function(e,t){var n,r,o,i,a=this,l=a._getHitInfo(e,t);u(l)||(n=t.getActiveSheet(),r={row:n.getActiveRowIndex(),col:n.getActiveColumnIndex()},n.isEditing()&&l.worksheetHitInfo&&l.worksheetHitInfo.col===r.col&&l.worksheetHitInfo.row===r.row||t.getTab()&&t.getTab()._tabNameEditor||(a._init(t),a._preOpenContextMenuView(l,t),o=a._filterDataWithHitInfo(a.menuData,l,t),!(i=a.onOpenMenu(a.menuData,o,l,t))&&o.length&&(_(e),a._openContextMenuImp(o,l,t))))},_preOpenContextMenuView:function(e,t){var n=this;n._contextMenuDialog._isHitOutside(e)&&n._switchContextByHitInfo(e,t)},_switchContextByHitInfo:function(e,t){var n=this,r=t.getActiveSheet();r.isEditing()&&r.endEdit(),n._isHitOnSheetTab(e)?n._switchTabStripContextHandler(e,t):n._isHitOnWorkSheet(e)&&n._switchWorkSheetContextHandler(e,t)},_isHitOnWorkSheet:function(e){return e.worksheetHitInfo},_isHitOutsideSelection:function(e,t,n){var r,o;for(r=0;r<e.length;r++)if(o=e[r],o.contains(t,n))return!1;return!0},_isHitOnSheetTab:function(e){return e.tabStripHitInfo&&e.tabStripHitInfo.sheetTab},_getHitSheetName:function(e){return e.tabStripHitInfo.sheetTab.sheetName},_switchWorkSheetContextHandler:function(e,t){var n=this,r=t.getActiveSheet(),o=e.worksheetHitInfo;o.floatingObjectHitInfo||o.commentHitInfo||(n._changeSelection(r,o),n._handleCommentEvent(r))},_handleCommentEvent:function(e){var t,n=e.getActiveRowIndex(),r=e.getActiveColumnIndex(),o=e.comments;o&&(t=o.get(n,r))&&o._hoverShowComment===t&&o._hide(t)},_isHitOnViewPort:function(e){return 3===e.hitTestType},_updateValidationUI:function(e,t,n){e._updateValidationUI&&e._updateValidationUI(t,n)},_changeSelection:function(e,t){var n,r=this,o=e._selectionModel.toArray(),i=t.row,a=t.col;r._isHitOutsideSelection(o,i,a)&&(e._eventHandler._changeSelection(e,t,i,a),n=e._selectionModel.toArray(),e._raiseSelectionChanging(o,n))},_switchTabStripContextHandler:function(e,t){var n=this._getHitSheetName(e);t.setActiveSheet(n),this._specialSwitchContextForTabUnhide(this.menuData,e,t)},_getHitInfo:function(e,t){var n=t._getSpreadOffset(),r=e.pageX-n.left,o=e.pageY-n.top;return t.hitTest(r,o)},onOpenMenu:function(e,t,n,r){},_openContextMenuImp:function(e,t,n){var r=this;r._contextMenuDialog._isHitOutside(t)&&(r._clearOldContextMenu(),r._showNewContextMenu(e,t,n))},_clearOldContextMenu:function(){this._contextMenuDialog.close()},_showNewContextMenu:function(e,t,n){var r=this;r._contextMenuDialog._open(r.menuView,e,t.x,t.y,n)},_filterDataWithHitInfo:function(e,t,n){var r=this,o=[],i=r._filterMenuDataByFeatures(e,n);return s.each(i,function(e,r){u(r)||(r.type===q&&o.push(r),s.each(ie,function(e,i){i(t,n,r)&&o.push(r)}))}),r._specialFilterDataLogic(o,t,n),o=r._trimSeparatorLine(o)},_filterMenuDataByFeatures:function(e,t){var n=this,r=t.getActiveSheet(),o=n._featureRelatedMenuData,i=JSON.parse(JSON.stringify(e));return s.each(o,function(e,t){var o,a,l;if(!t.checkFunction(r))for(o=t.menuDataDict,a=0,l=o.length;a<l;a++)n._iteratorMenuDataByName(i,o[a],function(e,t){e[t]=null})}),i},_trimSeparatorLine:function(e){var t,n,r,o,i,a=[],l=e.length;for(t=0;t<l;t++)e[t]&&e[t].type===q&&e[t+1]&&e[t+1].type===q||a.push(e[t]);for(l=a.length,n=0,r=0,o=!0,i=!0,t=0;t<l&&(o&&a[t].type===q?n++:o=!1,i&&a[l-1-t].type===q?r++:i=!1,o||i);t++);return a.splice(l-r,r),a.splice(0,n),a},_specialFilterDataLogic:function(e,t,n){this._specialFilterDataForFloatingObjectCutCopyPaste(e,t,n)},_specialFilterDataForFloatingObjectCutCopyPaste:function(e,t,n){var r,o,i,a,l,s,u,c=n.getActiveSheet();if(c._getFloatingObjectClipboardHelper&&(r=c._getFloatingObjectClipboardHelper(),o=r.fromSheet,i=o&&o._clipboardFloatingObjectData))for(a=[X,G,j],l=a.length,s=0;s<e.length;s++)if(e[s])for(u=0;u<l;u++)if(e[s].name===d+a[u]){e[s]=null;break}},_specialSwitchContextForTabUnhide:function(e,t,n){var r,o,i,a;if(t.tabStripHitInfo&&(r=this,o=n.sheets,i=r._find(d+T))){for(a=0;a<o.length;a++)if(!o[a].visible())return void(i.disable=!1);i.disable=!0}},_find:function(e){var t=this;return t._findImp(t.menuData,e)},_findImp:function(e,t){var n;return this._iteratorMenuDataByName(e,t,function(e,t){n=e[t]}),n},_iteratorMenuDataByName:function(e,t,n){for(var r=this,o=e.length,i=0;i<o;i++)if(!u(e[i])){if(t===e[i].name)return void n(e,i);e[i].subMenu&&r._iteratorMenuDataByName(e[i].subMenu,t,n)}},_registerCommand:function(e){var t,n,r,i,a,l,s,u,_,d,h,g,p,m,v,C,w,N,Y,q,Q,re,oe,ie,_e,fe,pe,me,ve,we=e.commandManager(),ye={canUndo:!1,execute:function(e){var t=e.getActiveSheet();t&&(le(t)?we.execute({cmd:"copyFloatingObjects",sheetName:t.name()}):we.execute({cmd:J,sheetName:t.name(),ignoreClipboard:!0}))}};we.register(f+J,ye,null,!1,!1,!1,!1),t={canUndo:!1,execute:function(e){var t=e.getActiveSheet();t&&(le(t)?we.execute({cmd:"cutFloatingObjects",sheetName:t.name()}):we.execute({cmd:Z,sheetName:t.name(),ignoreClipboard:!0}))}},we.register(f+Z,t,null,!1,!1,!1,!1),n={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();r&&(r.isPasteFloatingObject&&r.isPasteFloatingObject()?we.execute({cmd:"pasteFloatingObjects",sheetName:r.name()}):(t=r.options.clipBoardOptions,r.options.clipBoardOptions=0,n=function(){r.options.clipBoardOptions=t},we.execute({cmd:U,sheetName:r.name(),callback:n})))}},we.register(f+K,n,null,!1,!1,!1,!1),r={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();r&&(t=r.options.clipBoardOptions,r.options.clipBoardOptions=3,n=function(){r.options.clipBoardOptions=t},we.execute({cmd:U,sheetName:r.name(),callback:n}))}},we.register(f+j,r,null,!1,!1,!1,!1),i={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();r&&(t=r.options.clipBoardOptions,r.options.clipBoardOptions=1,n=function(){r.options.clipBoardOptions=t},we.execute({cmd:U,sheetName:r.name(),callback:n}))}},we.register(f+X,i,null,!1,!1,!1,!1),a={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();r&&(t=r.options.clipBoardOptions,r.options.clipBoardOptions=2,n=function(){r.options.clipBoardOptions=t},we.execute({cmd:U,sheetName:r.name(),callback:n}))}},we.register(f+G,a,null,!1,!1,!1,!1),l={canUndo:!1,execute:function(e){var t=e.getActiveSheet();t&&we.execute({cmd:"clear",sheetName:t.name()})}},we.register(f+z,l,null,!1,!1,!1,!1),s={canUndo:!1,execute:function(e){var t,n,r,o=e.getActiveSheet();o&&(t=o.getActiveRowIndex(),n=o.getActiveColumnIndex(),(r=o.comments.add(t,n,""))&&r.commentState(2))}},we.register(f+O,s,null,!1,!1,!1,!1),u={canUndo:!1,execute:function(e){var t,n,r,o=e.getActiveSheet();o&&(t=o.getActiveRowIndex(),n=o.getActiveColumnIndex(),(r=o.comments.get(t,n))&&r.commentState(2))}},we.register(f+b,u,null,!1,!1,!1,!1),_={canUndo:!1,execute:function(e){var t,n,r,o,i,a,l,s=e.getActiveSheet();if(s&&(s.suspendPaint(),t=s.getSelections(),!((n=t.length)<=0))){for(r=0;r<n;r++)for(o=t[r],i=o.row;i<o.row+o.rowCount;i++)for(a=o.col;a<o.col+o.colCount;a++)(l=s.comments.get(i,a))&&we.execute({cmd:x,sheetName:s.name(),comment:l});s.resumePaint()}}},we.register(f+x,_,null,!1,!1,!1,!1),d={canUndo:!1,execute:function(e){var t,n,r,o=e.getActiveSheet();o&&(t=o.getActiveRowIndex(),n=o.getActiveColumnIndex(),(r=o.comments.get(t,n))&&(2===r.displayMode()?r.displayMode(1):r.displayMode(2)))}},we.register(f+S,d,null,!1,!1,!1,!1),h={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();if(r){for(r.suspendPaint(),t=se(e),n=0;n<t.length;n++)r.addRows(t[n].row,t[n].rowCount),ce(r,t[n].row,-1,t[n].rowCount);r.resumePaint()}}},we.register(f+L,h,null,!1,!1,!1,!1),g={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();if(r){for(r.suspendPaint(),t=ue(e),n=0;n<t.length;n++)r.addColumns(t[n].col,t[n].colCount),ce(r,-1,t[n].col,t[n].colCount);r.resumePaint()}}},we.register(f+k,g,null,!1,!1,!1,!1),p={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();if(r){for(r.suspendPaint(),t=se(e),n=0;n<t.length;n++)r.deleteRows(t[n].row,t[n].rowCount);r.resumePaint()}}},we.register(f+B,p,null,!1,!1,!1,!1),m={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();if(r){for(r.suspendPaint(),t=ue(e),n=0;n<t.length;n++)r.deleteColumns(t[n].col,t[n].colCount);r.resumePaint()}}},we.register(f+W,m,null,!1,!1,!1,!1),v={canUndo:!1,execute:function(e){e.addSheet(e.getActiveSheetIndex())}},we.register(f+P,v,null,!1,!1,!1,!1),C={canUndo:!1,execute:function(e){e.getSheetCount()>1&&e.removeSheet(e.getActiveSheetIndex())}},we.register(f+H,C,null,!1,!1,!1,!1),w={canUndo:!1,execute:function(e){var t,n,r,i,a,l,s=e.getActiveSheet();if(s)if(t=s.getSelections(),n=t[0],i=Ce(s,n))r=i.rowFilter(),r.unfilter(),a=s.getActiveRowIndex(),l=s.getActiveColumnIndex(),r.addFilterItem(l,new o.ConditionalFormatting.Condition(o.ConditionalFormatting.ConditionType.textCondition,{compareType:0,expected:s.getText(a,l)})),r.filter(l);else if(s.rowFilter){if(!s.rowFilter())return void s.rowFilter(new o.Filter.HideRowFilter(n));s.rowFilter().unfilter(),s.rowFilter(new o.Filter.HideRowFilter(n))}}},we.register(f+V,w,null,!1,!1,!1,!1),N=function(e,t){var n,r,o,i=e.getActiveSheet();i&&(n=i.getSelections()[0],r=Ce(i,n),o=r?r.dataRange():n,i.sortRange(o.row,o.col,o.rowCount,o.colCount,!0,[{index:i._activeColIndex,ascending:t}]))},Y={canUndo:!1,execute:function(e){return N(e,!0)}},we.register(f+F,Y,null,!1,!1,!1,!1),q={canUndo:!1,execute:function(e){N(e,!1)}},we.register(f+D,q,null,!1,!1,!1,!1),Q={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();if(r&&(t=ge(r))&&0!==t.length)for(n in t)t.hasOwnProperty(n)&&t[n].sortState(1)}},we.register(f+$,Q,null,!1,!1,!1,!1),re={canUndo:!1,execute:function(e){var t,n,r=e.getActiveSheet();if(r&&(t=ge(r))&&0!==t.length)for(n in t)t.hasOwnProperty(n)&&t[n].sortState(2)}},we.register(f+ee,re,null,!1,!1,!1,!1),oe={canUndo:!1,execute:function(e){var t=e.getActiveSheet();t&&(t.suspendPaint(),de(t,te,function(e){t.setRowVisible(e,!1)}),t.resumePaint())}},we.register(f+M,oe,null,!1,!1,!1,!1),ie={canUndo:!1,execute:function(e){var t=e.getActiveSheet();t&&(t.suspendPaint(),de(t,ne,function(e){t.setColumnVisible(e,!1)}),t.resumePaint())}},we.register(f+E,ie,null,!1,!1,!1,!1),_e={canUndo:!1,execute:function(e){if(!(e.getSheetCount()-ae.length<=1)){var t=e.getActiveSheet();t&&(ae.push(t),t.visible(!1),e.getActiveSheet()&&e.focus(!0))}}},we.register(f+R,_e,null,!1,!1,!1,!1),fe={canUndo:!1,execute:function(e){var t,n=e.getActiveSheet();n&&(n.suspendPaint(),t=n.getSelections(),1===t.length&&he(n,t[0])?(n.setRowVisible(t[0].row-1,!0),n._setTopRow(t[0].row-1)):de(n,te,function(e){n.setRowVisible(e,!0)}),n.resumePaint())}},we.register(f+A,fe,null,!1,!1,!1,!1),pe={canUndo:!1,execute:function(e){var t,n=e.getActiveSheet();n&&(n.suspendPaint(),t=n.getSelections(),1===t.length&&he(n,t[0])?(n.setColumnVisible(t[0].col-1,!0),n._setLeftColumn(t[0].col-1)):de(n,ne,function(e){n.setColumnVisible(e,!0)}),n.resumePaint())}},we.register(f+I,pe,null,!1,!1,!1,!1),me={canUndo:!1,execute:function(e){var t,n,r;if(0===ae.length)for(t=e.sheets,n=0;n<t.length;n++)t[n].visible()||ae.push(t[n]);ae.length>0&&(r=ae.pop(),r.visible(!0),e.setActiveSheet(r.name())),e.getActiveSheet()&&e.focus(!0)}},we.register(f+T,me,null,!1,!1,!1,!1),ve={canUndo:!1,execute:function(e){var t,n,r,o=e.getActiveSheet();if(o&&(e.suspendPaint(),t=[],(n=o.slicers.all())&&!c(n))){for(r in n)n[r].isSelected()&&t.push(n[r].name());t.length>0&&we.execute({cmd:"deleteFloatingObjects",sheetName:o.name(),floatingObjects:t}),e.resumePaint()}}},we.register(f+y,ve,null,!1,!1,!1,!1)}};return s.extend(e.prototype,t),e}(),r={init:function(){this.options.allowContextMenu=!0},setHost:function(){var e=this,n=e._host;e.contextMenu||(e.contextMenu=new t),s(n).bind("contextmenu.gcSheet",function(t){if(e.options.allowContextMenu)return e.contextMenu._doContextMenu(t,e)})},dispose:function(){s(this._host).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var e,t=oe(),n=this.contextMenu;n&&(e=n.menuData,s.each(t,function(t,r){n._iteratorMenuDataByName(e,d+t,function(e,t){e[t].text=r})}))}},o.Workbook._registerFeature("contextmenu",r),re.ContextMenu=t,e.exports=re}()},function(e,t){e.exports=GC.Spread.Sheets},function(e,t){e.exports=GC.Spread.Common},function(e,t,n){!function(){"use strict";var t=n(2),r=t._BaseDialog,o=t.GC$,i=t._util._getPreferredZIndex,a="gc.command.executed",l="left",s="top",u=function(e){o.inherit(t,e);function t(t,n){var r=this;r._elem=n,e.call(r,t,i(t))}var n={_initContextMenuView:function(e,t,n){var r=this,o=e[0];r._menuView&&r._menuView._create&&r._menuView._create(o,t,n,this._elem)},_open:function(e,t,n,r,o){var i=this,a=i._prepareContainer(n,r);i._menuView=e,i._initContextMenuView(a,t,o)},_prepareContainer:function(t,n){var r=this,o=r._getContainer();return o.css([l,s],[t,n]),o.empty(),e.prototype._show.call(r),r._attachEvent(),o},_isHitOutside:function(e){var t,n,r,o=this,i=o._getContainer();return"block"!==i.css("display")||(t=i.offset(),t.top+=document.body.clientTop||0,t.left+=document.body.clientLeft||0,n=e.x,r=e.y,n<t.left||n>i.width()+t.left||r<t.top||r>i.height()+t.top)},_attachEvent:function(){var e=this;e._elem.bind(a,function(){e.close()})},_detachEvent:function(){this._elem.unbind(a)},close:function(){var t=this;t._menuView&&t._menuView._dispose(),t._detachEvent(),t._hasTargetContainer(t._name)&&o("#"+t._name).remove(),e.prototype.close.call(t)}};return o.extend(t.prototype,n),t}(r);e.exports=u}()},function(e,t,n){!function(){"use strict";var t,r=n(2),o=n(3),i=r.GC$,a=r._util._createElement,l=o._Types,s=l._isNullOrUndefined,u=l._isFunction,c=l._cloneObject,_="mouseenter",f="mouseleave",d="click",h="gc.command.executed",g=".",p="gc-ui-contextmenu",m="-",v="container",C="hover",w="disable-hover",y="text",S="icon",x="menuitem",b="nonselective-menuitem",T="menuitem-content",R="sup-container",A="separator",I="sup-indicator",M="subitems-container",E="group-container",F="title",D="group-header",N="groupitems-container",V="groupitem",O="nonexecutable",H="executable",P="disable",L=p+m+C,k=p+m+x,B=p+m+b,W=p+m+T,z=p+m+H,U=p+m+R,Y=p+m+M,G=" ui-widget",X=" ui-state-hover",j=" ui-icon ui-icon-triangle-1-e",K="DIV",Z="SPAN",J="keydown.ctx.gcSheet",q=void 0;function Q(e){if(e instanceof Object)return!0}t=function(){function e(){}var t={_create:function(e,t,n,r){var o=this;o._host=i(e),o._menuData=c(t),o._commandManager=n.commandManager(),o._context=n,o._elem=r,o._menuItems=[],o._menus={},o._menuStack=[],o._activeMenuItem=null,o._initMenuView()},_repositionMenuView:function(){var e,t,n,r,o=this,i=o._host.offset().left,a=o._host.width(),l=o._host.css("left");l=parseInt(l.split("p")[0]),i+a>window.innerWidth&&(l-=a,o._host.css("left",l)),e=o._host.offset().top,t=o._host.height(),n=o._host.css("top"),n=parseInt(n.split("p")[0]),e>.75*window.innerHeight?(n-=t,o._host.css("top",n)):e+t>window.innerHeight&&(r=e+t-window.innerHeight,n-=r,o._host.css("top",n))},_initMenuView:function(){var e,t,n,r=this,o=r._menuData;s(o)||!Q(o)||o.length<1||(o instanceof Array||(o=[o]),e="menuView",t=r._createMenuItems(e,o),r._menus.menuView=t,n=r._getMenuView(r._menuData),n.appendTo(r._host),r._repositionMenuView(),r._attachEvent(),r._menuStack.push({name:e,menuView:n}))},_createMenuItems:function(e,t){for(var n,r=this,o=t.length,i=0,a=[];i<o;i++)n=t[i],s(n)||"separator"===n.type||(n.subMenu?r._menus[n.name]=r._createMenuItems(n.name,n.subMenu):"groupHeader"===n.type&&(r._collectGroupItemsByGroupHeader(n,t),r._menus[n.name]=r._createMenuItems(e,n.groups)),a.push(r._createMenuItem(e,n)));return a},_createMenuItem:function(e,t){var n,r,o,a=this;if(n="groupHeader"===t.type?a._createNonSelectiveMenuItemHost():a._createMenuItemHost(),r=a.createMenuItemElement(t),!s(r))return r instanceof HTMLElement&&(r=i(r)),r.appendTo(n),o={name:t.name,host:n,menuItemData:t,menuName:e},a._menuItems.push(o),o},_createMenuItemHost:function(){var e=i(a(K));return e.addClass(k),e},_createNonSelectiveMenuItemHost:function(){var e=i(a(K));return e.addClass(B),e},createMenuItemElement:function(e){var t,n=this;return t="groupHeader"===e.type?n._createGroupMenuView(e):"groupItem"===e.type?n._createGroupMenuItemView(e):e.subMenu?n._createSubMenuView(e):n._createBaseMenuItemView(e)},_createBaseMenuItemView:function(e){var t,n,r=i(a(K)).addClass(W);return e.command?e.disable?r.addClass(p+m+P):r.addClass(z):r.addClass(p+m+O),t=i(a(Z)).addClass(p+m+S),e.iconClass&&t.addClass(e.iconClass),t.appendTo(r),e.text&&(n=i(a(Z)).addClass(p+m+y),n[0].innerHTML=e.text,n.appendTo(r)),r},_createSeparatorLine:function(e){return i(a(K)).addClass(p+m+A)},_createGroupMenuView:function(e){var t,n,r,o,l,s,u,c=this,_=i(a(K)).addClass(p+m+E)
;if(e.groups.length<=0)return _;for(t=c._createBaseMenuItemView(e),t.addClass(p+m+D),t.appendTo(_),n=i(a(K)).addClass(p+m+N),r=e.groups,o=r.length,l=0;l<o;l++)s=c._findMenuItem("name",r[l].name),u=s.host,u.addClass(p+m+V),u.appendTo(n);return n.appendTo(_),_},_createGroupMenuItemView:function(e){var t=this,n=t._createBaseMenuItemView(e);return n.find(g+p+m+y).remove(),n.attr(F,e.text),n},_createSubMenuView:function(e){var t,n,r=this,o=i(a(K)).addClass(U),l=r._createBaseMenuItemView(e);return e.subMenu.length>0&&(t=i(a(Z)).addClass(p+m+I+j),t.appendTo(l),n=r._getMenuView(e.subMenu),n.addClass(Y),n.appendTo(o)),l.appendTo(o),o},_getMenuView:function(e){for(var t,n,r,o,l=this,u=i(a(K)).addClass(p+m+v+G),c=e.length,_=0;_<c;_++)s(e[_])||(t=e[_].name,s(t)?"separator"===e[_].type&&(r=l._createNonSelectiveMenuItemHost(),o=l._createSeparatorLine(e[_]),o.appendTo(r),r.appendTo(u)):(n=l._findMenuItem("name",t),s(n)||n.host.appendTo(u)));return u},_findMenuItem:function(e,t){for(var n=this,r=n._menuItems,o=r.length,a=0;a<o;a++)if(t instanceof i?t[0]===r[a][e][0]:r[a][e]===t)return r[a]},_collectGroupItemsByGroupHeader:function(e,t){var n,r,o;for(e.groups=[],n=t.length,r=0;r<n;r++)(o=t[r])&&o.group&&o.group===e.name&&(o.type="groupItem",e.groups.push(o),t.splice(r--,1))},_attachEvent:function(){var e=this;i(g+k).bind(_,function(){var t,n,r,o=i(this),a=e._findMenuItem("host",o);for(e._activeMenuItem=a,t=e._menuStack,n=0,r=t.length;n<r&&a.menuName!==e._menuStack[r-n-1].name;n++)e._closeSubMenu();e._updateUIState(),e._showSubMenu(!1)}).bind(f,function(){e._activeMenuItem=null,e._updateUIState()}).bind(d,function(t){var n,r=i(this),o=e._findMenuItem("host",r);e._activeMenuItem=o,(n=e._selectMenuItem(!1,t))&&e._close()}),i(document).bind(J,function(t){var n,r,o;switch(t.keyCode){case 27:n=e._closeSubMenu(),n||e._close();break;case 32:case 13:n=e._selectMenuItem(!0,t),n&&e._close();break;case 9:t.shiftKey?e._moveToNextMenuItem(!1,!0):e._moveToNextMenuItem(!0,!0);break;case 37:r=e._closeSubMenu(),o=e._findMenuItem("name",r),o&&(e._activeMenuItem=o),e._activeMenuItem&&e._activeMenuItem.menuItemData.group&&e._moveToNextMenuItem(!1,!0);break;case 38:e._moveToNextMenuItem(!1,!1);break;case 39:e._activeMenuItem&&e._activeMenuItem.menuItemData.group&&e._moveToNextMenuItem(!0,!0),e._showSubMenu(!0);break;case 40:e._moveToNextMenuItem(!0,!1)}t.preventDefault?t.preventDefault():t.returnValue=!1})},_repositionSubMenu:function(e){var t,n,r,o=e.offset().left,i=e.width();o+i>window.innerWidth&&e.css("left",-i),t=e.offset().top,n=e.height(),r=e.position().top,t+n>window.innerHeight&&e.css("top",r-(t+n-window.innerHeight))},_getCommand:function(e){return e.command},getCommandOptions:function(e,t,n){},_selectMenuItem:function(e,t){var n,r=this,o=r._activeMenuItem;if(o&&!o.menuItemData.disable)return n=o.menuItemData,n.subMenu?void(n.subMenu.length>0&&r._showSubMenu(e)):(r._executeCommand(t),!0)},_executeCommand:function(e){var t,n,r=this,o=r._activeMenuItem,i=r._getCommand(o.menuItemData);s(i)||(t=r.getCommandOptions(o.menuItemData,o.host[0],e),n=r._commandManager,u(i)?i(r._context,t):n.execute({cmd:i,commandOptions:t}))},_detachEvent:function(){i(g+k).unbind(_).unbind(f).unbind(d),i(document).unbind(J)},_dispose:function(){var e=this;e._host=null,e._menuData=null,e._commandManager=null,e._context=null,e._elem=null,e._menuItems=null,e._menus=null,e._activeMenuItem=null,e._detachEvent()},_closeSubMenu:function(){var e,t,n,r=this;if(r._menuStack.length>1)return e=r._menuStack.pop(),t=e.menuView,n=t.find(g+k),n.removeClass(L+X),e.menuView.hide(),e.name},_updateUIState:function(){var e,t,n,r=this,o=r._getMenuItemsInCurrentMenu(!0);if(o){for(e=0,t=o.length;e<t;e++)o[e].host.removeClass(L+X);r._activeMenuItem&&(n=r._activeMenuItem.menuItemData,n.disable?r._activeMenuItem.host.addClass(p+m+w+X):r._activeMenuItem.host.addClass(L+X))}},_close:function(){var e=this;e._elem.trigger(h),e._dispose()},_moveToNextMenuItem:function(e,t){var n,r,o,i=this,a=i._getMenuItemsInCurrentMenu(t);i._activeMenuItem&&((n=i._getMenuItemIndexInCurrentMenu(i._activeMenuItem,a))||(r=i._menus[i._activeMenuItem.menuItemData.group])&&(o=r[0],n=i._getMenuItemIndexInCurrentMenu(o,a))),e?(n!==q&&n!==a.length-1||(n=-1),n="number"==typeof n?n+1:0):(n!==q&&0!==n||(n=a.length),n="number"==typeof n?n-1:0),i._activeMenuItem=a[n],i._updateUIState()},_getMenuItemsInCurrentMenu:function(e){for(var t,n,r,o=this,i=o._menuStack[o._menuStack.length-1].name,a=o._menus[i],l=0,s=a.length,u=[];l<s;l++)if("groupHeader"!==a[l].menuItemData.type)u.push(a[l]);else if(t=o._menus[a[l].menuItemData.name],e)for(n=0,r=t.length;n<r;n++)u.push(t[n]);else u.push(t[0]);return u},_getMenuItemIndexInCurrentMenu:function(e,t){var n,r=t.length;for(n=0;n<r;n++)if(e.name===t[n].name)return n},_showSubMenu:function(e){var t,n,r=this,o=r._activeMenuItem;o&&(t=o.menuItemData,t.subMenu&&t.subMenu.length>0&&(t.name!==r._menuStack[r._menuStack.length-1].name&&(n=i(o.host.find(g+Y)[0]),n.show(),r._repositionSubMenu(n),r._menuStack.push({name:t.name,menuView:n})),r._activeMenuItem=null,e&&r._moveToNextMenuItem(!0,!1)))}};return i.extend(e.prototype,t),e}(),e.exports=t}()},function(e,t){!function(){"use strict";e.exports={copy:"Copy",cut:"Cut",pasteOptions:"Paste Options:",pasteAll:"All",pasteFormula:"Formulas",pasteValues:"Values",pasteFormatting:"Formatting",clearContents:"Clear Contents",insertRows:"Insert",insertColumns:"Insert",deleteRows:"Delete",deleteColumns:"Delete",insertSheet:"Insert",deleteSheet:"Delete",insertComment:"Insert Comment",filter:"Filter",sort:"Sort",slicerSortAscend:"Sort A to Z",slicerSortDescend:"Sort Z to A",sortAscend:"Sort A to Z",sortDescend:"Sort Z to A",hideRows:"Hide",hideColumns:"Hide",hideSheet:"Hide",unhideSheet:"Unhide",unhideColumns:"Unhide",unhideRows:"Unhide",editComment:"Edit Comment",deleteComment:"Delete Comment",toggleComment:"Show/Hide Comment",removeSlicer:"Remove",removeFloatingObject:"Remove"}}()}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.ConditionalFormatting=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";var t=n(1);t.SR={},t.SR.en=n(5),e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v={},C=n(2),w=n(3),y=n(4),S=w.GC$,x=C._StringHelper,b=null,T=void 0,R="undefined",A="string",I=Math.min,M=Math.max,E=Math.abs,F=Math.floor,D=Math.ceil,N=y.Convert,V=N._isNumber,O=N._toDouble,H=N._tryToDouble,P=C._StringHelper,L=P._trimStart,k=P._startsWith,B=P._endsWith,W=P._contains,z=C._Types._isNullOrUndefined,U=C._RegexHelper,Y=C._isInstanceOf,G=w._util,X=w._supportsCalc,j=w.Style,K=C._ColorHelper,Z=K._toString,J=w._createRange,q=w.Range,Q=C._DateTimeHelper,$=C._ArrayHelper,ee=$._remove,te=$._indexOf,ne=$._getLength,re=y.Functions,oe=y._createCellIdentity,ie=w._ThemeContext,ae=function(){return C._getResource(v.SR)()},le=function(e){var t=e.row<0?y.BAND_INDEX_CONST:e.row,n=e.col<0?y.BAND_INDEX_CONST:e.col;return new y._createRangeExpression(b,b,t,n,t+e.rowCount-1,n+e.colCount-1)},se=function(e){var t;if(e instanceof y.Expression)t=e;else if(e instanceof q)t=le(e);else{if(!V(e))throw ae().Exp_NotSupport;e=O(e),isNaN(e)||(t=new y.Expression(2),t.value=e)}return t};function ue(e){var t,n,r=0,o=0,i=e.length;for(i>0&&(r=e[0].row,o=e[0].col),t=1;t<i;t++)n=e[t],r>n.row&&(r=n.row),o>n.col&&(o=n.col);return r=r<0?0:r,o=o<0?0:o,{r:r,c:o}}function ce(e,t,n){var r,o;for(r=0;r<e.length;r++)if(o=e[r],o.contains(t,n))return o}function _e(e){return e.rowCount}function fe(e){return e.colCount}t=function(e,t,n,r){var o=e,i=t,a=function(e,t){var a,l,s=this;return s.hasOwnProperty("_ps")||(s._ps={}),a=s._ps,0===arguments.length?a[o]!==T?r?r.call(s,a[o]):a[o]:i:(a[o]!==e&&(l=a[o]!==T?a[o]:i,a[o]=e,!1!==t&&n&&n.call(s,e,l)),s)};return a.isDefault=function(e){return e===i},a},r=function(e,t,n){var r=this;return n||(n={}),t||(t=r),S.each(t,function(t,o){var i,a=r[o];z(a)||(i=a.call(r),"formula"===o?(r.getFormulaString?i=r.getFormulaString(e):r.condition()&&r.condition().getFormulaString&&(i=r.condition().getFormulaString(e)),i&&(n[o]=i)):"iconCriteria"===o?n[o]=i:Q._isDate(i)?n[o]=Q._toOADateString(i):i&&i.toJSON?n[o]=i.toJSON(e):z(i)||a.isDefault(i)||(n[o]=i))}),n},o=function(e,t,n,r){if(n){var o=this,i;t||(t=o),S.each(t,function(t,a){var l,c,_,f,d,h,p;if(i=n[a],!z(i))if("ranges"===a){for(l=[],c=0;c<i.length;c++)_=i[c],l.push(J(_.row,_.col,_e(_),fe(_)));o.ranges(l,!1)}else if("style"===a)o.style(new j,!1),o.style().fromJSON(i,r);else if("iconCriteria"===a)for(f=i.length,d=0;d<f;d++)h=i[d],o._iconCriteria[d]=new g(h.isGreaterThanOrEqualTo,h.iconValueType,h.iconValue);else"item1"===a||"item2"===a?(o[a](u(),!1),o[a]().fromJSON(i,e)):"expected"===a?S.getType(i)===A&&5===n.conType?"/OADate("===i.substr(0,8)?o[a](Q._fromOADateString(i),!1):o[a](new Date(i)):o[a](i,!1):"condition"===a?(p=new s,p.fromJSON(i,e),o.condition(p,!1)):S.getType(i)===A&&"/OADate("===i.substr(0,8)?o[a](Q._fromOADateString(i),!1):o[a](i,!1)})}};function de(e,t,n){switch(e){case 0:return t===n;case 1:return t!==n;case 2:return t>n;case 3:return t>=n;case 4:return t<n;case 5:return t<=n;default:return!1}}i={init:function(){this.conditionalFormats=new m(this)},dispose:function(e){if(!1!==e){var t=this.conditionalFormats;t&&t._clearCellRuleCache()}},onLayoutChanged:function(e){var t=e.changeType,n=e.row,r=_e(e),o=e.col,i=fe(e),a=e.sheetArea,l=this.conditionalFormats;"addRows"===t?l._onRowsAdded(n,r):"deleteRows"===t?l._onRowsRemoved(n,r):"addColumns"===t?l._onColumnsAdded(o,i):"deleteColumns"===t?l._onColumnsRemoved(o,i):"clear"===t?l._clearCache():"setColumnCount"!==t&&"setRowCount"!==t||3!==a&&1!==a||l._resetCache()},toJson:function(e,t){var n=this.conditionalFormats,r=t&&t.ignoreStyle;n&&!r&&(e.conditionalFormats=n.toJSON(this))},fromJson:function(e,t,n){var r=n&&n.ignoreStyle;e&&e.conditionalFormats&&!r&&this.conditionalFormats.fromJSON(e.conditionalFormats,this,t)}},w.Worksheet._registerFeature("conditionalFormat",i),v.GeneralComparisonOperators={equalsTo:0,notEqualsTo:1,greaterThan:2,greaterThanOrEqualsTo:3,lessThan:4,lessThanOrEqualsTo:5},v.LogicalOperators={or:0,and:1},v.ComparisonOperators={equalsTo:0,notEqualsTo:1,greaterThan:2,greaterThanOrEqualsTo:3,lessThan:4,lessThanOrEqualsTo:5,between:6,notBetween:7},v.TextComparisonOperators={contains:0,doesNotContain:1,beginsWith:2,endsWith:3},v.TextCompareType={equalsTo:0,notEqualsTo:1,beginsWith:2,doesNotBeginWith:3,endsWith:4,doesNotEndWith:5,contains:6,doesNotContain:7},v.ColorCompareType={backgroundColor:0,foregroundColor:1},v.CustomValueType={empty:0,nonEmpty:1,error:2,nonError:3,formula:4},v.DateCompareType={equalsTo:0,notEqualsTo:1,before:2,beforeEqualsTo:3,after:4,afterEqualsTo:5},v.Top10ConditionType={top:0,bottom:1},v.DateOccurringType={today:0,yesterday:1,tomorrow:2,last7Days:3,thisMonth:4,lastMonth:5,nextMonth:6,thisWeek:7,lastWeek:8,nextWeek:9},v.QuarterType={quarter1:0,quarter2:1,quarter3:2,quarter4:3},v.AverageConditionType={above:0,below:1,equalOrAbove:2,equalOrBelow:3,above1StdDev:4,below1StdDev:5,above2StdDev:6,below2StdDev:7,above3StdDev:8,below3StdDev:9},v.ScaleValueType={number:0,lowestValue:1,highestValue:2,percent:3,percentile:4,automin:5,formula:6,automax:7},v.BarDirection={leftToRight:0,rightToLeft:1},v.DataBarAxisPosition={automatic:0,cellMidPoint:1,none:2},v.IconSetType={threeArrowsColored:0,threeArrowsGray:1,threeTriangles:2,threeStars:3,threeFlags:4,threeTrafficLightsUnrimmed:5,threeTrafficLightsRimmed:6,threeSigns:7,threeSymbolsCircled:8,threeSymbolsUncircled:9,fourArrowsColored:10,fourArrowsGray:11,fourRedToBlack:12,fourRatings:13,fourTrafficLights:14,fiveArrowsColored:15,fiveArrowsGray:16,fiveRatings:17,fiveQuarters:18,fiveBoxes:19},v.IconValueType={number:1,percent:4,formula:7,percentile:5},a={relationCondition:0,numberCondition:1,textCondition:2,colorCondition:3,formulaCondition:4,dateCondition:5,dateExCondition:6,textLengthCondition:7,top10Condition:8,uniqueCondition:9,averageCondition:10,cellValueCondition:11,areaCondition:12},v.ConditionType=a,l={conditionRuleBase:0,cellValueRule:1,specificTextRule:2,formulaRule:3,dateOccurringRule:4,top10Rule:5,uniqueRule:6,duplicateRule:7,averageRule:8,twoScaleRule:10,threeScaleRule:11,dataBarRule:12,iconSetRule:13},v.RuleType=l,function(){var e;for(e in a)a[e]!==T&&(a[a[e]]=e);for(e in l)l[e]!==T&&(l[l[e]]=e)}(),s=function(){var e,n,i,l,s,c,_,f=["conType","compareType","item1","item2","ignoreBlank","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"];function d(e,t){var n,r;t||(t={}),n=t.formula,r=this,r.offsetRow=0,r.offsetCol=0,r.conType("string"==typeof e?v.ConditionType[e]:e),z(t.compareType)||r._compareType(t.compareType),z(t.expected)||r.expected(t.expected),z(n)||r.formula("string"==typeof n?L(S.trim(n),"="):n),z(t.item1)||r.item1(t.item1),z(t.item2)||r.item2(t.item2),z(t.customValueType)||r.customValueType(t.customValueType),z(t.type)||r.type(t.type),r.ranges(t.ranges),r._expr=b,r._stdevExpr=b}return e=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0)},n=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999)},i=function(e,t){e.setDate(t)},l=function(e){return e.getDate()},s=function(e,t){return e.getYear()===t.getYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},c=function(e,t){return t>n(e)},_=function(t,n){return n<e(t)},d.prototype={conType:t("conType",b),ranges:t("ranges",b,function(e){var t=this.item1(),n=this.item2();t&&t.ranges&&t.ranges(e),n&&n.ranges&&n.ranges(e)}),context:function(e){if(1===arguments.length){this._context=e;var t=this.item1(),n=this.item2();t&&t.context&&t.context(e),n&&n.context&&n.context(e)}return this._context},initExpression:function(e,t,n){var r,o,i,a,l=this.item1(),s=this.item2();l&&l.initExpression&&l.initExpression(),s&&s.initExpression&&s.initExpression(),e=e||this._context,r=this._formula,e&&r&&!this._expr&&(this.ranges()?(o=ue(this.ranges()),t=o.r,n=o.c):(t=t||0,n=n||0),i=e.getCalcService(),a=e._getSheetSource(),i&&a&&(this._expr=i.parse(a,r,t,n)))},expression:function(e,t,n,r){var o,i,a;return 1===arguments.length?(this._expr=e,t=t||this._context,e?t&&(this.ranges()?(o=ue(this.ranges()),n=o.r,r=o.c):(n=n||0,r=r||0),i=t.getCalcService(),a=t._getSheetSource(),i&&a&&(this._formula=i.unparse(a,e,n,r))):this._formula=e,this._expr):(this._expr||this.initExpression(t,n,r),this._expr)},getFormulaString:function(e,t,n){var r,o,i;return e=e||this._context,r=this._expr,o=this._formula,e&&o?(r||(this.initExpression(e,t,n),r=this._expr),i=ue(this.ranges()),t=z(t)?i.r:t,n=z(n)?i.c:n,e.getCalcService().unparse(e._getSheetSource(),r,t,n)):o},ignoreBlank:t("ignoreBlank",!1),compareType:t("compareType",T),expected:t("expected",T),formula:function(e,t,n){if("string"!=typeof e){var r=this.item1(),o=this.item2();return 0===n&&r&&r.formula?r.formula(e,t,n):1===n&&o&&o.formula?o.formula(e,t,n):this.getFormulaString(T,e,t)}this._formula=e,this._expr=b},item1:t("item1",b),item2:t("item2",b),treatNullValueAsZero:t("treatNullValueAsZero",!1),integerValue:t("integerValue",!1),forceValue2Text:t("forceValue2Text",!1),useWildCards:t("useWildCards",!0),regex:t("regex",b),ignoreCase:t("ignoreCase",!1),customValueType:t("customValueType",T),expectTypeId:t("expectTypeId",0),type:t("type",b),isPercent:t("isPercent",!1),adjustOffset:function(e,t){var n=this,r=n.item1();r&&r.adjustOffset&&r.adjustOffset(e,t),r=n.item2(),r&&r.adjustOffset&&r.adjustOffset(e,t),n.offsetRow=e,n.offsetCol=t},relationConditionEvaluate:function(e,t,n,r,o){var i,a,l=this;function s(r,o){if(e&&r&&3===r.conType()){var i=e.getActualStyle(t,n);i&&(0===r._compareType()?o=i.backColor:1===r._compareType()&&(o=i.foreColor))}return o}function u(e,t){if(e)return e.ignoreBlank(l.ignoreBlank()),arguments.length<5?s(e,r):t}function c(r,o){return!z(r)&&r.evaluate(e,t,n,o)}return i=u(l.item1(),r),a=u(l.item2(),o),c(l.item1(),i)+c(l.item2(),a)>l._compareType()},cellValueConditionEvaluate:function(e,t,n,r){var o=this.getExpected(e,t,n);return!(o!==b||!e||!e._isDataValidator)||this.cellValueConditionCheckCondition(o,r)},cellValueConditionCheckCondition:function(e,t){var n,r,o,i=this,a=0,l=!1;if(z(t)&&z(e))switch(i._compareType()){case 0:case 3:case 5:return!0;case 1:case 2:case 4:default:return!1}return"boolean"==typeof e?de(i._compareType(),t,e):(n={},z(t)?i.treatNullValueAsZero()?(l=!0,a=0):a=t:"boolean"!=typeof t&&H(t,n)&&(a=n.value,l=!isNaN(a)),l?(r=0,o=!1,H(e,n)&&(r=n.value,o=!0),o?de(i._compareType(),a,r):1===i._compareType()):"string"==typeof t&&("string"==typeof e?de(i._compareType(),t,e):1===i._compareType()))},numberConditionEvaluate:function(e,t,n,r){var o=this.numberConditionGetExpected(e,t,n);return!(o!==b||!e||!e._isDataValidator)||(this.integerValue()&&(o=isNaN(o)?b:o>0?F(o):D(o)),this.numberConditionCheckCondition(o,r))},numberConditionCheckCondition:function(e,t){var n,r,o=this;if((z(t)||""===t)&&o.ignoreBlank())return!0;if(isNaN(t))return!1;if(z(e)){if(o.ignoreBlank())return!0;e=0}try{n=parseFloat(t)}catch(e){return!1}return(!o.integerValue()||(r=n-F(n)==0))&&de(o._compareType(),n,e)},numberConditionGetExpected:function(e,t,n){var r,o=this;return o._formula&&o._formula.length>0?(r=e._getCalcServiceInternal(),r?r.evaluate(e._getSheetSource(),o.expression(b,e),t,n):o.expected()):o.expected()},textConditionEvaluate:function(e,t,n,r){var o,i,a,l=this,s=l.compareType(),u=l.useWildCards(),c=l.ignoreCase();function _(e,t){return u?l.testByRegular(t,e,"^","$"):c?e.toLowerCase()===t.toLowerCase():e===t}function f(e,t){return u?l.testByRegular(t,e,"^",""):k(t,e,c)}function d(e,t){return u?l.testByRegular(t,e,"","$"):B(t,e,c)}function h(e,t){return u?l.testByRegular(t,e,"",""):W(t,e===T||e===b?"":e,c)}if(!l.forceValue2Text()&&Y(r,Date))return 2!==s&&4!==s&&6!==s&&(3===s||5===s||7===s);if(o=z(r)?"":""+r,l.ignoreBlank()&&""===o)return!0;if(i=this.getExpected(e,t,n),a=z(i)?"":""+i,l.hasWildcard(a)&&"number"==typeof r)return 3===s||7===s||5===s||1===s;switch(s){case 0:return _(a,o);case 1:return!_(a,o);case 2:return f(a,o);case 3:return!f(a,o);case 4:return d(a,o);case 5:return!d(a,o);case 6:return h(a,o);case 7:return!h(a,o);default:return!1}},hasWildcard:function(e){return e.indexOf("*")>-1||e.indexOf("?")>-1},testByRegular:function(e,t,n,r){if(this.regex())return U._getReg(this.regex()).test(e);var o=U._getWildcardCriteria(t);return o||(o=t),o=n+o+r,this.ignoreCase()?U._getRegIgnoreCase(o).test(e):U._getReg(o).test(e)},colorConditionEvaluate:function(e,t,n,r){var o,i,a,l;function s(e){return z(e)||""===e?b:K._fromString(e)}if(o=this,i=s(o.expected()),z(i)||""===i){if(o.ignoreBlank())return!0}else if(a=s(r),(z(a)||""===a)&&e&&e.getDefaultStyle&&(l=e.getDefaultStyle(),0===o._compareType()?a=l.backColor:1===o._compareType()&&(a=l.foreColor)),!z(a)&&""!==a)return a.a===i.a&&a.r===i.r&&a.g===i.g&&a.b===i.b;return!1},formulaConditionEvaluate:function(e,t,n,r){var o,i,a,l;if(!X)return!1;if(o=this,4===o.customValueType())return i=o.getExpected(e,t,n),!(!o.ignoreBlank()||!z(i)&&""!==i)||(a={},!!N._tryToBool(i,a)&&a.value);switch(l=N._isError,o.customValueType()){case 0:return z(r)||""===r;case 1:return!z(r)&&""!==r;case 2:return l(r);case 3:return!l(r);default:return!1}},formulaConditionGetExpected:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d=this;if(d._formula&&d._formula.length>0){if(!(r=e._getCalcServiceInternal()))return d.expected();if(o=r._evaluateParsedFormula(e._getSheetSource(),d.expression(T,e),oe(t,n),!0),N._isReference(o)){for(i=o.getRowCount(0),a=o.getColumnCount(0),l=[],s=0;s<i;s++)for(l[s]=[],u=0;u<a;u++)l[s][u]=o.getValue(0,s,u);o=l}else if(N._isArray(o)){for(i=o.getRowCount(),a=o.getColumnCount(),l=[],s=0;s<i;s++)for(l[s]=[],u=0;u<a;u++)l[s][u]=o.getValue(s,u);o=l}return Y(o,Array)?(i=ne(o),a=ne(o[0]),1===i&&1===a?o[0][0]:(c=ce(d.ranges(),t,n),_=t-c.row,f=n-c.col,_<i&&f<a?o[_][f]:y.Errors.NotAvailable)):o}return d.expected()},dateConditionEvaluate:function(e,t,n,r){var o,i,a=this;if((z(r)||""===r)&&a.ignoreBlank())return!0;if(!Y(r,Date))return!1;if(o=b,i=this.getExpected(e,t,n),Y(i,Date)?o=i:"string"==typeof i?o=Q._parseLocale(i):"number"==typeof i&&(o=Q._fromOADate(i)),z(o))return!!a.ignoreBlank();switch(a._compareType()){case 0:return s(o,r);case 1:return!s(o,r);case 4:return c(o,r);case 5:return c(o,r)||s(o,r);case 2:return _(o,r);case 3:return _(o,r)||s(o,r);default:return!1}},dateExConditionEvaluate:function(e,t,n,r){var o=this._getExpectedInt(e,t,n);return!z(o)&&this.dateExConditionCheckCondition(o,r)},dateExConditionCheckCondition:function(t,r){var o,a,s,c,_,f,d,h,g,p,m,v,C,w,y,S,x,T,R,A,I,M,E;function F(e,t){switch(e){case 0:return t.getMonth()>=0&&t.getMonth()<=2;case 1:return t.getMonth()>=3&&t.getMonth()<=5;case 2:return t.getMonth()>=6&&t.getMonth()<=8;case 3:return t.getMonth()>=9&&t.getMonth()<=11;default:return!1}}if(o=this,a=r,o.ignoreBlank()&&(z(a)||""===a))return!0;try{a=N._toDateTime(a)}catch(e){return!1}if(0===(c=o.expectTypeId())){switch(_=b,f=b,d=new Date,h=new Date(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds()),t){case 3:i(h,l(h)-6),_=e(h),f=n(d);break;case 1:i(h,l(h)-1),_=e(h),f=n(h);break;case 0:_=e(d),f=n(d);break;case 2:i(h,l(h)+1),_=e(h),f=n(h);break;case 8:g=d,i(g,l(d)-d.getDay()-7),p=h,p.setDate(l(h)-h.getDay()-1),_=e(g),f=n(p);break;case 7:m=d,i(m,l(d)-d.getDay()),v=h,i(v,l(h)-h.getDay()+6),_=e(m),f=n(v);break;case 9:C=d,i(C,l(d)-d.getDay()+7),w=h,i(w,l(h)-h.getDay()+13),_=e(C),f=n(w);break;case 5:y=d,i(y,1),y.setMonth(d.getMonth()-1),S=h,i(S,0),_=e(y),f=n(S);break;case 4:x=d,i(x,1),T=h,i(T,1),T.setMonth(h.getMonth()+1),i(T,0),_=e(x),f=n(T);break;case 6:R=d,i(R,1),R.setMonth(d.getMonth()+1),A=h,i(A,1),A.setMonth(h.getMonth()+2),i(A,0),_=e(R),f=n(A)}if(!z(_)&&!z(f))return I=u(5,5,_,b),M=u(5,3,f,b),E=u(0,1,b,b,b,b,b,I,M),E.evaluate(b,0,0,a)}else if(s=o._getExpectedInt(b,0,0),!z(s)){if(1===c)return s===a.getFullYear();if(2===c)return F(s,a);if(3===c)return s===a.getMonth();if(4===c)return s===a.getDay();if(5===c)return s===l(a)}return!1},textLengthConditionEvaluate:function(e,t,n,r){var o,i;return z(r)||""===r?this.ignoreBlank():(o=z(r)?0:(""+r).length,"number"==typeof(i=this._getExpectedInt(e,t,n))&&de(this._compareType(),o,i))},top10ConditionEvaluate:function(e,t,n,r){var o,i,a,l=this;if(z(r)||""===r)return l.ignoreBlank();if(o=l._getExpectedInt(e,t,n),!z(o)&&(i=l.getTopValues(e,o,l.ranges()))){a=0;try{a=l._toDouble(r)}catch(e){return!1}if($._contains(i,a))return!0}return!1},_getExpectedInt:function(e,t,n){var r=this.getExpected(e,t,n);return r=parseInt(r,10),isNaN(r)||!isFinite(r)?b:r},adjustRange:function(e,t){return J(e.row,e.col,Math.min(_e(e),t.getRowCount()),Math.min(fe(e),t.getColumnCount()))},getTopValues:function(e,t,n){var r,o,i,a,l,s,u,c,_,f=0===this.type()?1:-1,d=[];if(!n)return d;for(r=this._cloneToActualRanges(e,n),o=ne(r),u=0;u<o;u++)for(i=this.adjustRange(r[u],e),c=0;c<_e(i);c++)for(a=c+i.row,_=0;_<fe(i);_++)l=_+i.col,s=this._toDouble(e.getValue(a,l)),z(s)||d.push(s);return d.sort(function(e,t){return(t-e)*f}),ne(d)>t&&(d=d.slice(0,t)),d},_toDouble:function(e){return("number"==typeof e||Y(e,Date))&&X?O(e):b},uniqueConditionEvaluate:function(e,t,n,r){var o,i,a,l,s=this,u=r;return z(u)||""===u?s.ignoreBlank():(X&&V(u)&&(u=O(u)),o=this.getExpected(e,t,n),i={},N._tryToBool(o,i),a=i.value,!z(a)&&(l=s.getDuplicated(e,s.ranges()),!z(l)&&$._contains(l,u)?!0===a:!0!==a))},getDuplicated:function(e,t){var n,r,o,i,a,l,s,u,c,_=[],f=[],d=this._cloneToActualRanges(e,t);if(d){for(n=ne(d),r=0;r<n;r++)for(o=d[r],o=this.adjustRange(o,e),i=0;i<_e(o);i++)for(a=i+o.row,l=0;l<fe(o);l++)s=l+o.col,u=e.getValue(a,s,3),!z(u)&&X&&V(u)&&(u=O(u)),_.push(u);c={},S.each(_,function(e,t){c[t]=0}),S.each(_,function(e,t){c[t]++}),S.each(_,function(e,t){c[t]>1&&f.push(t)}),c=T}return f},_containsKey:function(e,t){var n,r=e.length;for(n=0;n<r;n++)if(e[n].key===t)return!0;return!1},averageConditionEvaluate:function(e,t,n,r){var o,i,a,l,s,u,c,_;if(!X)return!1;if(o=this,o.ignoreBlank()&&(z(r)||""===r))return!0;if(o._rebuildFormula(),i=this.getExpected(e,t,n),a={},l=H(i,a)?a.value:NaN,s=b,u=o._stdevExpr?o._getExpectedByExpression(e,o._stdevExpr,t,n):b,z(u)||(a={},s=H(u,a)?a.value:NaN),V(r)&&(c=O(r),!isNaN(l)))switch(_=isNaN(s),o.type()){case 0:return c>l;case 1:return c<l;case 2:return c>=l;case 3:return c<=l;case 4:return!_&&c>l+s;case 5:return!_&&c<l-s;case 6:return!_&&c>l+2*s;case 7:return!_&&c<l-2*s;case 8:return!_&&c>l+3*s;case 9:return!_&&c<l-3*s;default:return!1}return!1},_rebuildFormula:function(){var e=this;e.ranges()&&(e._expr=e._createExpression("AVERAGE",e.ranges()),e.type()>=4&&e.type()<=9&&(e._stdevExpr=e._createExpression("STDEV",e.ranges())))},_createExpression:function(e,t){var n,r,o,i;if(!X)return b;if(n=re.findGlobalFunction(e)){for(r=[],o=ne(t),i=0;i<o;i++)r[i]=se(t[i]);return y._createFunctionExpression(n,r)}return b},averageConditionGetExpected:function(e,t,n){var r=e._getCalcServiceInternal();return r?r._evaluateParsedFormula(e._getSheetSource(),this.expression(T,e),oe(t,n),!1):b},_getExpectedByExpression:function(e,t,n,r){var o=e._getCalcServiceInternal();return o?o._evaluateParsedFormula(e._getSheetSource(),t,oe(n,r),!1):b},_concatArray:function(e,t){var n,r;for(r=0;r<ne(t);r++)n=t[r],Y(n,Array)&&ne(n)>0?ne(t)>1?e.push(n[0]):e.push.apply(e,n):e.push(n)},getValidList:function(e,t,n){var r,o,i=[],a=this.getValidListImp(e,t,n);for(r=0,o=ne(a);r<o;r++)i.push(a[r].value);return i},getValidListImp:function(e,t,n){var r,o,i,a,l,s,u=this,c=[];if(u._formula&&u._formula.length>0)r=u.getExpected(e,t,n),Y(r,Array)?u._concatArray(c,r):c.push(r);else if(u.expected()&&u.expected().length>0&&(o=u.expected(),i=o.split(",")))for(a=0;a<ne(i);a++)l=i[a],z(l)||""!==(s=S.trim(l))&&c.push({text:s,value:s});return c},areaConditionEvaluate:function(e,t,n,r){var o,i,a,l,s,u;function c(e,t){return Y(e,Date)&&Y(t,Date)?e.valueOf()===t.valueOf():e===t}if(o=this,z(r)||""===r)return!0===o.ignoreBlank();for(i=o.getValidList(e,t,n),a=0;a<ne(i);a++){if(l=i[a],z(l)&&z(r))return!0;if(o._formula){if(c(l,r))return!0}else if(s=e.getActualStyle(t,n),u=G._parseText2Value(s,l,!0),c(u,r))return!0}return!1},areaConditionGetExpected:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h=this,g=[];if(h._formula){if(!(u=e._getCalcServiceInternal()))return g;if(c=u._evaluateParsedFormula(e._getSheetSource(),h.expression(T,e),oe(t,n),!0),N._isReference(c))for(r=c.getRowCount(0),o=c.getColumnCount(0),_=c.getRow(0),f=c.getColumn(0),d=c._source&&c._source._sheet,i=0;i<r;i++)for(g[i]=[],a=0;a<o;a++)l=c.getValue(0,i,a),s=d?d.getText(_+i,f+a):l,g[i][a]={value:l,text:s};else if(N._isArray(c))for(r=c.getRowCount(),o=c.getColumnCount(),i=0;i<r;i++)for(g[i]=[],a=0;a<o;a++)l=c.getValue(i,a),g[i][a]={value:l,text:l}}else g.push({value:h.expected(),text:h.expected()});return g},reset:function(){var e=this;switch(e.ignoreBlank(!1),e._compareType(1),e.item1(b),e.item2(b),e.value1=b,e.value2=b,e.style(b),e.stopIfTrue(!1),e.priority(1),e.expected(b),e._compareType(0),e.integerValue(!1),e.operator=0,e.text="",e._compareType(0),e.useWildCards(!0),e.ignoreCase(!1),e.forceValue2Text(!1),e.customValueType(0),e._expr=b,e.type(0),this.expectTypeId(0),e.ranges(b),e.isPercent(!1),e.regex(b),e.conType()){case 0:e.ignoreBlank(!1),e._compareType(1);break;case 1:e._compareType(0),e.integerValue(!1);break;case 2:e._compareType(0),e.useWildCards(!0),e.forceValue2Text(!1);break;case 3:e._compareType(0);break;case 4:e.customValueType(0),e._stdevExpr=b;break;case 5:e._compareType(0);break;case 6:e.expectTypeId(0);break;case 7:e._compareType(0);break;case 8:case 10:e.type(0);break;case 11:e.operator=6}},evaluate:function(e,t,n,r){var o=this.conType();return!z(o)&&this[a[o]+"Evaluate"](e,t,n,r)},getExpectedNormal:function(e,t,n,r,o,i){var a,l=this,s=l._formula,u=l.expected();return s?(a=e._getCalcServiceInternal(),a?a._evaluateParsedFormula(e._getSheetSource(),l.expression(T,e),oe(t,n),!1,i):u):u},getExpected:function(e,t,n){var r=this;switch(r.conType()){case 2:return r.getExpectedNormal(e,t,n,t-r.offsetRow,n-r.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:return r.getExpectedNormal(e,t,n,t-r.offsetRow,n-r.offsetCol,!1);case 8:return r.getExpectedNormal(e,t,n,t,n);case 0:return b;case 1:return r.numberConditionGetExpected(e,t,n);case 3:return b;case 4:return r.formulaConditionGetExpected(e,t,n);case 10:return r.averageConditionGetExpected(e,t,n);case 12:return r.areaConditionGetExpected(e,t,n);default:return b}},_cloneToActualRanges:function(e,t){var n,r,o,i=[];for(n=0,r=ne(t);n<r;n++)o=e._getActualRange(t[n]),i.push(o);return i},getExpressions:function(){var e=[],t=this;return 0===t.conType()?(t.item1()&&t.item1().getExpressions&&(e=t.item1().getExpressions()),t.item2()&&t.item2().getExpressions&&(e=e.concat(t.item2().getExpressions())),e):(t._expr||t.initExpression(),t._expr?[t._expr]:[])},setExpressions:function(e){var t,n=this;if(0===n.conType())return n.item1()&&n.item1().setExpressions&&(t=n.item1().getExpressions().length,n.item1().setExpressions(e.slice(0,t))),void(n.item2()&&n.item2().setExpressions&&n.item2().setExpressions(e.slice(t)));n.expression(e[0])},toJSON:function(e){return r.call(this,e,f)},fromJSON:function(e,t,n){e&&o.call(this,t,f,e,n)}},d.prototype._compareType=d.prototype.compareType,d.fromSource=function(e){return u(12,b,e,b)},d.fromFormula=function(e){return u(12,b,"",e)},d.fromDay=function(e){var t=u(6,b,e);return t.expectTypeId(5),t},d.fromMonth=function(e){var t=u(6,b,e);return t.expectTypeId(3),t},d.fromQuarter=function(e){var t=u(6,b,e);return t.expectTypeId(2),t},d.fromWeek=function(e){var t=u(6,b,e);return t.expectTypeId(4),t},d.fromYear=function(e){var t=u(6,b,e);return t.expectTypeId(1),t},d}(),v.Condition=s,u=function(e,t,n,r,o,i,a,l,u){return new s(e,{compareType:t,expected:n,formula:r,customValueType:o,type:i,ranges:a,item1:l,item2:u})},v._createCondition=u,c=function(){function e(e,t,n){var r=this;r.ruleType(e),r.style(t),r.ranges(n)}var n={ruleType:t("ruleType",b),ranges:t("ranges",b,function(e){var t=this.condition();t&&t.ranges()&&t.ranges(e)}),condition:t("condition",b),style:t("style",b),priority:t("priority",1),stopIfTrue:t("stopIfTrue",!1),evaluate:function(e,t,n,r){var o,i,a=this;return a.contains(t,n)?(a.initCondition(),o={baseRow:0,baseCol:0},a.getBaseCoordinate(o),a.condition().adjustOffset(t-o.baseRow,n-o.baseCol),i=b,a.condition().evaluate(e,t,n,r)&&(i=a.getExpected()),a.condition().adjustOffset(0,0),i):b},contains:function(e,t){var n,r,o,i=this.ranges();if(i)for(n=ne(i),o=0;o<n;o++)if(r=i[o],r.contains(e,t))return!0;return!1},createCondition:function(){return null},initCondition:function(e){var t=this.condition();t||(t=this.createCondition(),t&&(t.ranges(this.ranges()),this.condition(t)),e&&this.context(e),this.context()&&t&&t.context(this.context()))},context:function(e){return 1===arguments.length&&(this._context=e,this.condition()&&this.condition().context(e)),this._context},getExpected:function(){return this.style()},reset:function(){var e=this;e.ranges(b),e.condition(b),e.style(b),e.stopIfTrue(!1),e.priority(1)},intersects:function(e,t,n,r){var o,i,a,l=this.ranges();if(l)for(o=ne(l),a=0;a<o;a++)if(i=l[a],i.intersect(e,t,n,r))return!0;return!1},isScaleRule:function(){return!1},getBaseCoordinate:function(e){var t,n,r,o,i;if(e.baseRow=Number.MAX_VALUE,e.baseCol=Number.MAX_VALUE,t=this,t.ranges()&&ne(t.ranges())>0)for(n=0;n<ne(t.ranges());n++)r=t.ranges()[n],o=r.row,i=r.col,o=-1===o?0:o,i=-1===i?0:i,e.baseRow=I(o,e.baseRow),e.baseCol=I(i,e.baseCol);else e.baseRow=0,e.baseCol=0},_addData:function(e,t,n){var r,o,i,a,l,s=this,u=n?t:0,c=n?0:t;if(s.ranges())for(r=ne(s.ranges()),o=0;o<r;o++)i=s.ranges()[o],a=n?i.row:i.col,l=n?_e(i):fe(i),
-1!==a&&(a>=e?s.ranges()[o]=J(i.row+u,i.col+c,_e(i),fe(i)):e<a+l&&(s.ranges()[o]=J(i.row,i.col,_e(i)+u,fe(i)+c)))},_onRowsAdded:function(e,t){this._addData(e,t,!0)},_onColumnsAdded:function(e,t){this._addData(e,t,!1)},_removeData:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d=this,h=n?e:0,g=n?0:e,p=n?t:0,m=n?0:t;if(d.ranges()){for(r=[],o=ne(d.ranges()),i=0;i<o;i++)a=d.ranges()[i],l=n?a.row:a.col,s=n?_e(a):fe(a),-1!==l&&(l>e?l+s<=e+t?r.push(a):d.ranges()[i]=J(a.row-p,a.col-m,_e(a),fe(a)):e<l+s&&(u=J(a.row,a.col,_e(a)-I(a.row+_e(a)-h,p),fe(a)-I(a.col+fe(a)-g,m)),0===fe(u)||0===_e(u)?r.push(a):d.ranges()[i]=u));for(c=ne(r),_=0;_<c;_++)f=r[_],ee(d.ranges(),f)}},_onRowsRemoved:function(e,t){this._removeData(e,t,!0)},_onColumnsRemoved:function(e,t){this._removeData(e,t,!1)},toJSON:function(e){return r.call(this,e)},fromJSON:function(e,t,n){e&&(o.call(this,t,b,e,n),this.initCondition(t))}};return S.extend(e.prototype,n),e}(),v.ConditionRuleBase=c,_=function(e){var n,i;S.inherit(a,e),n=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"];function a(t,n,r,o,i,a,l,s,u,c){e.call(this,t,r);var _=this;_.ranges(n),_.operator(o),_.value1("string"==typeof i?S.trim(i):i),_.value2("string"==typeof a?S.trim(a):a),_.text(l),_.formula(s),_.type(u),_.rank(c)}return i={operator:t("operator",b),value1:function(e,t){var n,r;if(1!==arguments.length)return n=this.condition(),n&&(r=n.formula(e,t,0))&&r.length>0?"="+L(S.trim(""+r),"="):this._value1;this._value1=e},value2:function(e,t){var n,r;if(1!==arguments.length)return n=this.condition(),n&&(r=n.formula(e,t,1))&&r.length>0?"="+L(S.trim(""+r),"="):this._value2;this._value2=e},text:t("text",b),formula:function(e,t){var n=this,r=n.condition();if("string"!=typeof e)return r&&r.formula(e,t)||n._formula;n._formula=e,r&&r.formula(e)},type:t("type",b),rank:t("rank",b),priority:t("priority",1),cellValueRuleCreateCondition:function(){var e,t,n,r,o,i,a,l,s=this,c=s.value1(),_=s.value2(),f=s.ranges(),d=s._isFormula(c)?L(c,"="):b,h=s._isFormula(_)?L(_,"="):b,g=s.operator();return 6===g?(e=u(11,3,c,d,T,T,f),e.treatNullValueAsZero(!0),t=u(11,5,_,h,T,T,f),t.treatNullValueAsZero(!0),o=u(0,1,b,b,b,b,f,e,t),n=u(11,5,c,d,T,T,f),n.treatNullValueAsZero(!0),r=u(11,3,_,h,T,T,f),r.treatNullValueAsZero(!0),i=u(0,1,b,b,b,b,f,n,r),u(0,0,b,b,b,b,f,o,i)):7===g?(e=u(11,4,c,d,T,T,f),e.treatNullValueAsZero(!0),t=u(11,2,_,h,T,T,f),e.treatNullValueAsZero(!0),o=u(0,0,b,b,b,b,f,e,t),n=u(11,2,c,d,T,T,f),n.treatNullValueAsZero(!0),r=u(11,4,_,h,T,T,f),r.treatNullValueAsZero(!0),i=u(0,0,b,b,b,b,f,n,r),u(0,1,b,b,b,b,f,o,i)):(a=g,l=u(11,a,c,d,T,T,f),l.treatNullValueAsZero(!0),l)},_isFormula:function(e){return!z(e)&&"="===e[0]},specificTextRuleCreateCondition:function(){var e,t,n,r,o=this.operator();switch(o){case 2:e=2;break;case 3:e=4;break;case 0:e=6;break;case 1:e=7;break;default:e=0}return t=this.text(),n=b,t&&"="===t[0]&&(n=t),r=u(2,e,t,n,T,T,this.ranges()),r.ignoreCase(!0),r.useWildCards(2!==o&&3!==o),r},formulaRuleCreateCondition:function(){var e=this,t=e.ranges();return u(4,b,b,e._formula,4,t)},dateOccurringRuleCreateCondition:function(){return u(6,b,this.type(),b,b,T,this.ranges())},top10RuleCreateCondition:function(){return u(8,b,this.rank(),b,b,this.type(),this.ranges())},uniqueRuleCreateCondition:function(){return u(9,b,!1,b,b,b,this.ranges())},duplicateRuleCreateCondition:function(){return u(9,b,!0,b,b,b,this.ranges())},averageRuleCreateCondition:function(){return u(10,b,b,b,b,this.type(),this.ranges())},createCondition:function(){return this[l[this.ruleType()]+"CreateCondition"]()},reset:function(){var e=this;switch(e.ranges(b),e.condition(b),e.style(b),e.stopIfTrue(!1),e.priority(1),e.operator(6),e.value1(b),e.value2(b),e.text(""),e.formula(b),e.type(0),e.rank(10),e.ruleType()){case 1:e.operator(6);break;case 2:e.operator(0);break;case 4:e.style(0);break;case 5:e.type(0),e.rank(10);break;case 8:e.type(0)}},toJSON:function(e){var t=r.call(this,e,n),o=this.value1(),i=this.value2();return z(o)||(t.value1=o),z(i)||(t.value2=i),t},fromJSON:function(e,t,r){o.call(this,t,n,e,r),z(e.value1)||this.value1(e.value1),z(e.value2)||this.value2(e.value2),this.initCondition(t)}},S.extend(a.prototype,i),a}(c),v.NormalConditionRule=_,f=function(){function e(e,t){this.type=e,this.value=t}return e}(),v.ScaleValue=f,d=function(e){var n,i;S.inherit(a,e),n=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"];function a(t,n,r,o,i,a,l,s,u,c,_){var f,d,h,g,p,m,v,C,w,y;e.call(this,t,b,_),f=this,f.lowestValueCached=b,f.highestValueCached=b,f.cached=!1,f._oldRanges=b,d=n,h=r,g=o,p=i,m=a,v=l,C=s,w=u,y=c,arguments.length<=1&&(d=1,h=b,g=Z(255,248,105,107),p=4,m=50,v=Z(255,255,235,132),C=2,w=b,y=Z(255,99,190,123)),f.minColor(g),f.minValue(h),f.minType(d),f.midColor(v),f.midValue(m),f.midType(p),f.maxColor(y),f.maxValue(w),f.maxType(C)}return i={stopIfTrue:function(){return!1},minValue:t("minValue",b),minType:t("minType",5),minColor:t("minColor",b),midValue:t("midValue",50,b,function(e){var t=this;if(t._evaluator){if(2===t.midType())return t._getHighestValue(t._evaluator);if(1===t.midType())return t._getLowestValue(t._evaluator)}return e}),midType:t("midType",b),midColor:t("midColor",b),maxType:t("maxType",7),maxValue:t("maxValue",b),maxColor:t("maxColor",b),isScaleRule:function(){return!0},createCondition:function(){return b},_calculateLowestValueEx:function(e){var t=u(8,b,b,b,b,1).getTopValues(e,1,this.ranges());return ne(t)>0?t[0]:b},_calculateHighestValueEx:function(e){var t=u(8,b,b,b,b,0).getTopValues(e,1,this.ranges());return ne(t)>0?t[0]:b},_cloneRanges:function(e){var t,n,r=[],o=ne(e);for(n=0;n<o;n++)t=e[n],r.push(J(t.row,t.col,_e(t),fe(t)));return r},_rangesChanged:function(){var e,t,n,r=this._oldRanges,o=this.ranges();if(!r)return this._oldRanges=this._cloneRanges(o),!1;if(e=ne(r),t=ne(o),e!==t)return!0;for(n=0;n<t;n++)if(!r[n].equals(o[n]))return!0;return!1},_tryCache:function(e){var t=this;t._rangesChanged()&&(t._clearCache(),t._oldRanges=t._cloneRanges(t.ranges())),!1===t.cached&&(t.lowestValueCached=t._calculateLowestValueEx(e),t.highestValueCached=t._calculateHighestValueEx(e),t.cached=!0)},_clearCache:function(){this.lowestValueCached=b,this.highestValueCached=b,this.cached=!1},_calculateFormula:function(e,t,n,r){var o,i;return r&&(o=e._getCalcServiceInternal())?(i=o.parse(e._getSheetSource(),r,t,n),o._evaluateParsedFormula(e._getSheetSource(),i,oe(t,n),!1)):b},_isFormula:function(e){return e&&"="===e[0]},_trimFormula:function(e){return z(e)||""===e?b:"="===e[0]?e.substr(1):e},_calculateValue:function(e,t,n,r){if(this._isFormula(r))return this._calculateFormula(e,t,n,this._trimFormula(""+r));var o={};return H(r,o)?o.value:NaN},_getHighestValue:function(e){return this._tryCache(e),this.highestValueCached},_getLowestValue:function(e){return this._tryCache(e),this.lowestValueCached},_calculatePercent:function(e,t,n,r){var o,i,a=this._calculateValue(e,t,n,r);return!isNaN(a)&&0<=a&&a<=100&&(o=this._getLowestValue(e),i=this._getHighestValue(e),typeof o!==R&&o!==b&&typeof i!==R&&i!==b)?o+(i-o)*a/100:b},_calculatePercentile:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h=this._calculateValue(e,t,n,r);if(!isNaN(h)&&0<=h&&h<=100){for(o=0,i=this.ranges(),a=ne(i),l=0;l<a;l++)s=this._createExpression("PERCENTILE",[e._getActualRange(i[l]),h/100]),u=e._getCalcServiceInternal(),c=u.unparse(b,s,t,n),_=u.parse(e._getSheetSource(),c,t,n),f=u._evaluateParsedFormula(e._getSheetSource(),_,oe(t,n),!1),d={},o+=H(f,d)?d.value:0;return o/a}return b},_getActualValue:function(e,t,n,r,o){var i,a,l=this;switch(r){case 6:return l._isFormula(o)||(o="="+o),l._calculateValue(e,t,n,o);case 2:return l._getHighestValue(e);case 1:return l._getLowestValue(e);case 0:return l._calculateValue(e,t,n,o);case 3:return l._calculatePercent(e,t,n,o);case 4:return l._calculatePercentile(e,t,n,o);case 7:return i=l._getHighestValue(e),i<0?0:i;case 5:return a=l._getLowestValue(e),a>0?0:a;default:return b}},_evaluate2Scale:function(e,t,n){return e===t&&e===n?1:e<=t?0:e>=n?1:(e-t)/(n-t)},_evaluateColor:function(e,t,n){var r,o,i,a,l,s;return 0<=e&&e<=1?(r=K._fromString(t),o=K._fromString(n),i=r.a*(1-e)+o.a*e,a=r.r*(1-e)+o.r*e,l=r.g*(1-e)+o.g*e,s=r.b*(1-e)+o.b*e,Z(parseFloat(i/255),parseInt(a,10),parseInt(l,10),parseInt(s,10))):b},_createExpression:function(e,t){var n,r,o,i;if(!X)return b;if(n=re.findGlobalFunction(e)){for(r=[],o=ne(t),i=0;i<o;i++)r[i]=se(t[i]);return new y._createFunctionExpression(n,r)}return b},_onRowsAdded:function(t,n){e.prototype._onRowsAdded.call(this,t,n),this._clearCache()},_onColumnsAdded:function(t,n){e.prototype._onColumnsAdded.call(this,t,n),this._clearCache()},_onRowsRemoved:function(t,n){e.prototype._onRowsRemoved.call(this,t,n),this._clearCache()},_onColumnsRemoved:function(t,n){e.prototype._onColumnsRemoved.call(this,t,n),this._clearCache()},scaleEvaluate:function(e,t,n,r){var o,i,a,l,s=this;if(s._tryCache(e),s.contains(t,n)){if(z(r))return b;try{if(o=O(r),i=s._getActualValue(e,t,n,s.minType(),s.minValue()),a=s._getActualValue(e,t,n,s.midType(),s.midValue()),l=s._getActualValue(e,t,n,s.maxType(),s.maxValue()),i>l)return b;if(isNaN(a)){if(!isNaN(i)&&!isNaN(l))return s._evaluate2Scale(o,i,l)}else if(!isNaN(i)&&!isNaN(l))return o<i?0:o>=l?2:i<=o&&o<=a?s._evaluate2Scale(o,i,a):1+s._evaluate2Scale(o,i,l)}catch(e){return b}}return b},twoScaleRuleEvaluate:function(e,t,n,r){var o,i,a,l,s;if(!z(r)){if(o={},i=V(r)&&H(r,o)?o.value:NaN,isNaN(i))return b;if(a=this,l=a._getActualValue(e,t,n,a.minType(),a.minValue()),s=a._getActualValue(e,t,n,a.maxType(),a.maxValue()),!z(l)&&!z(s))return o=a._evaluate2Scale(i,l,s),a._evaluateColor(o,a.minColor(),a.maxColor())}return b},threeScaleRuleEvaluate:function(e,t,n,r){var o,i,a,l,s,u=this;if(u._evaluator=e,!z(r)){if(o={},i=V(r)&&H(r,o)?o.value:NaN,isNaN(i))return b;if(a=u._getActualValue(e,t,n,u.minType(),u.minValue()),l=u._getActualValue(e,t,n,u.midType(),u.midValue()),s=u._getActualValue(e,t,n,u.maxType(),u.maxValue()),!z(a)&&!z(s)&&!z(l))return a>s?b:i<=a||a===s?i>=s?u.maxColor():u.minColor():i>=s?u.maxColor():i<=l?(o=u._evaluate2Scale(i,a,l),u._evaluateColor(o,u.minColor(),u.midColor())):(o=u._evaluate2Scale(i,l,s),u._evaluateColor(o,u.midColor(),u.maxColor()))}return b},evaluate:function(e,t,n,r){return this[l[this.ruleType()]+"Evaluate"](e,t,n,r)},_init:function(){var e=this;e.minValue(b),e.minType(1),e.midValue(50),e.midType(4),e.maxValue(b),e.maxType(2),10===e.ruleType()&&(e.minColor(Z(0,255,255,255)),e.maxColor(Z(255,99,190,123))),11===e.ruleType()&&(e.midValue(50),e.midType(4),e.minColor(Z(255,248,105,107)),e.midColor(Z(255,255,235,132)),e.maxColor(Z(255,99,190,123)))},reset:function(){var e=this;e.ranges(b),e.condition(b),e.style(b),e._init(),e._evaluator=b,e.stopIfTrue(!1),e.priority(1)},toJSON:function(e){return r.call(this,e,n)},fromJSON:function(e,t,r){o.call(this,t,n,e,r),this.initCondition(t)}},S.extend(a.prototype,i),a}(c),v.ScaleRule=d,h=function(e){var n,i;S.inherit(a,e),n=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"];function a(t,n,r,o,i,a){var l=t,s=n,u=r,c=o,_=i;0===arguments.length&&(l=5,s=b,u=7,c=b,_=Z(255,99,142,198)),e.call(this,12,l,s,b,b,b,b,u,c,b,a),this._init(_)}return i={gradient:t("gradient",!0),color:t("color",b),showBorder:t("showBorder",!1),borderColor:t("borderColor","black"),dataBarDirection:t("dataBarDirection",0),negativeFillColor:t("negativeFillColor","red"),useNegativeFillColor:t("useNegativeFillColor",!0),negativeBorderColor:t("negativeBorderColor","black"),useNegativeBorderColor:t("useNegativeBorderColor",!1),axisPosition:t("axisPosition",0),axisColor:t("axisColor","black"),showBarOnly:t("showBarOnly",!1),_init:function(e){var t=this;t.gradient(!0),t.color(e),t.showBorder(!1),t.borderColor("black"),t.dataBarDirection(0),t.negativeFillColor("red"),t.useNegativeFillColor(!0),t.negativeBorderColor("black"),t.useNegativeBorderColor(!1),t.axisPosition(0),t.axisColor("black"),t.showBarOnly(!1)},reset:function(){var e=this;e.ranges(b),e.condition(b),e.style(b),e._init(Z(255,99,142,198)),e.stopIfTrue(!1),e.priority(1),e.minValue(b),e.minType(5),e.midValue(b),e.midType(b),e.maxValue(b),e.maxType(7),e.minColor(b),e.midColor(b),e.maxColor(b)},_calcuteMaxMinValue:function(e,t,n,r){var o,i,a,l,s=this,u=r?s.maxType():s.minType(),c=r?s.maxValue():s.minValue();if(6!==u&&4!==u)return s._getActualValue(e,t,n,u,c);for(i=0;i<ne(s.ranges());i++)if(s.ranges()[i].intersect(t,-1,1,-1)&&(o=s.ranges()[i]))return a=o.row,l=o.col,a=-1===a?0:a,l=-1===l?0:l,s._getActualValue(e,a,l,u,c)},_evaluateNoneScale:function(e,t,n,r){return r=0,e>=n&&e>t?[1,r]:e<=t&&e<n?[0,r]:n===t?[.5,r]:[(e-t)/(n-t),r]},_evaluateMidScale:function(e,t,n,r){var o,i,a;return r=.5,o=E(n-t),n>0&&t>=0?n===t?[.5,r]:e>=n?[.5,r]:e<=t?[t/n*.5,r]:[.5*E(e/n),r]:n>0&&t<0?(i=n>E(t)?.5:n/o,a=n>E(t)?t/o:-.5,e>0?e>=n?[i,r]:[e/n*i,r]:e<0?e<=t?[a,r]:[e/t*a,r]:[0,r]):n<=0&&t<0?n===t?[-.5,r]:e>=n?[-n/t*.5,r]:e<=t?[-.5,r]:[-e/t*.5,r]:0===n&&0===t?[0,r]:(r=-1,[-1,r])},_evaluateAutoScale:function(e,t,n,r){var o,i,a,l=E(t),s=E(n),u=E(n-t),c=t<0?-1:1;return n>0&&t>=0||n<=0&&t<0?(o=M(l,s),i=I(l,s),a=E(e),r=t<0?1:0,a<=i&&a<o?[0,r]:a>=o&&a>i?[c,r]:i===o?[.5*c,r]:[c*(E(e)-i)/u,r]):n>0&&t<0?(r=E(t)/u,0===e?[0,r]:e>=n?[1-r,r]:[M(e,t)/u,r]):0===n&&0===t?(r=.5,0===e?[0,r]:[.5*c,r]):(r=-1,[-1,r])},_evaluateScale:function(e,t,n,r){var o=this;return 0===o.axisPosition()?o._evaluateAutoScale(e,t,n,r):1===o.axisPosition()?o._evaluateMidScale(e,t,n,r):o._evaluateNoneScale(e,t,n,r)},evaluate:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g;if(!z(r)){if(o={},i=V(r,!0)&&H(r,o)?o.value:NaN,isNaN(i))return b;if(a=this,l=a._calcuteMaxMinValue(e,t,n,!1),s=a._calcuteMaxMinValue(e,t,n,!0),Y(l,Date)&&(l=Q._toOADate(l)),Y(s,Date)&&(s=Q._toOADate(s)),!z(l)&&!z(s))return l>s&&(u=s,s=l,l=u),!(_=a._evaluateScale(i,l,s,c))||ne(_)<2?b:(f=_[0],c=_[1],d=i<0&&a.useNegativeFillColor()?a.negativeFillColor():a.color(),h=i<0&&a.useNegativeBorderColor()?a.negativeBorderColor():a.borderColor(),g=a.axisColor(),d=ie._getColor(e,d),h=ie._getColor(e,h),g=ie._getColor(e,g),{fillColor:d,borderColor:h,showBorder:a.showBorder(),axisColor:g,isGradient:a.gradient(),direction:a.dataBarDirection(),axisLocation:c,scale:f,showBarOnly:a.showBarOnly()})}return b},toJSON:function(e){return r.call(this,e,n)},fromJSON:function(e,t,r){o.call(this,t,n,e,r),this.initCondition(t)}},S.extend(a.prototype,i),a.paintDataBar=function(e,t,n,r,o,i){var a,l,s,u,c,_,f,d,h,g,p,m,v,C,y=new w.Rect(n+2,r+2,o-4,i-4),S=y.x,x=y.y,b=F(E(y.width*t.scale)),T=y.height;if(0===t.axisLocation)t.scale<=0&&(b=0);else if(1===t.axisLocation)t.scale<0?S=S+y.width-b:b=0;else{for(a=F(y.width*t.axisLocation+S)+.5,l=y.y,s=1,u=i-2,e.lineWidth=s,e.strokeStyle=t.axisColor,e.beginPath(),c=0;c<=u;c+=2)1===t.direction?(e.moveTo(2*n+o-a,l+c),e.lineTo(2*n+o-a,l+c+1)):(e.moveTo(a,l+c),e.lineTo(a,l+c+1));e.stroke(),t.scale>0?S=a+s:t.scale<0?S=a-b:b=0}t.showBorder&&(S=F(S)+.5,b-=1,x+=.5,T-=1),_=S,f=S+b,1===t.direction&&(_=2*n+o-S-b,f=2*n+o-S),b>=0&&T>=0&&(d=t.fillColor,t.isGradient&&(h=.9,d=e.createLinearGradient(_,x,f,x),g=K._fromString(t.fillColor),p=Z(g.a,F(255*h+g.r*(1-h)),F(255*h+g.g*(1-h)),F(255*h+g.b*(1-h))),m=t.scale<0?1-h:h,v=t.fillColor,C=t.scale<0?1:0,1===t.direction?(d.addColorStop(m,v),d.addColorStop(C,p)):(d.addColorStop(m,p),d.addColorStop(C,v))),e.fillStyle=d,e.fillRect(_,x,b,T),t.showBorder&&b>0&&T>0&&(e.strokeStyle=t.borderColor,e.strokeRect(_,x,b,T)))},a}(d),v.DataBarRule=h,g=function(){function e(e,t,n){this.isGreaterThanOrEqualTo=e,this.iconValueType=t,this.iconValue=n}return e}(),v.IconCriterion=g,p=function(e){var n,i;S.inherit(a,e),n=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority"];function a(t,n){var r=t;0===arguments.length&&(r=0),e.call(this,13,b,b,b),this.ranges(n),this._init(r)}return i={_initIconSetType:function(e){var t=this;t.iconSetType(e,!1),t.iconSetType()>=0&&t.iconSetType()<=9?(t._iconCriteria=[],t._iconCriteria[0]=new g(!0,4,33),t._iconCriteria[1]=new g(!0,4,67)):t.iconSetType()>=10&&t.iconSetType()<=14?(t._iconCriteria=[],t._iconCriteria[0]=new g(!0,4,25),t._iconCriteria[1]=new g(!0,4,50),t._iconCriteria[2]=new g(!0,4,75)):t.iconSetType()>=15&&t.iconSetType()<=19?(t._iconCriteria=[],t._iconCriteria[0]=new g(!0,4,20),t._iconCriteria[1]=new g(!0,4,40),t._iconCriteria[2]=new g(!0,4,60),t._iconCriteria[3]=new g(!0,4,80)):t.iconSetType()>19&&(t._iconCriteria=[])},_init:function(e){this.showIconOnly(!1),this.reverseIconOrder(!1),this._initIconSetType(e)},_modifyIconIndex:function(e){var t=ne(this._iconCriteria)+1;return this.reverseIconOrder()&&t>2?t-1-e:e},_getActualValue:function(e,t,n,r){var o=this,i=o._iconCriteria[r];if(i)switch(i.iconValueType){case 7:case 1:return o._calculateValue(e,t,n,i.iconValue);case 4:return o._calculatePercent(e,t,n,i.iconValue);case 5:return o._calculatePercentile(e,t,n,i.iconValue);default:return b}},evaluate:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h=this,g=r;if(z(g))return b;if(o={},i=V(r,!0)&&"boolean"!=typeof g&&H(r,o)?o.value:NaN,isNaN(i))return b;if(a=0,l=h.iconSetType(),s=h._iconCriteria,l>=15?a=5:l>=10?a=4:l>=0&&(a=3),!s)return 0;for(c=0,_=a-1;_>0;_--)if(_<ne(s)+1&&(u=s[_-1],!z(u&&u.iconValue)&&(f=h._getActualValue(e,t,n,_-1),!z(f)&&(d=u.isGreaterThanOrEqualTo?i>=f:i>f,i<Number.MAX_VALUE&&d)))){c=_;break}return{iconSetType:l,iconIndex:h._modifyIconIndex(c),showIconOnly:h.showIconOnly()}},reset:function(){var e=this;e.ranges(b),e.condition(b),e.style(b),e.showIconOnly(!1),e.reverseIconOrder(!1),e.iconSetType(0,!1),e._iconCriteria=b,e.stopIfTrue(!1),e.priority(1),e.minColor(b),e.minValue(b),e.minType(5),e.midColor(b),e.midValue(b),e.midType(b),e.maxColor(b),e.maxValue(b),e.maxType(7)},iconSetType:t("iconSetType",0,function(e){this._initIconSetType(e)}),reverseIconOrder:t("reverseIconOrder",!1),showIconOnly:t("showIconOnly",!1),iconCriteria:function(){return this._iconCriteria},toJSON:function(e){return r.call(this,e,n)},fromJSON:function(e,t,r){o.call(this,t,n,e,r),this.initCondition(t)}},S.extend(a.prototype,i),a.paintIconSet=function(e,t,n,r,o,i,l,s){var u,c=n+1,_=r+2,f=16,d=16;t.showIconOnly&&(1===l.hAlign?c=n+o/2-f/2:2===l.hAlign&&(c=n+o-f-2)),1===l.vAlign?_=r+i/2-d/2:2===l.vAlign&&(_=r+i-d-2),u=a.getIcon(t.iconSetType,t.iconIndex);try{u&&s&&("string"===S.getType(u)?h(u,c,_,f,d):h(u.image,u.x,u.y,u.w,u.h,c,_,f,d))}catch(e){}function h(){var t,n=arguments,r=n[0],o=n[1],i=n[2],a=n[3],l=n[4];s._getState(r)?(t=s._getImage(r),5===ne(n)?e.drawImage(t,o,i,a,l):e.drawImage(t,o,i,a,l,n[5],n[6],n[7],n[8])):s._addImage(r)}},a._getImageSrc=function(){
return"data:image/png;base64,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"},a.getIcon=function(e,t){var n,r,o,i,l,s,u=[[160,180,80,b,b],[100,120,140,b,b],[900,920,880,b,b],[820,840,860,b,b],[780,1e3,420,b,b],[680,940,400,b,b],[800,1020,440,b,b],[740,1040,400,b,b],[720,980,380,b,b],[700,960,360,b,b],[160,40,60,80,b],[100,0,20,140,b],[220,340,460,760,b],[600,620,640,660,b],[200,680,940,400,b],[160,40,180,60,80],[100,0,120,20,140],[580,600,620,640,660],[480,500,520,540,560],[240,260,280,300,320]];for(n=0;n<ne(u);n++)for(r=0;r<ne(u[n]);r++)(o=u[n][r])!==b&&(u[n][r]="0,"+o+",16,16");return i=a._getImageSrc(),l=u[e][t],l?(s=l.split(","),{image:i,x:s[0],y:s[1],w:s[2],h:s[3]}):b},a}(d),v.IconSetRule=p;function he(e){return"string"==typeof e&&(e=S.trim(e),"="!==e[0]&&(e='="'+x._replace(e,'"','""')+'"')),e}m=function(){function e(e){this._rules=[],this._ruleTypes=b,this._cellRuleCache={},this._worksheet=e}function t(e,t){if(t)for(var n=0;n<t.length;n++)e.push(t[n])}var n={getRule:function(e){return this._rules[e]},count:function(){return ne(this._rules)},_getAllRules:function(){return this._rules},_cloneToActualRanges:function(e){var t,n,r=[],o=this._worksheet,i=ne(e);for(t=0;t<i;t++)n=o._getActualRange(e[t]),r.push(n);return r},_cloneToRanges:function(e){var t,n,r,o,i=[],a=this._worksheet;for(t=0,n=ne(e);t<n;t++)r=e[t],o=new q(r.row,r.col,_e(r),fe(r)),0===r.row&&_e(r)===a.getRowCount()&&(o.row=-1),0===r.col&&fe(r)===a.getColumnCount()&&(o.col=-1),i.push(o);return i},_resetCache:function(){if(this._cellRuleCache={},this._rules)for(var e=0;e<ne(this._rules);e++)this._addCache(this._rules[e])},_clearCellRuleCache:function(){this._cellRuleCache={}},_addCache:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d=this,h=d._cellRuleCache,g=d._cloneToActualRanges(e.ranges()),p=d._worksheet,m=p.getRowCount(),v=p.getColumnCount();for(i=0;i<ne(g);i++)for(a=g[i],l=a.row,s=a.col,u=_e(a),c=fe(a),l+u-1>=m&&(u=m-l),s+c-1>=v&&(c=v-s),_=0;_<u;_++)for(r=_+l,t=h[r],t||(h[r]=t={}),f=0;f<c;f++)o=f+s,n=t[o],n||(t[o]=n=[]),n.push(e)},_removeCache:function(e){var t,n,r,o,i,a,l,s,u,c,_=this._cellRuleCache,f=this._cloneToActualRanges(e.ranges());for(i=0;i<ne(f);i++)for(a=f[i],l=0;l<_e(a);l++)if(r=l+a.row,t=_[r])for(s=0;s<fe(a);s++)if(o=s+a.col,n=t[o]){for(u=[],c=0;c<ne(n);c++)n[c]!==e&&u.push(n[c]);0===ne(u)&&(u=T),t[o]=u}},_removeCacheByRange:function(e,t,n,r){var o,i,a,l,s,u=this._cellRuleCache;for(l=0;l<n;l++)if(o=l+e,a=u[o])for(s=0;s<r;s++)i=s+t,a[i]=T},addSpecificTextRule:function(e,t,n,r){var o=new _(2,r,n,e,b,b,t);return this.addRule(o)},addCellValueRule:function(e,t,n,r,o){var i=new _(1,o,r,e,he(t),he(n));return this.addRule(i)},addDateOccurringRule:function(e,t,n){var r=new _(4,n,t,b,b,b,b,b,e);return this.addRule(r)},addFormulaRule:function(e,t,n){var r=new _(3,n,t,b,b,b,b,e);return this.addRule(r)},addTop10Rule:function(e,t,n,r){var o=new _(5,r,n,b,b,b,b,b,e,t);return this.addRule(o)},addUniqueRule:function(e,t){var n=new _(6,t,e);return this.addRule(n)},addDuplicateRule:function(e,t){var n=new _(7,t,e);return this.addRule(n)},addAverageRule:function(e,t,n){var r=new _(8,n,t,b,b,b,b,b,e);return this.addRule(r)},add3ScaleRule:function(e,t,n,r,o,i,a,l,s,u){var c;return c=0===arguments.length?new d(11):new d(11,e,t,n,r,o,i,a,l,s,u),this.addRule(c)},add2ScaleRule:function(e,t,n,r,o,i,a){var l;return l=0===arguments.length?new d(10):new d(10,e,t,n,b,b,b,r,o,i,a),this.addRule(l)},addDataBarRule:function(e,t,n,r,o,i){var a;return a=0===arguments.length?new h:new h(e,t,n,r,o,i),this.addRule(a)},addIconSetRule:function(e,t){var n=new p(e,t);return this.addRule(n)},addRule:function(e){var t,n=this,r=n._worksheet;if(r){if(!e)throw Error(ae().Exp_RuleIsNull);for(t=0;t<ne(n._rules);t++)n._rules[t].priority(n._rules[t].priority()+1);return e.priority(1),n._rules.push(e),e.context(r),n._addCache(e),r._invalidate(),e}},removeRule:function(e){var t=this,n=t._worksheet;n&&(e&&(t._removeCache(e),ee(t._rules,e)),n._invalidate())},_removeRange:function(e,t,n,r,o){var i,a,l,s,u,c,_,f,d,h,g,p,m;return e.intersect(t,n,r,o)?(i=e.row,a=e.row+_e(e)-1,l=e.col,s=e.col+fe(e)-1,u=t,c=t+r-1,_=n,f=n+o-1,d=[],-1!==i&&-1!==l&&-1!==u&&-1!==_&&(_-l>0&&(h=J(i,l,_e(e),_-l),d.push(h)),s-f>0&&(g=J(i,f+1,_e(e),s-f),d.push(g)),u-i>0&&(p=J(i,M(_,l),u-i,I(f,s)-M(_,l)+1),d.push(p)),a-c>0&&(m=J(c+1,M(_,l),a-c,I(f,s)-M(_,l)+1),d.push(m))),ne(d)>0?d:b):[e]},removeRuleByRange:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g=this,p=g._worksheet;if(p){if(o=[],g._rules)for(g._removeCacheByRange(e,t,n,r),i=0,a=ne(g._rules);i<a;i++)if((l=g._rules[i])&&l.ranges()&&l.intersects(e,t,n,r)){for(s=[],u=g._cloneToActualRanges(l.ranges()),c=0,_=ne(u);c<_;c++)(f=g._removeRange(u[c],e,t,n,r))&&(s=s.concat(f));ne(s)>0?l.ranges(g._cloneToRanges(s)):o.push(l)}for(d=0,h=ne(o);d<h;d++)ee(g._rules,o[d]);p._invalidate()}},clearRule:function(){var e=this,t=e._worksheet;t&&(e._rules.length=0,e._resetCache(),t._invalidate())},getRules:function(e,n){var r,o,i,a,l=this._rules;return 0===arguments.length||0===ne(l)?l:(e=e===T?-1:e,n=n===T?-1:n,r=this._cellRuleCache,o=[],-1!==e&&-1!==n?(a=r[e])&&(i=a[n],t(o,i)):-1===e?S.each(r,function(e,r){i=r[n],t(o,i)}):(a=r[e])&&S.each(r,function(e,n){t(o,n)}),o)},containsRule:function(e,t,n){return!(!e||!$._contains(this._rules,e))&&e.contains(t,n)},_addData:function(e,t,n){var r,o,i,a=this;if(a._rules&&a._worksheet)for(r=ne(a._rules),o=0;o<r;o++)(i=a._rules[o])&&(n?i._onRowsAdded(e,t):i._onColumnsAdded(e,t));this._resetCache()},_onRowsAdded:function(e,t){this._addData(e,t,!0)},_onColumnsAdded:function(e,t){this._addData(e,t,!1)},_removeData:function(e,t,n){var r,o,i,a=this;if(a._rules&&a._worksheet)for(r=ne(a._rules),o=r-1;o>=0;o--)(i=a._rules[o])&&(n?i._onRowsRemoved(e,t):i._onColumnsRemoved(e,t),i.ranges().length<=0&&(a._removeCache(i),a._rules.splice(o,1)));this._resetCache()},_onRowsRemoved:function(e,t){this._removeData(e,t,!0)},_onColumnsRemoved:function(e,t){this._removeData(e,t,!1)},_clearCache:function(){var e,t,n,r=this._rules;if(r!==b&&ne(r)>0)for(t=0,n=ne(r);t<n;t++)e=r[t],Y(e,d)&&e._clearCache()},_copyRules:function(e,t,n,r,o,i,a){var l,s,u,c,_,f,d,h,g,p,m,v,C,y,S,x,b,T,R,A,I,M,E,F,D,N,V=[],O=[],H=[],P=this,L=P._worksheet;for(-1===e&&(e=0,r=0,i=L.getRowCount()),-1===t&&(t=0,o=0,a=L.getColumnCount()),l=0;l<i;l++)for(s=0;s<a;s++)for(u=P.getRules(e+l,t+s),c=0;c<ne(u);c++){for(_=u[c],f=_.ranges(),d=[],h=0;h<ne(f);h++)g=f[h],p=L._getActualRange(g),m=p.row,v=p.col,C=_e(p),y=fe(p),te(H,g)<=-1&&g.contains(e+l,t+s)&&(H.push(g),S=J(r+l,o+s,-1,-1),S.rowCount=m+C>=i+e?i-l:e<m?C:m+C-e,S.colCount=v+y>=a+t?a-s:t<v?y:v+y-t,P===n&&g.containsRange(S)||d.push(S));d.length>0&&(x=V.indexOf(_),x<0?(V.push(_),O.push(d)):O[x]=O[x].concat(d))}for(b=0,T=V.length;b<T;b++)R=P._createRuleFromJson(V[b].toJSON(),V[b].context()),A=R.ranges(),R.ranges(O[b]),I=R._formula,I&&(M=1===L.parent.options.referenceStyle,E=ue(A),F=w.CalcEngine.formulaToExpression(L,I,E.r,E.c,M),D=ue(O[b]),N=w.CalcEngine.expressionToFormula(L,F,D.r,D.c,M),R.formula(N)),n.addRule(R);P._resetCache()},_onRulesMoved:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w=[],y=this,S=y._worksheet;for(-1===e&&(e=0,n=S.getRowCount()),-1===t&&(t=0,r=S.getColumnCount()),o=0;o<n;o++)for(i=0;i<r;i++)for(a=y.getRules(e+o,t+i),l=0;l<ne(a);l++){for(s=a[l],u=s.ranges(),c=[],_=0;_<ne(u);_++)f=u[_],d=S._getActualRange(f),h=d.row,g=d.col,p=_e(d),m=fe(d),te(w,f)<=-1&&f.contains(e+o,t+i)&&(w.push(f),e>h&&c.push(J(h,g,e-h,m)),t>g&&c.push(J(M(e,h),g,I(e+n,h+p)-M(e,h),t-g)),t+r<g+m&&c.push(J(M(e,h),t+r,I(e+n,h+p)-M(e,h),g+m-(t+r))),e+n<h+p&&c.push(J(e+n,g,h+p-(e+n),m)));for(v=0;v<ne(w);v++)ee(u,w[v]);C=u.concat(c),C.length>0?s.ranges(C):y.removeRule(s)}y._resetCache()},_paint:function(e,t,n,r,o,i,a,l){var s=16,u=!1,c=!1,_=l.sheet,f=l.row,d=l.col,g=this._getIconSetAndDataBar(_,f,d,t),m=g.iconSet,v=g.dataBar;return(v||m)&&(e.save(),e.beginPath(),v&&(h.paintDataBar(e,v,n,r,o,i),u=v.showBarOnly),m&&((o<s||i<s)&&(e.rect(n,r,o,i),e.clip(),e.beginPath()),p.paintIconSet(e,m,n,r,o,i,a,l.imageLoader),c=m.showIconOnly),e.restore()),u||c},_getIconSetAndDataBar:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d=this,g=e._cachePool,m=g._getConditionalFormat(t,n);if(m)o=m.i,i=m.d;else{if(a=d.getRules(t,n),(l=ne(a))>0){for(a.sort(function(e,t){return e.priority()-t.priority()}),s=b,u=b,f=0;f<l&&(!s||!u);f++)(c=a[f])&&(Y(c,h)&&(s=c),Y(c,p)&&(u=c));if(s||u)for(s=u=b,f=0;f<l&&(!s||!u)&&!((c=a[f])&&(!s&&Y(c,h)&&(s=c),!u&&Y(c,p)&&(u=c),c.stopIfTrue()&&(_=c.evaluate(e,t,n,r))));f++);s&&(i=s.evaluate(e,t,n,r)),u&&(o=u.evaluate(e,t,n,r))}g._setConditionalFormat(t,n,i,o)}return{dataBar:i,iconSet:o}},_hasIconSet:function(e,t,n){var r,o,i;if(z(n)||3===n)for(r=this.getRules(e,t),o=0,i=ne(r);o<i;o++)if(r[o]instanceof p)return!0;return!1},toJSON:function(e){var t,n,r=[];for(t=0;t<ne(this._rules);t++)n=this._rules[t],r.push(n?n.toJSON(e):b);return 0===ne(r)?T:{rules:r}},fromJSON:function(e,t,n){var r,o,i;if(e&&e.rules){for(this._rules=[],r=0;r<ne(e.rules);r++)o=e.rules[r],(i=this._createRuleFromJson(o,t,n))&&this._rules.push(i);this._resetCache()}},_createRuleFromJson:function(e,t,n){var r,o,i=b;return e&&(r=this._getRuleTypes(),(o=r[e.ruleType])&&(i=new o,i.fromJSON(e,t,n))),i},_getRuleTypes:function(){if(!this._ruleTypes){var e={};e[0]=c,e[1]=_,e[2]=_,e[3]=_,e[4]=_,e[5]=_,e[6]=_,e[7]=_,e[8]=_,e[9]=d,e[10]=d,e[11]=d,e[12]=h,e[13]=p,this._ruleTypes=e}return this._ruleTypes},_applyFormats:function(e,t,n,r){var o,i,a,l,s,u,c=this;if(c&&c.count()>0&&(o=c.getRules(t,n),i=ne(o),l=b,i>0))for(o.sort(function(e,t){return e.priority()-t.priority()}),s=0;s<i&&!((a=o[s])&&(u=c._worksheet,a.isScaleRule()?10!==a.ruleType()&&11!==a.ruleType()||(l=a.evaluate(u,t,n,u.getValue(t,n,r)))&&(e||(e=new j),e.backColor===T&&(e.backColor=l)):(l=a.evaluate(u,t,n,u.getValue(t,n,r)))&&(e||(e=new j),e._compose(l,!1,1)),a.stopIfTrue()&&l));s++);return e},_getConditionalStyle:function(e,t,n,r){var o,i,a,l,s,u,c={_hasResult:!1},_=this;if(_&&_.count()>0&&(o=_.getRules(e,t),i=ne(o),l=b,i>0))for(o.sort(function(e,t){return e.priority()-t.priority()}),s=0;s<i;s++)if(a=o[s]){if(u=_._worksheet,a.isScaleRule()){if("backColor"===n&&Y(a,v.ScaleRule)&&(l=a.evaluate(u,e,t,u.getValue(e,t,r)))){c._result=l,c._hasResult=!0;break}}else if((l=a.evaluate(u,e,t,u.getValue(e,t,r)))&&l[n]!==T){c._result=l[n],c._hasResult=!0;break}if(a.stopIfTrue()&&l)break}return c}};return S.extend(e.prototype,n),e}(),v.ConditionalFormats=m,e.exports=v}()},function(e,t){e.exports=GC.Spread.Common},function(e,t){e.exports=GC.Spread.Sheets},function(e,t){e.exports=GC.Spread.CalcEngine},function(e,t){!function(){"use strict";e.exports={Exp_RuleIsNull:"The argument 'rule' is null",Exp_NotSupported:"NotSupportException"}}()}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Filter=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";n(1);var t=n(5);t.SR={},t.SR.en=n(6),e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r=n(2),o=n(3),i=r._BaseDialog,a=n(4),l=o._RegexHelper,s={},u=r.GC$,c=r.Events,_=r._util._createElement,f=r._util,d=f._cancelDefault,h=o._ArrayHelper._getLength,g=o._StringHelper._escapeHtml,p=null,m=o._Types._isNullOrUndefined,v=Math.max,C=parseFloat,w=u.inArray,y=isNaN,S="gc-sortASC",x="gc-sortDES",b="gc-filterOK",T="gc-filterCancel",R="gc-filterSearch",A="gc-filterCheckAll",I="gc-filterUnCheckAll",M="gc-filter-item",E="gc-filter-item-container",F="gc-filter-item-input",D="gc-filter-item-text",N="gc-filter-hover",V="gc-filter-button",O="gc-filter-sort",H="ui-state-hover ",P="gc-filter-button-hover "+H,L="gc-filter-item-hover",k=H+L,B=N+" form-control well "+k,W=" ui-corner-all ",z="ui-button-disabled",U=" ui-state-disabled",Y="gc-filter-button-disable",G="gc-no-user-select",X=" gc-filter-check",j="gc-filter-check-outerDiv",K="gc-filter-button-active",Z=".ui-filter-dialog",J="px",q="font-size",Q="string",$="javascript:void(0)",ee="mouseout",te="click",ne="keydown",re="keyup",oe="search",ie="input",ae="span",le="div",se="button",ue="DOMMouseScroll",ce="mousewheel",_e="mousedown",fe="mouseover",de="mouseup",he="margin",ge=he+"Left",pe=he+"Top",me=he+"Right",ve="padding",Ce=ve+"Left",we=ve+"Right",ye=ve+"Top",Se="display",xe="none",be="width",Te="height",Re="border",Ae="left",Ie="top",Me="box-sizing",Ee="content-box",Fe="block",De=o._Types._getType,Ne=function(){return o._getResource(s.SR)()},Ve=function(){function e(e,t,n,r,o,i,a,l){var s=this;s.rowFilter=e,s.row=t,s.col=n,s.sheetArea=r,s.x=o,s.y=i,s.width=a,s.height=l}return e.prototype._getState=function(){var e=this,t=e.rowFilter,n=e.col,r=t.getSortState(n);return t?t.isFiltered(n)?[3,4,5][r]:r:0},e}();s._FilterButtonInfo=Ve;function Oe(e,t){u(e).addClass(t)}function He(e,t){u(e).removeClass(t)}function Pe(e,t,n){e.css([be,Te],[t+J,n+J])}function Le(e){u(e).css([Re,he,ve],[0,0,0])}function ke(e,t,n,r){return{sheet:e,sheetName:e._name,table:t,tableCol:n,filterValues:r}}
function Be(e,t,n){return{sheet:e,sheetName:e._name,col:t,filterValues:n}}function We(e){return e.concat([])}function ze(e,t,n,r,o,i,a,l){e._width(t),e._height(n),e._minimum(r),e._maximum(o),e._pageValue(i),e._smallChange(a),e._largeChange(l),e._refreshLayout()}function Ue(e){return m(e)||""===e||"number"==typeof value1&&isNaN(e)?"blank":De(e)}t=function(e){u.inherit(t,e);function t(t,n,r){var o=this,i=n.parent;e.call(o,t,f._getPreferredZIndex(i&&i._host)),o._allValues=[],o._searchedValues=[],o._allCheckedValues=[],o._inputElements=[],o._spanElements=[],o._itemOuterDivs=[],o.sheet=n,o.filterButtonInfo=r,o._containerWidth=237,o._containerHeight=318,o._itemContainerWidth=191,o._itemContainerHeight=150,o._itemDivMargin=2,o._itemDivBorder=1,o._itemDivHeight=20,o._itemHeight=o._itemDivHeight+2*o._itemDivBorder+o._itemDivMargin,o._touchContainerWidth=257,o._touchContainerHeight=355,o._defaultScrollbarSize=i?i._getScrollbarSize():18,o.rEscape=/[\-\[\]{}()+.,\\\^$|#\s]/g,o._itemValueCache=[],o._firstOpenCache=[],o.elementList=[],o.activeItemIndex=0,o._container=o._getContainer(),o._createTableLayout(),o._initFilterPanel()}var n={_open:function(){var e,t,n=this,r=n.sheet.parent,o=n.filterButtonInfo,i=n._container;for(n._useTouchLayout=!!r&&r.options.useTouchLayout,n._initData(o.col),n._initFilterItemsLayout(),i.appendTo(n._getHost()),i.hide(),n._show(function(){u("#"+S).focus()}),n._useTouchLayout&&n._updateFilterPanel(n._touchContainerWidth,n._touchContainerHeight),i.css([Ae,Ie],[o.x+o.width-i.width()-6,o.y+o.height]),n._resetDialogPosition(),n._firstOpenCache=We(n._allCheckedValues),e=n._allValues,t=0;t<h(e);t++)n._itemValueCache.push(e[t]);n._attachEvent()},_updateFilterPanel:function(e,t){var n,r,o,i,a,l,s,c,_,f,d,h,g,p,m=this,v=e-m._containerWidth,w=t-m._containerHeight;v>0&&w>0&&(Pe(m._container,e,t),n=u("."+O),r=C(n.css(ye))+w/30,o=u("."+V),i=C(o.css(be))+v/4,a=C(o.css(Te))+w/8,l=u("#"+b),s=C(l.css(ge))+v/2,c=u("#"+R),_=C(c.css(be))+v,f=C(c.css(Te))+w/8,d=u("."+j),h=C(d.css(pe))+w/10,g=u("#"+I),p=C(g.css(ge))+v,n.css(ve,r+J+" 6px"),Pe(o,i,a),l.css(ge,s+J),Pe(c,_,f),d.css(pe,h+J),g.css(ge,p+J))},close:function(){var t=this,n=t.sheet;e.prototype.close.call(t),u(t._itemSpanElement).remove(),u(t._itemInputElement).remove(),n&&n._setFocus()},_initFilterPanel:function(){var e,n,r,o,i,a,l,s,c,f,d,h,g=this,p=g.elementList,m=g.table[0].children,v=m[0],C=m[1],w=m[2],y=m[3],M=m[4],F=g._getSortLink(S,Ne().SortAscending).css(pe,"6px"),D=g._getSortLink(x,Ne().SortDescending);u(v.children[0]).append(u(_("img")).attr("src",t._getImageSrc(6))),u(C.children[0]).append(u(_("img")).attr("src",t._getImageSrc(7))),u(v.children[1]).append(F),u(C.children[1]).append(D),p.push(F[0]),p.push(D[0]),e=u(_(le)).css([he,ve],[0,0]),n=u(_(le)).appendTo(e),r=u(_(ie)).attr({type:oe,placeholder:Ne().Search,id:R}).appendTo(n),Oe(e[0],"gc-search-outer-div ui-widget-header"+W+"ui-multiselect-header ui-helper-clearfix"),p.push(r[0]),o=u(_(le)).appendTo(e),a=g._getCheckLink(A,Ne().CheckAll,"gc-check-image ui-icon ui-icon-check"),l=g._getCheckLink(I,Ne().UncheckAll,"gc-uncheck-image ui-icon ui-icon-closethick"),Oe(o[0],j),o.append(a).append(l),u(w.children[1]).append(e),i=g.itemList=u(_(le)).css([be,Te,Me],[g._itemContainerWidth,g._itemContainerHeight,Ee]),Oe(i[0],E),u(y.children[1]).append(i),s=V+" gc-filter-button-default ui-button ui-state-default"+W+"btn btn-default",c=_(se),f=_(se),d=u(c).text(Ne().OK).css(q,"1em").attr("id",b),h=u(f).text(Ne().Cancel).css(q,"1em").attr("id",T),Oe(c,s),Oe(f,s),u(M.children[1]).append(d).append(h),p.push(c),p.push(f)},_createTableLayout:function(){var e,t,n,r,o,i=this,a=i._container,l=" gc-sort-container ui-menu-item",s=i.table=u(_("table")).css([ve,Se],[0,"table"]).attr({cellspacing:0,cellpadding:0});for(Oe(s[0],"gc-layout-table"),e=0;e<5;e++)for(n=_("tr"),r=u(n).appendTo(s),Le(n),t=0;t<3;t++)o=_("td"),u(o).appendTo(r),Le(o),0===t?Oe(o,"gc-layout-table-first-column"):2===t?Oe(o,"gc-layout-table-last-column"):1===t&&(0===e?Oe(o,"gc-filter-sort-asc-container"+l):1===e&&Oe(o,"gc-filter-sort-desc-container"+l));i.table.appendTo(a),a.css(["box-shadow",ve,be,Te,Me],["rgba(0, 0, 0, 0.4) 2px 4px 5px","2px",i._containerWidth+J,i._containerHeight+J,Ee]),Oe(a[0],"gc-filter-dialog-style "+G)},_itemsWrapMouseWheel:function(e){var t,n,r,o=this,i=e.originalEvent,a=e.wheelDelta,l=e.detail,s=o._spanElements,c=h(s),_=o._searchedValues,g=h(_),p=0;m(a)&&m(l)&&(a=i.wheelDelta,l=i.detail),n=l||a/-40,r=e.wheelDeltaY,f._isMacOS()&&r&&(n=r/-40),n=(n>=0?1:-1)*Math.floor(Math.abs(n)),c&&(p=w(u(s[0]).text(),_)),t=p+n,t>g-c&&(t=g-c),t<0&&(t=0),o._updateItemsLayout(t),d(e)},_attachEvent:function(){var e=this,t=e._itemsWrap,n=!1,r=!1,o=u("."+M),i=u("."+V);t.addEventListener(ce,function(t){e._itemsWrapMouseWheel(t)},!1),t.addEventListener(ue,function(t){e._itemsWrapMouseWheel(t)},!1),u("#"+S).bind(de,function(t){n&&(n=!1,e._sortByUser(!0),e.close(),d(t))}).bind(_e,function(e){d(e),n=!0}),u("#"+x).bind(de,function(t){r&&(r=!1,e._sortByUser(!1),e.close(),d(t))}).bind(_e,function(e){d(e),r=!0}),u("."+O).bind(fe,function(){He(u("."+N)[0],k),Oe(this,B)}).bind(ee,function(){He(this,B)}),u("#"+A).bind(_e,function(e){d(e)}).bind(de,function(t){e._updateFilterItemState(t,!0)}),u("#"+I).bind(_e,function(e){d(e)}).bind(de,function(t){e._updateFilterItemState(t,!1)}),o.bind(fe,function(){He(u("."+N)[0],k),Oe(this,B)}).bind(ee,function(){He(this,B)}).bind(te,function(){u(this).find(ie)[0].click()}),o.find(ie).bind(te,function(t){t&&t.stopPropagation?t.stopPropagation():window.event.cancelBubble=!0,e._updateActiveItemIndex(u(this).parent()[0]),e._setButtonState()}),u("#"+R).bind(ne,function(e){13===(e.which||e.keyCode)&&e.preventDefault()}).bind(re,function(t){w(t.keyCode,[9,37,38,39,40])<0&&(e._searchHandler(t),e._setButtonState())}).bind(oe,function(t){e._searchHandler(t),e._setButtonState()}),i.bind(fe,function(){Oe(this,P)}).bind(ee,function(){He(this,P)}),i.bind(_e,function(){He(this,P),Oe(this,K)}).bind(ee,function(){He(this,K)}),u("#"+b).bind(te,function(){var t=e._allCheckedValues;e.sheet.suspendPaint(),e._updateData(t),e._filter(t),e.sheet.resumePaint(),e.close()}),u("#"+T).bind(te,function(){e.close()}),e._container.bind(ce,function(e){d(e)}).bind(ue,function(e){d(e)}).bind(ne+Z,function(t){e._filterKeyDown(t)}).bind(re+Z,function(e){d(e)})},_updateFilterItemState:function(e,t){var n=this,r=[],o;n._itemOuterDivs.forEach(function(e){(o=e.style)&&o.display!==xe&&r.push(e)}),u(r).find(ie).prop("checked",t),n._allCheckedValues=t?We(n._searchedValues):[],n._setButtonState(),d(e)},_filterKeyDown:function(e){var t,n,r,o,i,a,l,s,c,_,f,g,p,m,v=this,C=v.elementList,y=u("."+L),b=y[0],R=w(e.which||e.keyCode,[27,13,38,40,9]);if(0===R)v.close(),d(e);else if(1===R&&1===h(y))t=y.attr("id"),n=t===S,r=v._allCheckedValues,n||t===x?(v._sortByUser(n),v.close()):t===T?v.close():(v._updateData(r),v._filter(r),v.close());else if(R>1){if(i=v._searchedValues,h(y)){for(a=v.activeItemIndex,l=We(C),He(y,k),s=0;s<h(i);s++)l.splice(-2,0,i[s]);if(4===R){if(c=We(C),_=w(b,v._itemOuterDivs),f=e.shiftKey,i[a]&&c.splice(-2,0,i[a]),_>=0)o=f?C[2]:v._isElementDisabled(C[3])?C[4]:C[3];else{if((_=w(b,c))>=0){for(o=f?c[_-1]:c[_+1];f&&_>0&&v._isElementDisabled(o);)o=c[--_-1];for(;!f&&v._isElementDisabled(o)&&_<h(c);)o=c[++_+1]}f&&!o&&(o=c[h(c)-1])}o||(o=c[0])}else if(w(b,v._itemOuterDivs)>=0&&(b=u(b).find("span."+D).text()),g=w(b,l),p=3===R,g>=0){for(o=p?l[g+1]:l[g-1],w(o,i)>=0&&w(b,i)<0&&(g=p?g+a:a+3,o=p?l[g+1]:l[g]);p&&g<h(l)&&v._isElementDisabled(o);)o=l[++g+1];if(!p){for(;g>0&&v._isElementDisabled(o);)o=l[--g-1];o||(o=l[h(l)-1])}o||(o=l[0])}}else o=C[0];typeof o===Q?(m=v._hoverToTargetFilterItem(o,i))&&(y=m):(y=u(o),y.focus()),Oe(y,N+" "+k),d(e)}},_hoverToTargetFilterItem:function(e,t){var n=this,r=w(e,t),o=p,i=n._spanElements,a=w(u(i[0]).text(),t);return r>=0&&(n.activeItemIndex=r,r<a?(n._updateItemsLayout(r),o=u(i[0]).parent()):o=n._indexOfCurrentItemList(e,i)>=0?n._getVisibleHoverItem(e,a+1):n._getVisibleHoverItem(e,r-h(i)+1),o.find(ie).focus()),o},_indexOfCurrentItemList:function(e,t){for(var n in t)if(u(t[n]).text()===e)return n;return-1},_getVisibleHoverItem:function(e,t){for(var n,r,o,i,a,l,s=this,c=p,_=s._spanElements;!((n=s._indexOfCurrentItemList(e,_))>=0&&(c=u(_[n]).parent(),r=s._scrollbarH,o=!0,s._showHorizontalScrollbar&&r&&h(c)>0&&"none"!==c.css(Se)&&(i=c.offset().top+s._itemHeight,a=r._getScrollbar(),l=u(a).offset().top,i>l&&(o=!1)),o))&&(s._updateItemsLayout(t),!(++t>=h(s._searchedValues))););return c},_updateActiveItemIndex:function(e){var t,n,r,o=this,i=o._allCheckedValues,a=u(e).find("span."+D);a&&(t=a.text(),n=w(t,i),r=w(t,o._searchedValues),n<0?i.push(t):i.splice(n,1),r>=0&&(o.activeItemIndex=r))},_isElementDisabled:function(e){return typeof e!==Q&&(e=u(e),0!==h(e)&&!!(e.hasClass(z)||e.hasClass(U)||e.hasClass(Y)))},_filter:function(e){var t,n,r,o,i,a=this,l=a.sheet;if(l)try{if(l.suspendPaint(),t=a.filterButtonInfo,n=t.rowFilter,!n)return;r=t.col,o=n.table&&n.table(),i=o?r-o.range().col:-1,e&&(o?l._trigger(c.TableFiltering,ke(l,o,i,e)):l._trigger(c.RangeFiltering,Be(l,r,e))),n.filter(r),e&&(o?l._trigger(c.TableFiltered,ke(l,o,i,e)):l._trigger(c.RangeFiltered,Be(l,r,e)))}finally{l.resumePaint()}},_updateData:function(e){var t,n,r,o=this,i=o.filterButtonInfo,l=i.col,s=i.rowFilter,u=h(e),c=Ne().Blanks;if(s&&(s.removeFilterItems(l),u!==h(o._allValues)))for(t=0;t<u;t++)n=e[t],n===c&&(n=""),r=new a.Condition(2),r._ps.compareType=0,r._ps.expected=n,r._ps.useWildCards=!1,s.addFilterItem(l,r)},_searchHandler:function(){var e,t,n,r=this,o=u.trim(u("#"+R).val().toLowerCase()),i=u("."+E).find(ie),a=i.parent(),s=r._firstOpenCache;o?(a.hide(),i.prop("checked",!1),e=l._getWildcardCriteria(o),t=[],e||(n=RegExp(o.replace(r.rEscape,"\\$&"),"gi")),u.map(r._itemValueCache,function(r){var o=e&&l._getRegIgnoreCase(e).exec(r);(o&&0===o.index||!e&&-1!==r.search(n))&&t.push(r)}),r._searchedValues=We(t),r._allCheckedValues=We(t),r.activeItemIndex=0,r._updateItemsLayout(0)):(a.show(),h(s)?(i.prop("checked",!1),r._searchedValues=We(r._allValues),r._allCheckedValues=We(s),r._updateItemsLayout(0)):r._firstOpenCache=We(r._allCheckedValues))},_getSortLink:function(e,t){var n=u(_("a"));return n.attr({id:e,href:$}).text(t).css([Se,ve,"cursor",he,"text-decoration","text-align",q,"outline",Te],[Fe,"5px 6px","default","2px 0 1px 2px",xe,Ae,"12px",xe,"inherit"]),Oe(n[0],O+W),n},_getCheckLink:function(e,t,n){var r=_(ae),o=u(_(ae)).text(t),i=_("a"),a=u(i);return Oe(r,"gc-check-uncheck-all "+n),a.attr({href:$,id:e}).css(["float",ge,ve,q,Te],[Ae,"7px","0","12px","16px"]).append(u(r)).append(o),Oe(i,X+X+"-style"),a},_initData:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g=this,p=g.filterButtonInfo.rowFilter;if(p){if(t=g.sheet,n=[],r=[],o=Ne().Blanks,i=!1,l={},s=t._getActualRange(p.range),u=s.col,e>=u&&e<u+s.colCount)for(a=0;a<s.rowCount;a++)c=s.row+a,_=t.getText(c,e),f=t.getValue(c,e),d=t.getRowHeight(c)>0,_=_?_.trim():_,""===_?i||(i=!0,n.push({text:o,value:f}),d&&r.push(o)):l[_]||t.getRowVisible(c,3,!0)&&t._getActualRowHeight(c)&&(d&&r.push(_),(d||!p.isFiltered()||p._isRowNotFilteredOutByOtherColumn(c,e))&&(n.push({text:_,value:f}),l[_]=!0));g._allCheckedValues=r,h={date:0,number:1,string:2,boolean:3,blank:4},n.sort(function(e,t){var n=e.value,r=t.value,o=Ue(n),i=Ue(r);return o!==i?h[o]<h[i]?-1:1:n>r?1:n<r?-1:0}),n=n.map(function(e){return e.text}),g._allValues=n,g._searchedValues=We(n),p.isFiltered(e)||(g._allCheckedValues=We(n))}},_initFilterItemsLayout:function(){var e,t,n,r,o,i,a,l,s,c,f,d,p,m,C,w,y,S,x,b=this,T=0,R=b._itemContainerWidth,A=b._itemContainerHeight,I=b._itemDivMargin,E=b._itemDivBorder,N=b._touchContainerWidth-b._containerWidth,V=b._touchContainerHeight-b._containerHeight,O=b.itemList;for(b._useTouchLayout&&(T=V/4,R+=N,A+=V/2,b._itemContainerHeight=A,b._itemContainerWidth=R,Pe(O,R,A),b._itemHeight+=T),b.defaultItemWidth=R-2*I-2*E,e=b._allValues,t=b._itemHeight,n=Math.round(A/t),r=0,o=0,i=_(le),b._itemsWrap=i,Oe(i,"gc-filter-item-wrapper"),a=0;a<h(e);a++)r+=t,a>=n||(l=e[a],s=_(le),c=_(ie),f=_(ae),d=u(s),o=v(b._getItemWidthByText(l),o),Oe(s,M+W+G),d.css([Se,ve,Re+"-"+be,he,Te,Me],[Fe,T/2,E+J,I+J,b._itemDivHeight+J,Ee]).attr("unselectable","on").appendTo(u(i)),Oe(c,F),u(c).attr({style:"margin: 3px; padding: 0",type:"checkbox",value:l}).appendTo(d),Oe(f,D),u(f).html(g(l)).appendTo(d),b._itemOuterDivs.push(s),b._inputElements.push(c),b._spanElements.push(f));b._maxItemWidth=o,b._totalItemsHeight=r,O.empty(),p=_("table"),m=_("tr"),C=_("tr"),w=_("td"),y=_("td"),S=_("td"),x=_("td"),b._hScrollbarTd=x,b._vScrollbarTd=S,Le(m),Le(C),Le(w),Le(S),Le(x),Le(y),m.appendChild(w),m.appendChild(S),C.appendChild(x),C.appendChild(y),p.appendChild(m),p.appendChild(C),w.appendChild(i),Le(p),u(p).css([be,Te],[R,A]).attr({cellspacing:0,cellpadding:0,border:0}),b._refreshScrollbar(),O.append(p),b._setItemWidth(),b._setCheckedValues()},_updateItemsLayout:function(e){var t,n,r,o,i=this,a=i._searchedValues,l=i._spanElements,s=i._scrollbarV,c=0,_=e;for(t=0;t<h(l);t++)n=l[t],r=i._inputElements[t],o=a[e++],n&&o?(u(r).attr("value",o),u(n).html(g(o)).parent().show(),c=v(i._getItemWidthByText(o),c)):(u(r).attr("value",""),u(n).html("").parent().hide());i._maxItemWidth=c,i._totalItemsHeight=h(a)*i._itemHeight,i._refreshScrollbar(),s&&s.value(_),i._setItemWidth(),i._setCheckedValues()},_refreshScrollbar:function(){var e,t=this,n=t._maxItemWidth,r=t._itemContainerWidth,o=t._itemContainerHeight,i=t._itemHeight,a=t._defaultScrollbarSize,l=r-a,s=o-a,c=t._isNeedScrollbars(n,t._totalItemsHeight,r,o),_=c._isNeedVScroll,f=c._isNeedHScroll,d=u(t._vScrollbarTd),g=u(t._hScrollbarTd);_?(f||(s+=a),t._scrollbarV||t._createFilterScrollbar(!1),e=Math.floor(s/i),ze(t._scrollbarV,a,s,0,h(t._searchedValues)-e,e,1,e-1),d.show(),t._showVerticalScrollbar=!0):(d.hide(),t._showVerticalScrollbar=!1),f?(_||(l+=a),t._scrollbarH||t._createFilterScrollbar(!0),ze(t._scrollbarH,l,a,0,n-l,l,i,l),g.show(),t._showHorizontalScrollbar=!0):(g.hide(),t._showHorizontalScrollbar=!1),f||_||(s=o,l=r),u(t._itemsWrap).css([be,Te,"overflow"],[l,s,"hidden"])},_createFilterScrollbar:function(e){var t=this,n=new r._Scrollbar(e),o=n._getScrollbar();e?(t._scrollbarH=n,t._hScrollbarTd.appendChild(o)):(t._scrollbarV=n,t._vScrollbarTd.appendChild(o)),u(o).bind("scroll.gcScrollbar",function(n,r){var o=r.scrollOrientation,i=r.newValue;w(r.scrollEventType,[0,1,2,3,5])>=0&&(e?0===o&&u("."+M).css(Ae,0-i):1===o&&t._updateItemsLayout(i))})},_isNeedScrollbars:function(e,t,n,r){var o=this._defaultScrollbarSize,i={_isNeedHScroll:!1,_isNeedVScroll:!1};return e>n&&(i._isNeedHScroll=!0,i._isNeedVScroll=!!(t>r-o)),t>r&&(i._isNeedVScroll=!0,i._isNeedHScroll=!!(e>n-o)),i},_getItemWidthByText:function(e){var t,n,r,o,i,a,l,s,c,f,d=this;return d._itemSpanElement||(t=_(ie),n=_(ae),r=document.body,o=u(t).attr("type","checkbox").addClass(F),i=u(n),Oe(t,F),Oe(n,D),d._itemInputElement=t,d._itemSpanElement=n,r.insertBefore(t,p),r.insertBefore(n,p),a=C(o.css(ge))+C(o.css(me)),l=C(o.css(Ce))+C(o.css(we)),s=C(i.css(ge))+C(i.css(me)),c=C(i.css(Ce))+C(i.css(we)),y(a)&&(a=0),y(l)&&(l=0),y(s)&&(s=0),y(c)&&(c=0),d._itemInputWidth=o.width()+a+l,d._itemSpanPartWidth=s+c,o.css(Se,xe),i.css(Se,xe)),(f=u(d._itemSpanElement).html(g(e)).width())+d._itemInputWidth+d._itemSpanPartWidth+1+2*d._itemDivMargin+2*d._itemDivBorder},_setItemWidth:function(){var e=this,t=e.defaultItemWidth,n;n=e._showHorizontalScrollbar?e._maxItemWidth:e._showVerticalScrollbar?t-e._defaultScrollbarSize:t,u(e._itemOuterDivs).css(be,n)},_setCheckedValues:function(){var e=this,t={};u.each(e._allCheckedValues,function(e,n){t[n]=n}),e._inputElements.forEach(function(e){u(e).prop("checked",!m(t[u(e).val()]))})},_sortByUser:function(e){var t,n,r=this,o=r.filterButtonInfo,i=o.rowFilter,a=r.sheet;i&&a&&a._canDoSort()&&(t=o.col,n={sheet:a,sheetName:a._name,col:t,ascending:e,cancel:!1},a._trigger(c.RangeSorting,n),!1===n.cancel&&(a.suspendPaint(),i.sortColumn(t,e),a.resumePaint(),a._trigger(c.RangeSorted,n)))},_setButtonState:function(){var e=u("#"+b),t=z+U+" "+Y;h(this._allCheckedValues)>0?(e.prop("disabled",!1),He(e[0],t)):(e.prop("disabled",!0),Oe(e[0],t))}};return u.extend(t.prototype,n),t._getImageSrc=function(e){
return 0===e?"data:image/png;base64,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":1===e?"data:image/png;base64,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":2===e?"data:image/png;base64,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":3===e?"data:image/png;base64,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":4===e?"data:image/png;base64,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":5===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAABy0lEQVR42pyST2gTQRTGv9nEpCnqTasHES8VLCioiFDIYYum+I/ebFXQm1BbsdSDhKgoXhS8tLQSqAhexIInETwJIqJiexJEZXupwRJNbRsy2Z3dzHxesjGEChs/eMx7A+837817giQAYCD3cZuScqG8Wtj19tG5n/iHhBAkKcLYCh3fdSd04HXCq5xHG2oAdOAdNIG3qAJ5tW1A/9hrm8ZsV+7vDLTe2nsmP9AWwATuXe27330lLwvLkloHY5EBR0dexkB0xxKp9Ieno8MbOjYP1ZRMHz77YE8kAMk35V/fkpWSc6L3dL7Tl6uPAaAm155EAYhwjFHVOsY4AEwPXXkG7W+0EqmCodlRW17oCkrO5Pjc55lon7i2mBqenc7ETTmLFWdvaenLpijJDUBcywsAYFRwu/jja1dMWNfWKf2WEOJ43T8ihLgHACAJkpgZvNQ3kTnJG/u6Z8O7ZgNwAACbzCb5dxNVLPnQW3aKyY7EKABM2XZPcwUk5wG8qIfvSL5qtJAfHLnvF+Z2GsPr2fefipPH0luq5aXsOi3frJ+5xhSm+k/1VErOxRWlqgkrfujO/t191ZqxLeB5azbJeSFELnz9v/agVX8GAIjG5r9I9yjkAAAAAElFTkSuQmCC":7===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAACXBIWXMAAAsSAAALEgHS3X78AAAAGXRFWHRTb2Z0d2FyZQBQYWludC5ORVQgVjMuNS41Tib51gAAAXlJREFUOE9jYACCqRH5a6eGZu6cHl00d2pUwa6J7r4Xe4w1U0ByWMB/DLHJnoHbQIKzI1PEp3r6vKjVU72HQzNIGNOA6W5uYiCZmUHxM+v0Vf836KuHkWQASPGciGznSe6+/+v01Vbh0YzdBeBwiC560GWi+aLVXEccxJ/i6KhNdBjMCM/u7be3+99hpJEK0jTJ01a0y1hjKVEGTHH31e4w1vxSrqP0tVZPbXazodqKSl2VV9W6KnOJMoCAf4mLRpAq/+pTEh4F+79aJSwGxwjJseBZdHCVa/b2/1YR00vJMsAtd+c957T1D42De17iMKARKO4NTUiuQLoLrs694IAT0PbvNrFzNYwDOv9bRc4IwGKIMVQzKCWCsBNcDVDzaafUdbfMwiZNMwnq/mIeNvkgDldsgWo+hqyZ2TVr+0egIRIgQcuomb7G/h3/zaOmaeFxBcJ2l6xtx8xDJ/6wDJ+cYhU2g8vYv/M9yABj//aLOFxRTUbU49YCALt6h216b0oVAAAAAElFTkSuQmCC":8===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAKBJREFUOE+l0cENwjAMBdCM0BEYhZG6AjdvwQhMUvXQI0KcKo6IY2/9v0qQnVilFoenJF+2q6RJRP7ihhFuGOGGO851Zg4/9PCGi8oOD+iAzQM8c7bRRTX9pStMmbnGd1Nhwz2vbOD+ATcwteagjPBSZuAVTmBqzUHhnTnkA2wkPmJT2wRKGbLk1avZHUAcwldv/n/hhhFuGOGGEW54nKQVV2qyDejeW7YAAAAASUVORK5CYII=":9===e?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAHpJREFUOE+lz8ENgDAMA8COxEiMkxWYgkmYhCGgllpkUz8aeJyQrVQJJSJ+sWWGLTNsmWHLaq22amkZX2T0MiuB7ASPOMusBIKNh9Evekh4weaTDOfDUDTYdBnTF/AjbOYssxJIf9Q39ouG35DwhS0zbJlhywxbzotyAztMtZGgPPrJAAAAAElFTkSuQmCC":""},t}(i),s._FilterDialog=t,e.exports=s}()},function(e,t){e.exports=GC.Spread.Sheets},function(e,t){e.exports=GC.Spread.Common},function(e,t){e.exports=GC.Spread.Sheets.ConditionalFormatting},function(e,t,n){!function(){"use strict";var t,r,o,i,a=n(2),l=n(3),s=n(4),u=n(1),c=null,_=void 0,f=s._createCondition,d=a._createRange,h=l._Types._isNullOrUndefined,g=parseInt,p=l._ArrayHelper,m=p._indexOf,v=p._contains,C=p._remove,w=p._getLength,y="mousedown.filter",S="HideRowFilter",x=a.GC$,b=x.each,T=u._FilterButtonInfo,R=function(){return l._getResource(u.SR)()};function A(e,t,n,r){var o,i;for(i=0;i<w(e);i++)if((o=e[i])&&o.row===t&&o.col===n&&o.sheetArea===r)return o;return c}t={rowFilter:function(e){var t=this,n=t._rowFilter,r=t.filterRowsVisibleInfo;return w(arguments)?(n&&n.reset(),n=t._rowFilter=e,n?t._rowFilter._sheet=t:r&&r._reset(),t._invalidate(),t):n},_createFilterButtonModel:function(){var e,t,n,r,o,i,a,l,s,u,c=this,_=[],f=c.rowFilter(),h=f&&f.range,g=c.tables;if(h&&(r=h.row,o=h.col,a=o<0?E(c):o+h.colCount,t=o<0?0:o,r<1?(e=F(c,1)-1,i=1):(e=r-1,i=3),e>=0))for(;t<a;)f.filterButtonVisible(t)?(l=c.getSpans(d(e,t,1,1),i),n=new T(f),n.sheetArea=i,n.row=e,w(l)?(s=l[0],n.row=s.row,
n.col=s.col,t+=s.colCount):(n.col=t,t++),_.push(n)):t++;return g&&(u=g.all(),b(u,function(r,o){if(e=o.headerIndex(),o&&o.showHeader()&&e>=0){var i=o.range(),a;for(a=0;a<i.colCount;a++)t=i.col+a,o.filterButtonVisible(a)&&(n=new T(o.rowFilter(),e,t,3),_.push(n))}})),_},_getFilterButtonModel:function(){var e=this,t=e._filterButtonsModel;return!t&&u&&(t=e._filterButtonsModel=e._createFilterButtonModel()),t},_isRowFilterOut:function(e,t){var n=this.filterRowsVisibleInfo;return h(t)&&(t=3),!(3!==t&&2!==t||!n||n._rowVisible(e))},_hasRowFilterOut:function(){return this.filterRowsVisibleInfo._hasFilterOut()},_getFilterButtonRect:function(e,t){var n=this,r=n._zoomFactor,o=n.parent,i=r>1?1:r,a=3===t||t===_?n.defaults.rowHeight:n.defaults.colHeaderRowHeight,l=g(""+Math.min(20,a)*i);return o&&o.options.useTouchLayout&&(l=g(""+a*r)),{x:e.x+e.width-l,y:e.y+e.height-l,width:l,height:l}}},x.extend(a.Worksheet.prototype,t),u.FilterActionType={filter:0,unfilter:1};function I(e,t){var n=D(e),r=e.compareType();2===n||7===n?-1===m(t,"T")&&t.push("T"):3===n?0===r&&-1===m(t,"BC")?t.push("BC"):1===r&&-1===m(t,"FC")&&t.push("FC"):-1===m(t,"V")&&t.push("V")}function M(e){var t,n,r,o,i=[];for(t=0;t<w(e);t++)n=e[t],0===D(n)?(r=n.item1(),o=n.item2(),r&&I(r,i),o&&I(o,i)):I(n,i);return i}function E(e){return e.getColumnCount()}function F(e,t){return e.getRowCount(t)}function D(e){return e.conType()}r=function(){function e(e){var t=this;t.range=e,t.reset(),t.typeName="",t.filterHandler=c}return e.prototype={filterButtonVisible:function(e,t){var n=this,r=n._sheet,o=n.range,i=n._getStartCol(o),a=n._getEndCol(o,r),l=arguments,s=n._filterButtonVisibleInfo,u=e>=i&&e<a,c=w(l),f=l[0],d=typeof f,h;if(0===c){for(h=i;h<a;h++)if(s[h]||s[h]===_)return!0;return!1}if(1===c){if("number"===d)return u&&s[e]===_&&(s[e]=!0),s[e];if("boolean"===d)for(h=i;h<a;h++)s[h]=f}else 2===c&&u&&(s[e]=t);return r&&r._invalidate(),n},_getStartCol:function(e){return e.row<0?0:e.col},_getEndCol:function(e,t){return e.row<0?E(t):e.col+e.colCount},addFilterItem:function(e,t){var n=this,r=n._sheet,o=n.range,i=n._filterItemMap,a=i[e];if(h(t))throw Error(R().Exp_FilterItemIsNull);if(e<-1||e>=E(r))throw Error(R().Exp_InvalidColumnIndex);if(o){if(o=r._getActualRange(o),e<o.col||e>=o.col+o.colCount)return;a||(a=[]),a.push(t),i[e]=a}},removeFilterItems:function(e){this._removeFilterItemsInternal(e),this.unfilter(e)},_removeFilterItemsInternal:function(e){var t=this,n=t._filterItemMap;t._removeFilteredItems(e),n[e]&&n.splice(e,1,c)},colConditionRelation:function(e,t){var n=this.colConditionRelations;return n||(n={},this.colConditionRelations=n),void 0!==t&&(-1===e?this.colsConditionRelation=t:n[e]=t),this.colsConditionRelation||"and"},unfilter:function(e){var t,n,r,o=this,i=o._sheet;if(i){if(t=[],n=o._filteredColumns,h(e))for(r=w(n)-1;r>=0;r--)t.push(n[r]),o._unfilterColumn(n[r]);else t.push(e),o._unfilterColumn(e),o.reFilter();o._updateLayoutByFilter(i,1,t)}},_filterColumn:function(e){var t,n,r,o,i,a,l,s=this,u=s.range;if(s._unfilterColumn(e),t=s.colConditionRelation(-1),s._filterItemMap[e]&&u){if(-1!==(n=u.col)&&(e<n||e>=n+u.colCount))return;for(u=s._sheet._getActualRange(u),r=u.row,o=u.rowCount,i=s._getRowDataCache(e,r,o),l=s._filterRowsWithTextEquals(r,o,e,i),a=r;a<r+o;a++)!l.length||"or"!==t&&s.isRowFilteredOut(a)||s._filterRowByCell(l,a,e,i);s._setColumnFilteredState(e,!0)}},_getRowDataCache:function(e,t,n){var r,o,i,a,l,s,u=this,c=u._sheet,_=M(u._filterItemMap[e]),f={},d=w(_);for(r=t;r<t+n;r++){for(l={},o=0;o<d;o++)i=_[o],"T"===i?(s=c.getText(r,e),l[i]=s?s.trim():s):"BC"===i?(a=c.getActualStyle(r,e))&&(l[i]=a.backColor):"FC"===i?(a=c.getActualStyle(r,e))&&(l[i]=a.foreColor):"V"===i&&(l[i]=c.getValue(r,e));f[r]=l}return f},filter:function(e){var t,n,r=this,o=r._sheet,i=r._filterItemMap;if(o){if(n=[],h(e))for(t=0;t<w(i);t++)i[t]&&(n.push(t),r._filterColumn(t));else{if(!i[e])return;n.push(e),r._filterColumn(e)}r._updateLayoutByFilter(o,0,n)}},_updateLayoutByFilter:function(e,t,n){var r,o=this;e._refreshObjectsAboveSheet&&e._refreshObjectsAboveSheet(),r=o._getFilterArgs(t,n),o.filterHandler&&o.filterHandler(r),o.onFilter(r),e._invalidate()},_getFilterArgs:function(e,t){var n,r,o,i=this,a=i._sheet,l=i.range,s=[],u=[];if(l)for(n=a._getActualRange(l),r=n.row,o=r;o<r+n.rowCount;o++)i.isRowFilteredOut(o)?u.push(o):s.push(o);return{action:e,sheet:a,range:l,filteredRows:s,filteredOutRows:u,columns:t}},onFilter:function(){},isFiltered:function(e){var t=this._filteredColumns;return arguments.length?v(t,e):t.length>0},isRowFilteredOut:function(e){var t,n,r,o=this,i=o.range,a=this.colConditionRelation(-1);return!(!o.isFiltered()||!i)&&(t=i.row,n=o._filteredInRowsWithColIndexs[e],(-1===t||!(e<t||e>=t+i.rowCount))&&(r=n&&n.length||0,"or"!==a&&r<o._filteredColumns.length||"or"===a&&0===r))},reset:function(){var e=this;e.unfilter(),e._filterItemMap=[],e._filteredColumns=[],e._filteredItems=[],e._filteredInRowsWithColIndexs={},e._filterButtonVisibleInfo={},e._sortInfo=c},_isFilterHeader:function(e,t,n){var r,o,i,a=this,l=!1,s=a._sheet,u=a.range;return u&&(u=s._getActualRange(u,n),r=u.row,o=u.col,i=t>=o&&t<o+u.colCount,1===n&&e===F(s,n)-1&&r-1<0&&i?l=!0:3===n&&e===r-1&&i&&(l=!0)),l},getFilterItems:function(e){return this._filterItemMap[e]||[]},getFilteredItems:function(){return this._filteredItems},sortColumn:function(e,t){var n,r,o,i=this,a=i._sheet;a&&(n=a._getActualRange(i.range),a.suspendPaint(),r={index:e,ascending:t},o=a.sortRange(n.row,n.col,n.rowCount,n.colCount,!0,[r]),o&&(i._sortInfo=r,i.isFiltered(e)&&i.reFilter()),a.resumePaint())},getSortState:function(e){var t=this._sortInfo,n=0;return t&&t.index===e&&(n=t.ascending?1:2),n},reFilter:function(){var e,t=this,n=t._filteredColumns,r=w(n);for(t._filteredInRowsWithColIndexs={},t._filteredItems=[],t._filteredColumns=[],e=0;e<r;e++)t.filter(n[e])},openFilterDialog:function(){},_addFilteredInRowsWithColumnIndex:function(e,t){var n=this._filteredInRowsWithColIndexs,r=n[e];h(r)?r=[t]:(v(r,t)&&C(r,t),r.push(t)),n[e]=r},_addFilteredItem:function(e){var t=this._filteredItems;v(t,e)||t.push(e)},_unfilterColumn:function(e){var t=this,n=t._filteredInRowsWithColIndexs,r,o;if(t.range&&t.isFiltered(e)){t._setColumnFilteredState(e,!1);for(r in n)r&&(o=n[r])&&v(o,e)&&(C(o,e),w(o)||(n[r]=_));t._removeFilteredItems(e)}},_setColumnFilteredState:function(e,t){var n=this._filteredColumns;if(t){if(w(n)){if(n[w(n)-1]===e)return;C(n,e)}n.push(e)}else C(n,e)},_removeFilteredItems:function(e){var t,n,r=this,o=r._filterItemMap,i=o.length,a=[],l=[];for(t=0;t<i;t++)t===e?a=a.concat(o[t]):l=l.concat(o[t]);for(n=a.length,t=0;t<n;t++)v(l,a[t])||C(r._filteredItems,a[t])},_filterRowsWithTextEquals:function(e,t,n,r){var o,i,a,l=this,s=l._filterItemMap[n],u={},c=[];for(o=0;o<w(s);o++)i=s[o],2!==D(i)||0!==i.compareType()||i.forceValue2Text()||i.useWildCards()||i.ignoreCase()||i.ignoreBlank()?c.push(i):u[i.expected()]=i;for(o=e;o<e+t;o++)a=l.isRowFilteredOut(o),u[r[o].T]&&(l._addFilteredInRowsWithColumnIndex(o,n),a||l._addFilteredItem(i));return c},_filterRowByCell:function(e,t,n,r){var o,i,a,l,s,u,c,_=this,f=_.range,d=_.colConditionRelation(n),h="and"===d;for(o=0;o<w(e);o++){if(i=e[o],a=i.item1(),l=i.item2(),0===D(i)?(a&&(s=_._applyNewItemRange(a,t,n,f,r)),l&&(u=_._applyNewItemRange(l,t,n,f,r))):s=_._applyNewItemRange(i,t,n,f,r),c=i.evaluate(_._sheet,t,n,s,u),"and"!==d&&c){h=!0;break}if(!c&&"and"===d){h=!1;break}}h&&(_._addFilteredInRowsWithColumnIndex(t,n),_._addFilteredItem(i))},_applyNewItemRange:function(e,t,n,r,o){var i,a,l,s=this,u=c,_=D(e),f=e.compareType(),h=o[t];return 8!==_&&10!==_||(i=[],a=s._sheet._getActualRange(r),l=a.col,l<=n&&n<l+a.colCount&&i.push(d(a.row,n,a.rowCount,1)),e.ranges(i)),2===_||7===_?u=h.T:3===_?0===f?u=h.BC:1===f&&(u=h.FC):u=h.V,u},_isRowfilteredOutByColumn:function(e,t){var n,r,o,i,a=this,l=a._filteredColumns;return!!w(l)&&(n=-1,r=m(l,t),o=a._filteredInRowsWithColIndexs[e],i=w(o),r>0&&(n=l[r-1]),n>-1?!!i&&n===o[i-1]:!i)},_isRowNotFilteredOutByOtherColumn:function(e,t){var n,r,o,i=this,a=i._filteredColumns;return!w(a)||(n=m(a,t),r=i._filteredInRowsWithColIndexs[e],o=w(r)||0,o>=w(a)||!(n<0||o<w(a)-1)&&(!r||m(r,t)<0))},_onRowsAdded:function(e,t){var n,r,o,i,a,l,s,u,c,f=this,h=f.range;if(h){if(n=F(f._sheet)-t-1,r=h.row,o=h.col,i=h.rowCount,a=h.colCount,r>-1&&(n=r+i-1,e<=r?f._setRangeInternal(d(r+t,o,i,a)):e<r+i&&f._setRangeInternal(d(r,o,i+t,a))),l=f._filteredInRowsWithColIndexs,f.isFiltered()&&l){for(s=[],u=0;u<w(l);u++)s.push(u);for(s.sort(),u=0;u<w(s);u++)(c=s[u])>=e&&c<=n&&(l[c+t]=l[c],l[c]=_)}f.reFilter()}},_onColumnsAdded:function(e,t){var n,r,o,i,a,l,s,u,c,_,f,h=this,g=h.range;if(g){if(n=g.row,r=g.col,o=g.rowCount,i=g.colCount,a=0,l=-1,s=0,e>=0&&h._isSorted()){for(u=0;u<t;u++)u+e<=h._sortedColumn()&&a++;h._sortedColumn(h._sortedColumn()+a)}for(r>-1&&(e<=r?(l=r,s=i,h._setRangeInternal(d(n,r+t,o,i))):e<r+i&&(l=e,s=i-(e-r),h._setRangeInternal(d(n,r,o,i+t)))),l<0&&(l=0,s=E(h._sheet)-t),u=l+s-1;u>=l;u--)u>=e&&(c=u+t,_=m(h._filteredColumns,u),_>=0&&(h._filteredColumns[_]=c),f=h._filterItemMap[u],w(f)&&(C(h._filterItemMap,u),h._filterItemMap[c]=f));h.reFilter()}},_onRowsRemoved:function(e,t){var n,r,o,i,a,l,s,u,f,h,g=this,p=g.range;if(p){if(n=0,r=F(g._sheet)+t-1,o=p.row,i=p.col,a=p.rowCount,l=p.colCount,o>-1&&(n=o,r=o+a-1,e<=o?o===e+1||o+a<=e+t?g._setRangeInternal(c):o<e+t?g._setRangeInternal(d(e,i,o+a-(e+t),l)):g._setRangeInternal(d(o-t,i,a,l)):e<o+a&&g._setRangeInternal(d(o,i,a-Math.min(o+a-e,t),l))),s=g._filteredInRowsWithColIndexs,g.isFiltered()&&s)for(u=n;u<=r;u++)u>=e&&u<e+t?s[u]=_:u>=e+t&&(f=u,h=s[f],h&&(s[f-t]=h,s[f]=_));g.reFilter()}},_setRangeInternal:function(e){this.range=e},_updateRange:function(e){var t,n,r,o,i,a,l,s,u,f,d,h,g=this,p=g._sheet,m=g.range;if(m)if(e){if(!e.equals(m)){if(r=m.col,o=m.colCount,i=e.col,a=e.colCount,l=E(p),g.isFiltered()&&!(r<0&&i<0))for(r<0&&(r=0,o=l),i<0&&(i=0,a=l),t=0;t<o;t++)n=r+t,(i>n||n>=i+a)&&g.removeFilterItems(n);if(s=m.row,u=m.rowCount,f=e.row,d=e.rowCount,h=F(p),g.isFiltered()&&g._filteredInRowsWithColIndexs&&!(s<0&&f<0))for(s<0&&(s=0,u=h),f<0&&(f=0,d=h),t=0;t<u;t++)n=s+t,(f>n||n>=f+d)&&(g._filteredInRowsWithColIndexs[n]=_)}}else g.reset();!g._isSorted()||e&&e.contains(-1,g._sortedColumn())||(g._sortInfo=c),g._setRangeInternal(e)},_onColumnsRemoved:function(e,t){var n,r,o,i,a,l,s,u,_=this,f=_.range,h=_._sortedColumn(),g=e+t;if(f){for(e>=0&&_._isSorted()&&(h>=e&&h<g?_._sortedColumn(-1):h>=g&&_._sortedColumn(h-t)),n=f.row,r=f.col,o=f.rowCount,r<0?(r=0,i=E(_._sheet)+t):i=f.colCount,a=r;a<r+i;a++)a>=e&&(a<g?_.removeFilterItems(a):(l=a-t,s=m(_._filteredColumns,a),u=_._filterItemMap[a],s>=0&&(_._filteredColumns[s]=l),w(u)&&(C(_._filterItemMap,a),_._filterItemMap[l]=u)));r>=0&&(e<r?g<=r?_._setRangeInternal(d(n,r-t,o,i)):g<=r+i?_._setRangeInternal(d(n,e,o,r+i-g)):_._setRangeInternal(c):e<r+i&&(g<=r+i?_._setRangeInternal(d(n,r,o,i-t)):_._setRangeInternal(d(n,r,o,e-r)))),_.reFilter()}},_isSorted:function(){var e=this,t=e._sortInfo;return!!t&&(t.index>-1&&0!==e.getSortState(t.index))},_sortedColumn:function(e){var t=this,n=t._sortInfo,r;return w(arguments)?(n?n.index=e:t._sortInfo={index:e,ascending:!1},r=t):r=n?n.index:-1,r},_clear:function(e,t,n,r){var o,i,a,l=this,s=l.range;s&&(o=d(e,t,n,r),l.filterButtonVisible()?(i=s.row-1,a=s.rowCount+1,i<0&&(i=-1,a=-1),o.containsRange(d(i,s.col,a,s.colCount))&&l.unfilter()):o.containsRange(s)&&l.unfilter())},fromJSON:function(e,t){var n,r,o,i,a,l,u,c,g,p,m,v,C,y,S,x,b;if(e){if(n=this,r=e.range,o=e.filterItemMap,i=n._filterItemMap,a=e.sortInfo,l=e.showFilterButton,u=e.filterButtonVisibleInfo,r&&(n.range=d(r.row,r.col,r.rowCount,r.colCount)),s)for(c=0;c<w(o);c++)for(m=o[c],v=m.conditions,g=0;g<w(v);g++)(C=v[g])&&(y=f(),S=m.index,x=i[S],y.fromJSON(C,t),x||(x=i[S]=[]),x.push(y));for(p=e.filteredColumns||e.filteredColMap,c=0;c<w(p);c++)h(p[c])||n._filteredColumns.push(p[c]);if(a&&(n._sortInfo={index:a.index,ascending:a.ascending}),l!==_)if(b=n.range,u)n._filterButtonVisibleInfo=u;else if(b)for(c=n._getStartCol(b);c<n._getEndCol(b,n._sheet);c++)n._filterButtonVisibleInfo[c]=l}},toJSON:function(){var e,t,n,r,o,i,a,l=this,s={},u=l.range,_=l._filterButtonVisibleInfo,f=l._filterItemMap,d=l._filteredColumns,h=l._sortInfo,g=[],p=0,m=l.typeName;for(u&&(s.range=u),m&&(s.typeName=m),e=0;e<w(f);e++)if(t=f[e]){for(n=[],r=0;r<w(t);r++)n.push(t[r]?t[r].toJSON():c);g[p++]={index:e,conditions:n}}if(w(g)&&(s.filterItemMap=g),w(d)&&(s.filteredColumns=d),h&&(s.sortInfo=h),_){s.filterButtonVisibleInfo=_,o=!1;for(e in _)if(_[e]){o=!0;break}s.showFilterButton=o}for(i=[],a=0;a<l._sheet.getRowCount();a++)l.isRowFilteredOut(a)&&i.push(a);return i.length>0&&(s.filteredOutRows=i),s},_canDoFilter:function(e){var t=e.options;return!t.isProtected||t.protectionOptions.allowFilter},hitTest:function(e,t,n){var r,o,i,a,l,s,u,_,f,d,h,g,p,m,v,C,w=this._sheet;if(w){if(r=e.rowViewportIndex,o=e.colViewportIndex,i=e.hitTestType,a=w._getViewportColumnLayout(o),1===i?(l=w._getColumnHeaderRowLayout().findY(n),s=a.findX(t),u=1):3===i&&(l=w._getViewportRowLayout(r).findY(n),s=a.findX(t),u=3),!l||!s)return c;if(_=l.row,f=s.col,d=w.getSpan(_,f,u),h=w._getFilterButtonModel(),d){if(g=d.row,p=d.col,_!==g+d.rowCount-1||f!==p+d.colCount-1)return c;_=g,f=p}return h&&(m=A(h,_,f,u))&&(v=w.getCellRect(_,f,r,o),C=w._getFilterButtonRect(v,u),C.x<=t&&t<=C.x+C.width&&C.y<=n&&n<=C.y+C.height)?new T(m.rowFilter,m.row,m.col,m.sheetArea,C.x,C.y,C.width,C.height):c}}},e}(),u.RowFilterBase=r,o=function(e){x.inherit(t,e);function t(t){e.call(this,t),this.typeName=S}var n={onFilter:function(e){var t=this,n=t._sheet;n&&(t._updateRowVisibleInfo(n,e.filteredRows,e.filteredOutRows),n._invalidateVScrollbar())},_updateRowVisibleInfo:function(e,t,n){var r,o=e.filterRowsVisibleInfo;o&&(r=o._updateVisible(t,n),a._supportsCalc&&e.recalcRows(r))},openFilterDialog:function(e){var t,n=this,r=n._sheet;n._canDoFilter(r)&&(t=new u._FilterDialog(r.parent._getContainerDiv(),r,e),r._filterDialog=t,t._open())}};return x.extend(t.prototype,n),t}(r),u.HideRowFilter=o;function N(){this._reset()}N.prototype={_rowVisible:function(e){var t=this.rowsVisibleInfo[e];return!!h(t)||t},_updateVisible:function(e,t){var n,r,o,i,a,l,s,u,f=[],d=this.rowsVisibleInfo;for(n=0,r=e.length;n<r;n++)o=e[n],i=d[o],i!==_&&i!==c&&f.push(o),delete d[o];for(a=0,l=t.length;a<l;a++)s=t[a],u=d[s],u!==_&&u!==c||f.push(s),d[s]=!1;return f},_reset:function(){this.rowsVisibleInfo={}},_hasFilterOut:function(){return Object.keys(this.rowsVisibleInfo).length>0}},i={init:function(){var e=this;e._rowFilter=c,e.filterRowsVisibleInfo=new N,e._rowStateProviders.push({_isVisible:function(t){return e.filterRowsVisibleInfo._rowVisible(t)}})},setHost:function(e){if(e){var t=this;e.bind(y,function(e){var n=t._getCanvasOffset(),r=e.pageX-n.left,o=e.pageY-n.top,i=t.hitTest(r,o),a=i.filterButtonHitInfo;a&&a.rowFilter.openFilterDialog(a)})}},onLayoutChanged:function(e){var t=this,n=e.changeType,r=e.row,o=e.rowCount,i=e.col,a=e.colCount,l=t._rowFilter;if("invalidateLayout"===n)return void(t._filterButtonsModel=c);l&&("addRows"===n?l._onRowsAdded(r,o):"deleteRows"===n?l._onRowsRemoved(r,o):"addColumns"===n?l._onColumnsAdded(i,a):"deleteColumns"===n?l._onColumnsRemoved(i,a):"clear"===n&&l.range&&l._clear(r,i,o,a))},dispose:function(){var e=this,t=e._filterDialiog;x(e._getCanvas()).unbind(y),t&&t.close()},toJson:function(e,t){var n=this._rowFilter,r=t&&t.ignoreStyle;n&&!r&&(e.rowFilter=n.toJSON())},fromJson:function(e,t,n){var r,i,l,s=e.rowFilter,c=this,_=n&&n.ignoreStyle;s&&u&&!_&&(r=s.typeName,r&&r!==S?(i=a.getTypeFromString(r))&&(l=new i):l=new o,l&&(c._rowFilter=l,l._sheet=c,l.fromJSON(s,t),l.reFilter()))},paintCell:function(e){var t,n,r,o,i,l,s,c,_=this,f=e.cell,d=f.width,h=f.height,g=f.cellLayout,p=_._getImageLoader(),m=_._getFilterButtonModel(),C=[],w=e.ctx;if(w.save(),w.beginPath(),w.lineWidth=1,w.fillStyle="#FFFFFF",w.strokeStyle="#CCCCCC",(!g||!v(C,g))&&m&&d>0&&h>0&&(t=A(m,f.row,f.col,e.sheetArea))){n=new T(t.rowFilter,t.row,t.col,t.sheetArea,f.x,f.y,d,h),r=_._getFilterButtonRect(new a.Rect(n.x,n.y,n.width,n.height),n.sheetArea),o=r.width,i=r.height,l=r.x,s=r.y,c=u._FilterDialog._getImageSrc(n._getState()),w.save(),w.rect(n.x,n.y,n.width,n.height),w.clip(),w.beginPath(),w.fillRect(l+1,s+1,o-3,i-3),w.strokeRect(l+1-.5,s+2-.5,o-3,i-4);try{p._getState(c)?w.drawImage(p._getImage(c),l,s+1,o-3,i-3):p._addImage(c)}catch(e){}w.beginPath(),w.restore()}w.restore()}},a.Worksheet._registerFeature("filter",i),e.exports=u}()},function(e,t){!function(){"use strict";e.exports={Exp_InvalidColumnIndex:"Invalid column index.",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",OK:"OK",Cancel:"Cancel",Search:"Search",CheckAll:"Check all",UncheckAll:"Uncheck all",Blanks:"(Blanks)",Exp_FilterItemIsNull:"FilterItem is null."}}()}]),GC=window.GC||{},GC.Spread=GC.Spread||{},GC.Spread.Sheets=GC.Spread.Sheets||{},GC.Spread.Sheets.Touch=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="/assets/",n(0)}([function(e,t,n){!function(){"use strict";var t=n(1);t.SR={},t.SR.en=n(4),e.exports=t}()},function(e,t,n){!function(){"use strict";var t,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v={},C=n(2),w=n(3),y=C._Types._isNullOrUndefined,S=w._BaseDialog,x=w.GC$,b=x.extend,T=x.isEmptyObject,R=x.inherit,A=w._util,I=A._createElement,M=w._ThemeStyleHelper,E=w.Rect,F=w._FocusHelper,D=w._DPIHelper,N=w._createRange,V=w.Events,O=w._Layout,H=w._LayoutModel,P=A._cancelDefault,L=A._browser.mozilla,k=A._device(),B=k.ipad||k.iphone,W=null,z=void 0,U=Math.abs,Y=Math.min,G=Math.max,X=Math.pow,j=Math.atan2,K=Math.PI,Z=Math.round,J=Math.sqrt,q=Math.atan,Q=Math.log,$=Math.floor,ee=100,te="touch",ne="none",re="MSPointerDown",oe="MSPointerMove",ie="MSPointerUp",ae="pointerdown",le="pointermove",se="pointerup",ue="touchstart",ce="touchmove",_e="touchend",fe="MSPOINTER_TYPE_TOUCH",de=isNaN,he=parseInt,ge=parseFloat,pe=window,me=pe.navigator,ve=document,Ce=pe._gcGlobal,we="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",ye="AAAAAElFTkSuQmCC",Se=w._CanvasHelper;function xe(){return C._getResource(v.SR)()}function be(e){return e.height}function Te(e){return e.width}function Re(e){clearInterval(e)}function Ae(){return(new Date).valueOf()}function Ie(e,t){var n,r,o,i,a,l,s,u;return!(!e||!t)&&(n=13,r=15,o=n,i=n,a=r,l=r,s=e.X-t.X,u=e.Y-t.Y,U(s)<o&&U(u)<i&&J(s*s+u*u)<Y(a,l))}function Me(e){return e.getActiveSheet()}function Ee(e){return e.getSelections()}function Fe(e){return e.frozenTrailingColumnCount()}function De(e){return e.frozenTrailingRowCount()}function Ne(e,t){return e.getColumnCount(t)}function Ve(e,t){return e.getRowCount(t)}t=400,r=1e3,o=20;function Oe(e){var t=x(e).offset(),n=ve.body,r=0,o=0;return t&&(r=t.top+n.clientTop||0,o=t.left+n.clientLeft||0),{_top:r,_left:o}}function He(){var e=this;e._elements=[],e._pressedPointers={length:0},e._manipulationProcessor=new ze,e._tapEventProcesser=new Ue}b(He.prototype,{_ManipulationStarting:function(e){this._manipulationProcessor._ManipulationStarting=e},_ManipulationStarted:function(e){this._manipulationProcessor._ManipulationStarted=e},_ManipulationCompleted:function(e){var t=this;t._manipulationProcessor._ManipulationCompleted=function(n){if(e){e(n);var r=t._touchMouseMessageFilter;r&&r._postProcessManipulationComplete()}}},_ManipulationInertiaStarting:function(e){this._manipulationProcessor._ManipulationInertiaStarting=e},_ManipulationDelta:function(e){this._manipulationProcessor._ManipulationDelta=e},_Tapped:function(e){this._tapEventProcesser._Tapped=e},_DoubleTapped:function(e){this._tapEventProcesser._DoubleTapped=e},_RightTapped:function(e){this._tapEventProcesser._RightTapped=e},_TouchOperatorStart:function(e){this._touchOperatorStart=e},_TouchOperatorEnd:function(e){this._touchOperatorEnd=e},_getOffsetRelativeToDownElement:function(e,t){var n=t?t._element:this._downElement._element;return A._getRelativeOffset(e,n)},_msPointerDown:function(e,t){var n,r,o,i,a,l,s=this,u=t.pointerType,c=t.target,_=t.offsetX,f=t.offsetY;u!==t[fe]&&u!==te||(n=s._getOffsetRelativeToDownElement(c,e),r=n._left,o=n._top,i=s._down(e,c,t.pointerId,new Ye(_+r,f+o),t.timeStamp),i&&P(t),"sheet"===s._downElement._eventFlag&&(a=t.pageX-(_+r),l=t.pageY-(f+o),Ce.canvasOffset={top:l,left:a}))},_msPointerMove:function(e){var t,n,r=this,o=e.pointerType,i=e.pointerId;if(o===e[fe]||o===te){if(r._pressedPointers[i]===z)return!1;t=r._getOffsetRelativeToDownElement(e.target),n=r._move(i,new Ye(e.offsetX+t._left,e.offsetY+t._top),e.timeStamp),n&&P(e)}},_msPointerUp:function(e){var t,n,r=this,o=e.pointerType,i=e.pointerId;if(o===e[fe]||o===te){if(r._pressedPointers[i]===z)return!1;t=r._getOffsetRelativeToDownElement(e.target),n=r._up(i,new Ye(e.offsetX+t._left,e.offsetY+t._top)),n&&P(e)}},_msPointerCancel:function(e){var t,n,r=this,o=e.pointerType,i=e.pointerId;if(o===e[fe]||o===te){if(r._pressedPointers[i]===z)return!1;t=r._getOffsetRelativeToDownElement(e.target),n=r._cancel(i,new Ye(e.offsetX+t._left,e.offsetY+t._top)),n&&P(e)}},_touchStart:function(e,t){var n,r,o,i=Oe(e._element),a=t.changedTouches,l=!1;for(n=0;n<a.length;n++)r=a[n],o=L?Ae():t.timeStamp,l=this._down(e,t.target,r.identifier,new Ye(r.pageX-i._left,r.pageY-i._top),o)||l;l&&P(t)},_touchMove:function(e){var t,n,r,o=this,i=Oe(o._downElement._element),a=e.changedTouches,l=!1;for(t=0;t<a.length;t++)n=a[t],r=L?Ae():e.timeStamp,l=o._move(n.identifier,new Ye(n.pageX-i._left,n.pageY-i._top),r)||l;l&&P(e)},_touchEnd:function(e){var t,n,r=this,o=Oe(r._downElement._element),i=e.changedTouches,a=!1;for(t=0;t<i.length;t++)n=i[t],a=r._up(n.identifier,new Ye(n.pageX-o._left,n.pageY-o._top))||a;a&&P(e)},_touchCancel:function(e){var t,n,r=this,o=Oe(r._downElement._element),i=e.changedTouches,a=!1;for(t=0;t<i.length;t++)n=i[t],a=r._cancel(n.identifier,new Ye(n.pageX-o._left,n.pageY-o._top))||a;a&&P(e)},_fixPosition:function(e){var t,n,r=this,o=r._downElement,i=r._manipulationElement;o!==i&&(t=x(o._element).offset(),n=x(i._element).offset(),e.X+=t.left-n.left,e.Y+=t.top-n.top)},_setCaptureElement:function(e){var t,n,r,o,i,a=this,l=a._elements;for(a._manipulationElement=W,a._touchMouseMessageFilter=W,n=0;n<l.length;n++)if(l[n]===e){if(r=l[n],o=W,i=W,r._canDoManipulation&&!r._canDoManipulation()){for(n=0;n<l.length;n++)if((t=l[n])!==r&&t._level>=0&&t._level<r._level&&(!t._canDoManipulation||t._canDoManipulation())){o=t;break}if(o===W)return!1}if(r._canDoTap&&!r._canDoTap()){for(n=0;n<l.length;n++)if((t=l[n])!==r&&t._level>=0&&t._level<r._level&&(!t._canDoTap||t._canDoTap())){i=t;break}if(i===W)return!1}o===W&&(o=r),i===W&&(i=r),a._downElement=r,a._manipulationElement=o,a._tapElement=i,a._ManipulationStarting(i._manipulationStarting||W),a._ManipulationStarted(o._manipulationStarted||W),a._ManipulationDelta(o._manipulationDelta||W),a._ManipulationInertiaStarting(o._manipulationInertiaStarting||W),a._ManipulationCompleted(o._manipulationCompleted||W),a._Tapped(i._tapped||W),a._DoubleTapped(i._doubleTapped||W),a._RightTapped(i._rightTapped||W),a._TouchOperatorStart(o._touchOperatorStart||W),a._TouchOperatorEnd(o._touchOperatorEnd||W),o._messageFilter&&(a._touchMouseMessageFilter=r._messageFilter);break}return!0},_down:function(e,t,n,r,o){var i=this;return i._pressedPointers[n]===z&&(!(0===i._pressedPointers.length&&!i._setCaptureElement(e,t))&&(!!i._manipulationElement&&(i._pressedPointers.length>=i._manipulationElement._maxPointer||(!i._touchMouseMessageFilter||!i._touchMouseMessageFilter._preProcessPointerDown())&&(i._fixPosition(r),i._touchMouseMessageFilter&&0===i._pressedPointers.length&&i._touchMouseMessageFilter._preProcessManipulationStarting(),i._pressedPointers[n]={id:n,time:Ae(),position:r},i._pressedPointers.length++,i._manipulationProcessor._PreviewPointerDown(t,n,r,o),i._manipulationProcessor._PointerDown(n,r,i._pressedPointers.length,o),1===i._pressedPointers.length&&i._tapEventProcesser._PointerDown(r),1===i._pressedPointers.length&&i._touchOperatorStart&&i._touchOperatorStart({_Position:r}),!0))))},_move:function(e,t,n){var r=this;return r._pressedPointers[e]!==z&&((!r._touchMouseMessageFilter||!r._touchMouseMessageFilter._preProcessPointerMove())&&(r._fixPosition(t),r._pressedPointers[e]={id:e,time:Ae(),position:t},r._manipulationProcessor._PointerMove(e,t,n),!0))},_up:function(e,t){var n=this;return n._pressedPointers[e]!==z&&(delete n._pressedPointers[e],n._pressedPointers.length--,(!n._touchMouseMessageFilter||!n._touchMouseMessageFilter._preProcessPointerUp())&&(n._fixPosition(t),n._manipulationProcessor._PreviewPointerUp(e),n._manipulationProcessor._PointerUp(e),0===n._pressedPointers.length&&(n._tapEventProcesser._PreviewPointerUp(t),n._tapEventProcesser._PointerUp(t)),0===n._pressedPointers.length&&n._touchOperatorEnd&&n._touchOperatorEnd({_Position:t}),n._touchMouseMessageFilter&&0===n._pressedPointers.length&&0===n._manipulationProcessor._process&&n._touchMouseMessageFilter._postProcessManipulationComplete(),!0))},_cancel:function(e,t){return this._up(e,t)},_attachDettach:function(e,t){var n,r,o,i,a,l=this,s="."+e._eventFlag,u=".gcSheet",c=re+u,_=oe+u+s,f=ie+u+s,d="MSPointerCancel"+u+s,h="MSLostPointerCapture"+u+s,g=ae+u,p=le+u+s,m=se+u+s,v="LostPointerCapture"+u+s,w="pointercancel"+u+s,S=ue+u,b=ce+u,T=_e+u,R="touchcancel"+u;function A(){x(ve).bind(_,E).bind(f,F).bind(p,E).bind(m,F).bind(d,D).bind(h,D).bind(v,D).bind(w,D)}function I(){x(ve).unbind(_).unbind(p).unbind(f).unbind(m).unbind(d).unbind(w).unbind(h).unbind(v)}function M(t){A(),l._msPointerDown(e,t)}function E(e){l._msPointerMove(e)}function F(e){l._msPointerUp(e),0===l._pressedPointers.length&&I()}function D(e){l._msPointerCancel(e),0===l._pressedPointers.length&&I()}n=e._element,r=l._elements,(o=C._ArrayHelper._indexOf(r,e))>=0&&t||o<0&&!t||(i=me.msPointerEnabled||me.pointerEnabled,t?i?(a=n.style,y(a.msTouchAction)||(a.msTouchAction=ne),y(a.touchAction)||(a.touchAction=ne),x(n).bind(c,M).bind(g,M)):(x(n).bind(S,function(t){l._touchStart(e,t)}),x(n).bind(b,function(e){l._touchMove(e)}).bind(T,function(e){l._touchEnd(e)}).bind(R,function(e){l._touchCancel(e)})):i?x(n).unbind(c).unbind(g):x(n).unbind(S).unbind(b).unbind(T).unbind(R),t?r.push(e):r.splice(o,1))},_dispose:function(){var e,t=this,n=t._elements;for(e=n.length-1;e>=0;e--)t._attachDettach(n[e],!1)}});function Pe(e,t){var n=j(t.Y,t.X)-j(e.Y,e.X);return n>K?n-=2*K:n<-K&&(n+=2*K),n}function Le(e,t){return J((t.X-e.X)*(t.X-e.X)+(t.Y-e.Y)*(t.Y-e.Y))}function ke(e,t,n){var r=new Ye(n._Center.X,n._Center.Y),o=new Ye(t.X-r.X,t.Y-r.Y),i=new Ye(e.X-r.X,e.Y-r.Y),a=Y(1,X(Le(t,r)/n._Radius,4)),l=Pe(o,i);return de(l)?0:l*a}function Be(e){return U(e)<=2.220446049250313e-16}function We(e,t){var n=!1,r=!1,o;return 0!==e&&(o=q(t/e)/K*180)<20&&(n=!0),0===e?r=!0:(o=q(t/e)/K*180)>75&&o<105&&(r=!0),{_translateXLocked:n,_translateYLocked:r}}function ze(){var e=this;e._totalTranslateX=0,e._totalTranslateY=0,e._totalScale=1,e._totalRotation=0,e._totalExpansion=0,e._process=0,e._workingModes=511,e._manipulatorPointers=new Qe,e._minimumScaleRotateRadius=20,e._deltaHistory=new Xe}b(ze.prototype,{_PreviewPointerDown:function(e,t,n,r){var o,i=this;3===i._process&&i._Complete(!0),i._isScroll=2===i._process&&1===i._manipulatorPointers._Count(),i._originalSource=e,o={},o._ID=t,o._PreviousPoint=n,o._InitialPoint=n,i._manipulatorPointers._Add(o),i._lastTime=r,i._manipulatorPointers._Count()>1&&(i._TranslateXLocked=!1,i._TranslateYLocked=!1,1===i._process&&i._StartManipulation())},_PointerDown:function(e,t,n){0===this._process&&1===n&&this._Starting(this._manipulatorPointers._ItemAt(0)._InitialPoint)},_PointerMove:function(e,t,n){var r,i,a,l,s,u,c,_=this;if(0!==_._workingModes&&_._manipulatorPointers._Contains(e)){if(1===_._process&&1===_._manipulatorPointers._Count()){if(r=_._IsPinned(),!_._SupportsMode(1)&&!_._SupportsMode(2)&&!r)return;if(i=_._manipulatorPointers._Find(e)._InitialPoint,Ie(t,i))return;a=U(t.X-i.X),l=U(t.Y-i.Y),_._SetTranslateRails(a,l)}if(!(n-_._lastTime<o)){if(_._manipulatorPointers._Find(e)._CurrentPoint=t,(s=_._manipulatorPointers._Count())>1)for(u=0;u<s;u++)if(c=_._manipulatorPointers._ItemAt(u),!c._CurrentPoint)return;for(_._PointerMoveCore(n),_._lastTime=n,s=_._manipulatorPointers._Count(),u=0;u<s;u++)c=_._manipulatorPointers._ItemAt(u),c._PreviousPoint=c._CurrentPoint,c._CurrentPoint=W}}},_PointerUp:function(){var e=this;e._needFireEvents&&(e._OnManipulationCompleted(e._needFireEvents),e._needFireEvents=W)},_PreviewPointerUp:function(e){var t=this;t._manipulatorPointers._Contains(e)&&(t._manipulatorPointers._Remove(e),2===t._process?0===t._manipulatorPointers._Count()&&(t._SupportsMode(64)||t._SupportsMode(256)||t._SupportsMode(128)?t._StartInertia():t._Complete(!0)):2===t._process||3===t._process?t._Complete(!0):1===t._process&&t._Complete(!1))},_PointerMoveCore:function(e){var t,n,r,o,i,a=this,l=a._CalculateTranslate(),s=l._translateX,u=l._translateY,c=l._position,_=a._CalculateRotationAndScale(),f=_._rotation,d=_._scale,h=_._expansion;if(a._totalTranslateX+=s,a._totalTranslateY+=u,a._totalScale*=d,a._totalRotation+=f,a._totalExpansion+=h,t={},t._expansion=h,t._rotation=f,t._timeStamp=e-a._lastTime,t._translateX=s,t._translateY=u,a._deltaHistory._Enqueue(t),a._lastPosition=c,1===a._process||2===a._process){if(1===a._process&&(n=a._StartManipulation()))return;if(r=new qe,r._Expansion=h,r._Rotation=f,r._Scale=d,r._Translation=new Ye(s,u),o=new je(a._deltaHistory),i=new tt(a._originalSource,a._GetCumulative(),r,!1,c,o),a._OnManipulationDelta(i),i._IsComplete)return void a._Complete(!0)}},_StartManipulation:function(){var e,t=this;return t._process=2,e=new rt(t._originalSource,t._manipulatorPointers._Count(),t._GetCumulative(),t._manipulatorPointers._ItemAt(0)._InitialPoint),t._OnManipulationStarted(e),!!e._IsComplete&&(t._Complete(!0),!0)},_SetTranslateRails:function(e,t){var n=We(e,t);this._TranslateXLocked=n._translateXLocked,this._TranslateYLocked=n._translateYLocked},_CalculateTranslate:function(){var e=0,t=0,n=this._GetAveragePoint(),r=n._currentAveragePoint,o=n._previousAveragePoint,i=new Ye(r.X,r.Y);return e=r.X-o.X,t=r.Y-o.Y,{_translateX:e,_translateY:t,_position:i}},_CalculateRotationAndScale:function(){var e,t=this,n=0,r=1,o=0;return t._SupportsMode(16)&&1===t._manipulatorPointers._Count()&&t._IsPinned()&&(n=ke(t._manipulatorPointers._ItemAt(0)._CurrentPoint,t._manipulatorPointers._ItemAt(0)._PreviousPoint,t._pivot)),t._manipulatorPointers._Count()>1&&(e=t._CalculateMultiManipulatorRotationAndScale(),n=e._rotation,r=e._scale,o=e._expansion),n=n/K*180,{_rotation:n,_scale:r,_expansion:o}},_CalculateMultiManipulatorRotationAndScale:function(){var e,t,n,r,o,i,a,l,s,u,c,_=this,f=_._GetAveragePoint(),d=f._currentAveragePoint,h=f._previousAveragePoint,g=_._IsPinned(),p=g?_._pivot._Center:new Ye(0,0),m=0,v=1,C=0,w=0,y=0,S=0,x=0,b=_._manipulatorPointers._Count();for(e=0;e<b;e++)t=_._manipulatorPointers._ItemAt(e),n=t._CurrentPoint,r=t._PreviousPoint,o=Le(n,d),i=Le(r,h),a=g?new Ye(r.X-p.X,r.Y-p.Y):new Ye(r.X-h.X,r.Y-h.Y),l=g?new Ye(n.X-p.X,n.Y-p.Y):new Ye(n.X-d.X,n.Y-d.Y),s=Le(r,p),u=Le(n,p),i>=_._minimumScaleRotateRadius&&o>=_._minimumScaleRotateRadius&&(y++,S+=o,x+=i,(!g||s>=_._minimumScaleRotateRadius)&&u>=_._minimumScaleRotateRadius&&(c=Pe(a,l),m+=c,w++));return w>0&&_._SupportsMode(16)?m/=w:m=0,y>0&&_._SupportsMode(32)?(_._isScroll||(v=S/x),C=(S-x)/y,_._lastDistance=S/y):_._lastDistance=0,{_rotation:m,_scale:v,_expansion:C}},_SupportsMode:function(e){return 0!=(this._workingModes&e)},_GetAveragePoint:function(){var e,t,n,r,o,i,a=0,l=0,s=0,u=0,c=this._manipulatorPointers,_=c._Count();for(e=0;e<_;e++)t=c._ItemAt(e),n=t._PreviousPoint,r=t._CurrentPoint,a+=n.X,l+=n.Y,s+=r.X,u+=r.Y;return o=new Ye(a/_,l/_),i=new Ye(s/_,u/_),{_currentAveragePoint:i,_previousAveragePoint:o}},_IsPinned:function(){var e=this._pivot;return e&&!de(e._Radius)},_Starting:function(e){var t=this,n=new ot(t._originalSource,t._workingModes,W,e);return n._Mode=511,t._OnManipulationStarting(n),t._ManipulationMode=n._Mode,
0===n._Mode?(t._Complete(!1),!1):(t._workingModes=n._Mode,t._pivot=n._Pivot,t._process=1,!0)},_Complete:function(e){var t,n=this,r=3===n._process;n._process=0,n._inertiaTimer&&(Re(n._inertiaTimer),n._inertiaTimer=W),e&&(t=new et(n._originalSource,n._GetCumulative(),r,Ge(n._lastPosition),new je(n._deltaHistory)),3===n._process?n._needFireEvents=t:n._OnManipulationCompleted(t)),n._deltaHistory._Clear(),n._manipulatorPointers._Clear(),n._pivot=W,n._totalTranslateX=0,n._totalTranslateY=0,n._totalScale=1,n._totalRotation=0,n._totalExpansion=0,n._TranslateXLocked=!1,n._TranslateYLocked=!1,n._workingModes=0},_StartInertia:function(){var e,t,n=this,r={},o=new je(n._deltaHistory);if(r._CurrentTranslateXVelocity=n._SupportsMode(64)?o._Linear().X:0,r._CurrentTranslateYVelocity=n._SupportsMode(64)?o._Linear().Y:0,r._CurrentExpansionVelocity=n._SupportsMode(256)?o._Expansion():0,r._CurrentRotationVelocity=n._SupportsMode(128)?o._Angular():0,0===r._CurrentTranslateXVelocity&&0===r._CurrentTranslateYVelocity&&0===r._CurrentExpansionVelocity&&0===r._CurrentRotationVelocity)return void n._Complete(!0);r._TranslateBehavior=new Je(r._CurrentTranslateXVelocity,r._CurrentTranslateYVelocity),r._ExpansionBehavior=new Ke(r._CurrentExpansionVelocity),r._RotationBehavior=new Ze(r._CurrentRotationVelocity),o=new je(W,r._CurrentTranslateXVelocity,r._CurrentTranslateYVelocity,r._CurrentRotationVelocity,r._CurrentExpansionVelocity),e=new nt(n._originalSource,n._GetCumulative(),new qe,o,r._ExpansionBehavior,r._RotationBehavior,r._TranslateBehavior),n._OnManipulationInertiaStarting(e),r._TranslateBehavior=e._TranslationBehavior,r._ExpansionBehavior=e._ExpansionBehavior,r._RotationBehavior=e._RotationBehavior,r._TranslateBehavior._XDeceleration<=0&&r._TranslateBehavior._YDeceleration<=0&&r._TranslateBehavior._SetDecelerationInternal(.003),r._ExpansionBehavior._DecelerationInternal()<=0&&r._ExpansionBehavior._SetDecelerationInternal(.002),r._RotationBehavior._DecelerationInternal()<=0&&r._RotationBehavior._SetDecelerationInternal(.003),t=Ae(),r._StartTime=t,r._LastTime=t,r._DeltaXRemainder=0,r._DeltaYRemainder=0,n._process=3,n._inertiaTimer=setInterval(function(){try{n._InertiaTick(r)}catch(e){}},20)},_InertiaTick:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h=this,g=Ae(),p=g-e._LastTime;if(0!==p){if(t=e._CurrentTranslateXVelocity,n=e._CurrentTranslateYVelocity,r=e._CurrentExpansionVelocity,o=e._CurrentRotationVelocity,e._CurrentTranslateXVelocity=h._GetInertiaCurrentVelocity(p,e._TranslateBehavior._XDeceleration,e._CurrentTranslateXVelocity),e._CurrentTranslateYVelocity=h._GetInertiaCurrentVelocity(p,e._TranslateBehavior._YDeceleration,e._CurrentTranslateYVelocity),e._CurrentExpansionVelocity=h._GetInertiaCurrentVelocity(p,e._ExpansionBehavior._DecelerationInternal(),e._CurrentExpansionVelocity),e._CurrentRotationVelocity=h._GetInertiaCurrentVelocity(p,e._RotationBehavior._DecelerationInternal(),e._CurrentRotationVelocity),t=(t+e._CurrentTranslateXVelocity)/2,n=(n+e._CurrentTranslateYVelocity)/2,r=(r+e._CurrentExpansionVelocity)/2,o=(o+e._CurrentRotationVelocity)/2,e._LastTime=g,i=!1,Be(t)&&Be(n)&&Be(r)&&Be(o)&&(i=!0),a=p*t,l=p*n,s=p*r,u=p*o,c=1,h._lastDistance>0&&(h._lastDistance+2*s<0&&(s=-h._lastDistance/2+1),0!==h._lastDistance&&(c=(h._lastDistance+2*s)/h._lastDistance)),h._totalExpansion+=s,h._totalRotation+=u,h._totalTranslateX+=a,h._totalTranslateY+=l,h._totalScale*=c,h._lastDistance+=s,h._lastPosition=new Ye(h._lastPosition.X+a,h._lastPosition.Y+l),e._DeltaXRemainder+=a,e._DeltaYRemainder+=l,i){if(a=Z(e._DeltaXRemainder),l=Z(e._DeltaYRemainder),Be(a)&&Be(l))return void h._Complete(!0)}else U(e._DeltaXRemainder)>=1&&(a=e._DeltaXRemainder,e._DeltaXRemainder-=a),U(e._DeltaYRemainder)>=1&&(l=e._DeltaYRemainder,e._DeltaYRemainder-=l);if(_=new qe,_._Translation=new Ye(a,l),_._Scale=c,_._Expansion=s,_._Rotation=u,f=new je(W,e._CurrentTranslateXVelocity,e._CurrentTranslateYVelocity,e._CurrentRotationVelocity,e._CurrentExpansionVelocity),d=new tt(h._originalSource,h._GetCumulative(),_,!0,Ge(h._lastPosition),f),h._OnManipulationDelta(d),d._IsComplete)return void h._Complete(!0);i&&h._Complete(!0)}},_GetInertiaCurrentVelocity:function(e,t,n){if(Be(n))return 0;var r;return r=n<0?n+t*e:n-t*e,(r<0&&n>0||r>0&&n<0)&&(r=0),r},_GetCumulative:function(){var e=this,t=new qe;return t._Expansion=e._totalExpansion,t._Rotation=e._totalRotation,t._Scale=e._totalScale,t._Translation=new Ye(e._totalTranslateX,e._totalTranslateY),t},_GetManipulationData:function(e,t,n,r){var o,i=this,a=new qe,l=new qe,s=0,u=0,c=0,_=0,f=i._SupportsMode(4)&&i._TranslateXLocked,d=i._SupportsMode(8)&&i._TranslateYLocked;return!i._SupportsMode(1)||d||e&&!i._SupportsMode(64)||(a._Translation.X=t._Translation.X,l._Translation.X=n._Translation.X,s=r._Linear().X),!i._SupportsMode(2)||f||e&&!i._SupportsMode(64)||(a._Translation.Y=t._Translation.Y,l._Translation.Y=n._Translation.Y,u=r._Linear().Y),!i._SupportsMode(32)||e&&!i._SupportsMode(256)?(a._Scale=t._Scale,l._Scale=1):(a._Scale=t._Scale,a._Expansion=t._Expansion,l._Scale=n._Scale,l._Expansion=n._Expansion,_=r._Expansion()),!i._SupportsMode(16)||e&&!i._SupportsMode(128)||(a._Rotation=t._Rotation,l._Rotation=n._Rotation,c=r._Angular()),o=new je(W,s,u,c,_),new $e(a,l,o)},_OnManipulationStarting:function(e){this._ManipulationStarting&&e&&this._ManipulationStarting(e)},_OnManipulationStarted:function(e){this._ManipulationStarted&&e&&this._ManipulationStarted(e)},_OnManipulationCompleted:function(e){var t,n=this;n._ManipulationCompleted&&e&&(t=n._GetManipulationData(!1,e._Cumulative,e._Cumulative,e._Velocities),e._Cumulative=t._Cumulative,e._Velocities=t._Velocities,n._ManipulationCompleted(e))},_OnManipulationInertiaStarting:function(e){var t,n=this;n._ManipulationInertiaStarting&&e&&(t=n._GetManipulationData(!1,e._Cumulative,e._Delta,e._Velocities),e._Cumulative=t._Cumulative,e._Delta=t._Delta,e._Velocities=t._Velocities,n._ManipulationInertiaStarting(e))},_OnManipulationDelta:function(e){var t,n=this;n._ManipulationDelta&&e&&(t=n._GetManipulationData(e._IsInertia,e._Cumulative,e._Delta,e._Velocities),e._Cumulative=t._Cumulative,e._Delta=t._Delta,e._Velocities=t._Velocities,n._ManipulationDelta(e))}});function Ue(){}b(Ue.prototype,{_PointerDown:function(e){var n,r=this;++r._pointerCount>1||(n=Ae(),r._firstDownPosition&&Ie(e,r._firstDownPosition)&&n-r._lastDownTimestamp<t?r._count++:(r._firstDownPosition=e,r._count=1),r._lastDownPosition=e,r._lastDownTimestamp=n)},_PointerUp:function(){var e=this;e._needFireEvents&&(e._needFireEvents instanceof it?e._OnTapped(e._needFireEvents):e._needFireEvents instanceof at&&e._OnRightTapped(e._needFireEvents),e._needFireEvents=W)},_PreviewPointerUp:function(e){var t,n=this;--n._pointerCount>0||(t=Ae(),Ie(e,n._lastDownPosition)?t-n._lastDownTimestamp>r?n._needFireEvents=new at(n._lastDownPosition):n._count>1?(n._count=0,n._OnDoubleTapped(new lt(n._firstDownPosition)),n._firstDownPosition=W):n._needFireEvents=new it(n._lastDownPosition):n._firstDownPosition=W)},_PointerCancel:function(){this._firstDownPosition=W},_OnTapped:function(e){this._Tapped&&e&&this._Tapped(e)},_OnDoubleTapped:function(e){this._DoubleTapped&&e&&this._DoubleTapped(e)},_OnRightTapped:function(e){this._RightTapped&&e&&this._RightTapped(e)}});function Ye(e,t){this.X=e,this.Y=t}function Ge(e){return new Ye(e?Z(e.X):-1,e?Z(e.Y):-1)}v._TouchPoint=Ye;function Xe(){var e=this;e._count=0,e._start=0,e._maxCount=10,e._history=[]}b(Xe.prototype,{_GetVelocity:function(e){var t,n,r,o,i,a,l=this;if(0===l._count)return 0;for(t=0,n=(1+l._count)*l._count/2,r=l._count-1;r>=0;r--)o=0,i=l._Item(r),0===e?o=i._translateX:1===e?o=i._translateY:2===e?o=i._expansion:3===e&&(o=i._rotation),a=l._GetSingleVelocity(o,i._timeStamp),a*=r+1,t+=a;return t/n},_GetSingleVelocity:function(e,t){return e/t},_Item:function(e){return this._history[this._GetInnerListIndex(e)]},_Last:function(){return this._history[this._count-1]},_Enqueue:function(e){var t,n,r=this;for(10===r._count&&r._Dequeue(),r._count++,r._history[r._GetInnerListIndex(r._count-1)]=e,t=o*r._maxCount,n=0;n<r._count;n++)e._timeStamp-r._history[n]._timeStamp>t&&(r._Dequeue(),n--)},_Dequeue:function(){var e=this;e._start++,e._start===e._maxCount&&(e._start=0),e._count--},_Clear:function(){this._count=0},_GetInnerListIndex:function(e){return(this._start+e)%this._maxCount}});function je(e,t,n,r,o){var i=this;e?i._history=e:(i._linear=new Ye(t,n),i._angular=r,i._expansion=o)}b(je.prototype,{_Linear:function(){var e=this;return e._linear||(e._linear=new Ye(e._history._GetVelocity(0),e._history._GetVelocity(1))),e._linear},_Angular:function(){var e=this;return y(e._angular)&&(e._angular=e._history._GetVelocity(3)),e._angular},_Expansion:function(){var e=this;return y(e._expansion)&&(e._expansion=e._history._GetVelocity(2)),e._expansion}});function Ke(e){this._initialVelocity=e,this._decelerationInternal=0}b(Ke.prototype,{_DecelerationInternal:function(){var e=this,t=e._DesiredExpansion,n=e._DesiredDeceleration,r=e._initialVelocity;return de(t)||0===t?de(n)?e._decelerationInternal:n:.5*r*r/t},_SetDecelerationInternal:function(e){this._decelerationInternal=e}});function Ze(e){this._initialVelocity=e,this._decelerationInternal=0}b(Ze.prototype,{_DecelerationInternal:function(){var e=this,t=e._DesiredRotation,n=e._DesiredDeceleration,r=e._initialVelocity;return de(t)||0===t?de(n)?e._decelerationInternal:n:.5*r*r/t},_SetDecelerationInternal:function(e){this._decelerationInternal=e}});function Je(e,t){var n=this;n._initialXVelocity=e,n._initialYVelocity=t,n._XDeceleration=0,n._YDeceleration=0,n._decelerationInternal=0,n._velocity=J(e*e+t*t)}b(Je.prototype,{_UpdateXYDecelerations:function(){var e=this,t=e._DesiredDisplacement,n=e._velocity,r=e._initialXVelocity,o=e._initialYVelocity,i=e._DecelerationInternal();de(t)||0===t?de(i)||0===i?(e._XDeceleration=0,e._YDeceleration=0):(e._XDeceleration=i*U(r)/n,e._YDeceleration=i*U(o)/n):(e._XDeceleration=.5*n*U(r)/t,e._YDeceleration=.5*n*U(o)/t)},_DecelerationInternal:function(){var e=this,t=e._DesiredDeceleration;return de(t)&&de(e._DesiredDisplacement)?e._decelerationInternal:t},_SetDecelerationInternal:function(e){this._decelerationInternal=e,this._UpdateXYDecelerations()}});function qe(){var e=this;e._Translation=new Ye(0,0),e._Scale=0,e._Rotation=0,e._Expansion=0}function Qe(){this._list=[]}b(Qe.prototype,{_Contains:function(e){var t,n,r=this._list;for(t=0;t<r.length;t++)if(n=r[t],n._ID===e)return!0;return!1},_Add:function(e){this._list.push(e)},_Remove:function(e){var t,n=this._list;for(t=0;t<n.length;t++)if(n[t]._ID===e){n.splice(t,1);break}},_Count:function(){return this._list.length},_ItemAt:function(e){return this._list[e]},_Find:function(e){var t,n,r=this._list;for(t=0;t<r.length;t++)if(n=r[t],n._ID===e)return n;return W},_Clear:function(){var e=this._list;e.splice(0,e.length)}});function $e(e,t,n){var r=this;r._Cumulative=e,r._Delta=t,r._Velocities=n}function et(e,t,n,r,o){var i=this;i._OriginalSource=e,i._Cumulative=t,i._IsInertia=n,i._Position=r,i._Velocities=o}function tt(e,t,n,r,o,i){var a=this;a._OriginalSource=e,a._Cumulative=t,a._Delta=n,a._IsInertia=r,a._Position=o,a._Velocities=i}function nt(e,t,n,r,o,i,a){var l=this;l._OriginalSource=e,l._Cumulative=t,l._Delta=n,l._Velocities=r,l._ExpansionBehavior=o,l._RotationBehavior=i,l._TranslationBehavior=a}function rt(e,t,n,r){var o=this;o._OriginalSource=e,o._PointerCount=t,o._Cumulative=n,o._Position=r}function ot(e,t,n,r){var o=this;o._OriginalSource=e,o._Mode=t,o._Pivot=n,o._Position=r}function it(e){this._Position=e}function at(e){this._Position=e}function lt(e){this._Position=e}function st(e,t){var n=e*t;return n>4?n=4:n<.5&&(n=.5),n}function ut(e){this._sheet=e}b(ut.prototype,{_getTouchCanvas:function(e,t){var n=this._canvas;return n?e===D._getLogicWidth(n)&&t===D._getLogicHeight(n)||D._setSize(n,e,t):(n=I("canvas"),D._adjustDevicePixel(n,W,this._sheet),D._setSize(n,e,t)),n},_saveCanvas:function(e,t,n,r){var o=this,i=D._getLogicWidth(e),a=D._getLogicHeight(e),l=o._getTouchCanvas(i,a),s=l.getContext("2d"),u=D._getScaleX(l),c=D._getScaleY(l);Se._scaleTo(s,1,1),s.drawImage(e,0,0,Te(l),be(l),0,0,Te(l),be(l)),Se._scaleTo(s,u,c),o._canvas=l,o._oldSheetLayout=t,o._oldGroupLayout=n,o._oldZoomFactor=r},_restoreCanvas:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d=this,h=d._sheet,g=D._getLogicWidth(e),p=D._getLogicHeight(e),m=Fe(h),v=De(h),C=m>0?1:0,w=v>0?1:0,y=d._oldGroupLayout,S=h._getOutlineLayout&&h._getOutlineLayout()||{x:0,y:0,width:0,height:0},x=d._oldSheetLayout,b=h._getSheetLayout(),T=t/d._oldZoomFactor,R=e.getContext("2d"),A=D._getScaleX(e),I=D._getScaleY(e),M=d._canvas;R.save(),R.fillStyle=n,R.fillRect(0,0,g,p),_=h.rowOutlines,f=h.columnOutlines,_&&_._paint(h,R,W,!0),f&&f._paint(h,R,W,!1),r=y.x+Te(y),o=y.y+be(y),i=x._frozenTrailingX-r-C,a=x._frozenTrailingY-o-w,l=S.x+Te(S),s=S.y+be(S),u=i*T,c=a*T,r*=A,o*=I,i*=A,a*=I,l*=A,s*=I,u*=A,c*=I,Se._scaleTo(R,1,1),R.drawImage(M,r,o,i,a,l,s,u,c),m>0&&(r=x._frozenTrailingX-C,o=y.y+be(y),i=x._frozenTrailingWidth+C,a=x._frozenTrailingY-o-w,l=b._frozenTrailingX-C,s=S.y+be(S),u=b._frozenTrailingWidth+C,c=a*T,r*=A,o*=I,i*=A,a*=I,l*=A,s*=I,u*=A,c*=I,R.drawImage(M,r,o,i,a,l,s,u,c)),v>0&&(r=y.x+Te(y),o=x._frozenTrailingY-w,i=x._frozenTrailingX-r-C,a=x._frozenTrailingHeight+w,l=S.x+Te(S),s=b._frozenTrailingY-w,u=i*T,c=b._frozenTrailingHeight+w,r*=A,o*=I,i*=A,a*=I,l*=A,s*=I,u*=A,c*=I,R.drawImage(M,r,o,i,a,l,s,u,c)),m>0&&v>0&&(r=x._frozenTrailingX-C,o=x._frozenTrailingY-w,i=x._frozenTrailingWidth+C,a=x._frozenTrailingHeight+w,l=b._frozenTrailingX-C,s=b._frozenTrailingY-w,u=b._frozenTrailingWidth+C,c=b._frozenTrailingHeight+w,r*=A,o*=I,i*=A,a*=I,l*=A,s*=I,u*=A,c*=I,R.drawImage(M,r,o,i,a,l,s,u,c)),Se._scaleTo(R,A,I),R.restore()},_startZoom:function(){var e=this,t=e._sheet,n=t._zoomFactor,r=t._render._getBufferCtx();r&&e._saveCanvas(r.canvas,t._getSheetLayout(),t._getOutlineLayout&&t._getOutlineLayout()||{x:0,y:0,width:0,height:0},n)},_continueZoom:function(e){var t,n,r,o=this,i=o._sheet;i.endEdit()&&(t=st(e,o._oldZoomFactor),i._zoomFactor!==t&&(i._trigger(V.UserZooming,{sheet:i,sheetName:i._name,oldZoomFactor:i._zoomFactor,newZoomFactor:t}),i._zoomInternal(t),i.invalidateLayout(),n=i._render,r=n._getCtx(),r&&o._restoreCanvas(r.canvas,t,n._getGrayAreaBackColor(!1)),i._paintFloatingObject&&i._paintFloatingObject(W,t),i._paintComment&&i._paintComment(W)))},_endZoom:function(e){var t=this,n=t._sheet;n._zoomInternal(st(e,t._oldZoomFactor)),n._needSyncHScrollbarSize=!0,n._needSyncVScrollbarSize=!0,n._invalidate()}}),v._TouchZoomManager=ut,i=200,a=20;function ct(e,t,n){var r=n,o=0,i=0,a=e._cachePool,l,s,u=e._getSheetLayout()._viewportY,c=e._getViewportRowLayout(1).findRow(r);if(c)if(t>0){for(l=e._getScrollableRow(-1),o=u-c.y;r>l&&o<t;)r--,o+=a._getZoomRowHeight(r);i=t-o}else if(t<0){for(s=e._getLastVisualScrollRow(),o=-(c.y+be(c)-u);r<s&&o>t;)r++,o-=a._getZoomRowHeight(r);i=t-o}return{_row:r,_offset:i}}function _t(e,t,n){var r=n,o=0,i=0,a,l,s=e._cachePool,u=e._getSheetLayout()._viewportX,c=e._getViewportColumnLayout(1).findCol(r);if(c)if(t>0){for(a=e._getScrollableColumn(-1),o=u-c.x;r>a&&o<t;)r--,o+=s._getZoomColWidth(r);i=t-o}else if(t<0){for(l=e._getLastVisualScrollColumn(),o=-(c.x+Te(c)-u);r<l&&o>t;)r++,o-=s._getZoomColWidth(r);i=t-o}return{_col:r,_offset:i}}function ft(e,t){return he(-t/(e/t+1)+t)}function dt(e,t){return he(t*(-t/(e-t)-1))}function ht(e,t,n,r,o,i){e.fillStyle=t,e.fillRect(n,r,o,i)}function gt(e,t,n,r,o){var i,a,l,s,u,c=M._getVisualStateThemeStyle(0,"gc-columnHeader-normal"),_=c&&c.backgroundImage,f=c&&c.backgroundColor;if(_&&-1!==_.indexOf("linear-gradient"))for(a=A._getLinearGradientColors(_),i=e.createLinearGradient(t+r/2,n,t+r/2,n+o),l=0,s=a.length;l<s;l++)u=a[l],i.addColorStop(u.point,u.color);else f&&(i=f);return i}function pt(){var e=M._getVisualStateThemeStyle(0,"gc-rowHeader-normal");return e&&e.backgroundColor}function mt(e,t){var n,r,o,i,a,l,s,u,c,_,f,d,h,g=e._getSheetLayout(),p=e._render,m=p._getGrayAreaBackColor(!1),v=p._getCtx(),C=p._getBufferCtx(),w=e._getViewportRowLayout(1),y=g._headerX,S=Te(g),x=e._getScrollableRow(-1),b=w.findRow(x);b&&(n=g._viewportY,(r=b.y-n-1)>0&&(t?(o=g._rowHeaderWidth,i=pt(),ht(v,i,y,n,o-1,r+1),ht(C,i,y,n,o-1,r+1),ht(v,m,y+o,n,S-o,r),ht(C,m,y+o,n,S-o,r)):(ht(v,m,y,n,S,r),ht(C,m,y,n,S,r)))),a=e._getScrollableRow(Ve(e),!0),l=w.findRow(a),l&&(n=l.y+be(l),(r=g._frozenTrailingY-n-1)>0&&(ht(v,m,y,n,S,r),ht(C,m,y,n,S,r))),s=e._getViewportColumnLayout(1),n=g._headerY,r=be(g),u=e._getScrollableColumn(-1),c=s.findCol(u),c&&(y=g._viewportX,(S=c.x-y-1)>0&&(t?(_=g._colHeaderHeight,f=gt(v,y,n,S+1,_-1),ht(v,f,y,n,S+1,_-1),ht(C,f,y,n,S+1,_-1),ht(v,m,y,n+_,S,r-_),ht(C,m,y,n+_,S,r-_)):(ht(v,m,y,n,S,r),ht(C,m,y,n,S,r)))),d=e._getScrollableColumn(Ne(e),!0),(h=s.findCol(d))&&(y=h.x+Te(h),(S=g._frozenTrailingX-y-1)>0&&(ht(v,m,y,n,S,r),ht(C,m,y,n,S,r)))}function vt(e,t,n,r,o,i){e.beginPath(),e.strokeStyle=t,e.moveTo(n,r),e.lineTo(o,i),e.stroke()}function Ct(e,t){var n,r,o,i,a,l=e._getSheetLayout(),s=e._render,u=e.options.gridline.color,c=M._getVisualStateThemeStyle(0,"gc-columnHeader-normal"),_=c&&c.borderBottomColor,f=s._getCtx(),d=e._getViewportRowLayout(1),h=l._headerX,g=Te(l),p=e._getScrollableRow(-1),m=d.findRow(p);m&&(n=l._viewportY,(r=m.y-n)>0&&(vt(f,u,h,m.y-.5,h+g,m.y-.5),t&&vt(f,_,l._frozenX-.5,n,l._frozenX-.5,m.y))),o=e._getViewportColumnLayout(1),n=l._headerY,r=be(l),i=e._getScrollableColumn(-1),(a=o.findCol(i))&&(h=l._viewportX,(g=a.x-h)>0&&(vt(f,u,a.x-.5,n,a.x-.5,n+r),t&&vt(f,_,h,l._frozenY-.5,a.x,l._frozenY-.5)))}function wt(e,t){var n=0;return e||(n|=1),t||(n|=2),n}function yt(e){this._sheet=e}function St(e,t){for(var n,r=new H,o=e._cachePool,i=e._getSheetLayout(),a=G(e.frozenColumnCount(),e._scrollLeftCol),l=Ne(e)-Fe(e),s=i._viewportX+t,u=i._viewportWidth-t;u>0&&a<l;a++)n=o._getZoomColWidth(a),r.push(new O(-1,a,s,-1,n,-1)),s+=n,u-=n;return r}function xt(e,t){for(var n,r=new H,o=e._cachePool,i=e._getSheetLayout(),a=G(e.frozenRowCount(),e._scrollTopRow),l=Ve(e)-De(e),s=i._viewportY+t,u=i._viewportHeight-t;u>0&&a<l;a++)n=o._getZoomRowHeight(a),r.push(new O(a,-1,-1,s,-1,n)),s+=n,u-=n;return r}function bt(e,t){var n=0;return n|=0!==e?1:0,n|=0!==t?2:0}b(yt.prototype,{_updateTouchViewportColumnLayout:function(e){var t=this._sheet,n=t._colLayoutCache;n.viewport||(n.viewport={}),n.viewport[1]=St(t,e)},_updateTouchViewportRowLayout:function(e){var t=this._sheet,n=t._rowLayoutCache;n.viewport||(n.viewport={}),n.viewport[1]=xt(t,e)},_invalidateLayout:function(){var e=this._sheet,t=e._colLayoutCache.viewport,n=e._rowLayoutCache.viewport;e.invalidateLayout(),e._colLayoutCache.viewport=t,e._rowLayoutCache.viewport=n},_vScrollTo:function(e,t,n,r){var o,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y=this,S=y._sheet,x=S._scrollTopRow,b=ct(S,e,x),T=b._row,R=b._offset;if(S._scrollTopRow=T,S._layoutSuspended>0)return!1;if(o=S._getBounds(),l=S._getSheetLayout(),s=l._viewportY,u=l._viewportHeight,c=o?o.x:l.x,_=Te(l),e<0)y._cachedOffsetY=0,y._cachedAvailableOffsetY=0,m=S._getViewportRowLayout(1),m&&m.length>0&&(g=m.findRow(T)),g&&(p=m[m.length-1],p.row>=T&&(f=2,d=s+U(e),(h=Y(s+u,p.y+be(p))-d)>=0&&(h-=f,y._updateTouchViewportRowLayout(R-be(g)),n.x=c,n.y=d,n.width=_,n.height=h,n.tx=c,n.ty=s,r.x=c,r.y=s+h,r.width=_,r.height=u-h)));else if(e>0){if(v=S._getScrollableRow(-1),T===v&&R>0)if(y._cachedOffsetY>0&&y._cachedAvailableOffsetY>0){if(C=y._cachedOffsetY+e,w=ft(C,i),e=w-y._cachedAvailableOffsetY,R=w,e<=0)return t;if(t&&w>=a)return!0;y._cachedOffsetY=C,y._cachedAvailableOffsetY=w}else{if(R>=i&&(e-=R-(i-1),R=i-1,e<=0))return t;if(C=dt(R,i),w=R,t&&w>=a)return!0;y._cachedOffsetY=C,y._cachedAvailableOffsetY=w}else y._cachedOffsetY=0,y._cachedAvailableOffsetY=0;e<u&&(f=2,d=s,h=u-e,De(S)>0&&(h-=1),y._updateTouchViewportRowLayout(R),n.x=c,n.y=d,n.width=_,n.height=h,n.tx=c,n.ty=d+e,r.x=c,r.y=d,r.width=_,r.height=e+f)}return!1},_hScrollTo:function(e,t,n,r){var o,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y=this,S=y._sheet,x=S._scrollLeftCol,b=_t(S,e,x),T=b._col,R=b._offset;if(S._scrollLeftCol=T,S._layoutSuspended>0)return!1;if(o=S._getBounds(),l=S._getSheetLayout(),s=l._viewportX,u=l._viewportWidth,c=o?o.y:l.y,_=be(l),e<0)y._cachedOffsetX=0,y._cachedAvailableOffsetX=0,C=S._getViewportColumnLayout(1),C&&C.length>0&&(m=C.findCol(T)),m&&(v=C[C.length-1],v.col>=T&&(f=2,d=s+U(e),(h=Y(s+u,v.x+Te(v))-d)>=0&&(h-=f,y._updateTouchViewportColumnLayout(R-Te(m)),n.x=d,n.y=c,n.width=h,n.height=_,n.tx=s,n.ty=c,r.x=s+h,r.y=c,r.width=u-h,r.height=_)));else if(e>0){if(w=S._getScrollableColumn(-1),T===w&&R>0)if(y._cachedOffsetX>0&&y._cachedAvailableOffsetX>0){if(g=y._cachedOffsetX+e,p=ft(g,i),e=p-y._cachedAvailableOffsetX,R=p,e<=0)return t;if(t&&p>=a)return!0;y._cachedOffsetX=g,y._cachedAvailableOffsetX=p}else{if(R>=i&&(e-=R-(i-1),R=i-1,e<=0))return t;if(g=dt(R,i),p=R,t&&p>=a)return!0;y._cachedOffsetX=g,y._cachedAvailableOffsetX=p}else y._cachedOffsetX=0,y._cachedAvailableOffsetX=0;e<u&&(f=2,d=s,h=u-e,Fe(S)>0&&(h-=1),y._updateTouchViewportColumnLayout(R),n.x=d,n.y=c,n.width=h,n.height=_,n.tx=d+e,n.ty=c,r.x=d,r.y=c,r.width=e+f,r.height=_)}return!1},_continueScrollCore:function(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p,m=this,v=m._sheet,C=!0,w=!0,y=v._render,S=y._getCtx(),x=0!=(2&n),b=0!=(1&n);if(b||x)return s=v._getBounds(),u=v._getSheetLayout(),c=s?s.y:u.y,_=be(u),f=s?s.x:u.x,d=Te(u),x&&(i={},o={},C=m._vScrollTo(t,r,o,i),y._copyScreen(o.x,o.y,Te(o),be(o),o.tx,o.ty)),b&&(a={},l={},w=m._hScrollTo(e,r,a,l),y._copyScreen(a.x,a.y,Te(a),be(a),a.tx,a.ty),x||(i=l)),h=v.parent,h&&!h.options.scrollbarShowMax&&(b&&(v._needSyncHScrollbarSize=!0),x&&(v._needSyncVScrollbarSize=!0)),m._invalidateLayout(),g=v.rowOutlines&&!v.rowOutlines._isEmpty()?1:0,p=v.columnOutlines&&!v.columnOutlines._isEmpty()?1:0,b&&x?y._paintBody(S,new E(i.x,i.y,Te(i),be(i)+g),new E(l.x,l.y,Te(l)+p,be(l))):y._paintBody(S,new E(i.x,i.y,Te(i)+p,be(i)+g)),y._paintAdornment(S,new E(f,c,d,_)),Ct(v,!0),mt(v,!0),m._onSheetScroll(b,x),C&&w},_onSheetScroll:function(e,t){var n,r=this._sheet;t&&r._syncVScrollbarPosition(),e&&r._syncHScrollbarPosition(),r._eventHandler._updateEditingEditor(),(n=r.comments)&&n._updateCommentsLayoutWhenSheetScroll()},_endScrollWithAnimation:function(e,t,n){function r(e,t,n,r){return e/=n,X(.75,e)*r*(t?1:-1)}function o(e,t,n){return e=U(e),e/=n,Q(e)/Q(.75)*t}var a=this,l=a._sheet,s=i,u=10,c=20,_=100,f=o(e,10,s),d=o(t,10,s),h=e,g=t,p=0,m=0,v=!1,C=!1;a._interval=setInterval(function(){var o,i,u,c,_;if(v&&C)return l._cachePool._endCache(),o=l.parent,o&&!o.options.scrollbarShowMax&&(l._needSyncHScrollbarSize=!0,l._needSyncVScrollbarSize=!0),l._cachePool._clearCacheEndPan(),l._invalidate(),l._syncHScrollbarPosition(),l._syncVScrollbarPosition(),Re(a._interval),void(a._interval=W);f+=20,d+=20,f>100&&d>100?(a._continueScrollCore(e-p,t-m,wt(v,C),n),v=!0,C=!0):(f>100&&!v&&(a._continueScrollCore(e-p,0,1,n),v=!0),d>100&&!C&&(a._continueScrollCore(0,t-m,2,n),C=!0),i=r(f,e>0,10,s),u=r(d,t>0,10,s),c=$(h-i),_=$(g-u),a._continueScrollCore(c,_,wt(v,C),n),h=i,g=u,p+=c,m+=_)},20)},_startScroll:function(e){var t=this,n=t._sheet,r=n._cachePool;t._interval&&(r._clearCacheEndPan(),Re(t._interval),t._interval=W),t._cachedOffsetX=0,t._cachedAvailableOffsetX=0,t._cachedOffsetY=0,t._cachedAvailableOffsetY=0,t._oldScrollTopRow=n._scrollTopRow,t._oldScrollLeftCol=n._scrollLeftCol,e&&r._startCacheBeforPan()},_continueScroll:function(e,t){var n=he(e.X),r=he(e.Y),o=bt(n,r);return this._continueScrollCore(n,r,o,t)},_endScroll:function(e){var t,n,r,o,i,a,l,s,u=this,c=u._sheet,_=c._getSheetLayout(),f=_._viewportX,d=_._viewportY,h=c._scrollTopRow,g=c._scrollLeftCol,p=c._getViewportColumnLayout(1),m=c._getLastVisualScrollColumn();p&&p.length>0&&(t=p.findCol(g),g<m&&t&&t.x+Te(t)-f<Te(t)/2&&g++),n=c._getViewportRowLayout(1),o=c._getLastVisualScrollRow(),n&&n.length>0&&(r=n.findRow(h),h<o&&r&&r.y+be(r)-d<be(r)/2&&h++),i=0,a=0,p&&p.length>0&&(t=p.findCol(g),i=f-t.x),n&&n.length>0&&(r=n.findRow(h),a=d-r.y),l=u._oldScrollTopRow,h!==l&&c._setTopRow(h),s=u._oldScrollLeftCol,g!==s&&c._setLeftColumn(g),u._endScrollWithAnimation(i,a,e)}});function Tt(e,t,n,r,o){var i,a,l,s,u,c=e.parent,_=e._eventHandler,f=e.options,d=t.rowViewportIndex,h=t.colViewportIndex,g=Ee(e),p=W;return e._isTouchMode&&g.length>0&&(i=g[g.length-1],a=i.row,l=i.row+i.rowCount-1,s=i.col,u=i.col+i.colCount-1,c&&!c.options.allowUserResize||(-1!==a&&-1===s&&d>=0&&h<0&&f.rowHeaderVisible?!(p=_._getResizeRowInfo(e,t,o,2,r))||"sizeRow"!==p.action&&"sizeHiddenRow"!==p.action||2!==p.sheetArea||p.index===l||(p=W):-1===a&&-1!==s&&d<0&&h>=0&&f.colHeaderVisible&&(!(p=_._getResizeColInfo(e,t,o,1,n))||"sizeCol"!==p.action&&"sizeHiddenCol"!==p.action||1!==p.sheetArea||p.index===u||(p=W)))),p}function Rt(e,t,n,r){var o,i,a,l,s,u,c,_,f;if(0===e.selectionPolicy())return W;for(o=t.hitTestType,i=jt(e),a=Ee(e),l=3,e._isTouchMode&&a.length>0&&(s=a[a.length-1],-1!==s.row&&-1!==s.col?l=3:-1!==s.row?l=2:-1!==s.col&&(l=1)),u=0;u<i.length;u++)if((c=i[u])&&(c.x-=Te(c),c.y-=be(c),c.width*=3,c.height*=3,c.contains(n,r)))return y(t.row)&&(_=e._getViewportRowLayout(1))&&_.length>0&&(t.row=_[_.length-1].row),y(t.col)&&(f=e._getViewportColumnLayout(1))&&f.length>0&&(t.col=f[f.length-1].col),{x:n,y:r,type:l,isHeader:!1,isFirstIndicator:0===u};return 1===o?{x:n,y:r,type:1,isHeader:!0}:2===o?{x:n,y:r,type:2,isHeader:!0}:W}function At(e,t,n,r){var o,i,a,l,s,u,c,_,f,d,h,g,p=W,m=t.rowViewportIndex,v=t.colViewportIndex;if(y(m)||y(v))return p;if(o=e.parent,i=e._getActiveSelectedRange(),m>=0&&v>=0&&1===e._selectionModel.length){if(a=e._getActualRange(i),l=Fe(e),s=De(e),u=Ne(e)-l,c=Ve(e)-s,1===v&&l>0&&a.col<u&&a.col+a.colCount>u&&(_=e._getColumnLayout(v))&&_.length>0&&(f=_[_.length-1],n>f.x+Te(f)))return p;if(1===m&&s>0&&a.row<c&&a.row+a.rowCount>c&&(d=e._getRowLayout(m))&&d.length>0&&(h=d[d.length-1],r>h.y+be(h)))return p}return g=Yt(e),g&&(p||(g.x-=Te(g),g.y-=be(g),g.width*=3,g.height*=3,g.contains(n,r)&&(p={action:"drag",side:"corner"})),o&&o.options.allowUserDragFill||p&&"corner"===p.side&&(p.side=W)),p}function It(e,t,n,r){var o,i,a,l,s,u,c,_,f=!1,d=e._selectionModel;for(o=0,i=d.length;o<i;o++){if(a=d[o],l=3===r||y(r),l&&(a=e._getActualRange(a)),s=a.row,u=a.col,c=a.rowCount,_=a.colCount,l)f=s<=t&&t<s+c&&u<=n&&n<u+_;else if(2===r)f=-1===u&&s<=t&&t<s+c;else if(1===r)f=-1===s&&u<=n&&n<u+_;else if(0===r)return f;if(f)break}return f}function Mt(e,t,n,r){if(!t){var o=Ee(e),i=o[o.length-1];n?3===r?(e._activeRowIndex=i.row+i.rowCount-1,e._activeColIndex=i.col+i.colCount-1):2===r?(e._activeRowIndex=i.row+i.rowCount-1,e._activeColIndex=0):1===r&&(e._activeRowIndex=0,e._activeColIndex=i.col+i.colCount-1):3===r?(e._activeRowIndex=i.row,e._activeColIndex=i.col):2===r?(e._activeRowIndex=i.row,e._activeColIndex=0):1===r&&(e._activeRowIndex=0,e._activeColIndex=i.col)}}function Et(e,t,n,r){var o=Ee(e),i=o[o.length-1];(t||n)&&(3===r?(e._activeRowIndex=i.row,e._activeColIndex=i.col):2===r?(e._activeRowIndex=i.row,e._activeColIndex=0):1===r&&(e._activeRowIndex=0,e._activeColIndex=i.col))}function Ft(e){var t=this;t._isScroll=!1,t._touchZoomManager=new ut(e),t._touchScrollManager=new yt(e),t._sheet=e}v.TouchEventHandler=Ft,b(Ft.prototype,{_doManipulationStarting:function(e){var t=this,n=t._sheet,r=n._getSheetLayout(),o=r._viewportX,i=r._viewportY,a=r._frozenTrailingX,l=r._frozenTrailingY,s=e._Position,u=0,c=t._touchHitTest(s.X,s.Y),_=c.dragInfo,f=c.x,d=c.y;c&&(c.resizeInfo||_&&"corner"===_.side||c.selectionHitInfo)?(u|=2,u|=1):(i<=d&&d<l&&(u|=2),o<=f&&f<a&&(u|=1),u|=96,n.parent&&(u|=12)),e._Mode=u},_doManipulationStarted:function(e){var t,n,r,o,i=this,a=e._Position,l=i._sheet,s=l.parent,u=l._eventHandler,c=l._render,_=i._touchHitTest(a.X,a.Y),f=_.dragInfo,d=_.selectionHitInfo;if(l._currentTarget=_,_.resizeInfo){if(!l.endEdit())return;u._startResizing(_)}else if(f&&"corner"===f.side)u._startDragFill&&u._startDragFill(_);else if(d){if(!l.endEdit())return;t=d.isHeader,n=d.isFirstIndicator,r=d.type,t&&u._startSelectingCore(_,!0),o=_.hitTestType,_.hitTestType=r,u._startSelectingScroll(_),_.hitTestType=o,Mt(l,t,n,r),l._showTouchSelectionIndicator=!1,c._refreshTouchSelectionIndicator()}else l._commentRender&&(l._commentRender()._showWhenTouchMoveOrScroll=!1),l._showTouchSelectionIndicator=!1,c._refreshTouchSelectionIndicator(),e._PointerCount>1&&s&&s.options.allowUserZoom?(i._isScroll=!1,i._touchZoomManager._startZoom()):(i._isScroll=!0,i._touchScrollManager._startScroll(1===e._PointerCount))},_doManipulationDelta:function(e){var t,n,r,o,i=this,a=e._Position,l=i._sheet,s=l._eventHandler,u=l._currentTarget,c=a.X,_=a.Y;if(u)if(t=u.dragInfo,n=u.selectionHitInfo,u.resizeInfo)s._mousePosition={e:e,x:c,y:_},s._continueResizing();else if(t&&"corner"===t.side)s._mousePosition={e:e,x:c,y:_},s._continueDragFill&&s._continueDragFill();else if(n||s._isSelecting){if(n){if(!s._startHitInfo||!s._isWorking)return;if(!0===s._forceCancelSelectiong)return;r=n.type,s._mousePosition={e:e,x:c,y:_},3===r?s._continueCellSelecting():2===r?s._continueRowSelecting():1===r&&s._continueColumnSelecting()}}else i._isScroll?e._IsComplete=i._touchScrollManager._continueScroll(e._Delta._Translation,e._IsInertia):(o=e._Cumulative._Scale,i._touchZoomManager._continueZoom(o))},_doManipulationCompleted:function(e){var t,n,r,o=this,i=o._sheet,a=i._eventHandler;i._showTouchSelectionIndicator=!0,t=i._currentTarget,n=t.selectionHitInfo,t.resizeInfo?a._stopResizing():t.dragInfo&&a._isDraggingFill?(a._endDragFill&&a._endDragFill(),i.parent.touchToolStrip._closeAutoFillIndicator()):n||a._isSelecting?(a._stopSelecting(),n&&Et(i,n.isHeader,n.isFirstIndicator,n.type),i._render._repaintSelection()):(i._commentRender&&(i._commentRender()._showWhenTouchMoveOrScroll=!0),o._isScroll?o._touchScrollManager._endScroll(e._IsInertia):(r=e._Cumulative._Scale,o._touchZoomManager._endZoom(r)))},_doTapped:function(e){var n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,S,x,b,T,R,A,I=this,M=e._Position,E=I._sheet,F=E.parent,D=!1;if(I._clearTouchToolStripTimeout(),E._unSelectAllFloatingObjects&&E._unSelectAllFloatingObjects(),n=E.comments,n&&n._clearActiveComment(),r=E._eventHandler,o=I._touchHitTest(M.X,M.Y,!0),i=o.filterButtonHitInfo,a=o.hitTestType,l=o.row,s=o.col,u=o.outlineHitInfo)E.isEditing()||(c=u.what,_=E.rowOutlines,f=E.columnOutlines,"rg"===c||"rgh"===c?_&&_._doClick(E,u):"cg"!==c&&"cgh"!==c||f&&f._doClick(E,u));else if(E._currentTarget=o,i){if(!E.endEdit())return;d=i.rowFilter,d&&d.openFilterDialog(i)}else if(o.resizeInfo);else if(E._canSelect(o.rowViewportIndex<0?-1:l,o.colViewportIndex<0?-1:s)){if(E._existTouchDragFillIndicator&&!r._isDraggingFill&&F.touchToolStrip._closeAutoFillIndicator(),h=E.getActiveRowIndex(),g=E.getActiveColumnIndex(),p=o.cellTypeHitInfo){if(m=E.getCellType(p.row,p.col,a),p.sheet||(p.sheet=E),I._canSetSelectionChange(m,p))if(v=p.sheetArea,!y(v)&&3!==v||l===h&&s===g)E._render._refreshTouchSelectionIndicator();else{if(E.suspendPaint(),!E.endEdit())return;if(C={sheet:E,sheetName:E._name,row:h,col:g,cancel:!1},E._trigger(V.LeaveCell,C),C&&!0===C.cancel)return;w=E._selectionModel.toArray(),S=E._getSpanModel().get(l,s),x=[N(S.row,S.col,S.rowCount,S.colCount)],E._raiseSelectionChanging(w,x),b=p.isReservedLocation&&p.isFocusAware,E._setActiveCellAndSelection(l,s,z,z,b?0:1),T={sheet:E,sheetName:E._name,row:l,col:s},E._trigger(V.EnterCell,T),E._trigger(V.FormulatextboxEnterCell,T),E._raiseSelectionChanged(w),E._noMoreSelectionChanged=!0,r._updateValidationUI&&r._updateValidationUI(l,s),E.resumePaint(),D=!0}m.processCellAndPaddingMouseDown(p),m.processMouseUp(p)}if(p&&p.isReservedLocation)return!0;E._trigger(V.CellClick,{sheet:E,sheetName:E._name,sheetArea:a,row:o.row,col:o.col,target:o});try{if(r._hitTestResult=o,E.isEditing()&&h===E.getActiveRowIndex()&&g===E.getActiveColumnIndex()&&!E.endEdit())return}finally{r._hitTestResult=W}if(y(l)||y(s))return;3===a&&r._updateValidationUI&&r._updateValidationUI(l,s),It(E,l,s,a)&&!D?I._touchToolStripTimeout=setTimeout(function(){var e={x:o.x,y:o.y,handled:!1},t=F.touchToolStrip;E._trigger(V.TouchToolStripOpening,e),e.handled||t.open(o.x,o.y-ee),
I._clearTouchToolStripTimeout()},t+20):(R=E._selectionModel.toArray(),r._startSelectingCore(o),A=E._selectionModel.toArray(),E._raiseSelectionChanging(R,A),r._stopSelecting())}},_canSetSelectionChange:function(e,t){return!(e&&e.activedOnClick&&!e.activedOnClick()&&t.isReservedLocation)},_doDoubleTapped:function(e){var t,n,r,o,i,a,l,s,u,c,_,f=this,d=f._sheet,h=e._Position;if(f._clearTouchToolStripTimeout(),(r=d._currentTarget)&&(d._trigger(V.CellDoubleClick,{sheet:d,sheetName:d._name,sheetArea:r.hitTestType,row:r.row,col:r.col}),o=r.resizeInfo))if("sizeRow"===o.action||"sizeHiddenRow"===o.action){if(i=[],d._isRowSelected(o.index)){for(t=0;t<d._selectionModel.length;t++)if(n=d._selectionModel[t],-1===n.col)for(n=d._getActualRange(n),a=0;a<n.rowCount;a++)i.push({row:n.row+a})}else i.push({row:o.index});d._commandManager().execute({cmd:"autoFitRow",sheetName:d.name(),rows:i,columnHeader:1===o.sheetArea})}else{if(l=[],d._isColumnSelected(o.index)){for(t=0;t<d._selectionModel.length;t++)if(n=d._selectionModel[t],-1===n.row)for(n=d._getActualRange(n),s=0;s<n.colCount;s++)l.push({col:n.col+s})}else l.push({col:o.index});d._commandManager().execute({cmd:"autoFitColumn",sheetName:d.name(),columns:l,rowHeader:2===o.sheetArea})}else!((u=f._touchHitTest(h.X,h.Y,!0))&&u.row>=0&&u.col>=0&&u.rowViewportIndex>=0&&u.colViewportIndex>=0)||u.resizeInfo||d.options.isProtected&&d._getStyleProperty(u.row,u.col,"locked")||(d._clearSelectionImp(),c=d._getRowViewportIndex(u.row),_=d._getColumnViewportIndex(u.col),d._setActiveCellImp(u.row,u.col,c,_,!0),d.addSelection(u.row,u.col,1,1),d._eventHandler._resumeFocus(!1,!0),d._startEditImp(d._getCanvas(),u.row,u.col))},_doTouchOperatorStart:function(e){var t,n=this,r=n._sheet,o=e._Position,i=n._touchHitTest(o.X,o.Y);r.isEditing()?i.row===r._activeRowIndex&&i.col===r._activeColIndex||r._eventHandler._releaseFocus(i):(n._target=i,(t=n._touchHitTest(o.X,o.Y,!0))&&t.cellTypeHitInfo&&t.cellTypeHitInfo.isEditting||r._eventHandler._releaseFocus(t))},_doTouchOperatorEnd:function(){var e,t,n,r,o=this,i=o._sheet;i.isEditing()||(e=o._target,t=!0,e&&(n=e.cellTypeHitInfo,n&&n.isReservedLocation?t=!1:(r=i.getCellType(e.row,e.col))&&r.isEditting()&&(t=!1)),t&&i._eventHandler._resumeFocus(!0))},_touchHitTest:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v=this,C=v._sheet;return C._getSheetLayout(),r={x:e,y:t,rowViewportIndex:W,colViewportIndex:W,row:-1,col:-1,resizeInfo:W,hitTestType:W,outlineHitInfo:W,filterButtonHitInfo:W,dragInfo:W,cellTypeHitInfo:W,selectionHitInfo:W},o=C.rowOutlines,i=C.columnOutlines,o&&(a=o.hitTest(C,e,t)),!a&&i&&(a=i.hitTest(C,e,t)),a?r.outlineHitInfo=a:(l=C._getRowViewportIndexFromY(t),s=C._getColumnViewportIndexFromX(e),r.rowViewportIndex=l,r.colViewportIndex=s,r.row=C._getRowIndexFromY(t,l),r.col=C._getColumnIndexFromX(e,s),l>=0&&l<=2&&s>=0&&(u=C._getCellLayoutByCell(l,s,z,r.row,r.col))&&(r.row=u.row,r.col=u.col),r.hitTestType=C._getSheetArea(l,s),c=Tt(C,r,e,t,10),f=C._rowFilter,d=f&&f.hitTest(r,e,t),d||(g=C.tables,p=g&&g.find(r.row,r.col),m=p&&p._rowFilter,d=m&&m.hitTest(r,e,t)),C._existTouchDragFillIndicator?(_=At(C,r,e,t),r.dragInfo=_):c?r.resizeInfo=c:d?r.filterButtonHitInfo=d:n?r.cellTypeHitInfo=C._getCellTypeHitInfo(r,e,t):(h=Rt(C,r,e,t),r.selectionHitInfo=h)),r},_clearTouchToolStripTimeout:function(){var e=this,t=e._touchToolStripTimeout;t&&(clearTimeout(t),e._touchToolStripTimeout=W)}});function Dt(e,t,n){var r=this;r._touchEventProvider=n,r._touchMouseMessageFilter=new Pt(t),r._touchEventHandler=new Ft(t),r._touchTarget=new Lt(e,"sheet",r._touchMouseMessageFilter,100,10),r._touchEventProvider._attachDettach(r._touchTarget,!0)}b(Dt.prototype,{_attach:function(){var e=this,t=e._touchEventHandler,n=e._touchTarget;n._manipulationStarting=function(e){return t._doManipulationStarting(e)},n._manipulationStarted=function(e){return t._doManipulationStarted(e)},n._manipulationDelta=function(e){return t._doManipulationDelta(e)},n._manipulationCompleted=function(e){return t._doManipulationCompleted(e)},n._tapped=function(e){return t._doTapped(e)},n._doubleTapped=function(e){return t._doDoubleTapped(e)},n._touchOperatorStart=function(e){return t._doTouchOperatorStart(e)},n._touchOperatorEnd=function(e){return t._doTouchOperatorEnd(e)}},_detach:function(){var e=this,t=e._touchTarget;t&&(e._touchEventProvider._attachDettach(t,!1),t._manipulationStarting=W,t._manipulationStarted=W,t._manipulationDelta=W,t._manipulationInertiaStarting=W,t._manipulationCompleted=W,t._tapped=W,t._doubleTapped=W,t._rightTapped=W,t._touchOperatorStart=W,t._touchOperatorEnd=W,e._touchTarget=W)},_preProcessMouseDown:function(e){return this._touchMouseMessageFilter._preProcessMouseDown(e)},_preProcessMouseUp:function(e){return this._touchMouseMessageFilter._preProcessMouseUp(e)},_preProcessMouseMove:function(e){return this._touchMouseMessageFilter._preProcessMouseMove(e)}}),l="gc-toolstrip-button",s="gc-toolstrip-text",u="gc-toolstrip-image",c="gc-toolstrip-item",_="gc-touch-sperate-line",f="height",d="width",h="px",g="button",R(Nt,S);function Nt(e,t){var n,r=this;S.call(r,t,A._getPreferredZIndex(e._host)),r._imageAreaHeight=32,r._separatorHeight=45,r._menuItems={},r._isOpen=!1,r._workbook=e,n=r._getContainer(),r._toolStripDialog=n,n.addClass("gc-toolstrip-default ui-state-default well"),n.appendTo(r._getHost()),n.hide(),r._createLayoutTable(),r._setDefaultCellDomString(),r._attachEvent()}b(Nt.prototype,{open:function(e,t){var n,r,o,i,a=this;if(Me(a._workbook)&&(F._setActiveElement(W,!0),a._toolStripDialog.css({left:e,top:t}),a._show(),a._isOpen=!0,a._resetDialogPosition(),!T(a._menuItems))){n=a._menuItems;for(r in n)n.hasOwnProperty(r)&&(o=n[r],i=!o._canExecute||o._canExecute.call(a),i?x("#"+r).show():x("#"+r).hide())}},add:function(e){var t,n,r,o;e&&(t=this,n=t._menuItems,e instanceof Ht?(r=e.name())&&(n[r]=e,t._addDom(e._getDOM(_,t._separatorHeight+h))):e instanceof Ot&&(o=e.name(),t.getItem(o)||(n[o]=e,t._addDom(e._getDOM(u,t._imageAreaHeight+h,s,l)))))},getItem:function(e){return this._menuItems[e]},getItems:function(){var e,t=this,n=[],r=t._menuItems;if(!T(r)){for(e in r)r.hasOwnProperty(e)&&n.push(r[e]);return n}return W},remove:function(e){var t,n=this;return n.getItem(e)?(x("#"+e).parent().remove(),t=n._menuItems[e],delete n._menuItems[e],t):W},clear:function(){var e=this;e._toolStripDialog&&(e._toolStripDialog.find("td."+c).remove(),e._menuItems={})},close:function(){var e,t,n=this;Ce._resumeEvent(),n._toolStripDialog&&n._toolStripDialog.hide(),n._isOpen=!1,n._closeOverlay(),(e=Me(n._workbook))&&(e._setFocus(),t=Ee(e),t.length>0&&!e._existTouchDragFillIndicator&&-1===t[0].row&&-1===t[0].col&&e._clearSelectionImp())},imageAreaHeight:function(e){var t=this;return 0===arguments.length?t._imageAreaHeight:(e>0&&(t._imageAreaHeight=e,t._toolStripDialog.find("span."+u).css(f,e+h)),t)},itemHeight:function(e){var t=this,n=t._toolStripDialog.find("button."+l);return 0===arguments.length?ge(n.css(f)):(e>0&&n.css(f,e+h),t)},itemWidth:function(e){var t,n,r=this,o=r._toolStripDialog.find("button."+l);return 0===arguments.length?ge(o.css(d)):(e>0&&(t="min-width",n=ge(o.css(t)),n>e&&o.css(t,e+h),o.css(d,e+h)),r)},separatorHeight:function(e){var t=this;return 0===arguments.length?t._separatorHeight:(e>0&&(t._separatorHeight=e,t._toolStripDialog.find("div."+_).css(f,e+h)),t)},_createLayoutTable:function(){var e="table",t=this,n=x(I(e)).css({padding:0,display:e}).attr({cellspacing:0,cellpadding:0});t._tableRow=x(I("tr")).appendTo(n),n.appendTo(t._toolStripDialog)},_dispose:function(){var e=this,t=e._toolStripDialog;t&&(e._isOpen&&Ce._resumeEvent(),t.remove(),e._closeOverlay(),e._toolStripDialog=W)},_attachEvent:function(){var e=this;e._toolStripDialog.bind("click",function(t){var n,r,o,i=t.target;i.tagName.toLowerCase()===g?n=i.id:(r=i.parentElement)&&r.tagName.toLowerCase()===g&&(n=r.id),o=e._menuItems[n],n&&o&&o._command.call(e)})},_addDom:function(e){this._toolStripDialog&&e&&x(I("td")).append(e).appendTo(this._tableRow).addClass(c)},_setDefaultCellDomString:function(){var e,t,n,r,o,i,a;function l(e){for(var t=0,n=e+t;ve.getElementById(n);)t++,n=e+t;return n}e="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA",t={0:we+e+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+ye,1:we+e+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+ye,2:we+e+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:we+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="},n=this,r=t[0],o=t[1],i=t[2],a=t[3],n._pasteItem=new Ot(l("wijspread_toolstrip_paste"),xe().ToolStrip_PasteText,r,n._doTapPaste),n._cutItem=new Ot(l("wijspread_toolstrip_cut"),xe().ToolStrip_CutText,o,n._doTapCut),n._copyItem=new Ot(l("wijspread_toolstrip_copy"),xe().ToolStrip_CopyText,i,n._doTapCopy),n._autoFillItem=new Ot(l("wijspread_toolstrip_autofill"),xe().ToolStrip_AutoFillText,a,n._showAutoFillIndicator,n._hideAutoFill),n.add(n._pasteItem),n.add(n._cutItem),n.add(n._copyItem),n.add(new Ht(n._hideAutoFill)),n.add(n._autoFillItem)},_hideAutoFill:function(){var e,t,n,r=Me(this._workbook);if(!r)return!1;for(e=Ee(r),t=0;t<e.length;t++)if(n=e[t],-1===n.row&&-1===n.col)return!1;return!0},_showAutoFillIndicator:function(){var e,t;this.close(),(e=Me(this._workbook))&&(t=Ee(e).length)<=1&&(e._existTouchDragFillIndicator=!0,e._render._repaintSelection())},_closeAutoFillIndicator:function(){var e=Me(this._workbook);e&&(e._existTouchDragFillIndicator=!1,e._render._repaintSelection())},_doTapCopy:function(){var e=Me(this._workbook);e&&(this._clipboardTouchData=e._doCopy(!0)),this.close()},_doTapCut:function(){var e=Me(this._workbook);e&&(this._clipboardTouchData=e._doCut(!0)),this.close()},_doTapPaste:function(){var e=this,t=e._clipboardTouchData,n=Me(e._workbook);n&&!y(t)&&n._doPaste({pasteHtml:t.copyHtml,pasteText:t.copyText}),e.close()},_updateResource:function(){var e=this,t="span."+s;x("#"+e._pasteItem._name).find(t).text(xe().ToolStrip_PasteText),x("#"+e._cutItem._name).find(t).text(xe().ToolStrip_CutText),x("#"+e._copyItem._name).find(t).text(xe().ToolStrip_CopyText),x("#"+e._autoFillItem._name).find(t).text(xe().ToolStrip_AutoFillText)}}),v.TouchToolStrip=Nt;function Vt(e,t,n){var r,o=I("span"),i=ve.body;return o.className=n,o.style.font=e,o.style.cssFloat="left",o.textContent=t,i.insertBefore(o,W),r=x(o).width(),i.removeChild(o),r}function Ot(e,t,n,r,o){this._font="normal 12px Arial";var i=this;i._name=e,i._text=t,i._image=n,r&&(i._command=r),o&&(i._canExecute=o)}b(Ot.prototype,{name:function(e){var t=this;return 0===arguments.length?t._name:(x("#"+t._name).attr("id",e),x("#"+t._name+"Text").attr("id",e+"Text"),x("#"+t._name+"Image").attr("id",e+"Image"),t._name=e,t)},text:function(e){var t=this;return 0===arguments.length?t._text:(t._text=e,x("#"+t.name()+"Text").text(e),t)},font:function(e){var t=this,n=x("#"+t.name()+"Text");return 0===arguments.length?t._font:(t._font=e,n.css("font",e),t)},foreColor:function(e){var t=this,n=x("#"+t.name()+"Text");return 0===arguments.length?t._foreColor?t._foreColor:n.css("color"):(n.css("color",e),t)},image:function(e){var t=this;return 0===arguments.length?t._image:(t._image=e,x("#"+t.name()+"Image").css("background-image","url("+e+")"),t)},_getDOM:function(e,t,n,r){var o,i,a,l,s=this,u=s.name(),c=s.font(),_=s.text(),f=x(I("span"));return f.attr("id",u+"Image"),f.addClass(e),f.css({"background-image":"url("+s.image()+")","background-repeat":"no-repeat",display:"block",height:t,"background-position-x":"50%"}),o=x(I("span")),o.attr("id",u+"Text"),o.addClass(n),o.css("font",c),o.text(_),i=Vt(c,_,n),a=60,i>a&&(a=i),l=x(I(g)),l.attr("type",g),l.attr("id",u),l.addClass(r+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),l.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:a+h}),l.append(f),l.append(o),l[0]}}),v.TouchToolStripItem=Ot;function Ht(e){function t(){for(var e="separator",t=0,n=e+""+t;ve.getElementById(n);)t++,n=e+""+t;return n}this._name=t(),e&&(this._canExecute=e)}b(Ht.prototype,{name:function(){return this._name},_getDOM:function(e,t){var n=x(I("div"));return n.attr("id",this.name()),n.addClass(e),n.css({width:"1px",height:t,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),n[0]}}),v.TouchToolStripSeparator=Ht;function Pt(e){this._owner=e}b(Pt.prototype,{_preProcessManipulationStarting:function(){this._eventMode=2,this._owner._isTouchMode=!0},_postProcessManipulationComplete:function(){this._eventMode=0,this._touchCompleteTimestamp=Ae()},_preProcessPointerDown:function(){return 1===this._eventMode},_preProcessPointerUp:function(){return 1===this._eventMode},_preProcessPointerMove:function(){return 1===this._eventMode},_preProcessMouseDown:function(){var e=this;if(2===e._eventMode)return!0;if(e._touchCompleteTimestamp){if(Ae()-e._touchCompleteTimestamp<=200)return e._mouseDownHandled++,!0;e._touchCompleteTimestamp=0,e._mouseDownHandled=0,e._eventMode=1}else e._eventMode=1;return e._owner._isTouchMode=!1,!1},_preProcessMouseUp:function(){var e=this;return e._mouseDownHandled?(e._mouseDownHandled--,!0):2===e._eventMode||(e._eventMode=0,!1)},_preProcessMouseMove:function(){return 2===this._eventMode}}),v._TouchMouseMessageFilter=Pt;function Lt(e,t,n,r,o){var i=this;i._element=e,i._messageFilter=n,i._eventFlag=t,i._maxPointer=r,i._level=o}v._TouchTargetElement=Lt;function kt(){}b(kt.prototype,{_simulateMouseEvent:function(e,t){var n,r,o=e,i=o.touches,a=o.targetTouches,l=o.changedTouches;!1!==o.isPrimary&&(i&&i.length>=1&&a&&a.length>=1&&(i[0].clientX!==a[0].clientX||i[0].clientY!==a[0].clientY)||(P(e),n=y(l)?o:l[0],r=ve.createEvent("MouseEvents"),r.initMouseEvent(t,!0,!0,pe,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,W),e.target.dispatchEvent(r)))},_down:function(e){var t,n=e.pointerType;if(!n||n===e[fe]||n===te){if(t=e.data,t._touchHandled)return;t._touchHandled=!0,t._touchMoved=!1,t._simulateMouseEvent(e,"mouseover"),t._simulateMouseEvent(e,"mousemove"),t._simulateMouseEvent(e,"mousedown")}},_move:function(e){var t,n=e.pointerType;if(!n||n===e[fe]||n===te){if(t=e.data,!t._touchHandled)return;t._touchMoved=!0,t._simulateMouseEvent(e,"mousemove")}},_up:function(e){var t,n=e.pointerType;if(!n||n===e[fe]||n===te){if(t=e.data,!t._touchHandled)return;t._simulateMouseEvent(e,"mouseup"),t._simulateMouseEvent(e,"mouseout"),t._touchMoved||t._simulateMouseEvent(e,"click"),t._touchHandled=!1}},_bindUnBindTouchEvents:function(e,t,n){var r,o,i,a,l,s,u,c,_,f,d,h=this;"."!==n.charAt(0)&&(n="."+n),r=re+n,o=oe+n,i=ie+n,a=ae+n,l=le+n,s=se+n,u=ue+n,c=ce+n,_=_e+n,f=me.msPointerEnabled||me.pointerEnabled,t?f?(d=e.style,y(d.msTouchAction)||(d.msTouchAction=ne),y(d.touchAction)||(d.touchAction=ne),x(e).bind(r,h,h._down).bind(a,h,h._down),x(ve).bind(o,h,h._move).bind(l,h,h._move).bind(i,h,h._up).bind(s,h,h._up)):x(e).bind(u,h,h._down).bind(c,h,h._move).bind(_,h,h._up):f?(x(e).unbind(r).unbind(a),x(ve).unbind(o).unbind(l).unbind(i).unbind(s)):x(e).unbind(u).unbind(c).unbind(_)}}),v._SimulateMouseEvents=kt,p="newSheet";function Bt(e){this._tab=e}b(Bt.prototype,{_getSheetsName:function(e){var t,n=[];for(t=0;t<e.sheets.length;t++)n.push(e.sheets[t].name());return n},_doManipulationStarted:function(e){var t,n,r,o,i,a,l,s,u,c,_,f=this,d=e._Position,h=f._tab,g=Me(h._workbook);h._tabNameEditor&&h._endSheetTabEditing(g,!1),t="resize",n=f._getSheetsName(h._workbook),r=h.hitTest(d.X,d.Y),o=r.element,o===t?(h._resizeTab=!0,h._activeX=d.X):(n.indexOf(o)>=0||o===p||""===o)&&(i=h._canvas,a=D._getLogicWidth(i),l=D._getLogicHeight(i),s=f._getTouchCanvas(a,l),u=s.getContext("2d"),c=D._getScaleX(s),_=D._getScaleY(s),Se._scaleTo(u,1,1),u.drawImage(i,0,0,Te(s),be(s),0,0,Te(s),be(s)),Se._scaleTo(u,c,_),f._canvas=s,f._oldFirstTab=h._firstTab,f._tabStartPosition=h._getTabStartPosition(),f._tabEndPosition=h._getTabEndPosition(),f._newTabSize=h._getNewTabSize(),h._hideNewTabSecondMoreTab=!0),f._minFirstTabIndex=h._getNextVisibleIndex(-1),f._maxFirstTabIndex=h._reCalculateFirstTabIndex(h._getVisibleTabs())},_doManipulationDelta:function(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,S,x,b,T,R,A,I,F,N,V=this,O=e._Position.X,H=V._tab;if(H._resizeTab)t=O-H._activeX,n=H._workbook,r=n.options,o=n._vp.clientWidth,r.tabStripRatio=n._getActualTabStripRatio()+t/o,i=H._resizeBarWidth/o,a=1,n._getActualTabStripRatio()<i?(r.tabStripRatio=i,H._activeX=H._resizeBarWidth):n._getActualTabStripRatio()>=a?(r.tabStripRatio=a,H._activeX=o):H._activeX=O;else{if(l=V._canvas,s=V._oldFirstTab,!l||y(s))return;u=V._minFirstTabIndex,c=V._maxFirstTabIndex,_=V._newTabSize,f=V._tabStartPosition,d=V._tabEndPosition,h=e._Cumulative._Translation.X,g=V._getNewFirstTabInfo(h,s),H._firstTab=g._firstTab,p=g._width,h>0&&s===u&&H._firstTab===u?p=0:h<0&&s===c&&H._firstTab===c&&(p=0),h>0&&h>p+_?h=p+_:h<0&&h<p-_&&(h=p-_),0!==h&&(m=H._canvas,v=m.getContext("2d"),C=D._getScaleX(m),w=D._getScaleY(m),v.save(),v.clearRect(0,0,D._getLogicWidth(m),D._getLogicHeight(m)),S=H._getBounds(),H._paintBackground(v,S),b=0,R=be(S),h>0?(x=f,A=x+h,T=d-A,T>0&&(Se._scaleTo(v,1,1),v.drawImage(l,x*C,b,T*C,R*w,A*C,b,T*C,R*w),Se._scaleTo(v,C,w)),I=h-p,d-f<=h&&(I=0),T=p,x=f,T>0&&(Se._translate(v,I,0),H._paintTabs(v,new E(x,b,T,R)),Se._translate(v,-I,0))):h<0&&(A=f,x=A+U(h),T=d-x,T>0&&(Se._scaleTo(v,1,1),v.drawImage(l,x*C,b,T*C,R*w,A*C,b,T*C,R*w),Se._scaleTo(v,C,w)),I=h-p,d-f<=U(h)&&(I=0),T=U(p),x=d-T,T>0&&(Se._translate(v,I,0),H._paintTabs(v,new E(x,b,T,R)),Se._translate(v,-I,0))),Se._scaleTo(v,1,1),x=0,T=f,v.drawImage(l,x*C,b,T*C,R*w,x*C,b,T*C,R*w),F=M._getCssClassThemeStyle(""),N=he(F.zIndex),N>2007&&(x=d,T=S.x+Te(S)-H._resizeBarWidth-x,v.drawImage(l,x*C,b,T*C,R*w,x*C,b,T*C,R*w)),x=Te(S)-H._resizeBarWidth,T=H._resizeBarWidth,v.drawImage(l,x*C,b,T*C,R*w,x*C,b,T*C,R*w),Se._scaleTo(v,C,w),v.restore())}},_doManipulationCompleted:function(){var e=this._tab;e._resizeTab?(e._resizeTab=!1,e._workbook._doTabHSResize()):(e._hideNewTabSecondMoreTab=z,e.repaint())},_doTapped:function(e){var t,n,r,o,i,a=this._tab,l=a._workbook,s=e._Position,u=Me(l);a._tabNameEditor&&a._endSheetTabEditing(u,!1),t=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],n=this._getSheetsName(l),r=a.hitTest(s.X,s.Y),o=r.element,l._suspendSetFocus=!0;try{t.indexOf(o)>=0?a._doNavButtonClick(r.index,!0):n.indexOf(o)>=0?a._doSheetTabClick(r.index,r.position):o===p&&a._doNewTabClick(r.position)}finally{l._suspendSetFocus=!1,i=Me(l),i!==u&&(i._isTouchMode=!0,i._setFocus())}},_doDoubleTapped:function(e){return this._tab._doMouseDbClickImp(e._Position.X,e._Position.Y)},_getTouchCanvas:function(e,t){var n=this._canvas;return n?e===D._getLogicWidth(n)&&t===D._getLogicHeight(n)||D._setSize(n,e,t):(n=I("canvas"),D._adjustDevicePixel(n,this._tab._workbook),D._setSize(n,e,t)),n},_getNewFirstTabInfo:function(e,t){var n=this,r=n._tab,o=r._tabSizes,i=n._minFirstTabIndex,a=n._maxFirstTabIndex,l=t,s=0;if(e>0){for(;l>=i&&!(s>e);)s+=o[l],l--;l<i&&(l=i)}else if(e<0&&-1!==a){for(;l<=a&&!(s<e);)s-=o[l],l++;l>a&&(l=a)}return{_firstTab:l,_width:s}}});function Wt(e,t,n){var r,o,i=this;i._touchMouseMessageFilter=new Pt(i),i._touchTarget=new Lt(e,"tabStrip",i._touchMouseMessageFilter,1,-1),i._touchEventProvider=n,i._touchEventHandler=new Bt(t),r=i._touchEventHandler,o=i._touchTarget,o._manipulationStarted=function(e){return r._doManipulationStarted(e)},o._manipulationDelta=function(e){return r._doManipulationDelta(e)},o._manipulationCompleted=function(e){return r._doManipulationCompleted(e)},o._tapped=function(e){return r._doTapped(e)},o._doubleTapped=function(e){return r._doDoubleTapped(e)}}b(Wt.prototype,{_attach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!0)},_detach:function(){var e=this,t=e._touchEventProvider;t&&t._attachDettach(e._touchTarget,!1)},_preProcessMouseDown:function(e){return this._touchMouseMessageFilter._preProcessMouseDown(e)},_preProcessMouseUp:function(e){return this._touchMouseMessageFilter._preProcessMouseUp(e)},_preProcessMouseMove:function(e){return this._touchMouseMessageFilter._preProcessMouseMove(e)}});function zt(e,t,n,r){var o=e._getImageLoader();o._getState(t)?n.drawImage(o._getImage(t),r.x,r.y,Te(r),be(r)):o._addImage(t)}function Ut(e,t){var n,r,o,i,a,l,s,u,c,_,f,d,h,g=e._getSheetLayout(),p=16,m=Ee(e);e._isTouchMode&&m.length>0&&(a=m[m.length-1],l=a.row,s=a.row+a.rowCount-1,u=a.col,c=a.col+a.colCount-1,_=e.parent,f="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",_&&!_.options.allowUserResize||(-1!==l&&-1===u&&e.getRowResizable(s)?(d=e._getRowViewportIndex(s),n=we+f+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",r=e.getCellRect(s,Ne(e,2)-1,d,-1),i=g._rowHeaderRect(d),i.y<=r.y&&r.y+be(r)<=i.y+be(i)&&(o=new E(g._frozenX-p,r.y+be(r)-p/2,p,p))):-1===l&&-1!==u&&e.getColumnResizable(c)&&(h=e._getColumnViewportIndex(c),n=we+f+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+ye,r=e.getCellRect(Ve(e,1)-1,c,-1,h),i=g._colHeaderRect(h),i.x<=r.x&&r.x+Te(r)<=i.x+Te(i)&&(o=new E(r.x+Te(r)-p/2,g._frozenY-p,p,p))),n&&o&&zt(e,n,t,o)))}function Yt(e){var t,n,r,o,i=W,a=Ee(e),l=a.length;return e._isTouchMode&&l>0&&(t=a[l-1],n=e._getRangeWholeRect(t),r=17,o=20,i=new E(n.x+Te(n)-r,n.y+be(n),r,o)),i}function Gt(e,t,n){var r=e._getRowViewportIndex(t),o=e._getColumnViewportIndex(n),i=e._getViewportRowLayout(r),a=e._getViewportColumnLayout(o),l=0,s=0,u=0,c=0;return i.length>0&&(l=i[0].row,s=i[i.length-1].row),a.length>0&&(u=a[0].col,c=a[a.length-1].col),N(l,u,s-l+1,c-u+1)}function Xt(e,t,n){var r,o,i,a=e._getRowViewportIndex(t),l=e._getColumnViewportIndex(n),s=e._getSheetLayout(),u=s._viewportRect(a,l),c=!1,_=e._getViewportColumnLayout(l),f=-1===n?_[0]:_.findCol(n);return f&&(c=u.x<=f.x&&f.x+Te(f)<=u.x+Te(u)),r=!1,o=e._getViewportRowLayout(a),i=-1===t?o[0]:o.findRow(t),i&&(r=u.y<=i.y&&i.y+be(i)<=u.y+be(u)),c&&r}function jt(e){var t,n,r,o,i,a,l,s,u,c,_,f,d,h,g,p,m,v,C,w,y,S,x,b,T,R,A,I,M,F,D,N,V=Ee(e),O=[];if(e._isTouchMode&&V.length>0)for(t=V[V.length-1],n=e._getRangeWholeRect(t),r=8,o=e._getSheetLayout(),i=t.row,a=t.row+t.rowCount-1,l=t.col,s=t.col+t.colCount-1,u=Gt(e,i,l),c=Gt(e,a,s),_=u.row,f=c.row+c.rowCount-1,d=u.col,h=c.col+c.colCount-1,m=a===f&&Xt(e,f,-1),v=s===h&&Xt(e,-1,h),-1!==t.row&&-1!==t.col?(d<=l&&l<=h&&_<=i&&i<=f&&(O[0]=new E(n.x-r,n.y-r,2*r,2*r)),(d<=s&&s<h||v)&&(_<=a&&a<f||m)&&(O[1]=new E(n.x+Te(n)-r,n.y+be(n)-r,2*r,2*r))):-1!==t.row?(g=o._viewportRect(1,0),p=o._viewportRect(1,1),C=g.x+(Te(g)+Te(p))/2-r,w=Ne(e)-1-Fe(e),y=e._getViewportColumnLayout(1),S=y.findCol(w),S&&(x=e._getViewportColumnLayout(0),(b=x[0]||y[0])&&(C=b.x+(S.x+Te(S)-b.x)/2-r)),_<=i&&i<=f&&(O[0]=new E(C,n.y-r,2*r,2*r)),(_<=a&&a<f||m)&&(O[1]=new E(C,n.y+be(n)-r,2*r,2*r))):-1!==t.col&&(g=o._viewportRect(0,1),p=o._viewportRect(1,1),T=g.y+(be(g)+be(p))/2-r,R=Ve(e)-1-De(e),A=e._getViewportRowLayout(1),I=A.findRow(R),I&&(M=e._getViewportRowLayout(0),(F=M[0]||A[0])&&(T=F.y+(I.y+be(I)-F.y)/2-r)),d<=l&&l<=h&&(O[0]=new E(n.x-r,T,2*r,2*r)),(d<=s&&s<h||v)&&(O[1]=new E(n.x+Te(n)-r,T,2*r,2*r))),N=O.length-1;N>=0;N--)(!(D=O[N])||D.x<0||D.y<0)&&(O[N]=W);return O}function Kt(e,t,n){var r,o,i,a,l=e.parent;if(F._isActiveElement(e)||l&&!l.options.hideSelection){if(e.isEditing()||!t||0===e.selectionPolicy())return;if(r=jt(e),(o=r.length)>0){for(n.save(),n.fillStyle="white",n.strokeStyle=e.getSelectionBorderColor(),a=0;a<o;a++)(i=r[a])&&(n.beginPath(),n.arc(i.x+Te(i)/2,i.y+be(i)/2,Te(i)/2,0,2*Math.PI,!1),n.fill(),n.stroke());n.restore()}}}function Zt(e,t){var n,r=Yt(e);r&&(n=we+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+ye,zt(e,n,t,r))}w._SheetRender.prototype._refreshTouchSelectionIndicator=function(){var e=this,t=e._sheet,n=Ee(t),r=n.length;t._layoutSuspended<=0&&r>0&&e._repaintSelection(n[r-1],z,z,!0)},w.Worksheet._registerFeature(te,{init:function(){this._existTouchDragFillIndicator=!1,this._showTouchSelectionIndicator=!0},setHost:function(e){var t=this,n=t.parent,r=n&&n._touchEventProvider||new He,o=new Dt(e[0],t,r);o._attach(),t._touchManager=o},dispose:function(e){var t=this;t._touchManager&&t._touchManager._detach(),!1!==e&&(t._touchManager=W)},startEdit:function(){this._render._refreshTouchSelectionIndicator()},paintAdornment:function(e){var t=this,n=e.ctx;t._isTouchMode&&(t.options.isProtected||Ut(t,n),t._existTouchDragFillIndicator?Zt(t,n):Kt(t,t._showTouchSelectionIndicator,n))},preProcessMouseDown:function(e){var t=e.e,n=this._touchManager;(B||n._preProcessMouseDown(t))&&(P(t),e.r=!0)},preProcessMouseMove:function(e){var t=e.e,n=this._touchManager;(B||n._preProcessMouseMove(t))&&(P(t),e.r=!0)},preProcessMouseUp:function(e){var t=e.e,n=this._touchManager;(B||n._preProcessMouseUp(t))&&(P(t),e.r=!0)},preProcessMouseDbClick:function(e){(B||this._isTouchMode)&&(e.r=!0)},preProcessMouseOut:function(e){B&&(e.r=!0)},preProcessMouseWheel:function(e){B&&(e.r=!0)}}),w.Workbook._registerFeature(te,{init:function(){this._touchEventProvider=new He},setHost:function(){var e=this;e.touchToolStrip=new Nt(e,e._getContainerDiv())},dispose:function(){var e=this,t=e._touchEventProvider,n=e.touchToolStrip;t&&t._dispose(),n&&(n._dispose(),e.touchToolStrip=W)},onCultureChanged:function(){var e=this.touchToolStrip;e&&e._updateResource()}}),w._SheetTabBase._registerFeature(te,{setHost:function(){var e=this,t=new Wt(e._canvas,e,e._workbook._touchEventProvider);t._attach(),e._touchManager=t},dispose:function(){var e=this,t=e._touchManager;t&&(t._detach(),e._touchManager=W)},preProcessMouseDown:function(e){var t=this._touchManager,n=e.e;(B||t._preProcessMouseDown(n))&&(P(n),e.r=!1)},preProcessMouseMove:function(e){var t=this._touchManager,n=e.e;(B||t._preProcessMouseMove(n))&&(P(n),e.r=!1)},preProcessMouseUp:function(e){var t=this._touchManager,n=e.e;(B||t._preProcessMouseUp(n))&&(P(n),e.r=!1)},preProcessMouseDbClick:function(e){var t=Me(this._workbook);(B||t._isTouchMode)&&(e.r=!1)},preProcessMouseOut:function(e){B&&(e.r=!1)}}),m=".gcScrollbar",w._Scrollbar._registerFeature(te,{initEvents:function(e){(this._simulateMouseEvents=new kt)._bindUnBindTouchEvents(e,!0,m)},dispose:function(e){var t=this._simulateMouseEvents;t&&t._bindUnBindTouchEvents(e,!1,m)}}),e.exports=v}()},function(e,t){e.exports=GC.Spread.Common},function(e,t){e.exports=GC.Spread.Sheets},function(e,t){!function(){"use strict";e.exports={ToolStrip_PasteText:"Paste",ToolStrip_CutText:"Cut",ToolStrip_CopyText:"Copy",ToolStrip_AutoFillText:"AutoFill"}}()}]);